/*! For license information please see main.js.LICENSE.txt */
(()=>{var e={1733:function(e,t){!function(e){"use strict";function t(e){return Array.prototype.slice.call(e)}function n(e){return new Promise((function(t,n){e.onsuccess=function(){t(e.result)},e.onerror=function(){n(e.error)}}))}function i(e,t,i){var r,s=new Promise((function(s,o){n(r=e[t].apply(e,i)).then(s,o)}));return s.request=r,s}function r(e,t,n){var r=i(e,t,n);return r.then((function(e){if(e)return new u(e,r.request)}))}function s(e,t,n){n.forEach((function(n){Object.defineProperty(e.prototype,n,{get:function(){return this[t][n]},set:function(e){this[t][n]=e}})}))}function o(e,t,n,r){r.forEach((function(r){r in n.prototype&&(e.prototype[r]=function(){return i(this[t],r,arguments)})}))}function a(e,t,n,i){i.forEach((function(i){i in n.prototype&&(e.prototype[i]=function(){return this[t][i].apply(this[t],arguments)})}))}function c(e,t,n,i){i.forEach((function(i){i in n.prototype&&(e.prototype[i]=function(){return r(this[t],i,arguments)})}))}function l(e){this._index=e}function u(e,t){this._cursor=e,this._request=t}function h(e){this._store=e}function d(e){this._tx=e,this.complete=new Promise((function(t,n){e.oncomplete=function(){t()},e.onerror=function(){n(e.error)},e.onabort=function(){n(e.error)}}))}function p(e,t,n){this._db=e,this.oldVersion=t,this.transaction=new d(n)}function f(e){this._db=e}s(l,"_index",["name","keyPath","multiEntry","unique"]),o(l,"_index",IDBIndex,["get","getKey","getAll","getAllKeys","count"]),c(l,"_index",IDBIndex,["openCursor","openKeyCursor"]),s(u,"_cursor",["direction","key","primaryKey","value"]),o(u,"_cursor",IDBCursor,["update","delete"]),["advance","continue","continuePrimaryKey"].forEach((function(e){e in IDBCursor.prototype&&(u.prototype[e]=function(){var t=this,i=arguments;return Promise.resolve().then((function(){return t._cursor[e].apply(t._cursor,i),n(t._request).then((function(e){if(e)return new u(e,t._request)}))}))})})),h.prototype.createIndex=function(){return new l(this._store.createIndex.apply(this._store,arguments))},h.prototype.index=function(){return new l(this._store.index.apply(this._store,arguments))},s(h,"_store",["name","keyPath","indexNames","autoIncrement"]),o(h,"_store",IDBObjectStore,["put","add","delete","clear","get","getAll","getKey","getAllKeys","count"]),c(h,"_store",IDBObjectStore,["openCursor","openKeyCursor"]),a(h,"_store",IDBObjectStore,["deleteIndex"]),d.prototype.objectStore=function(){return new h(this._tx.objectStore.apply(this._tx,arguments))},s(d,"_tx",["objectStoreNames","mode"]),a(d,"_tx",IDBTransaction,["abort"]),p.prototype.createObjectStore=function(){return new h(this._db.createObjectStore.apply(this._db,arguments))},s(p,"_db",["name","version","objectStoreNames"]),a(p,"_db",IDBDatabase,["deleteObjectStore","close"]),f.prototype.transaction=function(){return new d(this._db.transaction.apply(this._db,arguments))},s(f,"_db",["name","version","objectStoreNames"]),a(f,"_db",IDBDatabase,["close"]),["openCursor","openKeyCursor"].forEach((function(e){[h,l].forEach((function(n){e in n.prototype&&(n.prototype[e.replace("open","iterate")]=function(){var n=t(arguments),i=n[n.length-1],r=this._store||this._index,s=r[e].apply(r,n.slice(0,-1));s.onsuccess=function(){i(s.result)}})}))})),[l,h].forEach((function(e){e.prototype.getAll||(e.prototype.getAll=function(e,t){var n=this,i=[];return new Promise((function(r){n.iterateCursor(e,(function(e){e?(i.push(e.value),void 0===t||i.length!=t?e.continue():r(i)):r(i)}))}))})})),e.openDb=function(e,t,n){var r=i(indexedDB,"open",[e,t]),s=r.request;return s&&(s.onupgradeneeded=function(e){n&&n(new p(s.result,e.oldVersion,s.transaction))}),r.then((function(e){return new f(e)}))},e.deleteDb=function(e){return i(indexedDB,"deleteDatabase",[e])},Object.defineProperty(e,"__esModule",{value:!0})}(t)},3340:function(e,t){"use strict";var n=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,s){function o(e){try{c(i.next(e))}catch(e){s(e)}}function a(e){try{c(i.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.WaxEventSource=class{constructor(e){this.waxSigningURL=e,this.timeout=()=>n(this,void 0,void 0,(function*(){return new Promise(((e,t)=>setTimeout((()=>t(new Error("Timeout"))),5e3)))})),this.openEventSource=this.openEventSource.bind(this),this.onceEvent=this.onceEvent.bind(this)}openPopup(e){return n(this,void 0,void 0,(function*(){const t=yield window.open(e,"WaxPopup","height=800,width=600");if(t)return t;throw new Error("Unable to open popup window")}))}openEventSource(e,t,i){return n(this,void 0,void 0,(function*(){const r=i||(yield this.openPopup(e));if(!r)throw new Error("Unable to open a popup window");if(void 0===t)return r;const s=this.onceEvent(r,this.waxSigningURL,(e=>n(this,void 0,void 0,(function*(){"READY"===e.data.type&&r.postMessage(t,this.waxSigningURL)}))),"READY");return yield Promise.race([s,this.timeout()]).catch((e=>{if("Timeout"!==e.message)throw e;r.postMessage(t,this.waxSigningURL)})),r}))}onceEvent(e,t,i,r){return n(this,void 0,void 0,(function*(){return new Promise(((s,o)=>{window.addEventListener("message",(function a(c){return n(this,void 0,void 0,(function*(){if(c.origin===t&&c.source===e&&"object"==typeof c.data&&(!r||c.data.type&&c.data.type===r)){try{s(yield i(c))}catch(e){o(e)}window.removeEventListener("message",a,!1)}}))}),!1)}))}))}}},7975:function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,s){function o(e){try{c(i.next(e))}catch(e){s(e)}}function a(e){try{c(i.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const r=n(3340);t.WaxSigningApi=class{constructor(e,t){this.waxSigningURL=e,this.waxAutoSigningURL=t,this.waxEventSource=new r.WaxEventSource(e)}login(){return i(this,void 0,void 0,(function*(){if(this.user||(yield this.loginViaWindow()),this.user)return this.user;throw new Error("Login failed")}))}tryAutologin(){return i(this,void 0,void 0,(function*(){if(this.user)return!0;try{return yield this.loginViaEndpoint(),!0}catch(e){return!1}}))}prepareTransaction(e){return i(this,void 0,void 0,(function*(){this.canAutoSign(e)||(this.signingWindow=yield this.waxEventSource.openPopup(`${this.waxSigningURL}/cloud-wallet/signing/`))}))}signing(e,t,n=!1){return i(this,void 0,void 0,(function*(){if(this.canAutoSign(e))try{return yield this.signViaEndpoint(t,n)}catch(e){}return yield this.signViaWindow(t,this.signingWindow,n)}))}loginViaWindow(){return i(this,void 0,void 0,(function*(){const e=yield this.waxEventSource.openEventSource(`${this.waxSigningURL}/cloud-wallet/login/`);return this.waxEventSource.onceEvent(e,this.waxSigningURL,this.receiveLogin.bind(this),void 0)}))}loginViaEndpoint(){return i(this,void 0,void 0,(function*(){const e=yield fetch(`${this.waxAutoSigningURL}login`,{credentials:"include",method:"get"});if(!e.ok)throw new Error(`Login Endpoint Error ${e.status} ${e.statusText}`);const t=yield e.json();if(t.processed&&t.processed.except)throw new Error(t);return this.receiveLogin({data:t})}))}signViaEndpoint(e,t=!1){return i(this,void 0,void 0,(function*(){const n=new AbortController;setTimeout((()=>n.abort()),5e3);const i=yield fetch(`${this.waxAutoSigningURL}signing`,{body:JSON.stringify({freeBandwidth:!t,transaction:Object.values(e)}),credentials:"include",headers:{"Content-Type":"application/json"},method:"POST",signal:n.signal});if(!i.ok)throw this.whitelistedContracts=[],new Error(`Signing Endpoint Error ${i.status} ${i.statusText}`);const r=yield i.json();if(r.processed&&r.processed.except)throw this.whitelistedContracts=[],new Error(`Error returned from signing endpoint: ${JSON.stringify(r)}`);return this.receiveSignatures({data:r})}))}signViaWindow(e,t,n=!1){return i(this,void 0,void 0,(function*(){const i=yield this.waxEventSource.openEventSource(`${this.waxSigningURL}/cloud-wallet/signing/`,{freeBandwidth:!n,transaction:e,type:"TRANSACTION"},t);return this.waxEventSource.onceEvent(i,this.waxSigningURL,this.receiveSignatures.bind(this),"TX_SIGNED")}))}receiveLogin(e){return i(this,void 0,void 0,(function*(){const{verified:t,userAccount:n,pubKeys:i,whitelistedContracts:r}=e.data;if(!t)throw new Error("User declined to share their user account");if(!n||!i)throw new Error("User does not have a blockchain account");return this.whitelistedContracts=r||[],this.user={account:n,keys:i},!0}))}receiveSignatures(e){return i(this,void 0,void 0,(function*(){if("TX_SIGNED"===e.data.type){const{verified:t,signatures:n,whitelistedContracts:i,serializedTransaction:r}=e.data;if(!t||!n)throw new Error("User declined to sign the transaction");return this.whitelistedContracts=i||[],{serializedTransaction:r,signatures:n}}throw new Error(`Unexpected response received when attempting signing: ${JSON.stringify(e.data)}`)}))}canAutoSign(e){const t=navigator.userAgent.toLowerCase();return!(-1===t.search("chrome")&&t.search("safari")>=0||e.actions.find((e=>!this.isWhitelisted(e))))}isWhitelisted(e){return!(!this.whitelistedContracts||!this.whitelistedContracts.find((t=>t.contract===e.account&&("eosio.token"!==e.account||"transfer"!==e.name||t.recipients.includes(e.data.to)))))}}},6356:function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,s){function o(e){try{c(i.next(e))}catch(e){s(e)}}function a(e){try{c(i.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const r=n(7678),s=n(7975);function o(e,t,n){const{actions:i}=t,{actions:r}=n;if(JSON.stringify(i)!==JSON.stringify(r.slice(r.length-i.length)))throw new Error(`Augmented transaction actions has modified actions from the original.\nOriginal: ${JSON.stringify(i,void 0,2)}\nAugmented: ${JSON.stringify(r,void 0,2)}`);for(const t of r.slice(0,r.length-i.length))if(t.authorization.find((t=>t.actor===e.account)))throw new Error(`Augmented transaction actions has an extra action from the original authorizing the user.\nOriginal: ${JSON.stringify(i,void 0,2)}\nAugmented: ${JSON.stringify(r,void 0,2)}`)}t.WaxJS=class{constructor({rpcEndpoint:e,tryAutoLogin:t=!0,userAccount:n,pubKeys:a,apiSigner:c,waxSigningURL:l="https://all-access.wax.io",waxAutoSigningURL:u="https://api-idm.wax.io/v1/accounts/auto-accept/",eosApiArgs:h={},freeBandwidth:d=!0,verifyTx:p=o}){this.signingApi=new s.WaxSigningApi(l,u),this.rpc=new r.JsonRpc(e),this.waxSigningURL=l,this.waxAutoSigningURL=u,this.apiSigner=c,this.eosApiArgs=h,this.freeBandwidth=d,this.verifyTx=p,n&&Array.isArray(a)?this.receiveLogin({account:n,keys:a}):t&&this.signingApi.tryAutologin().then((e=>i(this,void 0,void 0,(function*(){e&&this.receiveLogin(yield this.signingApi.login())}))))}get userAccount(){return this.user&&this.user.account}get pubKeys(){return this.user&&this.user.keys}login(){return i(this,void 0,void 0,(function*(){return this.user||this.receiveLogin(yield this.signingApi.login()),this.user.account}))}isAutoLoginAvailable(){return i(this,void 0,void 0,(function*(){return!!this.user||!!(yield this.signingApi.tryAutologin())&&(this.receiveLogin(yield this.signingApi.login()),!0)}))}receiveLogin(e){this.user=e;const t={getAvailableKeys:()=>i(this,void 0,void 0,(function*(){return[...this.user.keys,...this.apiSigner&&(yield this.apiSigner.getAvailableKeys())||[]]})),sign:e=>i(this,void 0,void 0,(function*(){const t=yield this.api.deserializeTransactionWithActions(e.serializedTransaction),{serializedTransaction:n,signatures:i}=yield this.signingApi.signing(t,e.serializedTransaction,!this.freeBandwidth),r=yield this.api.deserializeTransactionWithActions(n);return this.verifyTx(this.user,t,r),e.serializedTransaction=n,{serializedTransaction:n,signatures:[...i,...this.apiSigner&&(yield this.apiSigner.sign(e)).signatures||[]]}}))};this.api=new r.Api(Object.assign(Object.assign({},this.eosApiArgs),{rpc:this.rpc,signatureProvider:t}));const n=this.api.transact.bind(this.api);this.api.transact=(e,t)=>i(this,void 0,void 0,(function*(){return yield this.signingApi.prepareTransaction(e),yield n(e,t)}))}}},146:function(e,t,n){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const r=i(n(7809)),s=i(n(2334));function o(e,t){var n;const i={};for(const e of t){const t=null!==(n=e.type)&&void 0!==n?n:"data";"number"==typeof e.value?i[t+":number."+e.key]=String(e.value):"boolean"==typeof e.value?i[t+":bool."+e.key]=e.value?"true":"false":i[t+"."+e.key]=e.value}return Object.assign({},e,i)}t.default=class{constructor(e,t,n){this.endpoint=e,this.namespace=t,n.fetch?this.fetchBuiltin=n.fetch:this.fetchBuiltin=window.fetch,this.action=(async()=>new r.default((await this.getConfig()).contract,this))()}async getConfig(){return await this.fetchEndpoint("/v1/config",{})}async getAssets(e={},t=1,n=100,i=[]){return await this.fetchEndpoint("/v1/assets",Object.assign({page:t,limit:n},o(e,i)))}async countAssets(e,t=[]){return await this.countEndpoint("/v1/assets",o(e,t))}async getAsset(e){return await this.fetchEndpoint("/v1/assets/"+e,{})}async getAssetStats(e){return await this.fetchEndpoint("/v1/assets/"+e+"/stats",{})}async getAssetLogs(e,t=1,n=100,i="desc"){return await this.fetchEndpoint("/v1/assets/"+e+"/logs",{page:t,limit:n,order:i})}async getCollections(e={},t=1,n=100){return await this.fetchEndpoint("/v1/collections",Object.assign({page:t,limit:n},e))}async countCollections(e={}){return await this.countEndpoint("/v1/collections",e)}async getCollection(e){return await this.fetchEndpoint("/v1/collections/"+e,{})}async getCollectionStats(e){return await this.fetchEndpoint("/v1/collections/"+e+"/stats",{})}async getCollectionLogs(e,t=1,n=100,i="desc"){return await this.fetchEndpoint("/v1/collections/"+e+"/logs",{page:t,limit:n,order:i})}async getSchemas(e={},t=1,n=100){return await this.fetchEndpoint("/v1/schemas",Object.assign({page:t,limit:n},e))}async countSchemas(e={}){return await this.countEndpoint("/v1/schemas",e)}async getSchema(e,t){return await this.fetchEndpoint("/v1/schemas/"+e+"/"+t,{})}async getSchemaStats(e,t){return await this.fetchEndpoint("/v1/schemas/"+e+"/"+t+"/stats",{})}async getSchemaLogs(e,t,n=1,i=100,r="desc"){return await this.fetchEndpoint("/v1/schemas/"+e+"/"+t+"/logs",{page:n,limit:i,order:r})}async getTemplates(e={},t=1,n=100,i=[]){return await this.fetchEndpoint("/v1/templates",Object.assign({page:t,limit:n},o(e,i)))}async countTemplates(e={},t=[]){return await this.countEndpoint("/v1/templates",o(e,t))}async getTemplate(e,t){return await this.fetchEndpoint("/v1/templates/"+e+"/"+t,{})}async getTemplateStats(e,t){return await this.fetchEndpoint("/v1/templates/"+e+"/"+t+"/stats",{})}async getTemplateLogs(e,t,n=1,i=100,r="desc"){return await this.fetchEndpoint("/v1/templates/"+e+"/"+t+"/logs",{page:n,limit:i,order:r})}async getTransfers(e={},t=1,n=100){return await this.fetchEndpoint("/v1/transfers",Object.assign({page:t,limit:n},e))}async countTransfers(e={}){return await this.countEndpoint("/v1/transfers",e)}async getOffers(e={},t=1,n=100){return await this.fetchEndpoint("/v1/offers",Object.assign({page:t,limit:n},e))}async countOffers(e={}){return await this.countEndpoint("/v1/offers",e)}async getOffer(e){return await this.fetchEndpoint("/v1/offers/"+e,{})}async getAccounts(e={},t=1,n=100){return await this.fetchEndpoint("/v1/accounts",Object.assign({page:t,limit:n},e))}async getBurns(e={},t=1,n=100){return await this.fetchEndpoint("/v1/burns",Object.assign({page:t,limit:n},e))}async countAccounts(e={}){return await this.countEndpoint("/v1/accounts",e)}async getAccount(e,t={}){return await this.fetchEndpoint("/v1/accounts/"+e,t)}async getAccountCollection(e,t){return await this.fetchEndpoint("/v1/accounts/"+e+"/"+t,{})}async getAccountBurns(e,t={}){return await this.fetchEndpoint("/v1/burns/"+e,t)}async fetchEndpoint(e,t){let n,i;const r=this.fetchBuiltin,o=Object.keys(t).map((e=>{let n=t[e];return!0===n&&(n="true"),!1===n&&(n="false"),e+"="+encodeURIComponent(n)})).join("&");try{n=await r(this.endpoint+"/"+this.namespace+e+(o.length>0?"?"+o:"")),i=await n.json()}catch(e){throw new s.default(e.message,500)}if(200!==n.status)throw new s.default(i.message,n.status);if(!i.success)throw new s.default(i.message,n.status);return i.data}async countEndpoint(e,t){const n=await this.fetchEndpoint(e+"/_count",t);return parseInt(n,10)}}},3100:function(e,t,n){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const r=n(5821),s=i(n(3427)),o=i(n(9893)),a=i(n(2929));t.default=class{constructor(e,t,n,i,r,c,l,u=!0){this.api=e,this.owner=t,this.id=n,this._data=new Promise((async(r,s)=>{if(i)r(i);else try{r(await e.queue.fetchAsset(t,n,u))}catch(e){s(e)}})),this._template=new Promise((async(t,n)=>{if(l)t(l);else try{const n=await this._data;if(Number(n.template_id)<0)return t(null);t(new a.default(e,n.collection_name,n.template_id,void 0,void 0,u))}catch(e){n(e)}})),this._collection=new Promise((async(t,n)=>{if(r)t(r);else try{const n=await this._data;t(new s.default(e,n.collection_name,void 0,u))}catch(e){n(e)}})),this._schema=new Promise((async(t,n)=>{if(c)t(c);else try{const n=await this._data;t(new o.default(e,n.collection_name,n.schema_name,void 0,u))}catch(e){n(e)}}))}async template(){return await this._template}async collection(){return await this._collection}async schema(){return await this._schema}async backedTokens(){return(await this._data).backed_tokens}async immutableData(){const e=await this.schema(),t=await this._data;return r.deserialize(t.immutable_serialized_data,await e.format())}async mutableData(){const e=await this.schema(),t=await this._data;return r.deserialize(t.mutable_serialized_data,await e.format())}async data(){const e=await this.mutableData(),t=await this.immutableData(),n=await this.template(),i=n?await n.immutableData():{};return Object.assign({},e,t,i)}async toObject(){const e=await this.template(),t=await this.collection(),n=await this.schema();return{asset_id:this.id,collection:await t.toObject(),schema:await n.toObject(),template:e?await e.toObject():null,backedTokens:await this.backedTokens(),immutableData:await this.immutableData(),mutableData:await this.mutableData(),data:await this.data()}}}},2236:function(e,t,n){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const r=i(n(9105));t.default=class{constructor(){this.cache=new r.default({expiryCheckInterval:6e4})}getAsset(e,t){return t&&(t.mutable_serialized_data=new Uint8Array(t.mutable_serialized_data),t.immutable_serialized_data=new Uint8Array(t.immutable_serialized_data)),this.access("assets",e,t)}deleteAsset(e){this.delete("assets",e)}getTemplate(e,t,n){return n&&(n.immutable_serialized_data=new Uint8Array(n.immutable_serialized_data)),this.access("templates",e+":"+t,n)}deleteTemplate(e,t){this.delete("templates",e+":"+t)}getSchema(e,t,n){return this.access("schemas",e+":"+t,n)}deleteSchema(e,t){this.delete("schemas",e+":"+t)}getCollection(e,t){return this.access("collections",e,t)}deleteCollection(e){this.delete("collections",e)}getOffer(e,t){return this.access("offers",e,t)}deleteOffer(e){this.delete("offers",e)}access(e,t,n){if(void 0===n){const n=this.cache.get(e+":"+t);return null===n?null:n.value}return this.cache.put(e+":"+t,n,9e5),n}delete(e,t){this.cache.remove(e+":"+t)}}},3427:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(2643),r=n(5821);t.default=class{constructor(e,t,n,i=!0){this.api=e,this.name=t,this._data=new Promise((async(r,s)=>{if(n)r(n);else try{r(await e.queue.fetchCollection(t,i))}catch(e){s(e)}}))}async author(){return(await this._data).author}async allowNotify(){return(await this._data).allow_notify}async authorizedAccounts(){return(await this._data).authorized_accounts}async notifyAccounts(){return(await this._data).notify_accounts}async marketFee(){return Number((await this._data).market_fee)}async data(){return r.deserialize((await this._data).serialized_data,i.ObjectSchema((await this.api.config()).collection_format))}async toObject(){return{collection_name:this.name,author:await this.author(),allowNotify:await this.allowNotify(),authorizedAccounts:await this.authorizedAccounts(),notifyAccounts:await this.notifyAccounts(),marketFee:await this.marketFee(),data:await this.data()}}}},2613:function(e,t,n){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const r=i(n(3100));t.default=class{constructor(e,t,n,i,s,o=!0){this.api=e,this.id=t,this._data=new Promise((async(e,i)=>{if(n)e(n);else try{e(await this.api.queue.fetchOffer(t,o))}catch(e){i(e)}})),this._senderAssets=new Promise((async(e,t)=>{if(i)e(i);else try{const t=await this._data,n=await this.api.queue.fetchAccountAssets(t.sender);return e(t.sender_asset_ids.map((e=>{const i=n.find((t=>t.asset_id===e));return i?new r.default(this.api,t.sender,e,i,void 0,void 0,void 0,o):e})))}catch(e){return t(e)}})),this._recipientAssets=new Promise((async(e,t)=>{if(s)e(s);else try{const t=await this._data,n=await this.api.queue.fetchAccountAssets(t.recipient);return e(t.recipient_asset_ids.map((e=>{const i=n.find((t=>t.asset_id===e));return i?new r.default(this.api,t.recipient,e,i,void 0,void 0,void 0,o):e})))}catch(e){return t(e)}}))}async sender(){return(await this._data).sender}async recipient(){return(await this._data).recipient}async senderAssets(){return await this._senderAssets}async recipientAssets(){return await this._recipientAssets}async memo(){return(await this._data).memo}async toObject(){return{offer_id:this.id,sender:{account:await this.sender(),assets:await Promise.all((await this.senderAssets()).map((async e=>"string"==typeof e?e:await e.toObject())))},recipient:{account:await this.recipient(),assets:await Promise.all((await this.recipientAssets()).map((async e=>"string"==typeof e?e:await e.toObject())))},memo:await this.memo()}}}},6970:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=class{constructor(e,t=4){this.api=e,this.requestLimit=t,this.elements=[],this.interval=null,this.preloadedCollections={}}async fetchAsset(e,t,n=!0){return await this.fetch_single_row("assets",e,t,(e=>n||void 0!==e?this.api.cache.getAsset(t,e):null))}async fetchAccountAssets(e){return(await this.fetch_all_rows("assets",e,"asset_id")).map((e=>this.api.cache.getAsset(e.asset_id,e)))}async fetchTemplate(e,t,n=!0){return await this.fetch_single_row("templates",e,t,(i=>n||void 0!==i?this.api.cache.getTemplate(e,t,i):null))}async fetchSchema(e,t,n=!0){return await this.fetch_single_row("schemas",e,t,(i=>n||void 0!==i?this.api.cache.getSchema(e,t,i):null))}async fetchCollection(e,t=!0){return await this.fetch_single_row("collections",this.api.contract,e,(n=>t||void 0!==n?this.api.cache.getCollection(e,n):null))}async fetchCollectionSchemas(e){return(await this.fetch_all_rows("schemas",e,"schema_name")).map((t=>this.api.cache.getSchema(e,t.schema_name,t)))}async fetchCollectionTemplates(e){return(await this.fetch_all_rows("templates",e,"template_id")).map((t=>this.api.cache.getTemplate(e,String(t.template_id),t)))}async preloadCollection(e,t=!0){(!t||!this.preloadedCollections[e]||this.preloadedCollections[e]+9e5<Date.now())&&(await this.fetchCollectionSchemas(e),await this.fetchCollectionTemplates(e))}async fetchOffer(e,t=!0){return await this.fetch_single_row("offers",this.api.contract,e,(n=>t||void 0!==n?this.api.cache.getOffer(e,n):null))}async fetchAccountOffers(e){const t=await Promise.all([this.fetch_all_rows("offers",this.api.contract,"offer_sender",e,e,2,"name"),this.fetch_all_rows("offers",this.api.contract,"offer_recipient",e,e,3,"name")]);return t[0].concat(t[1]).map((e=>this.api.cache.getOffer(e.offer_id,e)))}dequeue(){this.interval||(this.interval=setInterval((async()=>{this.elements.length>0?this.elements.shift()():(clearInterval(this.interval),this.interval=null)}),Math.ceil(1e3/this.requestLimit)))}async fetch_single_row(e,t,n,i,r=1,s=""){return new Promise(((o,a)=>{let c=i();if(null!==c)return o(c);this.elements.push((async()=>{if(c=i(),null!==c)return o(c);try{const c={code:this.api.contract,table:e,scope:t,limit:1,lower_bound:n,upper_bound:n,index_position:r,key_type:s},l=await this.api.getTableRows(c);return 0===l.rows.length?a(new Error("Row not found for "+JSON.stringify(c))):o(i(l.rows[0]))}catch(e){return a(e)}})),this.dequeue()}))}async fetch_all_rows(e,t,n,i="",r="",s=1,o=""){return new Promise((async(a,c)=>{this.elements.push((async()=>{const l=await this.api.getTableRows({code:this.api.contract,scope:t,table:e,lower_bound:i,upper_bound:r,limit:1e3,index_position:s,key_type:o});l.more&&1===s?(this.elements.unshift((async()=>{try{const i=await this.fetch_all_rows(e,t,n,l.rows[l.rows.length-1][n],r,s,o);i.length>0&&i.shift(),a(l.rows.concat(i))}catch(e){c(e)}})),this.dequeue()):a(l.rows)})),this.dequeue()}))}}},9893:function(e,t,n){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const r=n(2643),s=i(n(3427));t.default=class{constructor(e,t,n,i,r=!0){this.api=e,this.collection=t,this.name=n,this._data=new Promise((async(s,o)=>{if(i)s(i);else try{s(await e.queue.fetchSchema(t,n,r))}catch(e){o(e)}})),this._collection=new Promise((async(n,i)=>{try{n(new s.default(e,t,void 0,r))}catch(e){i(e)}}))}async format(){return r.ObjectSchema((await this._data).format)}async rawFormat(){return(await this._data).format}async toObject(){return{collection_name:this.collection,schema_name:this.name,format:await this.rawFormat()}}}},2929:function(e,t,n){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const r=n(5821),s=i(n(9893));t.default=class{constructor(e,t,n,i,r,o=!0){this.api=e,this.collection=t,this.id=n,this._data=new Promise((async(r,s)=>{if(i)r(i);else try{r(await e.queue.fetchTemplate(t,n,o))}catch(e){s(e)}})),this._schema=new Promise((async(e,n)=>{if(r)e(r);else try{const n=await this._data;e(new s.default(this.api,t,n.schema_name,void 0,o))}catch(e){n(e)}}))}async schema(){return await this._schema}async immutableData(){const e=await this._schema;return r.deserialize((await this._data).immutable_serialized_data,await e.format())}async isTransferable(){return(await this._data).transferable}async isBurnable(){return(await this._data).burnable}async maxSupply(){return(await this._data).max_supply}async circulation(){return(await this._data).issued_supply}async toObject(){return{collection_name:this.collection,template_id:this.id,schema:await(await this.schema()).toObject(),immutableData:await this.immutableData(),transferable:await this.isTransferable(),burnable:await this.isBurnable(),maxSupply:await this.maxSupply(),circulation:await this.circulation()}}}},5310:function(e,t,n){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const r=i(n(910)),s=i(n(9398)),o=i(n(3100)),a=i(n(2236)),c=i(n(3427)),l=i(n(2613)),u=i(n(6970)),h=i(n(9893)),d=i(n(2929));t.default=class{constructor(e,t,i={rateLimit:4}){this.endpoint=e,this.contract=t,i.fetch?this.fetchBuiltin=i.fetch:this.fetchBuiltin=n.g.fetch,this.queue=new u.default(this,i.rateLimit),this.cache=new a.default,this.action=new r.default(this),this._config=new Promise((async(e,t)=>{try{const n=await this.getTableRows({code:this.contract,scope:this.contract,table:"config"});return 1!==n.rows.length?t("invalid config"):e(n.rows[0])}catch(e){t(e)}}))}async config(){return await this._config}async getAsset(e,t,n=!0){n||this.cache.deleteAsset(t);const i=await this.queue.fetchAsset(e,t,n);return new o.default(this,e,t,i,void 0,void 0,void 0,n)}async getTemplate(e,t,n=!0){n||this.cache.deleteTemplate(e,t);const i=await this.queue.fetchTemplate(e,t,n);return new d.default(this,e,t,i,void 0,n)}async getCollection(e,t=!0){t||this.cache.deleteCollection(e);const n=await this.queue.fetchCollection(e,t);return new c.default(this,e,n,t)}async getCollectionTemplates(e){return(await this.queue.fetchCollectionTemplates(e)).map((t=>new d.default(this,e,String(t.template_id),t,void 0)))}async getCollectionsSchemas(e){return(await this.queue.fetchCollectionSchemas(e)).map((t=>new h.default(this,e,t.schema_name,void 0)))}async getSchema(e,t,n=!0){n||this.cache.deleteSchema(e,t);const i=await this.queue.fetchSchema(e,t,n);return new h.default(this,e,t,i,n)}async getOffer(e,t=!0){t||this.cache.deleteOffer(e);const n=await this.queue.fetchOffer(e,t);return new l.default(this,e,n,void 0,void 0,t)}async getAccountOffers(e){return(await this.queue.fetchAccountOffers(e)).map((e=>new l.default(this,e.offer_id,e,void 0,void 0)))}async getAccountAssets(e){return(await this.queue.fetchAccountAssets(e)).map((t=>new o.default(this,e,t.asset_id,t,void 0,void 0,void 0)))}async getCollectionInventory(e,t){return await this.queue.preloadCollection(e,!0),(await this.queue.fetchAccountAssets(t)).filter((t=>t.collection_name===e)).map((e=>new o.default(this,t,e.asset_id,e,void 0,void 0,void 0)))}async preloadCollection(e,t=!0){await this.queue.preloadCollection(e,t)}async getTableRows({code:e,scope:t,table:n,table_key:i="",lower_bound:r="",upper_bound:s="",index_position:o=1,key_type:a=""}){return await this.fetchRpc("/v1/chain/get_table_rows",{code:e,scope:t,table:n,table_key:i,lower_bound:r,upper_bound:s,index_position:o,key_type:a,limit:101,reverse:!1,show_payer:!1,json:!0})}async fetchRpc(e,t){let n,i;try{const r=this.fetchBuiltin;n=await r(this.endpoint+e,{body:JSON.stringify(t),method:"POST"}),i=await n.json()}catch(e){throw e.isFetchError=!0,e}if(i.processed&&i.processed.except||!n.ok)throw new s.default(i);return i}}},7809:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(522);class r extends i.ActionGenerator{constructor(e,t){super(e),this.api=t,this.config=t.getConfig()}async createcol(e,t,n,r,s,o,a,c){return super.createcol(e,t,n,r,s,o,a,i.toAttributeMap(c,(await this.config).collection_format))}async createtempl(e,t,n,r,s,o,a,c){const l=await this.api.getSchema(n,r),u=i.toAttributeMap(c,l.format);return super.createtempl(e,t,n,r,s,o,a,u)}async mintasset(e,t,n,r,s,o,a,c,l){const u=await this.api.getSchema(n,r),h=i.toAttributeMap(a,u.format),d=i.toAttributeMap(c,u.format);return super.mintasset(e,t,n,r,s,o,h,d,l)}async setassetdata(e,t,n,r,s){const o=await this.api.getAsset(r),a=i.toAttributeMap(s,o.schema.format);return super.setassetdata(e,t,n,r,a)}async setcoldata(e,t,n){const r=i.toAttributeMap(n,(await this.config).collection_format);return super.setcoldata(e,t,r)}}t.default=r},522:function(e,t,n){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.toAttributeMap=t.ActionGenerator=void 0;const r=i(n(9338));t.ActionGenerator=class{constructor(e){this.contract=e}async acceptoffer(e,t){return this._pack(e,"acceptoffer",{offer_id:t})}async addcolauth(e,t,n){return this._pack(e,"addcolauth",{collection_name:t,account_to_add:n})}async addconftoken(e,t,n){return this._pack(e,"addconftoken",{token_contract:t,token_symbol:n})}async addnotifyacc(e,t,n){return this._pack(e,"addnotifyacc",{collection_name:t,account_to_add:n})}async announcedepo(e,t,n){return this._pack(e,"announcedepo",{owner:t,symbol_to_announce:n})}async backasset(e,t,n,i,r){return this._pack(e,"backasset",{payer:t,asset_owner:n,asset_id:i,token_to_back:r})}async burnasset(e,t,n){return this._pack(e,"burnasset",{asset_owner:t,asset_id:n})}async canceloffer(e,t){return this._pack(e,"canceloffer",{offer_id:t})}async createcol(e,t,n,i,r,s,o,a){return this._pack(e,"createcol",{author:t,collection_name:n,allow_notify:i,authorized_accounts:r,notify_accounts:s,market_fee:o,data:a})}async createoffer(e,t,n,i,r,s){return this._pack(e,"createoffer",{sender:t,recipient:n,sender_asset_ids:i,recipient_asset_ids:r,memo:s})}async createtempl(e,t,n,i,r,s,o,a){return this._pack(e,"createtempl",{authorized_creator:t,collection_name:n,schema_name:i,transferable:r,burnable:s,max_supply:o,immutable_data:a})}async createschema(e,t,n,i,r){return this._pack(e,"createschema",{authorized_creator:t,collection_name:n,schema_name:i,schema_format:r})}async declineoffer(e,t){return this._pack(e,"declineoffer",{offer_id:t})}async extendschema(e,t,n,i,r){return this._pack(e,"extendschema",{authorized_editor:t,collection_name:n,schema_name:i,schema_format_extension:r})}async forbidnotify(e,t){return this._pack(e,"forbidnotify",{collection_name:t})}async locktemplate(e,t,n,i){return this._pack(e,"locktemplate",{authorized_editor:t,collection_name:n,template_id:i})}async mintasset(e,t,n,i,r,s,o,a,c){return this._pack(e,"mintasset",{authorized_minter:t,collection_name:n,schema_name:i,template_id:r,new_asset_owner:s,immutable_data:o,mutable_data:a,tokens_to_back:c})}async payofferram(e,t,n){return this._pack(e,"payofferram",{payer:t,offer_id:n})}async remcolauth(e,t,n){return this._pack(e,"remcolauth",{collection_name:t,account_to_remove:n})}async remnotifyacc(e,t,n){return this._pack(e,"remnotifyacc",{collection_name:t,account_to_remove:n})}async setassetdata(e,t,n,i,r){return this._pack(e,"setassetdata",{authorized_editor:t,asset_owner:n,asset_id:i,new_mutable_data:r})}async setcoldata(e,t,n){return this._pack(e,"setcoldata",{collection_name:t,data:n})}async setmarketfee(e,t,n){return this._pack(e,"setmarketfee",{collection_name:t,market_fee:n})}async transfer(e,t,n,i,r){return this._pack(e,"transfer",{from:t,to:n,asset_ids:i,memo:r})}async withdraw(e,t,n){return this._pack(e,"withdraw",{owner:t,token_to_withdraw:n})}_pack(e,t,n){return[{account:this.contract,name:t,authorization:e,data:n}]}},t.toAttributeMap=function(e,t){const n={},i=[];for(const e of t)n[e.name]=e.type;const s=Object.keys(e);for(const t of s){if(void 0!==n[t])throw new r.default("field not defined in schema");i.push({key:t,value:[n[t],e[t]]})}return i}},910:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(522);class r extends i.ActionGenerator{constructor(e){super(e.contract),this.api=e}async createcol(e,t,n,r,s,o,a,c){const l=await this.api.config();return super.createcol(e,t,n,r,s,o,a,i.toAttributeMap(c,l.collection_format))}async createtempl(e,t,n,r,s,o,a,c){const l=await this.api.getSchema(n,r),u=i.toAttributeMap(c,await l.rawFormat());return super.createtempl(e,t,n,r,s,o,a,u)}async mintasset(e,t,n,r,s,o,a,c,l){const u=await this.api.getTemplate(n,s),h=i.toAttributeMap(a,await(await u.schema()).rawFormat()),d=i.toAttributeMap(c,await(await u.schema()).rawFormat());return super.mintasset(e,t,n,r,s,o,h,d,l)}async setassetdata(e,t,n,r,s){const o=await this.api.getAsset(n,r),a=await o.schema(),c=i.toAttributeMap(s,await a.rawFormat());return super.setassetdata(e,t,n,r,c)}async setcoldata(e,t,n){const r=i.toAttributeMap(n,(await this.api.config()).collection_format);return super.setcoldata(e,t,r)}}t.default=r},2334:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});class n extends Error{constructor(e,t){super(e),this.message=e,this.status=t,this.isApiError=!0}}t.default=n},1100:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});class n extends Error{}t.default=n},9398:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});class n extends Error{constructor(e){e.error&&e.error.details&&e.error.details.length&&e.error.details[0].message?super(e.error.details[0].message):e.processed&&e.processed.except&&e.processed.except.message?super(e.processed.except.message):super(e.message),this.json=e}}t.default=n},9312:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});class n extends Error{}t.default=n},9338:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});class n extends Error{}t.default=n},2197:function(e,t,n){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const r=i(n(9312)),s=n(5480);t.default=class{constructor(e){this.attributes=e,this.reserved=4}deserialize(e,t=!1){const n={};for(;e.position<e.data.length;){const i=s.varint_decode(e);if(i.equals(0))break;const r=this.getAttribute(i.toJSNumber(),!t);r&&(n[r.name]=r.value.deserialize(e))}return n}serialize(e){const t=[];for(let n=0;n<this.attributes.length;n++){const i=this.attributes[n];void 0!==e[i.name]&&(t.push(s.varint_encode(n+this.reserved)),t.push(i.value.serialize(e[i.name])))}return t.push(s.varint_encode(0)),s.concat_byte_arrays(t)}getAttribute(e,t=!0){const n=e-this.reserved;if(!(n>=this.attributes.length))return this.attributes[Number(n)];if(t)throw new r.default("attribute does not exists")}}},524:function(e,t,n){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const r=i(n(9312)),s=n(4683);t.default=class{constructor(e){if(void 0===s.ParserTypes[e])throw new r.default(`attribute type '${e}' not defined`);this.parser=s.ParserTypes[e]}deserialize(e){return this.parser.deserialize(e)}serialize(e){return this.parser.serialize(e)}}},2508:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(5480);t.default=class{constructor(e){this.element=e}deserialize(e){const t=i.varint_decode(e).toJSNumber(),n=[];for(let i=0;i<t;i++)n.push(this.element.deserialize(e));return n}serialize(e){const t=[i.varint_encode(e.length)];for(const n of e)t.push(this.element.serialize(n));return i.concat_byte_arrays(t)}}},2643:function(e,t,n){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.ObjectSchema=void 0;const r=i(n(9312)),s=i(n(2197)),o=i(n(524)),a=i(n(2508));function c(e,t){const n=[];let i=t[e];void 0===i&&(i=[]),delete t[e];for(const e of i)n.push({name:e.name,value:l(e.type,t)});return new s.default(n)}function l(e,t){if(e.endsWith("[]"))return new a.default(l(e.substring(0,e.length-2),t));if(e.startsWith("object{")&&e.endsWith("}")){const n=parseInt(e.substring(7,e.length-1),10);if(isNaN(n))throw new r.default(`invalid type '${e}'`);return c(n,t)}return new o.default(e)}t.ObjectSchema=function(e){const t={};for(const n of e){const e=void 0===n.parent?0:n.parent;void 0===t[e]&&(t[e]=[]),t[e].push(n)}return c(0,t)}},5480:function(e,t,n){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.byte_vector_to_int=t.int_to_byte_vector=t.concat_byte_arrays=t.hex_encode=t.hex_decode=t.base58_encode=t.base58_decode=t.zigzag_decode=t.zigzag_encode=t.integer_unsign=t.integer_sign=t.varint_decode=t.varint_encode=void 0;const r=i(n(4574)),s=i(n(1100)),o=i(n(9338)),a=i(n(6607));t.varint_encode=function(e){const t=[];let n=r.default(e);if(n.lesser(0))throw new o.default("cant pack negative integer");for(;;){const e=n.and(127);if(n=n.shiftRight(7),n.equals(0)){t.push(e.toJSNumber());break}t.push(e.toJSNumber()+128)}return new Uint8Array(t)},t.varint_decode=function(e){let t=r.default(0);for(let n=0;;n++){if(e.position>=e.data.length)throw new s.default("failed to unpack integer");const i=r.default(e.data[e.position]);if(e.position+=1,i.lesser(128)){t=t.plus(i.shiftLeft(7*n));break}t=t.plus(i.and(127).shiftLeft(7*n))}return t},t.integer_sign=function(e,t){const n=r.default(e);if(n.greaterOrEquals(r.default(2).pow(8*t-1)))throw new Error("cannot sign integer: too big");return n.greaterOrEquals(0)?n:n.negate().xor(r.default(2).pow(8*t).minus(1)).plus(1)},t.integer_unsign=function(e,t){const n=r.default(e);if(n.greater(r.default(2).pow(8*t)))throw new Error("cannot unsign integer: too big");return n.greater(r.default(2).pow(8*t-1))?n.minus(1).xor(r.default(2).pow(8*t).minus(1)).negate():n},t.zigzag_encode=function(e){const t=r.default(e);return t.lesser(0)?t.plus(1).multiply(-2).plus(1):t.multiply(2)},t.zigzag_decode=function(e){const t=r.default(e);return t.mod(2).equals(0)?t.divmod(2).quotient:t.divmod(2).quotient.multiply(-1).minus(1)};const c=new a.default("123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz");t.base58_decode=function(e){return c.decode(e)},t.base58_encode=function(e){return c.encode(e)},t.hex_decode=function(e){const t=e.match(/.{1,2}/g);return t?new Uint8Array(t.map((e=>parseInt(e,16)))):new Uint8Array(0)},t.hex_encode=function(e){return e.reduce(((e,t)=>e+t.toString(16).padStart(2,"0")),"")},t.concat_byte_arrays=function(e){const t=new Uint8Array(e.reduce(((e,t)=>e+t.length),0));let n=0;for(const i of e)t.set(i,n),n+=i.length;return t},t.int_to_byte_vector=function(e){const t=[];let n=r.default(e);for(;n.notEquals(0);)t.push(n.and(255).toJSNumber()),n=n.shiftRight(8);return new Uint8Array(t)},t.byte_vector_to_int=function(e){let t=r.default(0);for(let n=0;n<e.length;n++)t=t.plus(r.default(e[n]).shiftLeft(8*n));return t.toJSNumber()}},6607:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=class{constructor(e){if(this.ALPHABET=e,e.length>=255)throw new TypeError("Alphabet too long");this.BASE_MAP=new Uint8Array(256);for(let e=0;e<this.BASE_MAP.length;e++)this.BASE_MAP[e]=255;for(let t=0;t<e.length;t++){const n=e.charAt(t),i=n.charCodeAt(0);if(255!==this.BASE_MAP[i])throw new TypeError(n+" is ambiguous");this.BASE_MAP[i]=t}this.BASE=e.length,this.LEADER=e.charAt(0),this.FACTOR=Math.log(this.BASE)/Math.log(256),this.iFACTOR=Math.log(256)/Math.log(this.BASE)}encode(e){if(0===e.length)return"";let t=0,n=0,i=0;const r=e.length;for(;i!==r&&0===e[i];)i++,t++;const s=(r-i)*this.iFACTOR+1>>>0,o=new Uint8Array(s);for(;i!==r;){let t=e[i],r=0;for(let e=s-1;(0!==t||r<n)&&-1!==e;e--,r++)t+=256*o[e]>>>0,o[e]=t%this.BASE>>>0,t=t/this.BASE>>>0;if(0!==t)throw new Error("Non-zero carry");n=r,i++}let a=s-n;for(;a!==s&&0===o[a];)a++;let c=this.LEADER.repeat(t);for(;a<s;++a)c+=this.ALPHABET.charAt(o[a]);return c}decode(e){const t=this.decodeUnsafe(e);if(t)return t;throw new Error("Non-base"+this.BASE+" character")}decodeUnsafe(e){if(0===e.length)return new Uint8Array(0);let t=0;if(" "===e[t])return new Uint8Array(0);let n=0,i=0;for(;e[t]===this.LEADER;)n++,t++;const r=(e.length-t)*this.FACTOR+1>>>0,s=new Uint8Array(r);for(;e[t];){let n=this.BASE_MAP[e.charCodeAt(t)];if(255===n)return new Uint8Array(0);let o=0;for(let e=r-1;(0!==n||o<i)&&-1!==e;e--,o++)n+=this.BASE*s[e]>>>0,s[e]=n%256>>>0,n=n/256>>>0;if(0!==n)throw new Error("Non-zero carry");i=o,t++}if(" "===e[t])return new Uint8Array(0);let o=r-i;for(;o!==r&&0===s[o];)o++;const a=new Uint8Array(n+(r-o));a.fill(0,0,n);let c=n;for(;o!==r;)a[c++]=s[o++];return a}}},9694:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.prepare=void 0;class n{constructor(e,t=0){this.data=e,this.position=t}}t.default=n,t.prepare=function(e){return new n(e,0)}},4301:function(e,t,n){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const r=i(n(1321));class s extends r.default{constructor(){super(1)}deserialize(e){return 1===super.deserialize(e)[0]?1:0}serialize(e){return super.serialize(new Uint8Array([e?1:0]))}}t.default=s},944:function(e,t,n){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.ByteParser=void 0;const r=i(n(4661));class s extends r.default{deserialize(e){return super.deserialize(e)}serialize(e){return super.serialize(e)}}t.ByteParser=s},3308:function(e,t,n){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const r=i(n(4574)),s=i(n(1321));class o extends s.default{deserialize(e){const t=super.deserialize(e).reverse();let n=r.default(0);for(const e of t)n=n.shiftLeft(8),n=n.plus(e);return this.size<=6?n.toJSNumber():n.toString()}serialize(e){let t=r.default(e);const n=[];for(let e=0;e<this.size;e++)n.push(t.and(255).toJSNumber()),t=t.shiftRight(8);return super.serialize(new Uint8Array(n))}}t.default=o},1321:function(e,t,n){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const r=i(n(1100)),s=i(n(9338));t.default=class{constructor(e){this.size=e}deserialize(e){e.position+=this.size;const t=e.data.slice(e.position-this.size,e.position);if(t.length!==this.size)throw new r.default("FixedParser: read past end");return t}serialize(e){if(e.length!==this.size)throw new s.default("input data does not conform fixed size");return e}}},1380:function(e,t,n){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const r=i(n(1321)),s=n(31);class o extends r.default{constructor(e){super(e?8:4),this.isDouble=e}deserialize(e){return this.isDouble?s.readDoubleLE(super.deserialize(e)):s.readFloatLE(super.deserialize(e))}serialize(e){let t=[];return this.isDouble?(s.writeDoubleLE(t,e),super.serialize(new Uint8Array(t))):(s.writeFloatLE(t,e),super.serialize(new Uint8Array(t)))}}t.default=o},1734:function(e,t,n){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const r=n(5480),s=i(n(4661));class o extends s.default{deserialize(e){return r.base58_encode(super.deserialize(e))}serialize(e){return super.serialize(r.base58_decode(e))}}t.default=o},5618:function(e,t,n){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const r=i(n(4661));class s extends r.default{deserialize(e){return(new TextDecoder).decode(super.deserialize(e))}serialize(e){return super.serialize((new TextEncoder).encode(e))}}t.default=s},3671:function(e,t,n){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const r=i(n(4574)),s=i(n(1100)),o=i(n(9338)),a=n(5480);t.default=class{constructor(e,t){this.size=e,this.unsigned=t}deserialize(e){let t=a.varint_decode(e);if(this.unsigned||(t=a.zigzag_decode(t)),t.greaterOrEquals(r.default(2).pow(8*this.size-(this.unsigned?0:1))))throw new s.default("number '"+t.toString()+"' too large for given type");return this.size<=6?t.toJSNumber():t.toString()}serialize(e){let t=r.default(e);if(t.greaterOrEquals(r.default(2).pow(8*this.size-(this.unsigned?0:1))))throw new o.default("number '"+t.toString()+"' too large for given type");return this.unsigned||(t=a.zigzag_encode(t)),a.varint_encode(t)}}},4661:function(e,t,n){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const r=i(n(1100)),s=n(5480);t.default=class{deserialize(e){const t=s.varint_decode(e).toJSNumber();e.position+=t;const n=e.data.slice(e.position-t,e.position);if(n.length!==t)throw new r.default("VariableParser: read past end");return n}serialize(e){return s.concat_byte_arrays([s.varint_encode(e.length),e])}}},9795:function(e,t,n){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.ParserTypes=void 0;const r=i(n(4301)),s=n(944),o=i(n(3308)),a=i(n(1380)),c=i(n(1734)),l=i(n(5618)),u=i(n(3671));t.ParserTypes={int8:new u.default(1,!1),int16:new u.default(2,!1),int32:new u.default(4,!1),int64:new u.default(8,!1),uint8:new u.default(1,!0),uint16:new u.default(2,!0),uint32:new u.default(4,!0),uint64:new u.default(8,!0),fixed8:new o.default(1),fixed16:new o.default(2),fixed32:new o.default(4),fixed64:new o.default(8),bool:new r.default,bytes:new s.ByteParser,string:new l.default,image:new l.default,ipfs:new c.default,float:new a.default(!1),double:new a.default(!0)}},5821:function(e,t,n){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.deserialize=t.serialize=void 0;const r=i(n(2197)),s=n(5480),o=i(n(9694));t.serialize=function(e,t){const n=t.serialize(e);return t instanceof r.default?n.slice(0,n.length-1):n},t.deserialize=function(e,t){t instanceof r.default&&(e=s.concat_byte_arrays([e,s.varint_encode(0)]));const n=new o.default(e,0);return t.deserialize(n)}},4683:function(e,t,n){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.ActionGenerator=t.ExplorerActionGenerator=t.RpcActionGenerator=t.ParserTypes=t.serialize=t.deserialize=t.ObjectSchema=t.ExplorerApi=t.RpcApi=void 0;const r=i(n(7809));t.ExplorerActionGenerator=r.default;const s=n(522);Object.defineProperty(t,"ActionGenerator",{enumerable:!0,get:function(){return s.ActionGenerator}});const o=i(n(910));t.RpcActionGenerator=o.default;const a=i(n(146));t.ExplorerApi=a.default;const c=i(n(5310));t.RpcApi=c.default;const l=n(2643);Object.defineProperty(t,"ObjectSchema",{enumerable:!0,get:function(){return l.ObjectSchema}});const u=n(5821);Object.defineProperty(t,"deserialize",{enumerable:!0,get:function(){return u.deserialize}}),Object.defineProperty(t,"serialize",{enumerable:!0,get:function(){return u.serialize}});const h=n(9795);Object.defineProperty(t,"ParserTypes",{enumerable:!0,get:function(){return h.ParserTypes}})},31:function(e){"use strict";var t,n,i,r,s,o,a,c,l,u,h,d,p=!1;function f(e,t,n){var i=e[t++],r=e[t++],s=e[t++],o=e[t];return"bige"===n?256*(256*(256*i+r)+s)+o:256*(256*(256*o+s)+r)+i}function _(e,t,n,i){var r=t>>>24&255,s=t>>16&255,o=t>>8&255,a=255&t;"bige"===i?(e[n++]=r,e[n++]=s,e[n++]=o,e[n]=a):(e[n++]=a,e[n++]=o,e[n++]=s,e[n]=r)}function g(e,t,n,i,r){"bige"===r?(_(e,t,i,r),_(e,n,i+4,r)):(_(e,n,i,r),_(e,t,i+4,r))}"function"==typeof Float32Array&&(l=new Float32Array(1),u=new Uint8Array(l.buffer),l[0]=-1,p=0===u[3],t=function(e,t){return(t=t||0)<0||t+4>e.length?0:(u[0]=e[t++],u[1]=e[t++],u[2]=e[t++],u[3]=e[t],l[0])},i=function(e,t){return(t=t||0)<0||t+4>e.length?0:(u[3]=e[t++],u[2]=e[t++],u[1]=e[t++],u[0]=e[t],l[0])},n=function(e,t,n){n=n||0,l[0]=t,e[n++]=u[0],e[n++]=u[1],e[n++]=u[2],e[n]=u[3]},r=function(e,t,n){n=n||0,l[0]=t,e[n++]=u[3],e[n++]=u[2],e[n++]=u[1],e[n]=u[0]}),"function"==typeof Float64Array&&(h=new Float64Array(1),d=new Uint8Array(h.buffer),s=function(e,t){return(t=t||0)<0||t+8>e.length?0:(d[0]=e[t+0],d[1]=e[t+1],d[2]=e[t+2],d[3]=e[t+3],d[4]=e[t+4],d[5]=e[t+5],d[6]=e[t+6],d[7]=e[t+7],h[0])},a=function(e,t){return(t=t||0)<0||t+8>e.length?0:(d[7]=e[t+0],d[6]=e[t+1],d[5]=e[t+2],d[4]=e[t+3],d[3]=e[t+4],d[2]=e[t+5],d[1]=e[t+6],d[0]=e[t+7],h[0])},o=function(e,t,n){n=n||0,h[0]=t,e[n+0]=d[0],e[n+1]=d[1],e[n+2]=d[2],e[n+3]=d[3],e[n+4]=d[4],e[n+5]=d[5],e[n+6]=d[6],e[n+7]=d[7]},c=function(e,t,n){n=n||0,h[0]=t,e[n+0]=d[7],e[n+1]=d[6],e[n+2]=d[5],e[n+3]=d[4],e[n+4]=d[3],e[n+5]=d[2],e[n+6]=d[1],e[n+7]=d[0]});for(var m=new Array,y=0;y<1200;y++)m[y]=Math.pow(2,y);var v=new Array;for(y=0;y<1200;y++)v[y]=Math.pow(2,-y);function w(e){return e>=0?m[e]:v[-e]}function b(e,t,n){var i,r,s=f(e,t,n),o=f(e,t+4,n);"bige"===n?(i=s,r=o):(i=o,r=s);var a=4294967296*(1048575&i)+r,c=(2146435072&i)>>>20;return(i>>31||1)*(0===c?a?a*w(-1074):0:c<2047?a>=0?(1+2220446049250313e-31*a)*w(c-1023):0:a?NaN:1/0)}w(-1023);var k=Math.pow(2,-23),T=Math.pow(2,-127);function E(e,t,n){var i=f(e,t,n),r=8388607&i,s=(2139095040&i)>>>23;return(i>>31||1)*(0===s?r?r*k*2*T:0:s<255?(1+r*k)*w(s-127):r?NaN:1/0)}var I={exp:0,mant:0};function S(e){var t=0;return e>=2?(e*=w(-(t=x(1,e))))>=2&&(e/=2,t+=1):e<1&&((t=x(e,2))<=1023?e*=w(t):(e*=w(t-100),e*=w(100)),t=-t),I.exp=t,I.mant=e,I}var C=Math.pow(2,192);function x(e,t){for(var n=0;e*C<t;)e*=C,n+=192;for(;0x10000000000000000*e<t;)e*=0x10000000000000000,n+=64;for(;65536*e<t;)e*=65536,n+=16;for(;64*e<t;)e*=64,n+=6;for(;2*e<t;)e*=2,n+=1;return n}function A(e,t){return(e*=t)-Math.floor(e)!=.5||1&e?e+.5:e}function N(e,t,n,i){var r,s=0;t<0&&(s=2147483648,t=-t),t&&t<1/0?((r=S(t)).exp+=127,r.exp<=0?r.exp<=-25?(r.mant=0,r.exp=0):(r.mant=A(r.mant,w(22+r.exp)),r.exp=0,r.mant>=8388608&&(r.mant-=8388608,r.exp+=1)):(r.mant=A(r.mant-1,8388608),r.mant>=8388608&&(r.mant-=8388608,r.exp+=1),r.exp>254&&(r.mant=0,r.exp=255)),_(e,s|r.exp<<23|r.mant,n,i)):_(e,0===t?1/t<0?2147483648:0:t===1/0?2139095040|s:2143289344,n,i)}new Uint8Array(8);var P=Math.pow(2,52);function O(e,t,n,i){var r,s,o,a=0;t<0&&(a=2147483648,t=-t),t&&t<1/0?((r=S(t)).exp+=1023,r.exp<=0?(r.mant*=w(51+r.exp),r.exp=0):r.mant=(r.mant-1)*P,g(e,s=a|r.exp<<20|r.mant/4294967296,o=r.mant>>>0,n,i)):(0===t?(s=1/t<0?2147483648:0,o=0):t===1/0?(s=a+2146435072,o=0):(s=2146959360,o=0),g(e,s,o,n,i))}(function l(){var u=e.exports||this;u.readWord=f,u.writeWord=_,u.writeDoubleWord=g,u.readFloat=E,u.writeFloat=N,u.readDouble=b,u.writeDouble=O,u._useFloatArray=function(e){u._usingFloatArray=e,e?("full"==e&&(u.readFloatLE=p?i:t),u.writeFloatLE=p?r:n,"full"==e&&(u.readFloatBE=p?t:i),u.writeFloatBE=p?n:r,u.readDoubleLE=p?a:s,u.writeDoubleLE=p?c:o,u.readDoubleBE=p?s:a,u.writeDoubleBE=p?o:c):(u._usingFloatArray="",u.readFloatLE=function(e,t){return u.readFloat(e,t||0,"le")},u.writeFloatLE=function(e,t,n){u.writeFloat(e,t,n||0,"le")},u.readFloatBE=function(e,t){return u.readFloat(e,t||0,"bige")},u.writeFloatBE=function(e,t,n){u.writeFloat(e,t,n||0,"bige")},u.readDoubleLE=function(e,t){return u.readDouble(e,t||0,"le")},u.writeDoubleLE=function(e,t,n){u.writeDouble(e,t,n||0,"le")},u.readDoubleBE=function(e,t){return u.readDouble(e,t||0,"bige")},u.writeDoubleBE=function(e,t,n){u.writeDouble(e,t,n||0,"bige")})},u._getBigeCpu=function(){return p},u._setBigeCpu=function(e){p=e},u._useFloatArray(!1),u._useFloatArray(t&&s&&"fastest"),l.prototype=u}).call(this)},4574:(e,t,n)=>{var i;e=n.nmd(e);var r=function(e){"use strict";var t=1e7,n=9007199254740992,i=d(n),s="0123456789abcdefghijklmnopqrstuvwxyz",o="function"==typeof BigInt;function a(e,t,n,i){return void 0===e?a[0]:void 0===t||10==+t&&!n?J(e):V(e,t,n,i)}function c(e,t){this.value=e,this.sign=t,this.isSmall=!1}function l(e){this.value=e,this.sign=e<0,this.isSmall=!0}function u(e){this.value=e}function h(e){return-n<e&&e<n}function d(e){return e<1e7?[e]:e<1e14?[e%1e7,Math.floor(e/1e7)]:[e%1e7,Math.floor(e/1e7)%1e7,Math.floor(e/1e14)]}function p(e){f(e);var n=e.length;if(n<4&&N(e,i)<0)switch(n){case 0:return 0;case 1:return e[0];case 2:return e[0]+e[1]*t;default:return e[0]+(e[1]+e[2]*t)*t}return e}function f(e){for(var t=e.length;0===e[--t];);e.length=t+1}function _(e){for(var t=new Array(e),n=-1;++n<e;)t[n]=0;return t}function g(e){return e>0?Math.floor(e):Math.ceil(e)}function m(e,n){var i,r,s=e.length,o=n.length,a=new Array(s),c=0,l=t;for(r=0;r<o;r++)c=(i=e[r]+n[r]+c)>=l?1:0,a[r]=i-c*l;for(;r<s;)c=(i=e[r]+c)===l?1:0,a[r++]=i-c*l;return c>0&&a.push(c),a}function y(e,t){return e.length>=t.length?m(e,t):m(t,e)}function v(e,n){var i,r,s=e.length,o=new Array(s),a=t;for(r=0;r<s;r++)i=e[r]-a+n,n=Math.floor(i/a),o[r]=i-n*a,n+=1;for(;n>0;)o[r++]=n%a,n=Math.floor(n/a);return o}function w(e,n){var i,r,s=e.length,o=n.length,a=new Array(s),c=0,l=t;for(i=0;i<o;i++)(r=e[i]-c-n[i])<0?(r+=l,c=1):c=0,a[i]=r;for(i=o;i<s;i++){if(!((r=e[i]-c)<0)){a[i++]=r;break}r+=l,a[i]=r}for(;i<s;i++)a[i]=e[i];return f(a),a}function b(e,n,i){var r,s,o=e.length,a=new Array(o),u=-n,h=t;for(r=0;r<o;r++)s=e[r]+u,u=Math.floor(s/h),s%=h,a[r]=s<0?s+h:s;return"number"==typeof(a=p(a))?(i&&(a=-a),new l(a)):new c(a,i)}function k(e,n){var i,r,s,o,a=e.length,c=n.length,l=_(a+c),u=t;for(s=0;s<a;++s){o=e[s];for(var h=0;h<c;++h)i=o*n[h]+l[s+h],r=Math.floor(i/u),l[s+h]=i-r*u,l[s+h+1]+=r}return f(l),l}function T(e,n){var i,r,s=e.length,o=new Array(s),a=t,c=0;for(r=0;r<s;r++)i=e[r]*n+c,c=Math.floor(i/a),o[r]=i-c*a;for(;c>0;)o[r++]=c%a,c=Math.floor(c/a);return o}function E(e,t){for(var n=[];t-- >0;)n.push(0);return n.concat(e)}function I(e,t){var n=Math.max(e.length,t.length);if(n<=30)return k(e,t);n=Math.ceil(n/2);var i=e.slice(n),r=e.slice(0,n),s=t.slice(n),o=t.slice(0,n),a=I(r,o),c=I(i,s),l=I(y(r,i),y(o,s)),u=y(y(a,E(w(w(l,a),c),n)),E(c,2*n));return f(u),u}function S(e,n,i){return new c(e<t?T(n,e):k(n,d(e)),i)}function C(e){var n,i,r,s,o=e.length,a=_(o+o),c=t;for(r=0;r<o;r++){i=0-(s=e[r])*s;for(var l=r;l<o;l++)n=s*e[l]*2+a[r+l]+i,i=Math.floor(n/c),a[r+l]=n-i*c;a[r+o]=i}return f(a),a}function x(e,t){var n,i,r,s,o=e.length,a=_(o);for(r=0,n=o-1;n>=0;--n)r=(s=1e7*r+e[n])-(i=g(s/t))*t,a[n]=0|i;return[a,0|r]}function A(e,n){var i,r=J(n);if(o)return[new u(e.value/r.value),new u(e.value%r.value)];var s,h=e.value,m=r.value;if(0===m)throw new Error("Cannot divide by zero");if(e.isSmall)return r.isSmall?[new l(g(h/m)),new l(h%m)]:[a[0],e];if(r.isSmall){if(1===m)return[e,a[0]];if(-1==m)return[e.negate(),a[0]];var y=Math.abs(m);if(y<t){s=p((i=x(h,y))[0]);var v=i[1];return e.sign&&(v=-v),"number"==typeof s?(e.sign!==r.sign&&(s=-s),[new l(s),new l(v)]):[new c(s,e.sign!==r.sign),new l(v)]}m=d(y)}var b=N(h,m);if(-1===b)return[a[0],e];if(0===b)return[a[e.sign===r.sign?1:-1],a[0]];i=h.length+m.length<=200?function(e,n){var i,r,s,o,a,c,l,u=e.length,h=n.length,d=t,f=_(n.length),g=n[h-1],m=Math.ceil(d/(2*g)),y=T(e,m),v=T(n,m);for(y.length<=u&&y.push(0),v.push(0),g=v[h-1],r=u-h;r>=0;r--){for(i=d-1,y[r+h]!==g&&(i=Math.floor((y[r+h]*d+y[r+h-1])/g)),s=0,o=0,c=v.length,a=0;a<c;a++)s+=i*v[a],l=Math.floor(s/d),o+=y[r+a]-(s-l*d),s=l,o<0?(y[r+a]=o+d,o=-1):(y[r+a]=o,o=0);for(;0!==o;){for(i-=1,s=0,a=0;a<c;a++)(s+=y[r+a]-d+v[a])<0?(y[r+a]=s+d,s=0):(y[r+a]=s,s=1);o+=s}f[r]=i}return y=x(y,m)[0],[p(f),p(y)]}(h,m):function(e,n){for(var i,r,s,o,a,c=e.length,l=n.length,u=[],h=[],d=t;c;)if(h.unshift(e[--c]),f(h),N(h,n)<0)u.push(0);else{s=h[(r=h.length)-1]*d+h[r-2],o=n[l-1]*d+n[l-2],r>l&&(s=(s+1)*d),i=Math.ceil(s/o);do{if(N(a=T(n,i),h)<=0)break;i--}while(i);u.push(i),h=w(h,a)}return u.reverse(),[p(u),p(h)]}(h,m),s=i[0];var k=e.sign!==r.sign,E=i[1],I=e.sign;return"number"==typeof s?(k&&(s=-s),s=new l(s)):s=new c(s,k),"number"==typeof E?(I&&(E=-E),E=new l(E)):E=new c(E,I),[s,E]}function N(e,t){if(e.length!==t.length)return e.length>t.length?1:-1;for(var n=e.length-1;n>=0;n--)if(e[n]!==t[n])return e[n]>t[n]?1:-1;return 0}function P(e){var t=e.abs();return!t.isUnit()&&(!!(t.equals(2)||t.equals(3)||t.equals(5))||!(t.isEven()||t.isDivisibleBy(3)||t.isDivisibleBy(5))&&(!!t.lesser(49)||void 0))}function O(e,t){for(var n,i,s,o=e.prev(),a=o,c=0;a.isEven();)a=a.divide(2),c++;e:for(i=0;i<t.length;i++)if(!e.lesser(t[i])&&!(s=r(t[i]).modPow(a,e)).isUnit()&&!s.equals(o)){for(n=c-1;0!=n;n--){if((s=s.square().mod(e)).isUnit())return!1;if(s.equals(o))continue e}return!1}return!0}c.prototype=Object.create(a.prototype),l.prototype=Object.create(a.prototype),u.prototype=Object.create(a.prototype),c.prototype.add=function(e){var t=J(e);if(this.sign!==t.sign)return this.subtract(t.negate());var n=this.value,i=t.value;return t.isSmall?new c(v(n,Math.abs(i)),this.sign):new c(y(n,i),this.sign)},c.prototype.plus=c.prototype.add,l.prototype.add=function(e){var t=J(e),n=this.value;if(n<0!==t.sign)return this.subtract(t.negate());var i=t.value;if(t.isSmall){if(h(n+i))return new l(n+i);i=d(Math.abs(i))}return new c(v(i,Math.abs(n)),n<0)},l.prototype.plus=l.prototype.add,u.prototype.add=function(e){return new u(this.value+J(e).value)},u.prototype.plus=u.prototype.add,c.prototype.subtract=function(e){var t=J(e);if(this.sign!==t.sign)return this.add(t.negate());var n=this.value,i=t.value;return t.isSmall?b(n,Math.abs(i),this.sign):function(e,t,n){var i;return N(e,t)>=0?i=w(e,t):(i=w(t,e),n=!n),"number"==typeof(i=p(i))?(n&&(i=-i),new l(i)):new c(i,n)}(n,i,this.sign)},c.prototype.minus=c.prototype.subtract,l.prototype.subtract=function(e){var t=J(e),n=this.value;if(n<0!==t.sign)return this.add(t.negate());var i=t.value;return t.isSmall?new l(n-i):b(i,Math.abs(n),n>=0)},l.prototype.minus=l.prototype.subtract,u.prototype.subtract=function(e){return new u(this.value-J(e).value)},u.prototype.minus=u.prototype.subtract,c.prototype.negate=function(){return new c(this.value,!this.sign)},l.prototype.negate=function(){var e=this.sign,t=new l(-this.value);return t.sign=!e,t},u.prototype.negate=function(){return new u(-this.value)},c.prototype.abs=function(){return new c(this.value,!1)},l.prototype.abs=function(){return new l(Math.abs(this.value))},u.prototype.abs=function(){return new u(this.value>=0?this.value:-this.value)},c.prototype.multiply=function(e){var n,i,r,s=J(e),o=this.value,l=s.value,u=this.sign!==s.sign;if(s.isSmall){if(0===l)return a[0];if(1===l)return this;if(-1===l)return this.negate();if((n=Math.abs(l))<t)return new c(T(o,n),u);l=d(n)}return new c(-.012*(i=o.length)-.012*(r=l.length)+15e-6*i*r>0?I(o,l):k(o,l),u)},c.prototype.times=c.prototype.multiply,l.prototype._multiplyBySmall=function(e){return h(e.value*this.value)?new l(e.value*this.value):S(Math.abs(e.value),d(Math.abs(this.value)),this.sign!==e.sign)},c.prototype._multiplyBySmall=function(e){return 0===e.value?a[0]:1===e.value?this:-1===e.value?this.negate():S(Math.abs(e.value),this.value,this.sign!==e.sign)},l.prototype.multiply=function(e){return J(e)._multiplyBySmall(this)},l.prototype.times=l.prototype.multiply,u.prototype.multiply=function(e){return new u(this.value*J(e).value)},u.prototype.times=u.prototype.multiply,c.prototype.square=function(){return new c(C(this.value),!1)},l.prototype.square=function(){var e=this.value*this.value;return h(e)?new l(e):new c(C(d(Math.abs(this.value))),!1)},u.prototype.square=function(e){return new u(this.value*this.value)},c.prototype.divmod=function(e){var t=A(this,e);return{quotient:t[0],remainder:t[1]}},u.prototype.divmod=l.prototype.divmod=c.prototype.divmod,c.prototype.divide=function(e){return A(this,e)[0]},u.prototype.over=u.prototype.divide=function(e){return new u(this.value/J(e).value)},l.prototype.over=l.prototype.divide=c.prototype.over=c.prototype.divide,c.prototype.mod=function(e){return A(this,e)[1]},u.prototype.mod=u.prototype.remainder=function(e){return new u(this.value%J(e).value)},l.prototype.remainder=l.prototype.mod=c.prototype.remainder=c.prototype.mod,c.prototype.pow=function(e){var t,n,i,r=J(e),s=this.value,o=r.value;if(0===o)return a[1];if(0===s)return a[0];if(1===s)return a[1];if(-1===s)return r.isEven()?a[1]:a[-1];if(r.sign)return a[0];if(!r.isSmall)throw new Error("The exponent "+r.toString()+" is too large.");if(this.isSmall&&h(t=Math.pow(s,o)))return new l(g(t));for(n=this,i=a[1];!0&o&&(i=i.times(n),--o),0!==o;)o/=2,n=n.square();return i},l.prototype.pow=c.prototype.pow,u.prototype.pow=function(e){var t=J(e),n=this.value,i=t.value,r=BigInt(0),s=BigInt(1),o=BigInt(2);if(i===r)return a[1];if(n===r)return a[0];if(n===s)return a[1];if(n===BigInt(-1))return t.isEven()?a[1]:a[-1];if(t.isNegative())return new u(r);for(var c=this,l=a[1];(i&s)===s&&(l=l.times(c),--i),i!==r;)i/=o,c=c.square();return l},c.prototype.modPow=function(e,t){if(e=J(e),(t=J(t)).isZero())throw new Error("Cannot take modPow with modulus 0");var n=a[1],i=this.mod(t);for(e.isNegative()&&(e=e.multiply(a[-1]),i=i.modInv(t));e.isPositive();){if(i.isZero())return a[0];e.isOdd()&&(n=n.multiply(i).mod(t)),e=e.divide(2),i=i.square().mod(t)}return n},u.prototype.modPow=l.prototype.modPow=c.prototype.modPow,c.prototype.compareAbs=function(e){var t=J(e),n=this.value,i=t.value;return t.isSmall?1:N(n,i)},l.prototype.compareAbs=function(e){var t=J(e),n=Math.abs(this.value),i=t.value;return t.isSmall?n===(i=Math.abs(i))?0:n>i?1:-1:-1},u.prototype.compareAbs=function(e){var t=this.value,n=J(e).value;return(t=t>=0?t:-t)===(n=n>=0?n:-n)?0:t>n?1:-1},c.prototype.compare=function(e){if(e===1/0)return-1;if(e===-1/0)return 1;var t=J(e),n=this.value,i=t.value;return this.sign!==t.sign?t.sign?1:-1:t.isSmall?this.sign?-1:1:N(n,i)*(this.sign?-1:1)},c.prototype.compareTo=c.prototype.compare,l.prototype.compare=function(e){if(e===1/0)return-1;if(e===-1/0)return 1;var t=J(e),n=this.value,i=t.value;return t.isSmall?n==i?0:n>i?1:-1:n<0!==t.sign?n<0?-1:1:n<0?1:-1},l.prototype.compareTo=l.prototype.compare,u.prototype.compare=function(e){if(e===1/0)return-1;if(e===-1/0)return 1;var t=this.value,n=J(e).value;return t===n?0:t>n?1:-1},u.prototype.compareTo=u.prototype.compare,c.prototype.equals=function(e){return 0===this.compare(e)},u.prototype.eq=u.prototype.equals=l.prototype.eq=l.prototype.equals=c.prototype.eq=c.prototype.equals,c.prototype.notEquals=function(e){return 0!==this.compare(e)},u.prototype.neq=u.prototype.notEquals=l.prototype.neq=l.prototype.notEquals=c.prototype.neq=c.prototype.notEquals,c.prototype.greater=function(e){return this.compare(e)>0},u.prototype.gt=u.prototype.greater=l.prototype.gt=l.prototype.greater=c.prototype.gt=c.prototype.greater,c.prototype.lesser=function(e){return this.compare(e)<0},u.prototype.lt=u.prototype.lesser=l.prototype.lt=l.prototype.lesser=c.prototype.lt=c.prototype.lesser,c.prototype.greaterOrEquals=function(e){return this.compare(e)>=0},u.prototype.geq=u.prototype.greaterOrEquals=l.prototype.geq=l.prototype.greaterOrEquals=c.prototype.geq=c.prototype.greaterOrEquals,c.prototype.lesserOrEquals=function(e){return this.compare(e)<=0},u.prototype.leq=u.prototype.lesserOrEquals=l.prototype.leq=l.prototype.lesserOrEquals=c.prototype.leq=c.prototype.lesserOrEquals,c.prototype.isEven=function(){return 0==(1&this.value[0])},l.prototype.isEven=function(){return 0==(1&this.value)},u.prototype.isEven=function(){return(this.value&BigInt(1))===BigInt(0)},c.prototype.isOdd=function(){return 1==(1&this.value[0])},l.prototype.isOdd=function(){return 1==(1&this.value)},u.prototype.isOdd=function(){return(this.value&BigInt(1))===BigInt(1)},c.prototype.isPositive=function(){return!this.sign},l.prototype.isPositive=function(){return this.value>0},u.prototype.isPositive=l.prototype.isPositive,c.prototype.isNegative=function(){return this.sign},l.prototype.isNegative=function(){return this.value<0},u.prototype.isNegative=l.prototype.isNegative,c.prototype.isUnit=function(){return!1},l.prototype.isUnit=function(){return 1===Math.abs(this.value)},u.prototype.isUnit=function(){return this.abs().value===BigInt(1)},c.prototype.isZero=function(){return!1},l.prototype.isZero=function(){return 0===this.value},u.prototype.isZero=function(){return this.value===BigInt(0)},c.prototype.isDivisibleBy=function(e){var t=J(e);return!t.isZero()&&(!!t.isUnit()||(0===t.compareAbs(2)?this.isEven():this.mod(t).isZero()))},u.prototype.isDivisibleBy=l.prototype.isDivisibleBy=c.prototype.isDivisibleBy,c.prototype.isPrime=function(t){var n=P(this);if(n!==e)return n;var i=this.abs(),s=i.bitLength();if(s<=64)return O(i,[2,3,5,7,11,13,17,19,23,29,31,37]);for(var o=Math.log(2)*s.toJSNumber(),a=Math.ceil(!0===t?2*Math.pow(o,2):o),c=[],l=0;l<a;l++)c.push(r(l+2));return O(i,c)},u.prototype.isPrime=l.prototype.isPrime=c.prototype.isPrime,c.prototype.isProbablePrime=function(t,n){var i=P(this);if(i!==e)return i;for(var s=this.abs(),o=t===e?5:t,a=[],c=0;c<o;c++)a.push(r.randBetween(2,s.minus(2),n));return O(s,a)},u.prototype.isProbablePrime=l.prototype.isProbablePrime=c.prototype.isProbablePrime,c.prototype.modInv=function(e){for(var t,n,i,s=r.zero,o=r.one,a=J(e),c=this.abs();!c.isZero();)t=a.divide(c),n=s,i=a,s=o,a=c,o=n.subtract(t.multiply(o)),c=i.subtract(t.multiply(c));if(!a.isUnit())throw new Error(this.toString()+" and "+e.toString()+" are not co-prime");return-1===s.compare(0)&&(s=s.add(e)),this.isNegative()?s.negate():s},u.prototype.modInv=l.prototype.modInv=c.prototype.modInv,c.prototype.next=function(){var e=this.value;return this.sign?b(e,1,this.sign):new c(v(e,1),this.sign)},l.prototype.next=function(){var e=this.value;return e+1<n?new l(e+1):new c(i,!1)},u.prototype.next=function(){return new u(this.value+BigInt(1))},c.prototype.prev=function(){var e=this.value;return this.sign?new c(v(e,1),!0):b(e,1,this.sign)},l.prototype.prev=function(){var e=this.value;return e-1>-n?new l(e-1):new c(i,!0)},u.prototype.prev=function(){return new u(this.value-BigInt(1))};for(var R=[1];2*R[R.length-1]<=t;)R.push(2*R[R.length-1]);var D=R.length,z=R[D-1];function M(e){return Math.abs(e)<=t}function L(e,t,n){t=J(t);for(var i=e.isNegative(),s=t.isNegative(),o=i?e.not():e,a=s?t.not():t,c=0,l=0,u=null,h=null,d=[];!o.isZero()||!a.isZero();)c=(u=A(o,z))[1].toJSNumber(),i&&(c=z-1-c),l=(h=A(a,z))[1].toJSNumber(),s&&(l=z-1-l),o=u[0],a=h[0],d.push(n(c,l));for(var p=0!==n(i?1:0,s?1:0)?r(-1):r(0),f=d.length-1;f>=0;f-=1)p=p.multiply(z).add(r(d[f]));return p}c.prototype.shiftLeft=function(e){var t=J(e).toJSNumber();if(!M(t))throw new Error(String(t)+" is too large for shifting.");if(t<0)return this.shiftRight(-t);var n=this;if(n.isZero())return n;for(;t>=D;)n=n.multiply(z),t-=D-1;return n.multiply(R[t])},u.prototype.shiftLeft=l.prototype.shiftLeft=c.prototype.shiftLeft,c.prototype.shiftRight=function(e){var t,n=J(e).toJSNumber();if(!M(n))throw new Error(String(n)+" is too large for shifting.");if(n<0)return this.shiftLeft(-n);for(var i=this;n>=D;){if(i.isZero()||i.isNegative()&&i.isUnit())return i;i=(t=A(i,z))[1].isNegative()?t[0].prev():t[0],n-=D-1}return(t=A(i,R[n]))[1].isNegative()?t[0].prev():t[0]},u.prototype.shiftRight=l.prototype.shiftRight=c.prototype.shiftRight,c.prototype.not=function(){return this.negate().prev()},u.prototype.not=l.prototype.not=c.prototype.not,c.prototype.and=function(e){return L(this,e,(function(e,t){return e&t}))},u.prototype.and=l.prototype.and=c.prototype.and,c.prototype.or=function(e){return L(this,e,(function(e,t){return e|t}))},u.prototype.or=l.prototype.or=c.prototype.or,c.prototype.xor=function(e){return L(this,e,(function(e,t){return e^t}))},u.prototype.xor=l.prototype.xor=c.prototype.xor;var U=1<<30;function F(e){var n=e.value,i="number"==typeof n?n|U:"bigint"==typeof n?n|BigInt(U):n[0]+n[1]*t|1073758208;return i&-i}function j(e,t){if(t.compareTo(e)<=0){var n=j(e,t.square(t)),i=n.p,s=n.e,o=i.multiply(t);return o.compareTo(e)<=0?{p:o,e:2*s+1}:{p:i,e:2*s}}return{p:r(1),e:0}}function q(e,t){return e=J(e),t=J(t),e.greater(t)?e:t}function B(e,t){return e=J(e),t=J(t),e.lesser(t)?e:t}function W(e,t){if(e=J(e).abs(),t=J(t).abs(),e.equals(t))return e;if(e.isZero())return t;if(t.isZero())return e;for(var n,i,r=a[1];e.isEven()&&t.isEven();)n=B(F(e),F(t)),e=e.divide(n),t=t.divide(n),r=r.multiply(n);for(;e.isEven();)e=e.divide(F(e));do{for(;t.isEven();)t=t.divide(F(t));e.greater(t)&&(i=t,t=e,e=i),t=t.subtract(e)}while(!t.isZero());return r.isUnit()?e:e.multiply(r)}c.prototype.bitLength=function(){var e=this;return e.compareTo(r(0))<0&&(e=e.negate().subtract(r(1))),0===e.compareTo(r(0))?r(0):r(j(e,r(2)).e).add(r(1))},u.prototype.bitLength=l.prototype.bitLength=c.prototype.bitLength;var V=function(e,t,n,i){n=n||s,e=String(e),i||(e=e.toLowerCase(),n=n.toLowerCase());var r,o=e.length,a=Math.abs(t),c={};for(r=0;r<n.length;r++)c[n[r]]=r;for(r=0;r<o;r++)if("-"!==(h=e[r])&&h in c&&c[h]>=a){if("1"===h&&1===a)continue;throw new Error(h+" is not a valid digit in base "+t+".")}t=J(t);var l=[],u="-"===e[0];for(r=u?1:0;r<e.length;r++){var h;if((h=e[r])in c)l.push(J(c[h]));else{if("<"!==h)throw new Error(h+" is not a valid character");var d=r;do{r++}while(">"!==e[r]&&r<e.length);l.push(J(e.slice(d+1,r)))}}return H(l,t,u)};function H(e,t,n){var i,r=a[0],s=a[1];for(i=e.length-1;i>=0;i--)r=r.add(e[i].times(s)),s=s.times(t);return n?r.negate():r}function K(e,t){if((t=r(t)).isZero()){if(e.isZero())return{value:[0],isNegative:!1};throw new Error("Cannot convert nonzero numbers to base 0.")}if(t.equals(-1)){if(e.isZero())return{value:[0],isNegative:!1};if(e.isNegative())return{value:[].concat.apply([],Array.apply(null,Array(-e.toJSNumber())).map(Array.prototype.valueOf,[1,0])),isNegative:!1};var n=Array.apply(null,Array(e.toJSNumber()-1)).map(Array.prototype.valueOf,[0,1]);return n.unshift([1]),{value:[].concat.apply([],n),isNegative:!1}}var i=!1;if(e.isNegative()&&t.isPositive()&&(i=!0,e=e.abs()),t.isUnit())return e.isZero()?{value:[0],isNegative:!1}:{value:Array.apply(null,Array(e.toJSNumber())).map(Number.prototype.valueOf,1),isNegative:i};for(var s,o=[],a=e;a.isNegative()||a.compareAbs(t)>=0;){s=a.divmod(t),a=s.quotient;var c=s.remainder;c.isNegative()&&(c=t.minus(c).abs(),a=a.next()),o.push(c.toJSNumber())}return o.push(a.toJSNumber()),{value:o.reverse(),isNegative:i}}function $(e,t,n){var i=K(e,t);return(i.isNegative?"-":"")+i.value.map((function(e){return function(e,t){return e<(t=t||s).length?t[e]:"<"+e+">"}(e,n)})).join("")}function G(e){if(h(+e)){var t=+e;if(t===g(t))return o?new u(BigInt(t)):new l(t);throw new Error("Invalid integer: "+e)}var n="-"===e[0];n&&(e=e.slice(1));var i=e.split(/e/i);if(i.length>2)throw new Error("Invalid integer: "+i.join("e"));if(2===i.length){var r=i[1];if("+"===r[0]&&(r=r.slice(1)),(r=+r)!==g(r)||!h(r))throw new Error("Invalid integer: "+r+" is not a valid exponent.");var s=i[0],a=s.indexOf(".");if(a>=0&&(r-=s.length-a-1,s=s.slice(0,a)+s.slice(a+1)),r<0)throw new Error("Cannot include negative exponent part for integers");e=s+=new Array(r+1).join("0")}if(!/^([0-9][0-9]*)$/.test(e))throw new Error("Invalid integer: "+e);if(o)return new u(BigInt(n?"-"+e:e));for(var d=[],p=e.length,_=p-7;p>0;)d.push(+e.slice(_,p)),(_-=7)<0&&(_=0),p-=7;return f(d),new c(d,n)}function J(e){return"number"==typeof e?function(e){if(o)return new u(BigInt(e));if(h(e)){if(e!==g(e))throw new Error(e+" is not an integer.");return new l(e)}return G(e.toString())}(e):"string"==typeof e?G(e):"bigint"==typeof e?new u(e):e}c.prototype.toArray=function(e){return K(this,e)},l.prototype.toArray=function(e){return K(this,e)},u.prototype.toArray=function(e){return K(this,e)},c.prototype.toString=function(t,n){if(t===e&&(t=10),10!==t)return $(this,t,n);for(var i,r=this.value,s=r.length,o=String(r[--s]);--s>=0;)i=String(r[s]),o+="0000000".slice(i.length)+i;return(this.sign?"-":"")+o},l.prototype.toString=function(t,n){return t===e&&(t=10),10!=t?$(this,t,n):String(this.value)},u.prototype.toString=l.prototype.toString,u.prototype.toJSON=c.prototype.toJSON=l.prototype.toJSON=function(){return this.toString()},c.prototype.valueOf=function(){return parseInt(this.toString(),10)},c.prototype.toJSNumber=c.prototype.valueOf,l.prototype.valueOf=function(){return this.value},l.prototype.toJSNumber=l.prototype.valueOf,u.prototype.valueOf=u.prototype.toJSNumber=function(){return parseInt(this.toString(),10)};for(var Z=0;Z<1e3;Z++)a[Z]=J(Z),Z>0&&(a[-Z]=J(-Z));return a.one=a[1],a.zero=a[0],a.minusOne=a[-1],a.max=q,a.min=B,a.gcd=W,a.lcm=function(e,t){return e=J(e).abs(),t=J(t).abs(),e.divide(W(e,t)).multiply(t)},a.isInstance=function(e){return e instanceof c||e instanceof l||e instanceof u},a.randBetween=function(e,n,i){e=J(e),n=J(n);var r=i||Math.random,s=B(e,n),o=q(e,n).subtract(s).add(1);if(o.isSmall)return s.add(Math.floor(r()*o));for(var c=K(o,t).value,l=[],u=!0,h=0;h<c.length;h++){var d=u?c[h]+(h+1<c.length?c[h+1]/t:0):t,p=g(r()*d);l.push(p),p<c[h]&&(u=!1)}return s.add(a.fromArray(l,t,!1))},a.fromArray=function(e,t,n){return H(e.map(J),J(t||10),n)},a}();e.hasOwnProperty("exports")&&(e.exports=r),void 0===(i=function(){return r}.call(t,n,t,e))||(e.exports=i)},5461:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},3915:function(e,t,n){"use strict";var i=this&&this.__assign||function(){return i=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},i.apply(this,arguments)},r=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,s){function o(e){try{c(i.next(e))}catch(e){s(e)}}function a(e){try{c(i.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}c((i=i.apply(e,t||[])).next())}))},s=this&&this.__generator||function(e,t){var n,i,r,s,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,i&&(r=2&s[0]?i.return:s[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,s[1])).done)return r;switch(i=0,r&&(s=[2&s[0],r.value]),s[0]){case 0:case 1:r=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,i=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!((r=(r=o.trys).length>0&&r[r.length-1])||6!==s[0]&&2!==s[0])){o=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){o.label=s[1];break}if(6===s[0]&&o.label<r[1]){o.label=r[1],r=s;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(s);break}r[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(e){s=[6,e],i=0}finally{n=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}},o=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var i,r,s=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(i=s.next()).done;)o.push(i.value)}catch(e){r={error:e}}finally{try{i&&!i.done&&(n=s.return)&&n.call(s)}finally{if(r)throw r.error}}return o},a=this&&this.__spreadArray||function(e,t){for(var n=0,i=t.length,r=e.length;n<i;n++,r++)e[r]=t[n];return e},c=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],i=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&i>=e.length&&(e=void 0),{value:e&&e[i++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0}),t.ActionBuilder=t.TransactionBuilder=t.Api=void 0;var l=n(8442),u=n(2753),h=function(){function e(e){this.contracts=new Map,this.cachedAbis=new Map,this.transactionExtensions=[{id:1,type:"resource_payer",keys:["payer","max_net_bytes","max_cpu_us","max_memory_bytes"]}],this.rpc=e.rpc,this.authorityProvider=e.authorityProvider||e.rpc,this.abiProvider=e.abiProvider||e.rpc,this.signatureProvider=e.signatureProvider,this.chainId=e.chainId,this.textEncoder=e.textEncoder,this.textDecoder=e.textDecoder,this.abiTypes=u.getTypesFromAbi(u.createAbiTypes()),this.transactionTypes=u.getTypesFromAbi(u.createTransactionTypes())}return e.prototype.rawAbiToJson=function(e){var t=new u.SerialBuffer({textEncoder:this.textEncoder,textDecoder:this.textDecoder,array:e});if(!u.supportedAbiVersion(t.getString()))throw new Error("Unsupported abi version");return t.restartRead(),this.abiTypes.get("abi_def").deserialize(t)},e.prototype.jsonToRawAbi=function(e){var t=new u.SerialBuffer({textEncoder:this.textEncoder,textDecoder:this.textDecoder});if(this.abiTypes.get("abi_def").serialize(t,e),!u.supportedAbiVersion(t.getString()))throw new Error("Unsupported abi version");return t.asUint8Array()},e.prototype.getCachedAbi=function(e,t){return void 0===t&&(t=!1),r(this,void 0,void 0,(function(){var n,i,r,o;return s(this,(function(s){switch(s.label){case 0:if(!t&&this.cachedAbis.get(e))return[2,this.cachedAbis.get(e)];s.label=1;case 1:return s.trys.push([1,3,,4]),[4,this.abiProvider.getRawAbi(e)];case 2:return i=s.sent().abi,r=this.rawAbiToJson(i),n={rawAbi:i,abi:r},[3,4];case 3:throw(o=s.sent()).message="fetching abi for "+e+": "+o.message,o;case 4:if(!n)throw new Error("Missing abi for "+e);return this.cachedAbis.set(e,n),[2,n]}}))}))},e.prototype.getAbi=function(e,t){return void 0===t&&(t=!1),r(this,void 0,void 0,(function(){return s(this,(function(n){switch(n.label){case 0:return[4,this.getCachedAbi(e,t)];case 1:return[2,n.sent().abi]}}))}))},e.prototype.getTransactionAbis=function(e,t){return void 0===t&&(t=!1),r(this,void 0,void 0,(function(){var n,i,c,l,u=this;return s(this,(function(h){return n=(e.context_free_actions||[]).concat(e.actions),i=n.map((function(e){return e.account})),c=new Set(i),l=a([],o(c)).map((function(e){return r(u,void 0,void 0,(function(){var n;return s(this,(function(i){switch(i.label){case 0:return n={accountName:e},[4,this.getCachedAbi(e,t)];case 1:return[2,(n.abi=i.sent().rawAbi,n)]}}))}))})),[2,Promise.all(l)]}))}))},e.prototype.getContract=function(e,t){return void 0===t&&(t=!1),r(this,void 0,void 0,(function(){var n,i,r,o,a,l,h,d,p,f,_;return s(this,(function(s){switch(s.label){case 0:return!t&&this.contracts.get(e)?[2,this.contracts.get(e)]:[4,this.getAbi(e,t)];case 1:n=s.sent(),i=u.getTypesFromAbi(u.createInitialTypes(),n),r=new Map;try{for(o=c(n.actions),a=o.next();!a.done;a=o.next())l=a.value,h=l.name,d=l.type,r.set(h,u.getType(i,d))}catch(e){f={error:e}}finally{try{a&&!a.done&&(_=o.return)&&_.call(o)}finally{if(f)throw f.error}}return p={types:i,actions:r},this.contracts.set(e,p),[2,p]}}))}))},e.prototype.serialize=function(e,t,n){this.transactionTypes.get(t).serialize(e,n)},e.prototype.deserialize=function(e,t){return this.transactionTypes.get(t).deserialize(e)},e.prototype.serializeTransaction=function(e){var t=new u.SerialBuffer({textEncoder:this.textEncoder,textDecoder:this.textDecoder});return this.serialize(t,"transaction",i({max_net_usage_words:0,max_cpu_usage_ms:0,delay_sec:0,context_free_actions:[],actions:[],transaction_extensions:[]},e)),t.asUint8Array()},e.prototype.serializeContextFreeData=function(e){var t,n;if(!e||!e.length)return null;var i=new u.SerialBuffer({textEncoder:this.textEncoder,textDecoder:this.textDecoder});i.pushVaruint32(e.length);try{for(var r=c(e),s=r.next();!s.done;s=r.next()){var o=s.value;i.pushBytes(o)}}catch(e){t={error:e}}finally{try{s&&!s.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}return i.asUint8Array()},e.prototype.deserializeTransaction=function(e){var t=new u.SerialBuffer({textEncoder:this.textEncoder,textDecoder:this.textDecoder});return t.pushArray(e),this.deserialize(t,"transaction")},e.prototype.serializeTransactionExtensions=function(e){var t=[];if(e.resource_payer){var n=new u.SerialBuffer({textEncoder:this.textEncoder,textDecoder:this.textDecoder});u.getTypesFromAbi(u.createTransactionExtensionTypes()).get("resource_payer").serialize(n,e.resource_payer),t=a(a([],o(t)),[[1,u.arrayToHex(n.asUint8Array())]])}return t},e.prototype.deserializeTransactionExtensions=function(e){var t=this,n={};return e.forEach((function(e){var i=t.transactionExtensions.find((function(t){return t.id===e[0]}));if(void 0===i)throw new Error("Transaction Extension could not be determined: "+e);var r=u.getTypesFromAbi(u.createTransactionExtensionTypes()),s=new u.SerialBuffer({textEncoder:t.textEncoder,textDecoder:t.textDecoder});s.pushArray(u.hexToUint8Array(e[1]));var o=r.get(i.type).deserialize(s);1===e[0]&&(o.max_net_bytes=Number(o.max_net_bytes),o.max_cpu_us=Number(o.max_cpu_us),o.max_memory_bytes=Number(o.max_memory_bytes),n.resource_payer=o)})),n},e.prototype.deleteTransactionExtensionObjects=function(e){return delete e.resource_payer,e},e.prototype.serializeActions=function(e){return r(this,void 0,void 0,(function(){var t=this;return s(this,(function(n){switch(n.label){case 0:return[4,Promise.all(e.map((function(e){return r(t,void 0,void 0,(function(){var t,n,i,r,o;return s(this,(function(s){switch(s.label){case 0:return t=e.account,n=e.name,i=e.authorization,r=e.data,[4,this.getContract(t)];case 1:return o=s.sent(),"object"!=typeof r?[2,e]:[2,u.serializeAction(o,t,n,i,r,this.textEncoder,this.textDecoder)]}}))}))})))];case 1:return[2,n.sent()]}}))}))},e.prototype.deserializeActions=function(e){return r(this,void 0,void 0,(function(){var t=this;return s(this,(function(n){switch(n.label){case 0:return[4,Promise.all(e.map((function(e){var n=e.account,i=e.name,o=e.authorization,a=e.data;return r(t,void 0,void 0,(function(){var e;return s(this,(function(t){switch(t.label){case 0:return[4,this.getContract(n)];case 1:return e=t.sent(),[2,u.deserializeAction(e,n,i,o,a,this.textEncoder,this.textDecoder)]}}))}))})))];case 1:return[2,n.sent()]}}))}))},e.prototype.deserializeTransactionWithActions=function(e){return r(this,void 0,void 0,(function(){var t,n,r;return s(this,(function(s){switch(s.label){case 0:return"string"==typeof e&&(e=u.hexToUint8Array(e)),t=this.deserializeTransaction(e),[4,this.deserializeActions(t.context_free_actions)];case 1:return n=s.sent(),[4,this.deserializeActions(t.actions)];case 2:return r=s.sent(),[2,i(i({},t),{context_free_actions:n,actions:r})]}}))}))},e.prototype.deflateSerializedArray=function(e){return l.deflate(e,{level:9})},e.prototype.inflateSerializedArray=function(e){return l.inflate(e)},e.prototype.transact=function(e,t){var n=void 0===t?{}:t,o=n.broadcast,a=void 0===o||o,c=n.sign,l=void 0===c||c,u=n.readOnlyTrx,h=n.returnFailureTraces,d=n.requiredKeys,p=n.compression,f=n.blocksBehind,_=n.useLastIrreversible,g=n.expireSeconds;return r(this,void 0,void 0,(function(){var t,n,r,o,c,m,y,v;return s(this,(function(s){switch(s.label){case 0:if("number"==typeof f&&_)throw new Error("Use either blocksBehind or useLastIrreversible");return this.chainId?[3,2]:[4,this.rpc.get_info()];case 1:t=s.sent(),this.chainId=t.chain_id,s.label=2;case 2:return"number"!=typeof f&&!_||!g?[3,4]:[4,this.generateTapos(t,e,f,_,g)];case 3:e=s.sent(),s.label=4;case 4:if(!this.hasRequiredTaposFields(e))throw new Error("Required configuration or TAPOS fields are not present");return[4,this.getTransactionAbis(e)];case 5:return n=s.sent(),r=[i({},e)],v={},[4,this.serializeTransactionExtensions(e)];case 6:return v.transaction_extensions=s.sent(),[4,this.serializeActions(e.context_free_actions||[])];case 7:return v.context_free_actions=s.sent(),[4,this.serializeActions(e.actions)];case 8:return e=i.apply(void 0,r.concat([(v.actions=s.sent(),v)])),e=this.deleteTransactionExtensionObjects(e),o=this.serializeTransaction(e),c=this.serializeContextFreeData(e.context_free_data),m={serializedTransaction:o,serializedContextFreeData:c,signatures:[]},l?d?[3,11]:[4,this.signatureProvider.getAvailableKeys()]:[3,13];case 9:return y=s.sent(),[4,this.authorityProvider.getRequiredKeys({transaction:e,availableKeys:y})];case 10:d=s.sent(),s.label=11;case 11:return[4,this.signatureProvider.sign({chainId:this.chainId,requiredKeys:d,serializedTransaction:o,serializedContextFreeData:c,abis:n})];case 12:m=s.sent(),s.label=13;case 13:return a?p?[2,this.pushCompressedSignedTransaction(m,u,h)]:[2,this.pushSignedTransaction(m,u,h)]:[2,m]}}))}))},e.prototype.query=function(e,t,n,o){var a=o.sign,c=o.requiredKeys,l=o.authorization,h=void 0===l?[]:l;return r(this,void 0,void 0,(function(){var r,o,l,d,p,f,_,g,m,y,v;return s(this,(function(s){switch(s.label){case 0:return[4,this.rpc.get_info()];case 1:return r=s.sent(),[4,this.tryRefBlockFromGetInfo(r)];case 2:return o=s.sent(),l=new u.SerialBuffer({textEncoder:this.textEncoder,textDecoder:this.textDecoder}),u.serializeQuery(l,n),d=i(i({},u.transactionHeader(o,1800)),{context_free_actions:[],actions:[{account:e,name:"queryit",authorization:h,data:u.arrayToHex(l.asUint8Array())}]}),p=this.serializeTransaction(d),f=[],a?[4,this.getTransactionAbis(d)]:[3,8];case 3:return _=s.sent(),c?[3,6]:[4,this.signatureProvider.getAvailableKeys()];case 4:return g=s.sent(),[4,this.authorityProvider.getRequiredKeys({transaction:d,availableKeys:g})];case 5:c=s.sent(),s.label=6;case 6:return[4,this.signatureProvider.sign({chainId:this.chainId,requiredKeys:c,serializedTransaction:p,serializedContextFreeData:null,abis:_})];case 7:m=s.sent(),f=m.signatures,s.label=8;case 8:return[4,this.rpc.send_transaction({signatures:f,compression:0,serializedTransaction:p})];case 9:return y=s.sent(),v=new u.SerialBuffer({textEncoder:this.textEncoder,textDecoder:this.textDecoder,array:u.hexToUint8Array(y.processed.action_traces[0][1].return_value)}),t?[2,u.deserializeAnyvarShort(v)]:[2,u.deserializeAnyvar(v)]}}))}))},e.prototype.pushSignedTransaction=function(e,t,n){var i=e.signatures,o=e.serializedTransaction,a=e.serializedContextFreeData;return void 0===t&&(t=!1),void 0===n&&(n=!1),r(this,void 0,void 0,(function(){return s(this,(function(e){return t?[2,this.rpc.push_ro_transaction({signatures:i,serializedTransaction:o,serializedContextFreeData:a},n)]:[2,this.rpc.push_transaction({signatures:i,serializedTransaction:o,serializedContextFreeData:a})]}))}))},e.prototype.pushCompressedSignedTransaction=function(e,t,n){var i=e.signatures,o=e.serializedTransaction,a=e.serializedContextFreeData;return void 0===t&&(t=!1),void 0===n&&(n=!1),r(this,void 0,void 0,(function(){var e,r;return s(this,(function(s){return e=this.deflateSerializedArray(o),r=this.deflateSerializedArray(a||new Uint8Array(0)),t?[2,this.rpc.push_ro_transaction({signatures:i,compression:1,serializedTransaction:e,serializedContextFreeData:r},n)]:[2,this.rpc.push_transaction({signatures:i,compression:1,serializedTransaction:e,serializedContextFreeData:r})]}))}))},e.prototype.generateTapos=function(e,t,n,o,a){return r(this,void 0,void 0,(function(){var r,c,l,h;return s(this,(function(s){switch(s.label){case 0:return e?[3,2]:[4,this.rpc.get_info()];case 1:e=s.sent(),s.label=2;case 2:return o?[4,this.tryRefBlockFromGetInfo(e)]:[3,4];case 3:return r=s.sent(),[2,i(i({},u.transactionHeader(r,a)),t)];case 4:return(c=e.head_block_num-n)<=e.last_irreversible_block_num?[4,this.tryGetBlockInfo(c)]:[3,6];case 5:return h=s.sent(),[3,8];case 6:return[4,this.tryGetBlockHeaderState(c)];case 7:h=s.sent(),s.label=8;case 8:return l=h,[2,i(i({},u.transactionHeader(l,a)),t)]}}))}))},e.prototype.hasRequiredTaposFields=function(e){var t=e.expiration,n=e.ref_block_num,i=e.ref_block_prefix;return!(!t||"number"!=typeof n||"number"!=typeof i)},e.prototype.tryGetBlockHeaderState=function(e){return r(this,void 0,void 0,(function(){return s(this,(function(t){switch(t.label){case 0:return t.trys.push([0,2,,4]),[4,this.rpc.get_block_header_state(e)];case 1:case 3:return[2,t.sent()];case 2:return t.sent(),[4,this.tryGetBlockInfo(e)];case 4:return[2]}}))}))},e.prototype.tryGetBlockInfo=function(e){return r(this,void 0,void 0,(function(){return s(this,(function(t){switch(t.label){case 0:return t.trys.push([0,2,,4]),[4,this.rpc.get_block_info(e)];case 1:case 3:return[2,t.sent()];case 2:return t.sent(),[4,this.rpc.get_block(e)];case 4:return[2]}}))}))},e.prototype.tryRefBlockFromGetInfo=function(e){return r(this,void 0,void 0,(function(){var t;return s(this,(function(n){switch(n.label){case 0:return e.hasOwnProperty("last_irreversible_block_id")&&e.hasOwnProperty("last_irreversible_block_num")&&e.hasOwnProperty("last_irreversible_block_time")?[2,{block_num:e.last_irreversible_block_num,id:e.last_irreversible_block_id,timestamp:e.last_irreversible_block_time}]:[3,1];case 1:return[4,this.tryGetBlockInfo(e.last_irreversible_block_num)];case 2:return[2,{block_num:(t=n.sent()).block_num,id:t.id,timestamp:t.timestamp}]}}))}))},e.prototype.with=function(e){return new p(this,e)},e.prototype.buildTransaction=function(e){var t=new d(this);return e?e(t):t},e}();t.Api=h;var d=function(){function e(e){this.actions=[],this.contextFreeGroups=[],this.api=e}return e.prototype.with=function(e){var t=new p(this.api,e);return this.actions.push(t),t},e.prototype.associateContextFree=function(e){return this.contextFreeGroups.push(e),this},e.prototype.send=function(e){return r(this,void 0,void 0,(function(){var t,n,i,o=this;return s(this,(function(a){switch(a.label){case 0:return t=[],n=[],i=this.actions.map((function(e){return e.serializedData})),[4,Promise.all(this.contextFreeGroups.map((function(e){return r(o,void 0,void 0,(function(){var r,o,a,c;return s(this,(function(s){return r=e({cfd:t.length,cfa:n.length}),o=r.action,a=r.contextFreeAction,c=r.contextFreeData,o&&i.push(o),a&&n.push(a),c&&t.push(c),[2]}))}))})))];case 1:return a.sent(),this.contextFreeGroups=[],this.actions=[],[4,this.api.transact({context_free_data:t,context_free_actions:n,actions:i},e)];case 2:return[2,a.sent()]}}))}))},e}();t.TransactionBuilder=d;var p=function(){function e(e,t){this.api=e,this.accountName=t}return e.prototype.as=function(e){void 0===e&&(e=[]);var t;return t=e&&"string"==typeof e?[{actor:e,permission:"active"}]:e,new f(this,this.api,this.accountName,t)},e}();t.ActionBuilder=p;var f=function(e,t,n,i){var r,s,o=this,a=t.cachedAbis.get(n);if(!a)throw new Error("ABI must be cached before using ActionBuilder, run api.getAbi()");var l=u.getTypesFromAbi(u.createInitialTypes(),a.abi),h=new Map;try{for(var d=c(a.abi.actions),p=d.next();!p.done;p=d.next()){var f=p.value,_=f.name,g=f.type;h.set(_,u.getType(l,g))}}catch(e){r={error:e}}finally{try{p&&!p.done&&(s=d.return)&&s.call(d)}finally{if(r)throw r.error}}h.forEach((function(r,s){var a;Object.assign(o,((a={})[s]=function(){for(var o=[],a=0;a<arguments.length;a++)o[a]=arguments[a];var c={};o.forEach((function(e,t){var n=r.fields[t];c[n.name]=e}));var d=u.serializeAction({types:l,actions:h},n,s,i,c,t.textEncoder,t.textDecoder);return e.serializedData=d,d},a))}))}},6208:function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,s){function o(e){try{c(i.next(e))}catch(e){s(e)}}function a(e){try{c(i.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}c((i=i.apply(e,t||[])).next())}))},r=this&&this.__generator||function(e,t){var n,i,r,s,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,i&&(r=2&s[0]?i.return:s[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,s[1])).done)return r;switch(i=0,r&&(s=[2&s[0],r.value]),s[0]){case 0:case 1:r=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,i=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!((r=(r=o.trys).length>0&&r[r.length-1])||6!==s[0]&&2!==s[0])){o=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){o.label=s[1];break}if(6===s[0]&&o.label<r[1]){o.label=r[1],r=s;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(s);break}r[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(e){s=[6,e],i=0}finally{n=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}},s=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],i=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&i>=e.length&&(e=void 0),{value:e&&e[i++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0}),t.JsonRpc=void 0;var o=n(1823),a=n(3937),c=function(e){var t,n,i="";try{for(var r=s(e),o=r.next();!o.done;o=r.next())i+=("00"+o.value.toString(16)).slice(-2)}catch(e){t={error:e}}finally{try{o&&!o.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}return i},l=function(){function e(e,t){void 0===t&&(t={}),this.endpoint=e.replace(/\/$/,""),t.fetch?this.fetchBuiltin=t.fetch:this.fetchBuiltin=n.g.fetch}return e.prototype.fetch=function(e,t){return i(this,void 0,void 0,(function(){var n,i,s;return r(this,(function(r){switch(r.label){case 0:return r.trys.push([0,3,,4]),[4,(0,this.fetchBuiltin)(this.endpoint+e,{body:JSON.stringify(t),method:"POST"})];case 1:return[4,(n=r.sent()).json()];case 2:if((i=r.sent()).processed&&i.processed.except)throw new a.RpcError(i);if(i.result&&i.result.except)throw new a.RpcError(i);return[3,4];case 3:throw(s=r.sent()).isFetchError=!0,s;case 4:if(!n.ok)throw new a.RpcError(i);return[2,i]}}))}))},e.prototype.abi_bin_to_json=function(e,t,n){return i(this,void 0,void 0,(function(){return r(this,(function(i){switch(i.label){case 0:return[4,this.fetch("/v1/chain/abi_bin_to_json",{code:e,action:t,binargs:n})];case 1:return[2,i.sent()]}}))}))},e.prototype.abi_json_to_bin=function(e,t,n){return i(this,void 0,void 0,(function(){return r(this,(function(i){switch(i.label){case 0:return[4,this.fetch("/v1/chain/abi_json_to_bin",{code:e,action:t,args:n})];case 1:return[2,i.sent()]}}))}))},e.prototype.get_abi=function(e){return i(this,void 0,void 0,(function(){return r(this,(function(t){switch(t.label){case 0:return[4,this.fetch("/v1/chain/get_abi",{account_name:e})];case 1:return[2,t.sent()]}}))}))},e.prototype.get_account=function(e){return i(this,void 0,void 0,(function(){return r(this,(function(t){switch(t.label){case 0:return[4,this.fetch("/v1/chain/get_account",{account_name:e})];case 1:return[2,t.sent()]}}))}))},e.prototype.get_accounts_by_authorizers=function(e,t){return i(this,void 0,void 0,(function(){return r(this,(function(n){switch(n.label){case 0:return[4,this.fetch("/v1/chain/get_accounts_by_authorizers",{accounts:e,keys:t})];case 1:return[2,n.sent()]}}))}))},e.prototype.get_activated_protocol_features=function(e){var t=e.limit,n=void 0===t?10:t,s=e.search_by_block_num,o=void 0!==s&&s,a=e.reverse,c=void 0!==a&&a,l=e.lower_bound,u=void 0===l?null:l,h=e.upper_bound,d=void 0===h?null:h;return i(this,void 0,void 0,(function(){return r(this,(function(e){switch(e.label){case 0:return[4,this.fetch("/v1/chain/get_activated_protocol_features",{lower_bound:u,upper_bound:d,limit:n,search_by_block_num:o,reverse:c})];case 1:return[2,e.sent()]}}))}))},e.prototype.get_block_header_state=function(e){return i(this,void 0,void 0,(function(){return r(this,(function(t){switch(t.label){case 0:return[4,this.fetch("/v1/chain/get_block_header_state",{block_num_or_id:e})];case 1:return[2,t.sent()]}}))}))},e.prototype.get_block_info=function(e){return i(this,void 0,void 0,(function(){return r(this,(function(t){switch(t.label){case 0:return[4,this.fetch("/v1/chain/get_block_info",{block_num:e})];case 1:return[2,t.sent()]}}))}))},e.prototype.get_block=function(e){return i(this,void 0,void 0,(function(){return r(this,(function(t){switch(t.label){case 0:return[4,this.fetch("/v1/chain/get_block",{block_num_or_id:e})];case 1:return[2,t.sent()]}}))}))},e.prototype.get_code=function(e){return i(this,void 0,void 0,(function(){return r(this,(function(t){switch(t.label){case 0:return[4,this.fetch("/v1/chain/get_code",{account_name:e,code_as_wasm:!0})];case 1:return[2,t.sent()]}}))}))},e.prototype.get_code_hash=function(e){return i(this,void 0,void 0,(function(){return r(this,(function(t){switch(t.label){case 0:return[4,this.fetch("/v1/chain/get_code_hash",{account_name:e})];case 1:return[2,t.sent()]}}))}))},e.prototype.get_currency_balance=function(e,t,n){return void 0===n&&(n=null),i(this,void 0,void 0,(function(){return r(this,(function(i){switch(i.label){case 0:return[4,this.fetch("/v1/chain/get_currency_balance",{code:e,account:t,symbol:n})];case 1:return[2,i.sent()]}}))}))},e.prototype.get_currency_stats=function(e,t){return i(this,void 0,void 0,(function(){return r(this,(function(n){switch(n.label){case 0:return[4,this.fetch("/v1/chain/get_currency_stats",{code:e,symbol:t})];case 1:return[2,n.sent()]}}))}))},e.prototype.get_info=function(){return i(this,void 0,void 0,(function(){return r(this,(function(e){switch(e.label){case 0:return[4,this.fetch("/v1/chain/get_info",{})];case 1:return[2,e.sent()]}}))}))},e.prototype.get_producer_schedule=function(){return i(this,void 0,void 0,(function(){return r(this,(function(e){switch(e.label){case 0:return[4,this.fetch("/v1/chain/get_producer_schedule",{})];case 1:return[2,e.sent()]}}))}))},e.prototype.get_producers=function(e,t,n){return void 0===e&&(e=!0),void 0===t&&(t=""),void 0===n&&(n=50),i(this,void 0,void 0,(function(){return r(this,(function(i){switch(i.label){case 0:return[4,this.fetch("/v1/chain/get_producers",{json:e,lower_bound:t,limit:n})];case 1:return[2,i.sent()]}}))}))},e.prototype.get_raw_code_and_abi=function(e){return i(this,void 0,void 0,(function(){return r(this,(function(t){switch(t.label){case 0:return[4,this.fetch("/v1/chain/get_raw_code_and_abi",{account_name:e})];case 1:return[2,t.sent()]}}))}))},e.prototype.getRawAbi=function(e){return i(this,void 0,void 0,(function(){var t,n;return r(this,(function(i){switch(i.label){case 0:return[4,this.get_raw_abi(e)];case 1:return t=i.sent(),n=o.base64ToBinary(t.abi),[2,{accountName:t.account_name,abi:n}]}}))}))},e.prototype.get_raw_abi=function(e){return i(this,void 0,void 0,(function(){return r(this,(function(t){switch(t.label){case 0:return[4,this.fetch("/v1/chain/get_raw_abi",{account_name:e})];case 1:return[2,t.sent()]}}))}))},e.prototype.get_scheduled_transactions=function(e,t,n){return void 0===e&&(e=!0),void 0===t&&(t=""),void 0===n&&(n=50),i(this,void 0,void 0,(function(){return r(this,(function(i){switch(i.label){case 0:return[4,this.fetch("/v1/chain/get_scheduled_transactions",{json:e,lower_bound:t,limit:n})];case 1:return[2,i.sent()]}}))}))},e.prototype.get_table_rows=function(e){var t=e.json,n=void 0===t||t,s=e.code,o=e.scope,a=e.table,c=e.lower_bound,l=void 0===c?"":c,u=e.upper_bound,h=void 0===u?"":u,d=e.index_position,p=void 0===d?1:d,f=e.key_type,_=void 0===f?"":f,g=e.limit,m=void 0===g?10:g,y=e.reverse,v=void 0!==y&&y,w=e.show_payer,b=void 0!==w&&w;return i(this,void 0,void 0,(function(){return r(this,(function(e){switch(e.label){case 0:return[4,this.fetch("/v1/chain/get_table_rows",{json:n,code:s,scope:o,table:a,lower_bound:l,upper_bound:h,index_position:p,key_type:_,limit:m,reverse:v,show_payer:b})];case 1:return[2,e.sent()]}}))}))},e.prototype.get_kv_table_rows=function(e){var t=e.json,n=void 0===t||t,s=e.code,o=e.table,a=e.index_name,c=e.encode_type,l=void 0===c?"bytes":c,u=e.index_value,h=e.lower_bound,d=e.upper_bound,p=e.limit,f=void 0===p?10:p,_=e.reverse,g=void 0!==_&&_,m=e.show_payer,y=void 0!==m&&m;return i(this,void 0,void 0,(function(){return r(this,(function(e){switch(e.label){case 0:return[4,this.fetch("/v1/chain/get_kv_table_rows",{json:n,code:s,table:o,index_name:a,encode_type:l,index_value:u,lower_bound:h,upper_bound:d,limit:f,reverse:g,show_payer:y})];case 1:return[2,e.sent()]}}))}))},e.prototype.get_table_by_scope=function(e){var t=e.code,n=e.table,s=e.lower_bound,o=void 0===s?"":s,a=e.upper_bound,c=void 0===a?"":a,l=e.limit,u=void 0===l?10:l;return i(this,void 0,void 0,(function(){return r(this,(function(e){switch(e.label){case 0:return[4,this.fetch("/v1/chain/get_table_by_scope",{code:t,table:n,lower_bound:o,upper_bound:c,limit:u})];case 1:return[2,e.sent()]}}))}))},e.prototype.getRequiredKeys=function(e){return i(this,void 0,void 0,(function(){var t;return r(this,(function(n){switch(n.label){case 0:return t=o.convertLegacyPublicKeys,[4,this.fetch("/v1/chain/get_required_keys",{transaction:e.transaction,available_keys:e.availableKeys})];case 1:return[2,t.apply(void 0,[n.sent().required_keys])]}}))}))},e.prototype.push_transaction=function(e){var t=e.signatures,n=e.compression,s=void 0===n?0:n,o=e.serializedTransaction,a=e.serializedContextFreeData;return i(this,void 0,void 0,(function(){return r(this,(function(e){switch(e.label){case 0:return[4,this.fetch("/v1/chain/push_transaction",{signatures:t,compression:s,packed_context_free_data:c(a||new Uint8Array(0)),packed_trx:c(o)})];case 1:return[2,e.sent()]}}))}))},e.prototype.push_ro_transaction=function(e,t){var n=e.signatures,s=e.compression,o=void 0===s?0:s,a=e.serializedTransaction;return void 0===t&&(t=!1),i(this,void 0,void 0,(function(){return r(this,(function(e){switch(e.label){case 0:return[4,this.fetch("/v1/chain/push_ro_transaction",{transaction:{signatures:n,compression:o,packed_context_free_data:c(new Uint8Array(0)),packed_trx:c(a)},return_failure_traces:t})];case 1:return[2,e.sent()]}}))}))},e.prototype.push_transactions=function(e){return i(this,void 0,void 0,(function(){var t;return r(this,(function(n){switch(n.label){case 0:return t=e.map((function(e){var t=e.signatures,n=e.compression,i=void 0===n?0:n,r=e.serializedTransaction,s=e.serializedContextFreeData;return{signatures:t,compression:i,packed_context_free_data:c(s||new Uint8Array(0)),packed_trx:c(r)}})),[4,this.fetch("/v1/chain/push_transactions",t)];case 1:return[2,n.sent()]}}))}))},e.prototype.send_transaction=function(e){var t=e.signatures,n=e.compression,s=void 0===n?0:n,o=e.serializedTransaction,a=e.serializedContextFreeData;return i(this,void 0,void 0,(function(){return r(this,(function(e){switch(e.label){case 0:return[4,this.fetch("/v1/chain/send_transaction",{signatures:t,compression:s,packed_context_free_data:c(a||new Uint8Array(0)),packed_trx:c(o)})];case 1:return[2,e.sent()]}}))}))},e.prototype.db_size_get=function(){return i(this,void 0,void 0,(function(){return r(this,(function(e){switch(e.label){case 0:return[4,this.fetch("/v1/db_size/get",{})];case 1:return[2,e.sent()]}}))}))},e.prototype.trace_get_block=function(e){return i(this,void 0,void 0,(function(){return r(this,(function(t){switch(t.label){case 0:return[4,this.fetch("/v1/trace_api/get_block",{block_num:e})];case 1:return[2,t.sent()]}}))}))},e.prototype.history_get_actions=function(e,t,n){return void 0===t&&(t=null),void 0===n&&(n=null),i(this,void 0,void 0,(function(){return r(this,(function(i){switch(i.label){case 0:return[4,this.fetch("/v1/history/get_actions",{account_name:e,pos:t,offset:n})];case 1:return[2,i.sent()]}}))}))},e.prototype.history_get_transaction=function(e,t){return void 0===t&&(t=null),i(this,void 0,void 0,(function(){return r(this,(function(n){switch(n.label){case 0:return[4,this.fetch("/v1/history/get_transaction",{id:e,block_num_hint:t})];case 1:return[2,n.sent()]}}))}))},e.prototype.history_get_key_accounts=function(e){return i(this,void 0,void 0,(function(){return r(this,(function(t){switch(t.label){case 0:return[4,this.fetch("/v1/history/get_key_accounts",{public_key:e})];case 1:return[2,t.sent()]}}))}))},e.prototype.history_get_controlled_accounts=function(e){return i(this,void 0,void 0,(function(){return r(this,(function(t){switch(t.label){case 0:return[4,this.fetch("/v1/history/get_controlled_accounts",{controlling_account:e})];case 1:return[2,t.sent()]}}))}))},e}();t.JsonRpc=l},1823:function(e,t,n){"use strict";var i=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var i,r,s=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(i=s.next()).done;)o.push(i.value)}catch(e){r={error:e}}finally{try{i&&!i.done&&(n=s.return)&&n.call(s)}finally{if(r)throw r.error}}return o},r=this&&this.__spreadArray||function(e,t){for(var n=0,i=t.length,r=e.length;n<i;n++,r++)e[r]=t[n];return e},s=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],i=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&i>=e.length&&(e=void 0),{value:e&&e[i++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0}),t.signatureToString=t.stringToSignature=t.privateKeyToString=t.privateKeyToLegacyString=t.stringToPrivateKey=t.convertLegacyPublicKeys=t.convertLegacyPublicKey=t.publicKeyToString=t.publicKeyToLegacyString=t.stringToPublicKey=t.signatureDataSize=t.privateKeyDataSize=t.publicKeyDataSize=t.KeyType=t.base64ToBinary=t.binaryToBase58=t.base58ToBinary=t.signedBinaryToDecimal=t.binaryToDecimal=t.signedDecimalToBinary=t.decimalToBinary=t.negate=t.isNegative=void 0;var o,a=n(6204),c=n(1963).RIPEMD160.hash,l="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz",u="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",h=function(){for(var e=Array(256).fill(-1),t=0;t<l.length;++t)e[l.charCodeAt(t)]=t;return e}(),d=function(){for(var e=Array(256).fill(-1),t=0;t<u.length;++t)e[u.charCodeAt(t)]=t;return e["=".charCodeAt(0)]=0,e}();t.isNegative=function(e){return 0!=(128&e[e.length-1])},t.negate=function(e){for(var t=1,n=0;n<e.length;++n){var i=(255&~e[n])+t;e[n]=i,t=i>>8}},t.decimalToBinary=function(e,t){for(var n=new Uint8Array(e),i=0;i<t.length;++i){var r=t.charCodeAt(i);if(r<"0".charCodeAt(0)||r>"9".charCodeAt(0))throw new Error("invalid number");for(var s=r-"0".charCodeAt(0),o=0;o<e;++o){var a=10*n[o]+s;n[o]=a,s=a>>8}if(s)throw new Error("number is out of range")}return n},t.signedDecimalToBinary=function(e,n){var i="-"===n[0];i&&(n=n.substr(1));var r=t.decimalToBinary(e,n);if(i){if(t.negate(r),!t.isNegative(r))throw new Error("number is out of range")}else if(t.isNegative(r))throw new Error("number is out of range");return r},t.binaryToDecimal=function(e,t){void 0===t&&(t=1);for(var n=Array(t).fill("0".charCodeAt(0)),s=e.length-1;s>=0;--s){for(var o=e[s],a=0;a<n.length;++a){var c=(n[a]-"0".charCodeAt(0)<<8)+o;n[a]="0".charCodeAt(0)+c%10,o=c/10|0}for(;o;)n.push("0".charCodeAt(0)+o%10),o=o/10|0}return n.reverse(),String.fromCharCode.apply(String,r([],i(n)))},t.signedBinaryToDecimal=function(e,n){if(void 0===n&&(n=1),t.isNegative(e)){var i=e.slice();return t.negate(i),"-"+t.binaryToDecimal(i,n)}return t.binaryToDecimal(e,n)},t.base58ToBinary=function(e,t){if(!e)return function(e){for(var t,n,i=[],r=0;r<e.length;++r){var o=h[e.charCodeAt(r)];if(o<0)throw new Error("invalid base-58 value");for(var a=0;a<i.length;++a){var c=58*i[a]+o;i[a]=255&c,o=c>>8}o&&i.push(o)}try{for(var l=s(e),u=l.next();!u.done&&"1"===u.value;u=l.next())i.push(0)}catch(e){t={error:e}}finally{try{u&&!u.done&&(n=l.return)&&n.call(l)}finally{if(t)throw t.error}}return i.reverse(),new Uint8Array(i)}(t);for(var n=new Uint8Array(e),i=0;i<t.length;++i){var r=h[t.charCodeAt(i)];if(r<0)throw new Error("invalid base-58 value");for(var o=0;o<e;++o){var a=58*n[o]+r;n[o]=a,r=a>>8}if(r)throw new Error("base-58 value is out of range")}return n.reverse(),n},t.binaryToBase58=function(e,t){var n,o,a,c;void 0===t&&(t=1);var u=[];try{for(var d=s(e),p=d.next();!p.done;p=d.next()){for(var f=p.value,_=0;_<u.length;++_){var g=(h[u[_]]<<8)+f;u[_]=l.charCodeAt(g%58),f=g/58|0}for(;f;)u.push(l.charCodeAt(f%58)),f=f/58|0}}catch(e){n={error:e}}finally{try{p&&!p.done&&(o=d.return)&&o.call(d)}finally{if(n)throw n.error}}try{for(var m=s(e),y=m.next();!y.done&&!y.value;y=m.next())u.push("1".charCodeAt(0))}catch(e){a={error:e}}finally{try{y&&!y.done&&(c=m.return)&&c.call(m)}finally{if(a)throw a.error}}return u.reverse(),String.fromCharCode.apply(String,r([],i(u)))},t.base64ToBinary=function(e){var t=e.length;if(1==(3&t)&&"="===e[t-1]&&(t-=1),0!=(3&t))throw new Error("base-64 value is not padded correctly");var n=t>>2,i=3*n;t>0&&"="===e[t-1]&&("="===e[t-2]?i-=2:i-=1);for(var r=new Uint8Array(i),s=0;s<n;++s){var o=d[e.charCodeAt(4*s+0)],a=d[e.charCodeAt(4*s+1)],c=d[e.charCodeAt(4*s+2)],l=d[e.charCodeAt(4*s+3)];r[3*s+0]=o<<2|a>>4,3*s+1<i&&(r[3*s+1]=(15&a)<<4|c>>2),3*s+2<i&&(r[3*s+2]=(3&c)<<6|l)}return r},function(e){e[e.k1=0]="k1",e[e.r1=1]="r1",e[e.wa=2]="wa"}(o=t.KeyType||(t.KeyType={})),t.publicKeyDataSize=33,t.privateKeyDataSize=32,t.signatureDataSize=65;var p=function(e,t){for(var n=new Uint8Array(e.length+t.length),i=0;i<e.length;++i)n[i]=e[i];for(i=0;i<t.length;++i)n[e.length+i]=t.charCodeAt(i);return c(n)},f=function(e,n,i,r){var s=t.base58ToBinary(i?i+4:0,e),o={type:n,data:new Uint8Array(s.buffer,0,s.length-4)},a=new Uint8Array(p(o.data,r));if(a[0]!==s[s.length-4]||a[1]!==s[s.length-3]||a[2]!==s[s.length-2]||a[3]!==s[s.length-1])throw new Error("checksum doesn't match");return o},_=function(e,n,i){for(var r=new Uint8Array(p(e.data,n)),s=new Uint8Array(e.data.length+4),o=0;o<e.data.length;++o)s[o]=e.data[o];for(o=0;o<4;++o)s[o+e.data.length]=r[o];return i+t.binaryToBase58(s)};t.stringToPublicKey=function(e){if("string"!=typeof e)throw new Error("expected string containing public key");if("EOS"===e.substr(0,3)){for(var n=t.base58ToBinary(t.publicKeyDataSize+4,e.substr(3)),i={type:o.k1,data:new Uint8Array(t.publicKeyDataSize)},r=0;r<t.publicKeyDataSize;++r)i.data[r]=n[r];var s=new Uint8Array(c(i.data));if(s[0]!==n[t.publicKeyDataSize]||s[1]!==n[34]||s[2]!==n[35]||s[3]!==n[36])throw new Error("checksum doesn't match");return i}if("PUB_K1_"===e.substr(0,7))return f(e.substr(7),o.k1,t.publicKeyDataSize,"K1");if("PUB_R1_"===e.substr(0,7))return f(e.substr(7),o.r1,t.publicKeyDataSize,"R1");if("PUB_WA_"===e.substr(0,7))return f(e.substr(7),o.wa,0,"WA");throw new Error("unrecognized public key format")},t.publicKeyToLegacyString=function(e){if(e.type===o.k1&&e.data.length===t.publicKeyDataSize)return _(e,"","EOS");throw e.type===o.r1||e.type===o.wa?new Error("Key format not supported in legacy conversion"):new Error("unrecognized public key format")},t.publicKeyToString=function(e){if(e.type===o.k1&&e.data.length===t.publicKeyDataSize)return _(e,"K1","PUB_K1_");if(e.type===o.r1&&e.data.length===t.publicKeyDataSize)return _(e,"R1","PUB_R1_");if(e.type===o.wa)return _(e,"WA","PUB_WA_");throw new Error("unrecognized public key format")},t.convertLegacyPublicKey=function(e){return"EOS"===e.substr(0,3)?t.publicKeyToString(t.stringToPublicKey(e)):e},t.convertLegacyPublicKeys=function(e){return e.map(t.convertLegacyPublicKey)},t.stringToPrivateKey=function(e){if("string"!=typeof e)throw new Error("expected string containing private key");if("PVT_R1_"===e.substr(0,7))return f(e.substr(7),o.r1,t.privateKeyDataSize,"R1");if("PVT_K1_"===e.substr(0,7))return f(e.substr(7),o.k1,t.privateKeyDataSize,"K1");var n=t.base58ToBinary(t.privateKeyDataSize+5,e),i={type:o.k1,data:new Uint8Array(t.privateKeyDataSize)};if(128!==n[0])throw new Error("unrecognized private key type");for(var r=0;r<t.privateKeyDataSize;++r)i.data[r]=n[r+1];return i},t.privateKeyToLegacyString=function(e){if(e.type===o.k1&&e.data.length===t.privateKeyDataSize){var n=[];n.push(128),e.data.forEach((function(e){return n.push(e)}));for(var i=new Uint8Array(a.sha256().update(a.sha256().update(n).digest()).digest()),r=new Uint8Array(t.privateKeyDataSize+5),s=0;s<n.length;s++)r[s]=n[s];for(s=0;s<4;s++)r[s+n.length]=i[s];return t.binaryToBase58(r)}throw e.type===o.r1||e.type===o.wa?new Error("Key format not supported in legacy conversion"):new Error("unrecognized public key format")},t.privateKeyToString=function(e){if(e.type===o.r1)return _(e,"R1","PVT_R1_");if(e.type===o.k1)return _(e,"K1","PVT_K1_");throw new Error("unrecognized private key format")},t.stringToSignature=function(e){if("string"!=typeof e)throw new Error("expected string containing signature");if("SIG_K1_"===e.substr(0,7))return f(e.substr(7),o.k1,t.signatureDataSize,"K1");if("SIG_R1_"===e.substr(0,7))return f(e.substr(7),o.r1,t.signatureDataSize,"R1");if("SIG_WA_"===e.substr(0,7))return f(e.substr(7),o.wa,0,"WA");throw new Error("unrecognized signature format")},t.signatureToString=function(e){if(e.type===o.k1)return _(e,"K1","SIG_K1_");if(e.type===o.r1)return _(e,"R1","SIG_R1_");if(e.type===o.wa)return _(e,"WA","SIG_WA_");throw new Error("unrecognized signature format")}},5576:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},3937:function(e,t){"use strict";var n,i=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},n(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function i(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0}),t.RpcError=void 0;var r=function(e){function t(n){var i=this;return n.error&&n.error.details&&n.error.details.length&&n.error.details[0].message?(i=e.call(this,n.error.details[0].message)||this).details=n.error.details:n.processed&&n.processed.except&&n.processed.except.message?(i=e.call(this,n.processed.except.message)||this).details=n.processed.except:n.result&&n.result.except&&n.result.except.message?(i=e.call(this,n.result.except.message)||this).details=n.result.except:i=e.call(this,n.message)||this,Object.setPrototypeOf(i,t.prototype),i.json=n,i}return i(t,e),t}(Error);t.RpcError=r},2753:function(e,t,n){"use strict";var i=this&&this.__assign||function(){return i=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},i.apply(this,arguments)},r=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var i,r,s=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(i=s.next()).done;)o.push(i.value)}catch(e){r={error:e}}finally{try{i&&!i.done&&(n=s.return)&&n.call(s)}finally{if(r)throw r.error}}return o},s=this&&this.__spreadArray||function(e,t){for(var n=0,i=t.length,r=e.length;n<i;n++,r++)e[r]=t[n];return e},o=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],i=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&i>=e.length&&(e=void 0),{value:e&&e[i++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0}),t.serializeQuery=t.deserializeAnyArray=t.serializeAnyArray=t.deserializeAnyObject=t.serializeAnyObject=t.deserializeAnyvarShort=t.deserializeAnyvar=t.serializeAnyvar=t.deserializeAction=t.deserializeActionData=t.serializeAction=t.serializeActionData=t.transactionHeader=t.getTypesFromAbi=t.getType=t.createTransactionTypes=t.createTransactionExtensionTypes=t.createAbiTypes=t.createInitialTypes=t.hexToUint8Array=t.arrayToHex=t.symbolToString=t.stringToSymbol=t.blockTimestampToDate=t.dateToBlockTimestamp=t.timePointSecToDate=t.dateToTimePointSec=t.timePointToDate=t.dateToTimePoint=t.supportedAbiVersion=t.SerialBuffer=t.SerializerState=void 0;var a=n(1823),c=function(e){void 0===e&&(e={}),this.skippedBinaryExtension=!1,this.options=e};t.SerializerState=c;var l=function(){function e(e){var t=void 0===e?{}:e,n=t.textEncoder,i=t.textDecoder,r=t.array;this.readPos=0,this.array=r||new Uint8Array(1024),this.length=r?r.length:0,this.textEncoder=n||new TextEncoder,this.textDecoder=i||new TextDecoder("utf-8",{fatal:!0})}return e.prototype.reserve=function(e){if(!(this.length+e<=this.array.length)){for(var t=this.array.length;this.length+e>t;)t=Math.ceil(1.5*t);var n=new Uint8Array(t);n.set(this.array),this.array=n}},e.prototype.haveReadData=function(){return this.readPos<this.length},e.prototype.restartRead=function(){this.readPos=0},e.prototype.asUint8Array=function(){return new Uint8Array(this.array.buffer,this.array.byteOffset,this.length)},e.prototype.pushArray=function(e){this.reserve(e.length),this.array.set(e,this.length),this.length+=e.length},e.prototype.push=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.pushArray(e)},e.prototype.get=function(){if(this.readPos<this.length)return this.array[this.readPos++];throw new Error("Read past end of buffer")},e.prototype.pushUint8ArrayChecked=function(e,t){if(e.length!==t)throw new Error("Binary data has incorrect size");this.pushArray(e)},e.prototype.getUint8Array=function(e){if(this.readPos+e>this.length)throw new Error("Read past end of buffer");var t=new Uint8Array(this.array.buffer,this.array.byteOffset+this.readPos,e);return this.readPos+=e,t},e.prototype.skip=function(e){if(this.readPos+e>this.length)throw new Error("Read past end of buffer");this.readPos+=e},e.prototype.pushUint16=function(e){this.push(e>>0&255,e>>8&255)},e.prototype.getUint16=function(){var e=0;return(e|=this.get()<<0)|this.get()<<8},e.prototype.pushUint32=function(e){this.push(e>>0&255,e>>8&255,e>>16&255,e>>24&255)},e.prototype.getUint32=function(){var e=0;return e|=this.get()<<0,e|=this.get()<<8,e|=this.get()<<16,(e|=this.get()<<24)>>>0},e.prototype.pushNumberAsUint64=function(e){this.pushUint32(e>>>0),this.pushUint32(Math.floor(e/4294967296)>>>0)},e.prototype.getUint64AsNumber=function(){var e=this.getUint32();return 4294967296*(this.getUint32()>>>0)+(e>>>0)},e.prototype.pushVaruint32=function(e){for(;;){if(!(e>>>7)){this.push(e);break}this.push(128|127&e),e>>>=7}},e.prototype.getVaruint32=function(){for(var e=0,t=0;;){var n=this.get();if(e|=(127&n)<<t,t+=7,!(128&n))break}return e>>>0},e.prototype.pushVarint32=function(e){this.pushVaruint32(e<<1^e>>31)},e.prototype.getVarint32=function(){var e=this.getVaruint32();return 1&e?~e>>1|2147483648:e>>>1},e.prototype.pushFloat32=function(e){this.pushArray(new Uint8Array(new Float32Array([e]).buffer))},e.prototype.getFloat32=function(){return new Float32Array(this.getUint8Array(4).slice().buffer)[0]},e.prototype.pushFloat64=function(e){this.pushArray(new Uint8Array(new Float64Array([e]).buffer))},e.prototype.getFloat64=function(){return new Float64Array(this.getUint8Array(8).slice().buffer)[0]},e.prototype.pushName=function(e){if("string"!=typeof e)throw new Error("Expected string containing name");if(!new RegExp(/^[.1-5a-z]{0,12}[.1-5a-j]?$/).test(e))throw new Error("Name should be less than 13 characters, or less than 14 if last character is between 1-5 or a-j, and only contain the following symbols .12345abcdefghijklmnopqrstuvwxyz");for(var t=function(e){return e>="a".charCodeAt(0)&&e<="z".charCodeAt(0)?e-"a".charCodeAt(0)+6:e>="1".charCodeAt(0)&&e<="5".charCodeAt(0)?e-"1".charCodeAt(0)+1:0},n=new Uint8Array(8),i=63,r=0;r<e.length;++r){var s=t(e.charCodeAt(r));i<5&&(s<<=1);for(var o=4;o>=0;--o)i>=0&&(n[Math.floor(i/8)]|=(s>>o&1)<<i%8,--i)}this.pushArray(n)},e.prototype.getName=function(){for(var e=this.getUint8Array(8),t="",n=63;n>=0;){for(var i=0,r=0;r<5;++r)n>=0&&(i=i<<1|e[Math.floor(n/8)]>>n%8&1,--n);t+=i>=6?String.fromCharCode(i+"a".charCodeAt(0)-6):i>=1?String.fromCharCode(i+"1".charCodeAt(0)-1):"."}for(;t.endsWith(".");)t=t.substr(0,t.length-1);return t},e.prototype.pushBytes=function(e){this.pushVaruint32(e.length),this.pushArray(e)},e.prototype.getBytes=function(){return this.getUint8Array(this.getVaruint32())},e.prototype.pushString=function(e){this.pushBytes(this.textEncoder.encode(e))},e.prototype.getString=function(){return this.textDecoder.decode(this.getBytes())},e.prototype.pushSymbolCode=function(e){if("string"!=typeof e)throw new Error("Expected string containing symbol_code");var t=[];for(t.push.apply(t,s([],r(this.textEncoder.encode(e))));t.length<8;)t.push(0);this.pushArray(t.slice(0,8))},e.prototype.getSymbolCode=function(){var e,t=this.getUint8Array(8);for(e=0;e<t.length&&t[e];++e);return this.textDecoder.decode(new Uint8Array(t.buffer,t.byteOffset,e))},e.prototype.pushSymbol=function(e){var t=e.name,n=e.precision;if(!/^[A-Z]{1,7}$/.test(t))throw new Error("Expected symbol to be A-Z and between one and seven characters");var i=[255&n];for(i.push.apply(i,s([],r(this.textEncoder.encode(t))));i.length<8;)i.push(0);this.pushArray(i.slice(0,8))},e.prototype.getSymbol=function(){var e,t=this.get(),n=this.getUint8Array(7);for(e=0;e<n.length&&n[e];++e);return{name:this.textDecoder.decode(new Uint8Array(n.buffer,n.byteOffset,e)),precision:t}},e.prototype.pushAsset=function(e){if("string"!=typeof e)throw new Error("Expected string containing asset");var t=0,n="",i=0;"-"===(e=e.trim())[t]&&(n+="-",++t);for(var r=!1;t<e.length&&e.charCodeAt(t)>="0".charCodeAt(0)&&e.charCodeAt(t)<="9".charCodeAt(0);)r=!0,n+=e[t],++t;if(!r)throw new Error("Asset must begin with a number");if("."===e[t])for(++t;t<e.length&&e.charCodeAt(t)>="0".charCodeAt(0)&&e.charCodeAt(t)<="9".charCodeAt(0);)n+=e[t],++i,++t;var s=e.substr(t).trim();this.pushArray(a.signedDecimalToBinary(8,n)),this.pushSymbol({name:s,precision:i})},e.prototype.getAsset=function(){var e=this.getUint8Array(8),t=this.getSymbol(),n=t.name,i=t.precision,r=a.signedBinaryToDecimal(e,i+1);return i&&(r=r.substr(0,r.length-i)+"."+r.substr(r.length-i)),r+" "+n},e.prototype.pushPublicKey=function(e){var t=a.stringToPublicKey(e);this.push(t.type),this.pushArray(t.data)},e.prototype.getPublicKey=function(){var e,t=this.get();if(t===a.KeyType.wa){var n=this.readPos;this.skip(34),this.skip(this.getVaruint32()),e=new Uint8Array(this.array.buffer,this.array.byteOffset+n,this.readPos-n)}else e=this.getUint8Array(a.publicKeyDataSize);return a.publicKeyToString({type:t,data:e})},e.prototype.pushPrivateKey=function(e){var t=a.stringToPrivateKey(e);this.push(t.type),this.pushArray(t.data)},e.prototype.getPrivateKey=function(){var e=this.get(),t=this.getUint8Array(a.privateKeyDataSize);return a.privateKeyToString({type:e,data:t})},e.prototype.pushSignature=function(e){var t=a.stringToSignature(e);this.push(t.type),this.pushArray(t.data)},e.prototype.getSignature=function(){var e,t=this.get();if(t===a.KeyType.wa){var n=this.readPos;this.skip(65),this.skip(this.getVaruint32()),this.skip(this.getVaruint32()),e=new Uint8Array(this.array.buffer,this.array.byteOffset+n,this.readPos-n)}else e=this.getUint8Array(a.signatureDataSize);return a.signatureToString({type:t,data:e})},e}();t.SerialBuffer=l,t.supportedAbiVersion=function(e){return e.startsWith("eosio::abi/1.")};var u=function(e){var t=Date.parse(e);if(Number.isNaN(t))throw new Error("Invalid time format");return t};function h(e,t){throw new Error("Don't know how to serialize "+this.name)}function d(e){throw new Error("Don't know how to deserialize "+this.name)}function p(e,t,n,i){var r,s;if(void 0===n&&(n=new c),void 0===i&&(i=!0),"object"!=typeof t)throw new Error("expected object containing data: "+JSON.stringify(t));this.base&&this.base.serialize(e,t,n,i);try{for(var a=o(this.fields),l=a.next();!l.done;l=a.next()){var u=l.value;if(u.name in t){if(n.skippedBinaryExtension)throw new Error("unexpected "+this.name+"."+u.name);u.type.serialize(e,t[u.name],n,i&&u===this.fields[this.fields.length-1])}else{if(!i||!u.type.extensionOf)throw new Error("missing "+this.name+"."+u.name+" (type="+u.type.name+")");n.skippedBinaryExtension=!0}}}catch(e){r={error:e}}finally{try{l&&!l.done&&(s=a.return)&&s.call(a)}finally{if(r)throw r.error}}}function f(e,t,n){var i,r,s;void 0===t&&(t=new c),void 0===n&&(n=!0),s=this.base?this.base.deserialize(e,t,n):{};try{for(var a=o(this.fields),l=a.next();!l.done;l=a.next()){var u=l.value;n&&u.type.extensionOf&&!e.haveReadData()?t.skippedBinaryExtension=!0:s[u.name]=u.type.deserialize(e,t,n)}}catch(e){i={error:e}}finally{try{l&&!l.done&&(r=a.return)&&r.call(a)}finally{if(i)throw i.error}}return s}function _(e,t,n,i){if(!Array.isArray(t)||2!==t.length||"string"!=typeof t[0])throw new Error('expected variant: ["type", value]');var r=this.fields.findIndex((function(e){return e.name===t[0]}));if(r<0)throw new Error('type "'+t[0]+'" is not valid for variant');e.pushVaruint32(r),this.fields[r].type.serialize(e,t[1],n,i)}function g(e,t,n){var i=e.getVaruint32();if(i>=this.fields.length)throw new Error("type index "+i+" is not valid for variant");var r=this.fields[i];return[r.name,r.type.deserialize(e,t,n)]}function m(e,t,n,i){var r,s;e.pushVaruint32(t.length);try{for(var a=o(t),c=a.next();!c.done;c=a.next()){var l=c.value;this.arrayOf.serialize(e,l,n,!1)}}catch(e){r={error:e}}finally{try{c&&!c.done&&(s=a.return)&&s.call(a)}finally{if(r)throw r.error}}}function y(e,t,n){for(var i=e.getVaruint32(),r=[],s=0;s<i;++s)r.push(this.arrayOf.deserialize(e,t,!1));return r}function v(e,t,n,i){null==t?e.push(0):(e.push(1),this.optionalOf.serialize(e,t,n,i))}function w(e,t,n){return e.get()?this.optionalOf.deserialize(e,t,n):null}function b(e,t,n,i){this.extensionOf.serialize(e,t,n,i)}function k(e,t,n){return this.extensionOf.deserialize(e,t,n)}function T(e,t,n,i){var s,a,c=Object.entries(t);e.pushVaruint32(c.length);try{for(var l=o(c),u=l.next();!u.done;u=l.next()){var h=r(u.value,2),d=h[0],p=h[1],f=this.fields[0].type,_=this.fields[1].type;f.serialize(e,d,n,i),_.serialize(e,p,n,i)}}catch(e){s={error:e}}finally{try{u&&!u.done&&(a=l.return)&&a.call(l)}finally{if(s)throw s.error}}}function E(e,t,n){for(var i=e.getVaruint32(),r={},s=0;s<i;++s){var o=this.fields[0].type,a=this.fields[1].type;r[o.deserialize(e,t,n)]=a.deserialize(e,t,n)}return r}function I(e,t,n,i){var r=this;e.pushVaruint32(t.length),t.forEach((function(t){r.fields[0].type.serialize(e,t[0],n,i),r.fields[1].type.serialize(e,t[1],n,i)}))}function S(e,t,n){for(var i=[],r=e.getVaruint32(),s=0;s<r;++s)i.push(this.fields[0].type.deserialize(e,t,n)),i.push(this.fields[1].type.deserialize(e,t,n));return i}t.dateToTimePoint=function(e){return Math.round(1e3*u(e+"Z"))},t.timePointToDate=function(e){var t=new Date(e/1e3).toISOString();return t.substr(0,t.length-1)},t.dateToTimePointSec=function(e){return Math.round(u(e+"Z")/1e3)},t.timePointSecToDate=function(e){var t=new Date(1e3*e).toISOString();return t.substr(0,t.length-1)},t.dateToBlockTimestamp=function(e){return Math.round((u(e+"Z")-9466848e5)/500)},t.blockTimestampToDate=function(e){var t=new Date(500*e+9466848e5).toISOString();return t.substr(0,t.length-1)},t.stringToSymbol=function(e){if("string"!=typeof e)throw new Error("Expected string containing symbol");var t=e.match(/^([0-9]+),([A-Z]+)$/);if(!t)throw new Error("Invalid symbol");return{name:t[2],precision:+t[1]}},t.symbolToString=function(e){var t=e.name;return e.precision+","+t},t.arrayToHex=function(e){var t,n,i="";try{for(var r=o(e),s=r.next();!s.done;s=r.next())i+=("00"+s.value.toString(16)).slice(-2)}catch(e){t={error:e}}finally{try{s&&!s.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}return i.toUpperCase()},t.hexToUint8Array=function(e){if("string"!=typeof e)throw new Error("Expected string containing hex digits");if(e.length%2)throw new Error("Odd number of hex digits");for(var t=e.length/2,n=new Uint8Array(t),i=0;i<t;++i){var r=parseInt(e.substr(2*i,2),16);if(Number.isNaN(r))throw new Error("Expected hex string");n[i]=r}return n};var C=function(e){return i({name:"<missing name>",aliasOfName:"",arrayOf:null,optionalOf:null,extensionOf:null,baseName:"",base:null,fields:[],serialize:h,deserialize:d},e)},x=function(e,t){if(Number.isNaN(+e)||Number.isNaN(+t)||"number"!=typeof e&&"string"!=typeof e)throw new Error("Expected number");if(+e!=+t)throw new Error("Number is out of range");return+e};t.createInitialTypes=function(){var e=new Map(Object.entries({bool:C({name:"bool",serialize:function(e,t){if("boolean"!=typeof t&&("number"!=typeof t||1!==t&&0!==t))throw new Error("Expected boolean or number equal to 1 or 0");e.push(t?1:0)},deserialize:function(e){return!!e.get()}}),uint8:C({name:"uint8",serialize:function(e,t){e.push(x(t,255&t))},deserialize:function(e){return e.get()}}),int8:C({name:"int8",serialize:function(e,t){e.push(x(t,t<<24>>24))},deserialize:function(e){return e.get()<<24>>24}}),uint16:C({name:"uint16",serialize:function(e,t){e.pushUint16(x(t,65535&t))},deserialize:function(e){return e.getUint16()}}),int16:C({name:"int16",serialize:function(e,t){e.pushUint16(x(t,t<<16>>16))},deserialize:function(e){return e.getUint16()<<16>>16}}),uint32:C({name:"uint32",serialize:function(e,t){e.pushUint32(x(t,t>>>0))},deserialize:function(e){return e.getUint32()}}),uint64:C({name:"uint64",serialize:function(e,t){e.pushArray(a.decimalToBinary(8,""+t))},deserialize:function(e){return a.binaryToDecimal(e.getUint8Array(8))}}),int64:C({name:"int64",serialize:function(e,t){e.pushArray(a.signedDecimalToBinary(8,""+t))},deserialize:function(e){return a.signedBinaryToDecimal(e.getUint8Array(8))}}),int32:C({name:"int32",serialize:function(e,t){e.pushUint32(x(t,0|t))},deserialize:function(e){return 0|e.getUint32()}}),varuint32:C({name:"varuint32",serialize:function(e,t){e.pushVaruint32(x(t,t>>>0))},deserialize:function(e){return e.getVaruint32()}}),varint32:C({name:"varint32",serialize:function(e,t){e.pushVarint32(x(t,0|t))},deserialize:function(e){return e.getVarint32()}}),uint128:C({name:"uint128",serialize:function(e,t){e.pushArray(a.decimalToBinary(16,""+t))},deserialize:function(e){return a.binaryToDecimal(e.getUint8Array(16))}}),int128:C({name:"int128",serialize:function(e,t){e.pushArray(a.signedDecimalToBinary(16,""+t))},deserialize:function(e){return a.signedBinaryToDecimal(e.getUint8Array(16))}}),float32:C({name:"float32",serialize:function(e,t){e.pushFloat32(t)},deserialize:function(e){return e.getFloat32()}}),float64:C({name:"float64",serialize:function(e,t){e.pushFloat64(t)},deserialize:function(e){return e.getFloat64()}}),float128:C({name:"float128",serialize:function(e,n){e.pushUint8ArrayChecked(t.hexToUint8Array(n),16)},deserialize:function(e){return t.arrayToHex(e.getUint8Array(16))}}),bytes:C({name:"bytes",serialize:function(e,n){n instanceof Uint8Array||Array.isArray(n)?e.pushBytes(n):e.pushBytes(t.hexToUint8Array(n))},deserialize:function(e,n){return n&&n.options.bytesAsUint8Array?e.getBytes():t.arrayToHex(e.getBytes())}}),string:C({name:"string",serialize:function(e,t){e.pushString(t)},deserialize:function(e){return e.getString()}}),name:C({name:"name",serialize:function(e,t){e.pushName(t)},deserialize:function(e){return e.getName()}}),time_point:C({name:"time_point",serialize:function(e,n){e.pushNumberAsUint64(t.dateToTimePoint(n))},deserialize:function(e){return t.timePointToDate(e.getUint64AsNumber())}}),time_point_sec:C({name:"time_point_sec",serialize:function(e,n){e.pushUint32(t.dateToTimePointSec(n))},deserialize:function(e){return t.timePointSecToDate(e.getUint32())}}),block_timestamp_type:C({name:"block_timestamp_type",serialize:function(e,n){e.pushUint32(t.dateToBlockTimestamp(n))},deserialize:function(e){return t.blockTimestampToDate(e.getUint32())}}),symbol_code:C({name:"symbol_code",serialize:function(e,t){e.pushSymbolCode(t)},deserialize:function(e){return e.getSymbolCode()}}),symbol:C({name:"symbol",serialize:function(e,n){e.pushSymbol(t.stringToSymbol(n))},deserialize:function(e){return t.symbolToString(e.getSymbol())}}),asset:C({name:"asset",serialize:function(e,t){e.pushAsset(t)},deserialize:function(e){return e.getAsset()}}),checksum160:C({name:"checksum160",serialize:function(e,n){e.pushUint8ArrayChecked(t.hexToUint8Array(n),20)},deserialize:function(e){return t.arrayToHex(e.getUint8Array(20))}}),checksum256:C({name:"checksum256",serialize:function(e,n){e.pushUint8ArrayChecked(t.hexToUint8Array(n),32)},deserialize:function(e){return t.arrayToHex(e.getUint8Array(32))}}),checksum512:C({name:"checksum512",serialize:function(e,n){e.pushUint8ArrayChecked(t.hexToUint8Array(n),64)},deserialize:function(e){return t.arrayToHex(e.getUint8Array(64))}}),public_key:C({name:"public_key",serialize:function(e,t){e.pushPublicKey(t)},deserialize:function(e){return e.getPublicKey()}}),private_key:C({name:"private_key",serialize:function(e,t){e.pushPrivateKey(t)},deserialize:function(e){return e.getPrivateKey()}}),signature:C({name:"signature",serialize:function(e,t){e.pushSignature(t)},deserialize:function(e){return e.getSignature()}})}));return e.set("extended_asset",C({name:"extended_asset",baseName:"",fields:[{name:"quantity",typeName:"asset",type:e.get("asset")},{name:"contract",typeName:"name",type:e.get("name")}],serialize:p,deserialize:f})),e},t.createAbiTypes=function(){var e=t.createInitialTypes();return e.set("extensions_entry",C({name:"extensions_entry",baseName:"",fields:[{name:"tag",typeName:"uint16",type:null},{name:"value",typeName:"bytes",type:null}],serialize:p,deserialize:f})),e.set("type_def",C({name:"type_def",baseName:"",fields:[{name:"new_type_name",typeName:"string",type:null},{name:"type",typeName:"string",type:null}],serialize:p,deserialize:f})),e.set("field_def",C({name:"field_def",baseName:"",fields:[{name:"name",typeName:"string",type:null},{name:"type",typeName:"string",type:null}],serialize:p,deserialize:f})),e.set("struct_def",C({name:"struct_def",baseName:"",fields:[{name:"name",typeName:"string",type:null},{name:"base",typeName:"string",type:null},{name:"fields",typeName:"field_def[]",type:null}],serialize:p,deserialize:f})),e.set("action_def",C({name:"action_def",baseName:"",fields:[{name:"name",typeName:"name",type:null},{name:"type",typeName:"string",type:null},{name:"ricardian_contract",typeName:"string",type:null}],serialize:p,deserialize:f})),e.set("table_def",C({name:"table_def",baseName:"",fields:[{name:"name",typeName:"name",type:null},{name:"index_type",typeName:"string",type:null},{name:"key_names",typeName:"string[]",type:null},{name:"key_types",typeName:"string[]",type:null},{name:"type",typeName:"string",type:null}],serialize:p,deserialize:f})),e.set("clause_pair",C({name:"clause_pair",baseName:"",fields:[{name:"id",typeName:"string",type:null},{name:"body",typeName:"string",type:null}],serialize:p,deserialize:f})),e.set("error_message",C({name:"error_message",baseName:"",fields:[{name:"error_code",typeName:"uint64",type:null},{name:"error_msg",typeName:"string",type:null}],serialize:p,deserialize:f})),e.set("variant_def",C({name:"variant_def",baseName:"",fields:[{name:"name",typeName:"string",type:null},{name:"types",typeName:"string[]",type:null}],serialize:p,deserialize:f})),e.set("action_result",C({name:"action_result",baseName:"",fields:[{name:"name",typeName:"name",type:null},{name:"result_type",typeName:"string",type:null}],serialize:p,deserialize:f})),e.set("primary_key_index_def",C({name:"primary_key_index_def",baseName:"",fields:[{name:"name",typeName:"name",type:null},{name:"type",typeName:"string",type:null}],serialize:p,deserialize:f})),e.set("secondary_index_def",C({name:"secondary_index_def",baseName:"",fields:[{name:"type",typeName:"string",type:null}],serialize:p,deserialize:f})),e.set("secondary_indices",C({name:"secondary_indices",baseName:"",fields:[{name:"name",typeName:"name",type:null},{name:"secondary_index_def",typeName:"secondary_index_def",type:null}],serialize:T,deserialize:E})),e.set("kv_table_entry_def",C({name:"kv_table_entry_def",baseName:"",fields:[{name:"type",typeName:"string",type:null},{name:"primary_index",typeName:"primary_key_index_def",type:null},{name:"secondary_indices",typeName:"secondary_indices",type:null}],serialize:p,deserialize:f})),e.set("kv_table",C({name:"kv_table",baseName:"",fields:[{name:"name",typeName:"name",type:null},{name:"kv_table_entry_def",typeName:"kv_table_entry_def",type:null}],serialize:T,deserialize:E})),e.set("abi_def",C({name:"abi_def",baseName:"",fields:[{name:"version",typeName:"string",type:null},{name:"types",typeName:"type_def[]",type:null},{name:"structs",typeName:"struct_def[]",type:null},{name:"actions",typeName:"action_def[]",type:null},{name:"tables",typeName:"table_def[]",type:null},{name:"ricardian_clauses",typeName:"clause_pair[]",type:null},{name:"error_messages",typeName:"error_message[]",type:null},{name:"abi_extensions",typeName:"extensions_entry[]",type:null},{name:"variants",typeName:"variant_def[]$",type:null},{name:"action_results",typeName:"action_result[]$",type:null},{name:"kv_tables",typeName:"kv_table$",type:null}],serialize:p,deserialize:f})),e},t.createTransactionExtensionTypes=function(){var e=t.createInitialTypes();return e.set("resource_payer",C({name:"resource_payer",baseName:"",fields:[{name:"payer",typeName:"name",type:null},{name:"max_net_bytes",typeName:"uint64",type:null},{name:"max_cpu_us",typeName:"uint64",type:null},{name:"max_memory_bytes",typeName:"uint64",type:null}],serialize:p,deserialize:f})),e},t.createTransactionTypes=function(){var e=t.createInitialTypes();return e.set("permission_level",C({name:"permission_level",baseName:"",fields:[{name:"actor",typeName:"name",type:null},{name:"permission",typeName:"name",type:null}],serialize:p,deserialize:f})),e.set("action",C({name:"action",baseName:"",fields:[{name:"account",typeName:"name",type:null},{name:"name",typeName:"name",type:null},{name:"authorization",typeName:"permission_level[]",type:null},{name:"data",typeName:"bytes",type:null}],serialize:p,deserialize:f})),e.set("extension",C({name:"extension",baseName:"",fields:[{name:"type",typeName:"uint16",type:null},{name:"data",typeName:"bytes",type:null}],serialize:I,deserialize:S})),e.set("transaction_header",C({name:"transaction_header",baseName:"",fields:[{name:"expiration",typeName:"time_point_sec",type:null},{name:"ref_block_num",typeName:"uint16",type:null},{name:"ref_block_prefix",typeName:"uint32",type:null},{name:"max_net_usage_words",typeName:"varuint32",type:null},{name:"max_cpu_usage_ms",typeName:"uint8",type:null},{name:"delay_sec",typeName:"varuint32",type:null}],serialize:p,deserialize:f})),e.set("transaction",C({name:"transaction",baseName:"transaction_header",fields:[{name:"context_free_actions",typeName:"action[]",type:null},{name:"actions",typeName:"action[]",type:null},{name:"transaction_extensions",typeName:"extension",type:null}],serialize:p,deserialize:f})),e},t.getType=function(e,n){var i=e.get(n);if(i&&i.aliasOfName)return t.getType(e,i.aliasOfName);if(i)return i;if(n.endsWith("[]"))return C({name:n,arrayOf:t.getType(e,n.substr(0,n.length-2)),serialize:m,deserialize:y});if(n.endsWith("?"))return C({name:n,optionalOf:t.getType(e,n.substr(0,n.length-1)),serialize:v,deserialize:w});if(n.endsWith("$"))return C({name:n,extensionOf:t.getType(e,n.substr(0,n.length-1)),serialize:b,deserialize:k});throw new Error("Unknown type: "+n)},t.getTypesFromAbi=function(e,n){var i,s,a,c,l,u,h,d,m,y,v=new Map(e);if(n&&n.types)try{for(var w=o(n.types),b=w.next();!b.done;b=w.next()){var k=b.value,T=k.new_type_name,E=k.type;v.set(T,C({name:T,aliasOfName:E}))}}catch(e){i={error:e}}finally{try{b&&!b.done&&(s=w.return)&&s.call(w)}finally{if(i)throw i.error}}if(n&&n.structs)try{for(var I=o(n.structs),S=I.next();!S.done;S=I.next()){var x=S.value,A=x.name,N=x.base,P=x.fields;v.set(A,C({name:A,baseName:N,fields:P.map((function(e){return{name:e.name,typeName:e.type,type:null}})),serialize:p,deserialize:f}))}}catch(e){a={error:e}}finally{try{S&&!S.done&&(c=I.return)&&c.call(I)}finally{if(a)throw a.error}}if(n&&n.variants)try{for(var O=o(n.variants),R=O.next();!R.done;R=O.next()){var D=R.value,z=D.name,M=D.types;v.set(z,C({name:z,fields:M.map((function(e){return{name:e,typeName:e,type:null}})),serialize:_,deserialize:g}))}}catch(e){l={error:e}}finally{try{R&&!R.done&&(u=O.return)&&u.call(O)}finally{if(l)throw l.error}}try{for(var L=o(v),U=L.next();!U.done;U=L.next()){var F=r(U.value,2);F[0],(E=F[1]).baseName&&(E.base=t.getType(v,E.baseName));try{for(var j=(m=void 0,o(E.fields)),q=j.next();!q.done;q=j.next()){var B=q.value;B.type=t.getType(v,B.typeName)}}catch(e){m={error:e}}finally{try{q&&!q.done&&(y=j.return)&&y.call(j)}finally{if(m)throw m.error}}}}catch(e){h={error:e}}finally{try{U&&!U.done&&(d=L.return)&&d.call(L)}finally{if(h)throw h.error}}return v},t.transactionHeader=function(e,n){var i,r=e.header?e.header.timestamp:e.timestamp,s=parseInt((i=e.id.substr(16,8)).substr(6,2)+i.substr(4,2)+i.substr(2,2)+i.substr(0,2),16);return{expiration:t.timePointSecToDate(t.dateToTimePointSec(r)+n),ref_block_num:65535&e.block_num,ref_block_prefix:s}},t.serializeActionData=function(e,n,i,r,s,o){var a=e.actions.get(i);if(!a)throw new Error("Unknown action "+i+" in contract "+n);var c=new l({textEncoder:s,textDecoder:o});return a.serialize(c,r),t.arrayToHex(c.asUint8Array())},t.serializeAction=function(e,n,i,r,s,o,a){return{account:n,name:i,authorization:r,data:t.serializeActionData(e,n,i,s,o,a)}},t.deserializeActionData=function(e,n,i,r,s,o){var a=e.actions.get(i);if("string"==typeof r&&(r=t.hexToUint8Array(r)),!a)throw new Error("Unknown action "+i+" in contract "+n);var c=new l({textDecoder:o,textEncoder:s});return c.pushArray(r),a.deserialize(c)},t.deserializeAction=function(e,n,i,r,s,o,a){return{account:n,name:i,authorization:r,data:t.deserializeActionData(e,n,i,s,o,a)}},t.serializeAnyvar=function(e,t){var n,i,s,o,a,c,l,u,h;null===t?(u=(n=r([P.null_t,t],2))[0],h=n[1]):"string"==typeof t?(u=(i=r([P.string,t],2))[0],h=i[1]):"number"==typeof t?(u=(s=r([P.int32,t],2))[0],h=s[1]):t instanceof Uint8Array?(u=(o=r([P.bytes,t],2))[0],h=o[1]):Array.isArray(t)?(u=(a=r([P.any_array,t],2))[0],h=a[1]):2===Object.keys(t).length&&t.hasOwnProperty("type")&&t.hasOwnProperty("value")?(u=(c=r([P[t.type],t.value],2))[0],h=c[1]):(u=(l=r([P.any_object,t],2))[0],h=l[1]),e.pushVaruint32(u.index),u.type.serialize(e,h)},t.deserializeAnyvar=function(e,t){var n=e.getVaruint32();if(n>=O.length)throw new Error("Tried to deserialize unknown anyvar type");var i=O[n],r=i.type.deserialize(e,t);return t&&t.options.useShortForm||i.useShortForm?r:{type:i.type.name,value:r}},t.deserializeAnyvarShort=function(e){return t.deserializeAnyvar(e,new c({useShortForm:!0}))},t.serializeAnyObject=function(e,n){var i,s,a=Object.entries(n);e.pushVaruint32(a.length);try{for(var c=o(a),l=c.next();!l.done;l=c.next()){var u=r(l.value,2),h=u[0],d=u[1];e.pushString(h),t.serializeAnyvar(e,d)}}catch(e){i={error:e}}finally{try{l&&!l.done&&(s=c.return)&&s.call(c)}finally{if(i)throw i.error}}},t.deserializeAnyObject=function(e,n){for(var i=e.getVaruint32(),r={},s=0;s<i;++s){var o=e.getString();if(o in r){for(var a=1;o+"_"+a in r;)++a;o=o+"_"+a}r[o]=t.deserializeAnyvar(e,n)}return r},t.serializeAnyArray=function(e,n){var i,r;e.pushVaruint32(n.length);try{for(var s=o(n),a=s.next();!a.done;a=s.next()){var c=a.value;t.serializeAnyvar(e,c)}}catch(e){i={error:e}}finally{try{a&&!a.done&&(r=s.return)&&r.call(s)}finally{if(i)throw i.error}}},t.deserializeAnyArray=function(e,n){for(var i=e.getVaruint32(),r=[],s=0;s<i;++s)r.push(t.deserializeAnyvar(e,n));return r};var A,N=((A=t.createInitialTypes()).set("null_t",C({name:"null_t",serialize:function(e,t){},deserialize:function(e,t){}})),A.set("any_object",C({name:"any_object",serialize:t.serializeAnyObject,deserialize:t.deserializeAnyObject})),A.set("any_array",C({name:"any_array",serialize:t.serializeAnyArray,deserialize:t.deserializeAnyArray})),A),P={null_t:{index:0,useShortForm:!0,type:N.get("null_t")},int64:{index:1,useShortForm:!1,type:N.get("int64")},uint64:{index:2,useShortForm:!1,type:N.get("uint64")},int32:{index:3,useShortForm:!0,type:N.get("int32")},uint32:{index:4,useShortForm:!1,type:N.get("uint32")},int16:{index:5,useShortForm:!1,type:N.get("int16")},uint16:{index:6,useShortForm:!1,type:N.get("uint16")},int8:{index:7,useShortForm:!1,type:N.get("int8")},uint8:{index:8,useShortForm:!1,type:N.get("uint8")},time_point:{index:9,useShortForm:!1,type:N.get("time_point")},checksum256:{index:10,useShortForm:!1,type:N.get("checksum256")},float64:{index:11,useShortForm:!1,type:N.get("float64")},string:{index:12,useShortForm:!0,type:N.get("string")},any_object:{index:13,useShortForm:!0,type:N.get("any_object")},any_array:{index:14,useShortForm:!0,type:N.get("any_array")},bytes:{index:15,useShortForm:!1,type:N.get("bytes")},symbol:{index:16,useShortForm:!1,type:N.get("symbol")},symbol_code:{index:17,useShortForm:!1,type:N.get("symbol_code")},asset:{index:18,useShortForm:!1,type:N.get("asset")}},O=[P.null_t,P.int64,P.uint64,P.int32,P.uint32,P.int16,P.uint16,P.int8,P.uint8,P.time_point,P.checksum256,P.float64,P.string,P.any_object,P.any_array,P.bytes,P.symbol,P.symbol_code,P.asset];t.serializeQuery=function(e,n){var i,s,a,c,l,u,h,d;if("string"==typeof n?u=n:Array.isArray(n)&&2===n.length?(u=(i=r(n,2))[0],d=i[1]):Array.isArray(n)&&3===n.length?(u=(s=r(n,3))[0],h=s[1],d=s[2]):(u=(a=r([n.method,n.arg,n.filter],3))[0],h=a[1],d=a[2]),e.pushString(u),void 0===h?e.push(0):(e.push(1),t.serializeAnyvar(e,h)),void 0===d)e.push(0);else{e.pushVaruint32(d.length);try{for(var p=o(d),f=p.next();!f.done;f=p.next()){var _=f.value;t.serializeQuery(e,_)}}catch(e){c={error:e}}finally{try{f&&!f.done&&(l=p.return)&&l.call(p)}finally{if(c)throw c.error}}}}},7678:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Serialize=t.RpcError=t.RpcInterfaces=t.Numeric=t.JsonRpc=t.ApiInterfaces=t.Api=void 0;var i=n(3915);Object.defineProperty(t,"Api",{enumerable:!0,get:function(){return i.Api}});var r=n(5461);t.ApiInterfaces=r;var s=n(6208);Object.defineProperty(t,"JsonRpc",{enumerable:!0,get:function(){return s.JsonRpc}});var o=n(1823);t.Numeric=o;var a=n(5576);t.RpcInterfaces=a;var c=n(3937);Object.defineProperty(t,"RpcError",{enumerable:!0,get:function(){return c.RpcError}});var l=n(2753);t.Serialize=l},1963:e=>{"use strict";var t=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),n=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return t(e,null,[{key:"get_n_pad_bytes",value:function(e){return 64-(e+8&63)}},{key:"pad",value:function(t){var n,i,r=t.byteLength,s=e.get_n_pad_bytes(r),o=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],i=!0,r=!1,s=void 0;try{for(var o,a=e[Symbol.iterator]();!(i=(o=a.next()).done)&&(n.push(o.value),!t||n.length!==t);i=!0);}catch(e){r=!0,s=e}finally{try{!i&&a.return&&a.return()}finally{if(r)throw s}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}((n=r,i=536870912,[Math.floor(n/i),n%i]).map((function(e,t){return t?8*e:e})),2),a=o[0],c=o[1],l=new Uint8Array(r+s+8);l.set(new Uint8Array(t),0);var u=new DataView(l.buffer);return u.setUint8(r,128),u.setUint32(r+s,c,!0),u.setUint32(r+s+4,a,!0),l.buffer}},{key:"f",value:function(e,t,n,i){return 0<=e&&e<=15?t^n^i:16<=e&&e<=31?t&n|~t&i:32<=e&&e<=47?(t|~n)^i:48<=e&&e<=63?t&i|n&~i:64<=e&&e<=79?t^(n|~i):void 0}},{key:"K",value:function(e){return 0<=e&&e<=15?0:16<=e&&e<=31?1518500249:32<=e&&e<=47?1859775393:48<=e&&e<=63?2400959708:64<=e&&e<=79?2840853838:void 0}},{key:"KP",value:function(e){return 0<=e&&e<=15?1352829926:16<=e&&e<=31?1548603684:32<=e&&e<=47?1836072691:48<=e&&e<=63?2053994217:64<=e&&e<=79?0:void 0}},{key:"add_modulo32",value:function(){return 0|Array.from(arguments).reduce((function(e,t){return e+t}),0)}},{key:"rol32",value:function(e,t){return e<<t|e>>>32-t}},{key:"hash",value:function(t){for(var n=e.pad(t),i=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13],r=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11],s=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6],o=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11],a=n.byteLength/64,c=new Array(a).fill(void 0).map((function(e,t){return function(e){return new DataView(n,64*t,64).getUint32(4*e,!0)}})),l=[1732584193,4023233417,2562383102,271733878,3285377520],u=0;u<a;++u){for(var h=l[0],d=l[1],p=l[2],f=l[3],_=l[4],g=h,m=d,y=p,v=f,w=_,b=0;b<80;++b){var k=e.add_modulo32(e.rol32(e.add_modulo32(h,e.f(b,d,p,f),c[u](i[b]),e.K(b)),s[b]),_);h=_,_=f,f=e.rol32(p,10),p=d,d=k,k=e.add_modulo32(e.rol32(e.add_modulo32(g,e.f(79-b,m,y,v),c[u](r[b]),e.KP(b)),o[b]),w),g=w,w=v,v=e.rol32(y,10),y=m,m=k}var T=e.add_modulo32(l[1],p,v);l[1]=e.add_modulo32(l[2],f,w),l[2]=e.add_modulo32(l[3],_,g),l[3]=e.add_modulo32(l[4],h,m),l[4]=e.add_modulo32(l[0],d,y),l[0]=T}var E=new ArrayBuffer(20),I=new DataView(E);return l.forEach((function(e,t){return I.setUint32(4*t,e,!0)})),E}}]),e}();e.exports={RIPEMD160:n}},6204:(e,t,n)=>{var i=t;i.utils=n(6414),i.common=n(2238),i.sha=n(4538),i.ripemd=n(2185),i.hmac=n(6316),i.sha1=i.sha.sha1,i.sha256=i.sha.sha256,i.sha224=i.sha.sha224,i.sha384=i.sha.sha384,i.sha512=i.sha.sha512,i.ripemd160=i.ripemd.ripemd160},2238:(e,t,n)=>{"use strict";var i=n(6414),r=n(6794);function s(){this.pending=null,this.pendingTotal=0,this.blockSize=this.constructor.blockSize,this.outSize=this.constructor.outSize,this.hmacStrength=this.constructor.hmacStrength,this.padLength=this.constructor.padLength/8,this.endian="big",this._delta8=this.blockSize/8,this._delta32=this.blockSize/32}t.BlockHash=s,s.prototype.update=function(e,t){if(e=i.toArray(e,t),this.pending?this.pending=this.pending.concat(e):this.pending=e,this.pendingTotal+=e.length,this.pending.length>=this._delta8){var n=(e=this.pending).length%this._delta8;this.pending=e.slice(e.length-n,e.length),0===this.pending.length&&(this.pending=null),e=i.join32(e,0,e.length-n,this.endian);for(var r=0;r<e.length;r+=this._delta32)this._update(e,r,r+this._delta32)}return this},s.prototype.digest=function(e){return this.update(this._pad()),r(null===this.pending),this._digest(e)},s.prototype._pad=function(){var e=this.pendingTotal,t=this._delta8,n=t-(e+this.padLength)%t,i=new Array(n+this.padLength);i[0]=128;for(var r=1;r<n;r++)i[r]=0;if(e<<=3,"big"===this.endian){for(var s=8;s<this.padLength;s++)i[r++]=0;i[r++]=0,i[r++]=0,i[r++]=0,i[r++]=0,i[r++]=e>>>24&255,i[r++]=e>>>16&255,i[r++]=e>>>8&255,i[r++]=255&e}else for(i[r++]=255&e,i[r++]=e>>>8&255,i[r++]=e>>>16&255,i[r++]=e>>>24&255,i[r++]=0,i[r++]=0,i[r++]=0,i[r++]=0,s=8;s<this.padLength;s++)i[r++]=0;return i}},6316:(e,t,n)=>{"use strict";var i=n(6414),r=n(6794);function s(e,t,n){if(!(this instanceof s))return new s(e,t,n);this.Hash=e,this.blockSize=e.blockSize/8,this.outSize=e.outSize/8,this.inner=null,this.outer=null,this._init(i.toArray(t,n))}e.exports=s,s.prototype._init=function(e){e.length>this.blockSize&&(e=(new this.Hash).update(e).digest()),r(e.length<=this.blockSize);for(var t=e.length;t<this.blockSize;t++)e.push(0);for(t=0;t<e.length;t++)e[t]^=54;for(this.inner=(new this.Hash).update(e),t=0;t<e.length;t++)e[t]^=106;this.outer=(new this.Hash).update(e)},s.prototype.update=function(e,t){return this.inner.update(e,t),this},s.prototype.digest=function(e){return this.outer.update(this.inner.digest()),this.outer.digest(e)}},2185:(e,t,n)=>{"use strict";var i=n(6414),r=n(2238),s=i.rotl32,o=i.sum32,a=i.sum32_3,c=i.sum32_4,l=r.BlockHash;function u(){if(!(this instanceof u))return new u;l.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.endian="little"}function h(e,t,n,i){return e<=15?t^n^i:e<=31?t&n|~t&i:e<=47?(t|~n)^i:e<=63?t&i|n&~i:t^(n|~i)}function d(e){return e<=15?0:e<=31?1518500249:e<=47?1859775393:e<=63?2400959708:2840853838}function p(e){return e<=15?1352829926:e<=31?1548603684:e<=47?1836072691:e<=63?2053994217:0}i.inherits(u,l),t.ripemd160=u,u.blockSize=512,u.outSize=160,u.hmacStrength=192,u.padLength=64,u.prototype._update=function(e,t){for(var n=this.h[0],i=this.h[1],r=this.h[2],l=this.h[3],u=this.h[4],y=n,v=i,w=r,b=l,k=u,T=0;T<80;T++){var E=o(s(c(n,h(T,i,r,l),e[f[T]+t],d(T)),g[T]),u);n=u,u=l,l=s(r,10),r=i,i=E,E=o(s(c(y,h(79-T,v,w,b),e[_[T]+t],p(T)),m[T]),k),y=k,k=b,b=s(w,10),w=v,v=E}E=a(this.h[1],r,b),this.h[1]=a(this.h[2],l,k),this.h[2]=a(this.h[3],u,y),this.h[3]=a(this.h[4],n,v),this.h[4]=a(this.h[0],i,w),this.h[0]=E},u.prototype._digest=function(e){return"hex"===e?i.toHex32(this.h,"little"):i.split32(this.h,"little")};var f=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13],_=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11],g=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6],m=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]},4538:(e,t,n)=>{"use strict";t.sha1=n(6854),t.sha224=n(9104),t.sha256=n(7284),t.sha384=n(8909),t.sha512=n(1260)},6854:(e,t,n)=>{"use strict";var i=n(6414),r=n(2238),s=n(2181),o=i.rotl32,a=i.sum32,c=i.sum32_5,l=s.ft_1,u=r.BlockHash,h=[1518500249,1859775393,2400959708,3395469782];function d(){if(!(this instanceof d))return new d;u.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.W=new Array(80)}i.inherits(d,u),e.exports=d,d.blockSize=512,d.outSize=160,d.hmacStrength=80,d.padLength=64,d.prototype._update=function(e,t){for(var n=this.W,i=0;i<16;i++)n[i]=e[t+i];for(;i<n.length;i++)n[i]=o(n[i-3]^n[i-8]^n[i-14]^n[i-16],1);var r=this.h[0],s=this.h[1],u=this.h[2],d=this.h[3],p=this.h[4];for(i=0;i<n.length;i++){var f=~~(i/20),_=c(o(r,5),l(f,s,u,d),p,n[i],h[f]);p=d,d=u,u=o(s,30),s=r,r=_}this.h[0]=a(this.h[0],r),this.h[1]=a(this.h[1],s),this.h[2]=a(this.h[2],u),this.h[3]=a(this.h[3],d),this.h[4]=a(this.h[4],p)},d.prototype._digest=function(e){return"hex"===e?i.toHex32(this.h,"big"):i.split32(this.h,"big")}},9104:(e,t,n)=>{"use strict";var i=n(6414),r=n(7284);function s(){if(!(this instanceof s))return new s;r.call(this),this.h=[3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428]}i.inherits(s,r),e.exports=s,s.blockSize=512,s.outSize=224,s.hmacStrength=192,s.padLength=64,s.prototype._digest=function(e){return"hex"===e?i.toHex32(this.h.slice(0,7),"big"):i.split32(this.h.slice(0,7),"big")}},7284:(e,t,n)=>{"use strict";var i=n(6414),r=n(2238),s=n(2181),o=n(6794),a=i.sum32,c=i.sum32_4,l=i.sum32_5,u=s.ch32,h=s.maj32,d=s.s0_256,p=s.s1_256,f=s.g0_256,_=s.g1_256,g=r.BlockHash,m=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];function y(){if(!(this instanceof y))return new y;g.call(this),this.h=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],this.k=m,this.W=new Array(64)}i.inherits(y,g),e.exports=y,y.blockSize=512,y.outSize=256,y.hmacStrength=192,y.padLength=64,y.prototype._update=function(e,t){for(var n=this.W,i=0;i<16;i++)n[i]=e[t+i];for(;i<n.length;i++)n[i]=c(_(n[i-2]),n[i-7],f(n[i-15]),n[i-16]);var r=this.h[0],s=this.h[1],g=this.h[2],m=this.h[3],y=this.h[4],v=this.h[5],w=this.h[6],b=this.h[7];for(o(this.k.length===n.length),i=0;i<n.length;i++){var k=l(b,p(y),u(y,v,w),this.k[i],n[i]),T=a(d(r),h(r,s,g));b=w,w=v,v=y,y=a(m,k),m=g,g=s,s=r,r=a(k,T)}this.h[0]=a(this.h[0],r),this.h[1]=a(this.h[1],s),this.h[2]=a(this.h[2],g),this.h[3]=a(this.h[3],m),this.h[4]=a(this.h[4],y),this.h[5]=a(this.h[5],v),this.h[6]=a(this.h[6],w),this.h[7]=a(this.h[7],b)},y.prototype._digest=function(e){return"hex"===e?i.toHex32(this.h,"big"):i.split32(this.h,"big")}},8909:(e,t,n)=>{"use strict";var i=n(6414),r=n(1260);function s(){if(!(this instanceof s))return new s;r.call(this),this.h=[3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428]}i.inherits(s,r),e.exports=s,s.blockSize=1024,s.outSize=384,s.hmacStrength=192,s.padLength=128,s.prototype._digest=function(e){return"hex"===e?i.toHex32(this.h.slice(0,12),"big"):i.split32(this.h.slice(0,12),"big")}},1260:(e,t,n)=>{"use strict";var i=n(6414),r=n(2238),s=n(6794),o=i.rotr64_hi,a=i.rotr64_lo,c=i.shr64_hi,l=i.shr64_lo,u=i.sum64,h=i.sum64_hi,d=i.sum64_lo,p=i.sum64_4_hi,f=i.sum64_4_lo,_=i.sum64_5_hi,g=i.sum64_5_lo,m=r.BlockHash,y=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591];function v(){if(!(this instanceof v))return new v;m.call(this),this.h=[1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209],this.k=y,this.W=new Array(160)}function w(e,t,n,i,r){var s=e&n^~e&r;return s<0&&(s+=4294967296),s}function b(e,t,n,i,r,s){var o=t&i^~t&s;return o<0&&(o+=4294967296),o}function k(e,t,n,i,r){var s=e&n^e&r^n&r;return s<0&&(s+=4294967296),s}function T(e,t,n,i,r,s){var o=t&i^t&s^i&s;return o<0&&(o+=4294967296),o}function E(e,t){var n=o(e,t,28)^o(t,e,2)^o(t,e,7);return n<0&&(n+=4294967296),n}function I(e,t){var n=a(e,t,28)^a(t,e,2)^a(t,e,7);return n<0&&(n+=4294967296),n}function S(e,t){var n=a(e,t,14)^a(e,t,18)^a(t,e,9);return n<0&&(n+=4294967296),n}function C(e,t){var n=o(e,t,1)^o(e,t,8)^c(e,t,7);return n<0&&(n+=4294967296),n}function x(e,t){var n=a(e,t,1)^a(e,t,8)^l(e,t,7);return n<0&&(n+=4294967296),n}function A(e,t){var n=a(e,t,19)^a(t,e,29)^l(e,t,6);return n<0&&(n+=4294967296),n}i.inherits(v,m),e.exports=v,v.blockSize=1024,v.outSize=512,v.hmacStrength=192,v.padLength=128,v.prototype._prepareBlock=function(e,t){for(var n=this.W,i=0;i<32;i++)n[i]=e[t+i];for(;i<n.length;i+=2){var r=(g=n[i-4],m=n[i-3],y=void 0,(y=o(g,m,19)^o(m,g,29)^c(g,m,6))<0&&(y+=4294967296),y),s=A(n[i-4],n[i-3]),a=n[i-14],l=n[i-13],u=C(n[i-30],n[i-29]),h=x(n[i-30],n[i-29]),d=n[i-32],_=n[i-31];n[i]=p(r,s,a,l,u,h,d,_),n[i+1]=f(r,s,a,l,u,h,d,_)}var g,m,y},v.prototype._update=function(e,t){this._prepareBlock(e,t);var n,i,r,a=this.W,c=this.h[0],l=this.h[1],p=this.h[2],f=this.h[3],m=this.h[4],y=this.h[5],v=this.h[6],C=this.h[7],x=this.h[8],A=this.h[9],N=this.h[10],P=this.h[11],O=this.h[12],R=this.h[13],D=this.h[14],z=this.h[15];s(this.k.length===a.length);for(var M=0;M<a.length;M+=2){var L=D,U=z,F=(r=void 0,(r=o(n=x,i=A,14)^o(n,i,18)^o(i,n,9))<0&&(r+=4294967296),r),j=S(x,A),q=w(x,0,N,0,O),B=b(0,A,0,P,0,R),W=this.k[M],V=this.k[M+1],H=a[M],K=a[M+1],$=_(L,U,F,j,q,B,W,V,H,K),G=g(L,U,F,j,q,B,W,V,H,K);L=E(c,l),U=I(c,l),F=k(c,0,p,0,m),j=T(0,l,0,f,0,y);var J=h(L,U,F,j),Z=d(L,U,F,j);D=O,z=R,O=N,R=P,N=x,P=A,x=h(v,C,$,G),A=d(C,C,$,G),v=m,C=y,m=p,y=f,p=c,f=l,c=h($,G,J,Z),l=d($,G,J,Z)}u(this.h,0,c,l),u(this.h,2,p,f),u(this.h,4,m,y),u(this.h,6,v,C),u(this.h,8,x,A),u(this.h,10,N,P),u(this.h,12,O,R),u(this.h,14,D,z)},v.prototype._digest=function(e){return"hex"===e?i.toHex32(this.h,"big"):i.split32(this.h,"big")}},2181:(e,t,n)=>{"use strict";var i=n(6414).rotr32;function r(e,t,n){return e&t^~e&n}function s(e,t,n){return e&t^e&n^t&n}function o(e,t,n){return e^t^n}t.ft_1=function(e,t,n,i){return 0===e?r(t,n,i):1===e||3===e?o(t,n,i):2===e?s(t,n,i):void 0},t.ch32=r,t.maj32=s,t.p32=o,t.s0_256=function(e){return i(e,2)^i(e,13)^i(e,22)},t.s1_256=function(e){return i(e,6)^i(e,11)^i(e,25)},t.g0_256=function(e){return i(e,7)^i(e,18)^e>>>3},t.g1_256=function(e){return i(e,17)^i(e,19)^e>>>10}},6414:(e,t,n)=>{"use strict";var i=n(6794),r=n(5153);function s(e,t){return 55296==(64512&e.charCodeAt(t))&&!(t<0||t+1>=e.length)&&56320==(64512&e.charCodeAt(t+1))}function o(e){return(e>>>24|e>>>8&65280|e<<8&16711680|(255&e)<<24)>>>0}function a(e){return 1===e.length?"0"+e:e}function c(e){return 7===e.length?"0"+e:6===e.length?"00"+e:5===e.length?"000"+e:4===e.length?"0000"+e:3===e.length?"00000"+e:2===e.length?"000000"+e:1===e.length?"0000000"+e:e}t.inherits=r,t.toArray=function(e,t){if(Array.isArray(e))return e.slice();if(!e)return[];var n=[];if("string"==typeof e)if(t){if("hex"===t)for((e=e.replace(/[^a-z0-9]+/gi,"")).length%2!=0&&(e="0"+e),r=0;r<e.length;r+=2)n.push(parseInt(e[r]+e[r+1],16))}else for(var i=0,r=0;r<e.length;r++){var o=e.charCodeAt(r);o<128?n[i++]=o:o<2048?(n[i++]=o>>6|192,n[i++]=63&o|128):s(e,r)?(o=65536+((1023&o)<<10)+(1023&e.charCodeAt(++r)),n[i++]=o>>18|240,n[i++]=o>>12&63|128,n[i++]=o>>6&63|128,n[i++]=63&o|128):(n[i++]=o>>12|224,n[i++]=o>>6&63|128,n[i++]=63&o|128)}else for(r=0;r<e.length;r++)n[r]=0|e[r];return n},t.toHex=function(e){for(var t="",n=0;n<e.length;n++)t+=a(e[n].toString(16));return t},t.htonl=o,t.toHex32=function(e,t){for(var n="",i=0;i<e.length;i++){var r=e[i];"little"===t&&(r=o(r)),n+=c(r.toString(16))}return n},t.zero2=a,t.zero8=c,t.join32=function(e,t,n,r){var s=n-t;i(s%4==0);for(var o=new Array(s/4),a=0,c=t;a<o.length;a++,c+=4){var l;l="big"===r?e[c]<<24|e[c+1]<<16|e[c+2]<<8|e[c+3]:e[c+3]<<24|e[c+2]<<16|e[c+1]<<8|e[c],o[a]=l>>>0}return o},t.split32=function(e,t){for(var n=new Array(4*e.length),i=0,r=0;i<e.length;i++,r+=4){var s=e[i];"big"===t?(n[r]=s>>>24,n[r+1]=s>>>16&255,n[r+2]=s>>>8&255,n[r+3]=255&s):(n[r+3]=s>>>24,n[r+2]=s>>>16&255,n[r+1]=s>>>8&255,n[r]=255&s)}return n},t.rotr32=function(e,t){return e>>>t|e<<32-t},t.rotl32=function(e,t){return e<<t|e>>>32-t},t.sum32=function(e,t){return e+t>>>0},t.sum32_3=function(e,t,n){return e+t+n>>>0},t.sum32_4=function(e,t,n,i){return e+t+n+i>>>0},t.sum32_5=function(e,t,n,i,r){return e+t+n+i+r>>>0},t.sum64=function(e,t,n,i){var r=e[t],s=i+e[t+1]>>>0,o=(s<i?1:0)+n+r;e[t]=o>>>0,e[t+1]=s},t.sum64_hi=function(e,t,n,i){return(t+i>>>0<t?1:0)+e+n>>>0},t.sum64_lo=function(e,t,n,i){return t+i>>>0},t.sum64_4_hi=function(e,t,n,i,r,s,o,a){var c=0,l=t;return c+=(l=l+i>>>0)<t?1:0,c+=(l=l+s>>>0)<s?1:0,e+n+r+o+(c+=(l=l+a>>>0)<a?1:0)>>>0},t.sum64_4_lo=function(e,t,n,i,r,s,o,a){return t+i+s+a>>>0},t.sum64_5_hi=function(e,t,n,i,r,s,o,a,c,l){var u=0,h=t;return u+=(h=h+i>>>0)<t?1:0,u+=(h=h+s>>>0)<s?1:0,u+=(h=h+a>>>0)<a?1:0,e+n+r+o+c+(u+=(h=h+l>>>0)<l?1:0)>>>0},t.sum64_5_lo=function(e,t,n,i,r,s,o,a,c,l){return t+i+s+a+l>>>0},t.rotr64_hi=function(e,t,n){return(t<<32-n|e>>>n)>>>0},t.rotr64_lo=function(e,t,n){return(e<<32-n|t>>>n)>>>0},t.shr64_hi=function(e,t,n){return e>>>n},t.shr64_lo=function(e,t,n){return(e<<32-n|t>>>n)>>>0}},5153:e=>{"function"==typeof Object.create?e.exports=function(e,t){t&&(e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:e.exports=function(e,t){if(t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}}},6794:e=>{function t(e,t){if(!e)throw new Error(t||"Assertion failed")}e.exports=t,t.equal=function(e,t,n){if(e!=t)throw new Error(n||"Assertion failed: "+e+" != "+t)}},8442:(e,t,n)=>{"use strict";const{Deflate:i,deflate:r,deflateRaw:s,gzip:o}=n(8064),{Inflate:a,inflate:c,inflateRaw:l,ungzip:u}=n(6986),h=n(8681);e.exports.Deflate=i,e.exports.deflate=r,e.exports.deflateRaw=s,e.exports.gzip=o,e.exports.Inflate=a,e.exports.inflate=c,e.exports.inflateRaw=l,e.exports.ungzip=u,e.exports.constants=h},8064:(e,t,n)=>{"use strict";const i=n(9246),r=n(3251),s=n(7816),o=n(2587),a=n(4213),c=Object.prototype.toString,{Z_NO_FLUSH:l,Z_SYNC_FLUSH:u,Z_FULL_FLUSH:h,Z_FINISH:d,Z_OK:p,Z_STREAM_END:f,Z_DEFAULT_COMPRESSION:_,Z_DEFAULT_STRATEGY:g,Z_DEFLATED:m}=n(8681);function y(e){this.options=r.assign({level:_,method:m,chunkSize:16384,windowBits:15,memLevel:8,strategy:g},e||{});let t=this.options;t.raw&&t.windowBits>0?t.windowBits=-t.windowBits:t.gzip&&t.windowBits>0&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new a,this.strm.avail_out=0;let n=i.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(n!==p)throw new Error(o[n]);if(t.header&&i.deflateSetHeader(this.strm,t.header),t.dictionary){let e;if(e="string"==typeof t.dictionary?s.string2buf(t.dictionary):"[object ArrayBuffer]"===c.call(t.dictionary)?new Uint8Array(t.dictionary):t.dictionary,n=i.deflateSetDictionary(this.strm,e),n!==p)throw new Error(o[n]);this._dict_set=!0}}function v(e,t){const n=new y(t);if(n.push(e,!0),n.err)throw n.msg||o[n.err];return n.result}y.prototype.push=function(e,t){const n=this.strm,r=this.options.chunkSize;let o,a;if(this.ended)return!1;for(a=t===~~t?t:!0===t?d:l,"string"==typeof e?n.input=s.string2buf(e):"[object ArrayBuffer]"===c.call(e)?n.input=new Uint8Array(e):n.input=e,n.next_in=0,n.avail_in=n.input.length;;)if(0===n.avail_out&&(n.output=new Uint8Array(r),n.next_out=0,n.avail_out=r),(a===u||a===h)&&n.avail_out<=6)this.onData(n.output.subarray(0,n.next_out)),n.avail_out=0;else{if(o=i.deflate(n,a),o===f)return n.next_out>0&&this.onData(n.output.subarray(0,n.next_out)),o=i.deflateEnd(this.strm),this.onEnd(o),this.ended=!0,o===p;if(0!==n.avail_out){if(a>0&&n.next_out>0)this.onData(n.output.subarray(0,n.next_out)),n.avail_out=0;else if(0===n.avail_in)break}else this.onData(n.output)}return!0},y.prototype.onData=function(e){this.chunks.push(e)},y.prototype.onEnd=function(e){e===p&&(this.result=r.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},e.exports.Deflate=y,e.exports.deflate=v,e.exports.deflateRaw=function(e,t){return(t=t||{}).raw=!0,v(e,t)},e.exports.gzip=function(e,t){return(t=t||{}).gzip=!0,v(e,t)},e.exports.constants=n(8681)},6986:(e,t,n)=>{"use strict";const i=n(7387),r=n(3251),s=n(7816),o=n(2587),a=n(4213),c=n(2442),l=Object.prototype.toString,{Z_NO_FLUSH:u,Z_FINISH:h,Z_OK:d,Z_STREAM_END:p,Z_NEED_DICT:f,Z_STREAM_ERROR:_,Z_DATA_ERROR:g,Z_MEM_ERROR:m}=n(8681);function y(e){this.options=r.assign({chunkSize:65536,windowBits:15,to:""},e||{});const t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits&&(t.windowBits=-15)),!(t.windowBits>=0&&t.windowBits<16)||e&&e.windowBits||(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&0==(15&t.windowBits)&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new a,this.strm.avail_out=0;let n=i.inflateInit2(this.strm,t.windowBits);if(n!==d)throw new Error(o[n]);if(this.header=new c,i.inflateGetHeader(this.strm,this.header),t.dictionary&&("string"==typeof t.dictionary?t.dictionary=s.string2buf(t.dictionary):"[object ArrayBuffer]"===l.call(t.dictionary)&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(n=i.inflateSetDictionary(this.strm,t.dictionary),n!==d)))throw new Error(o[n])}function v(e,t){const n=new y(t);if(n.push(e),n.err)throw n.msg||o[n.err];return n.result}y.prototype.push=function(e,t){const n=this.strm,r=this.options.chunkSize,o=this.options.dictionary;let a,c,y;if(this.ended)return!1;for(c=t===~~t?t:!0===t?h:u,"[object ArrayBuffer]"===l.call(e)?n.input=new Uint8Array(e):n.input=e,n.next_in=0,n.avail_in=n.input.length;;){for(0===n.avail_out&&(n.output=new Uint8Array(r),n.next_out=0,n.avail_out=r),a=i.inflate(n,c),a===f&&o&&(a=i.inflateSetDictionary(n,o),a===d?a=i.inflate(n,c):a===g&&(a=f));n.avail_in>0&&a===p&&n.state.wrap>0&&0!==e[n.next_in];)i.inflateReset(n),a=i.inflate(n,c);switch(a){case _:case g:case f:case m:return this.onEnd(a),this.ended=!0,!1}if(y=n.avail_out,n.next_out&&(0===n.avail_out||a===p))if("string"===this.options.to){let e=s.utf8border(n.output,n.next_out),t=n.next_out-e,i=s.buf2string(n.output,e);n.next_out=t,n.avail_out=r-t,t&&n.output.set(n.output.subarray(e,e+t),0),this.onData(i)}else this.onData(n.output.length===n.next_out?n.output:n.output.subarray(0,n.next_out));if(a!==d||0!==y){if(a===p)return a=i.inflateEnd(this.strm),this.onEnd(a),this.ended=!0,!0;if(0===n.avail_in)break}}return!0},y.prototype.onData=function(e){this.chunks.push(e)},y.prototype.onEnd=function(e){e===d&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=r.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},e.exports.Inflate=y,e.exports.inflate=v,e.exports.inflateRaw=function(e,t){return(t=t||{}).raw=!0,v(e,t)},e.exports.ungzip=v,e.exports.constants=n(8681)},3251:e=>{"use strict";const t=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);e.exports.assign=function(e){const n=Array.prototype.slice.call(arguments,1);for(;n.length;){const i=n.shift();if(i){if("object"!=typeof i)throw new TypeError(i+"must be non-object");for(const n in i)t(i,n)&&(e[n]=i[n])}}return e},e.exports.flattenChunks=e=>{let t=0;for(let n=0,i=e.length;n<i;n++)t+=e[n].length;const n=new Uint8Array(t);for(let t=0,i=0,r=e.length;t<r;t++){let r=e[t];n.set(r,i),i+=r.length}return n}},7816:e=>{"use strict";let t=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(e){t=!1}const n=new Uint8Array(256);for(let e=0;e<256;e++)n[e]=e>=252?6:e>=248?5:e>=240?4:e>=224?3:e>=192?2:1;n[254]=n[254]=1,e.exports.string2buf=e=>{let t,n,i,r,s,o=e.length,a=0;for(r=0;r<o;r++)n=e.charCodeAt(r),55296==(64512&n)&&r+1<o&&(i=e.charCodeAt(r+1),56320==(64512&i)&&(n=65536+(n-55296<<10)+(i-56320),r++)),a+=n<128?1:n<2048?2:n<65536?3:4;for(t=new Uint8Array(a),s=0,r=0;s<a;r++)n=e.charCodeAt(r),55296==(64512&n)&&r+1<o&&(i=e.charCodeAt(r+1),56320==(64512&i)&&(n=65536+(n-55296<<10)+(i-56320),r++)),n<128?t[s++]=n:n<2048?(t[s++]=192|n>>>6,t[s++]=128|63&n):n<65536?(t[s++]=224|n>>>12,t[s++]=128|n>>>6&63,t[s++]=128|63&n):(t[s++]=240|n>>>18,t[s++]=128|n>>>12&63,t[s++]=128|n>>>6&63,t[s++]=128|63&n);return t},e.exports.buf2string=(e,i)=>{let r,s;const o=i||e.length,a=new Array(2*o);for(s=0,r=0;r<o;){let t=e[r++];if(t<128){a[s++]=t;continue}let i=n[t];if(i>4)a[s++]=65533,r+=i-1;else{for(t&=2===i?31:3===i?15:7;i>1&&r<o;)t=t<<6|63&e[r++],i--;i>1?a[s++]=65533:t<65536?a[s++]=t:(t-=65536,a[s++]=55296|t>>10&1023,a[s++]=56320|1023&t)}}return((e,n)=>{if(n<65534&&e.subarray&&t)return String.fromCharCode.apply(null,e.length===n?e:e.subarray(0,n));let i="";for(let t=0;t<n;t++)i+=String.fromCharCode(e[t]);return i})(a,s)},e.exports.utf8border=(e,t)=>{(t=t||e.length)>e.length&&(t=e.length);let i=t-1;for(;i>=0&&128==(192&e[i]);)i--;return i<0||0===i?t:i+n[e[i]]>t?i:t}},5775:e=>{"use strict";e.exports=(e,t,n,i)=>{let r=65535&e|0,s=e>>>16&65535|0,o=0;for(;0!==n;){o=n>2e3?2e3:n,n-=o;do{r=r+t[i++]|0,s=s+r|0}while(--o);r%=65521,s%=65521}return r|s<<16|0}},8681:e=>{"use strict";e.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},2576:e=>{"use strict";const t=new Uint32Array((()=>{let e,t=[];for(var n=0;n<256;n++){e=n;for(var i=0;i<8;i++)e=1&e?3988292384^e>>>1:e>>>1;t[n]=e}return t})());e.exports=(e,n,i,r)=>{const s=t,o=r+i;e^=-1;for(let t=r;t<o;t++)e=e>>>8^s[255&(e^n[t])];return-1^e}},9246:(e,t,n)=>{"use strict";const{_tr_init:i,_tr_stored_block:r,_tr_flush_block:s,_tr_tally:o,_tr_align:a}=n(1443),c=n(5775),l=n(2576),u=n(2587),{Z_NO_FLUSH:h,Z_PARTIAL_FLUSH:d,Z_FULL_FLUSH:p,Z_FINISH:f,Z_BLOCK:_,Z_OK:g,Z_STREAM_END:m,Z_STREAM_ERROR:y,Z_DATA_ERROR:v,Z_BUF_ERROR:w,Z_DEFAULT_COMPRESSION:b,Z_FILTERED:k,Z_HUFFMAN_ONLY:T,Z_RLE:E,Z_FIXED:I,Z_DEFAULT_STRATEGY:S,Z_UNKNOWN:C,Z_DEFLATED:x}=n(8681),A=258,N=262,P=103,O=113,R=666,D=(e,t)=>(e.msg=u[t],t),z=e=>(e<<1)-(e>4?9:0),M=e=>{let t=e.length;for(;--t>=0;)e[t]=0};let L=(e,t,n)=>(t<<e.hash_shift^n)&e.hash_mask;const U=e=>{const t=e.state;let n=t.pending;n>e.avail_out&&(n=e.avail_out),0!==n&&(e.output.set(t.pending_buf.subarray(t.pending_out,t.pending_out+n),e.next_out),e.next_out+=n,t.pending_out+=n,e.total_out+=n,e.avail_out-=n,t.pending-=n,0===t.pending&&(t.pending_out=0))},F=(e,t)=>{s(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,U(e.strm)},j=(e,t)=>{e.pending_buf[e.pending++]=t},q=(e,t)=>{e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=255&t},B=(e,t,n,i)=>{let r=e.avail_in;return r>i&&(r=i),0===r?0:(e.avail_in-=r,t.set(e.input.subarray(e.next_in,e.next_in+r),n),1===e.state.wrap?e.adler=c(e.adler,t,r,n):2===e.state.wrap&&(e.adler=l(e.adler,t,r,n)),e.next_in+=r,e.total_in+=r,r)},W=(e,t)=>{let n,i,r=e.max_chain_length,s=e.strstart,o=e.prev_length,a=e.nice_match;const c=e.strstart>e.w_size-N?e.strstart-(e.w_size-N):0,l=e.window,u=e.w_mask,h=e.prev,d=e.strstart+A;let p=l[s+o-1],f=l[s+o];e.prev_length>=e.good_match&&(r>>=2),a>e.lookahead&&(a=e.lookahead);do{if(n=t,l[n+o]===f&&l[n+o-1]===p&&l[n]===l[s]&&l[++n]===l[s+1]){s+=2,n++;do{}while(l[++s]===l[++n]&&l[++s]===l[++n]&&l[++s]===l[++n]&&l[++s]===l[++n]&&l[++s]===l[++n]&&l[++s]===l[++n]&&l[++s]===l[++n]&&l[++s]===l[++n]&&s<d);if(i=A-(d-s),s=d-A,i>o){if(e.match_start=t,o=i,i>=a)break;p=l[s+o-1],f=l[s+o]}}}while((t=h[t&u])>c&&0!=--r);return o<=e.lookahead?o:e.lookahead},V=e=>{const t=e.w_size;let n,i,r,s,o;do{if(s=e.window_size-e.lookahead-e.strstart,e.strstart>=t+(t-N)){e.window.set(e.window.subarray(t,t+t),0),e.match_start-=t,e.strstart-=t,e.block_start-=t,i=e.hash_size,n=i;do{r=e.head[--n],e.head[n]=r>=t?r-t:0}while(--i);i=t,n=i;do{r=e.prev[--n],e.prev[n]=r>=t?r-t:0}while(--i);s+=t}if(0===e.strm.avail_in)break;if(i=B(e.strm,e.window,e.strstart+e.lookahead,s),e.lookahead+=i,e.lookahead+e.insert>=3)for(o=e.strstart-e.insert,e.ins_h=e.window[o],e.ins_h=L(e,e.ins_h,e.window[o+1]);e.insert&&(e.ins_h=L(e,e.ins_h,e.window[o+3-1]),e.prev[o&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=o,o++,e.insert--,!(e.lookahead+e.insert<3)););}while(e.lookahead<N&&0!==e.strm.avail_in)},H=(e,t)=>{let n,i;for(;;){if(e.lookahead<N){if(V(e),e.lookahead<N&&t===h)return 1;if(0===e.lookahead)break}if(n=0,e.lookahead>=3&&(e.ins_h=L(e,e.ins_h,e.window[e.strstart+3-1]),n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!==n&&e.strstart-n<=e.w_size-N&&(e.match_length=W(e,n)),e.match_length>=3)if(i=o(e,e.strstart-e.match_start,e.match_length-3),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=3){e.match_length--;do{e.strstart++,e.ins_h=L(e,e.ins_h,e.window[e.strstart+3-1]),n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart}while(0!=--e.match_length);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=L(e,e.ins_h,e.window[e.strstart+1]);else i=o(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(i&&(F(e,!1),0===e.strm.avail_out))return 1}return e.insert=e.strstart<2?e.strstart:2,t===f?(F(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(F(e,!1),0===e.strm.avail_out)?1:2},K=(e,t)=>{let n,i,r;for(;;){if(e.lookahead<N){if(V(e),e.lookahead<N&&t===h)return 1;if(0===e.lookahead)break}if(n=0,e.lookahead>=3&&(e.ins_h=L(e,e.ins_h,e.window[e.strstart+3-1]),n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=2,0!==n&&e.prev_length<e.max_lazy_match&&e.strstart-n<=e.w_size-N&&(e.match_length=W(e,n),e.match_length<=5&&(e.strategy===k||3===e.match_length&&e.strstart-e.match_start>4096)&&(e.match_length=2)),e.prev_length>=3&&e.match_length<=e.prev_length){r=e.strstart+e.lookahead-3,i=o(e,e.strstart-1-e.prev_match,e.prev_length-3),e.lookahead-=e.prev_length-1,e.prev_length-=2;do{++e.strstart<=r&&(e.ins_h=L(e,e.ins_h,e.window[e.strstart+3-1]),n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart)}while(0!=--e.prev_length);if(e.match_available=0,e.match_length=2,e.strstart++,i&&(F(e,!1),0===e.strm.avail_out))return 1}else if(e.match_available){if(i=o(e,0,e.window[e.strstart-1]),i&&F(e,!1),e.strstart++,e.lookahead--,0===e.strm.avail_out)return 1}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(i=o(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<2?e.strstart:2,t===f?(F(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(F(e,!1),0===e.strm.avail_out)?1:2};function $(e,t,n,i,r){this.good_length=e,this.max_lazy=t,this.nice_length=n,this.max_chain=i,this.func=r}const G=[new $(0,0,0,0,((e,t)=>{let n=65535;for(n>e.pending_buf_size-5&&(n=e.pending_buf_size-5);;){if(e.lookahead<=1){if(V(e),0===e.lookahead&&t===h)return 1;if(0===e.lookahead)break}e.strstart+=e.lookahead,e.lookahead=0;const i=e.block_start+n;if((0===e.strstart||e.strstart>=i)&&(e.lookahead=e.strstart-i,e.strstart=i,F(e,!1),0===e.strm.avail_out))return 1;if(e.strstart-e.block_start>=e.w_size-N&&(F(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,t===f?(F(e,!0),0===e.strm.avail_out?3:4):(e.strstart>e.block_start&&(F(e,!1),e.strm.avail_out),1)})),new $(4,4,8,4,H),new $(4,5,16,8,H),new $(4,6,32,32,H),new $(4,4,16,16,K),new $(8,16,32,32,K),new $(8,16,128,128,K),new $(8,32,128,256,K),new $(32,128,258,1024,K),new $(32,258,258,4096,K)];function J(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=x,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(1146),this.dyn_dtree=new Uint16Array(122),this.bl_tree=new Uint16Array(78),M(this.dyn_ltree),M(this.dyn_dtree),M(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(16),this.heap=new Uint16Array(573),M(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(573),M(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const Z=e=>{if(!e||!e.state)return D(e,y);e.total_in=e.total_out=0,e.data_type=C;const t=e.state;return t.pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=t.wrap?42:O,e.adler=2===t.wrap?0:1,t.last_flush=h,i(t),g},Y=e=>{const t=Z(e);var n;return t===g&&((n=e.state).window_size=2*n.w_size,M(n.head),n.max_lazy_match=G[n.level].max_lazy,n.good_match=G[n.level].good_length,n.nice_match=G[n.level].nice_length,n.max_chain_length=G[n.level].max_chain,n.strstart=0,n.block_start=0,n.lookahead=0,n.insert=0,n.match_length=n.prev_length=2,n.match_available=0,n.ins_h=0),t},Q=(e,t,n,i,r,s)=>{if(!e)return y;let o=1;if(t===b&&(t=6),i<0?(o=0,i=-i):i>15&&(o=2,i-=16),r<1||r>9||n!==x||i<8||i>15||t<0||t>9||s<0||s>I)return D(e,y);8===i&&(i=9);const a=new J;return e.state=a,a.strm=e,a.wrap=o,a.gzhead=null,a.w_bits=i,a.w_size=1<<a.w_bits,a.w_mask=a.w_size-1,a.hash_bits=r+7,a.hash_size=1<<a.hash_bits,a.hash_mask=a.hash_size-1,a.hash_shift=~~((a.hash_bits+3-1)/3),a.window=new Uint8Array(2*a.w_size),a.head=new Uint16Array(a.hash_size),a.prev=new Uint16Array(a.w_size),a.lit_bufsize=1<<r+6,a.pending_buf_size=4*a.lit_bufsize,a.pending_buf=new Uint8Array(a.pending_buf_size),a.d_buf=1*a.lit_bufsize,a.l_buf=3*a.lit_bufsize,a.level=t,a.strategy=s,a.method=n,Y(e)};e.exports.deflateInit=(e,t)=>Q(e,t,x,15,8,S),e.exports.deflateInit2=Q,e.exports.deflateReset=Y,e.exports.deflateResetKeep=Z,e.exports.deflateSetHeader=(e,t)=>e&&e.state?2!==e.state.wrap?y:(e.state.gzhead=t,g):y,e.exports.deflate=(e,t)=>{let n,i;if(!e||!e.state||t>_||t<0)return e?D(e,y):y;const s=e.state;if(!e.output||!e.input&&0!==e.avail_in||s.status===R&&t!==f)return D(e,0===e.avail_out?w:y);s.strm=e;const c=s.last_flush;if(s.last_flush=t,42===s.status)if(2===s.wrap)e.adler=0,j(s,31),j(s,139),j(s,8),s.gzhead?(j(s,(s.gzhead.text?1:0)+(s.gzhead.hcrc?2:0)+(s.gzhead.extra?4:0)+(s.gzhead.name?8:0)+(s.gzhead.comment?16:0)),j(s,255&s.gzhead.time),j(s,s.gzhead.time>>8&255),j(s,s.gzhead.time>>16&255),j(s,s.gzhead.time>>24&255),j(s,9===s.level?2:s.strategy>=T||s.level<2?4:0),j(s,255&s.gzhead.os),s.gzhead.extra&&s.gzhead.extra.length&&(j(s,255&s.gzhead.extra.length),j(s,s.gzhead.extra.length>>8&255)),s.gzhead.hcrc&&(e.adler=l(e.adler,s.pending_buf,s.pending,0)),s.gzindex=0,s.status=69):(j(s,0),j(s,0),j(s,0),j(s,0),j(s,0),j(s,9===s.level?2:s.strategy>=T||s.level<2?4:0),j(s,3),s.status=O);else{let t=x+(s.w_bits-8<<4)<<8,n=-1;n=s.strategy>=T||s.level<2?0:s.level<6?1:6===s.level?2:3,t|=n<<6,0!==s.strstart&&(t|=32),t+=31-t%31,s.status=O,q(s,t),0!==s.strstart&&(q(s,e.adler>>>16),q(s,65535&e.adler)),e.adler=1}if(69===s.status)if(s.gzhead.extra){for(n=s.pending;s.gzindex<(65535&s.gzhead.extra.length)&&(s.pending!==s.pending_buf_size||(s.gzhead.hcrc&&s.pending>n&&(e.adler=l(e.adler,s.pending_buf,s.pending-n,n)),U(e),n=s.pending,s.pending!==s.pending_buf_size));)j(s,255&s.gzhead.extra[s.gzindex]),s.gzindex++;s.gzhead.hcrc&&s.pending>n&&(e.adler=l(e.adler,s.pending_buf,s.pending-n,n)),s.gzindex===s.gzhead.extra.length&&(s.gzindex=0,s.status=73)}else s.status=73;if(73===s.status)if(s.gzhead.name){n=s.pending;do{if(s.pending===s.pending_buf_size&&(s.gzhead.hcrc&&s.pending>n&&(e.adler=l(e.adler,s.pending_buf,s.pending-n,n)),U(e),n=s.pending,s.pending===s.pending_buf_size)){i=1;break}i=s.gzindex<s.gzhead.name.length?255&s.gzhead.name.charCodeAt(s.gzindex++):0,j(s,i)}while(0!==i);s.gzhead.hcrc&&s.pending>n&&(e.adler=l(e.adler,s.pending_buf,s.pending-n,n)),0===i&&(s.gzindex=0,s.status=91)}else s.status=91;if(91===s.status)if(s.gzhead.comment){n=s.pending;do{if(s.pending===s.pending_buf_size&&(s.gzhead.hcrc&&s.pending>n&&(e.adler=l(e.adler,s.pending_buf,s.pending-n,n)),U(e),n=s.pending,s.pending===s.pending_buf_size)){i=1;break}i=s.gzindex<s.gzhead.comment.length?255&s.gzhead.comment.charCodeAt(s.gzindex++):0,j(s,i)}while(0!==i);s.gzhead.hcrc&&s.pending>n&&(e.adler=l(e.adler,s.pending_buf,s.pending-n,n)),0===i&&(s.status=P)}else s.status=P;if(s.status===P&&(s.gzhead.hcrc?(s.pending+2>s.pending_buf_size&&U(e),s.pending+2<=s.pending_buf_size&&(j(s,255&e.adler),j(s,e.adler>>8&255),e.adler=0,s.status=O)):s.status=O),0!==s.pending){if(U(e),0===e.avail_out)return s.last_flush=-1,g}else if(0===e.avail_in&&z(t)<=z(c)&&t!==f)return D(e,w);if(s.status===R&&0!==e.avail_in)return D(e,w);if(0!==e.avail_in||0!==s.lookahead||t!==h&&s.status!==R){let n=s.strategy===T?((e,t)=>{let n;for(;;){if(0===e.lookahead&&(V(e),0===e.lookahead)){if(t===h)return 1;break}if(e.match_length=0,n=o(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,n&&(F(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,t===f?(F(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(F(e,!1),0===e.strm.avail_out)?1:2})(s,t):s.strategy===E?((e,t)=>{let n,i,r,s;const a=e.window;for(;;){if(e.lookahead<=A){if(V(e),e.lookahead<=A&&t===h)return 1;if(0===e.lookahead)break}if(e.match_length=0,e.lookahead>=3&&e.strstart>0&&(r=e.strstart-1,i=a[r],i===a[++r]&&i===a[++r]&&i===a[++r])){s=e.strstart+A;do{}while(i===a[++r]&&i===a[++r]&&i===a[++r]&&i===a[++r]&&i===a[++r]&&i===a[++r]&&i===a[++r]&&i===a[++r]&&r<s);e.match_length=A-(s-r),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=3?(n=o(e,1,e.match_length-3),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(n=o(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),n&&(F(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,t===f?(F(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(F(e,!1),0===e.strm.avail_out)?1:2})(s,t):G[s.level].func(s,t);if(3!==n&&4!==n||(s.status=R),1===n||3===n)return 0===e.avail_out&&(s.last_flush=-1),g;if(2===n&&(t===d?a(s):t!==_&&(r(s,0,0,!1),t===p&&(M(s.head),0===s.lookahead&&(s.strstart=0,s.block_start=0,s.insert=0))),U(e),0===e.avail_out))return s.last_flush=-1,g}return t!==f?g:s.wrap<=0?m:(2===s.wrap?(j(s,255&e.adler),j(s,e.adler>>8&255),j(s,e.adler>>16&255),j(s,e.adler>>24&255),j(s,255&e.total_in),j(s,e.total_in>>8&255),j(s,e.total_in>>16&255),j(s,e.total_in>>24&255)):(q(s,e.adler>>>16),q(s,65535&e.adler)),U(e),s.wrap>0&&(s.wrap=-s.wrap),0!==s.pending?g:m)},e.exports.deflateEnd=e=>{if(!e||!e.state)return y;const t=e.state.status;return 42!==t&&69!==t&&73!==t&&91!==t&&t!==P&&t!==O&&t!==R?D(e,y):(e.state=null,t===O?D(e,v):g)},e.exports.deflateSetDictionary=(e,t)=>{let n=t.length;if(!e||!e.state)return y;const i=e.state,r=i.wrap;if(2===r||1===r&&42!==i.status||i.lookahead)return y;if(1===r&&(e.adler=c(e.adler,t,n,0)),i.wrap=0,n>=i.w_size){0===r&&(M(i.head),i.strstart=0,i.block_start=0,i.insert=0);let e=new Uint8Array(i.w_size);e.set(t.subarray(n-i.w_size,n),0),t=e,n=i.w_size}const s=e.avail_in,o=e.next_in,a=e.input;for(e.avail_in=n,e.next_in=0,e.input=t,V(i);i.lookahead>=3;){let e=i.strstart,t=i.lookahead-2;do{i.ins_h=L(i,i.ins_h,i.window[e+3-1]),i.prev[e&i.w_mask]=i.head[i.ins_h],i.head[i.ins_h]=e,e++}while(--t);i.strstart=e,i.lookahead=2,V(i)}return i.strstart+=i.lookahead,i.block_start=i.strstart,i.insert=i.lookahead,i.lookahead=0,i.match_length=i.prev_length=2,i.match_available=0,e.next_in=o,e.input=a,e.avail_in=s,i.wrap=r,g},e.exports.deflateInfo="pako deflate (from Nodeca project)"},2442:e=>{"use strict";e.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},400:e=>{"use strict";e.exports=function(e,t){let n,i,r,s,o,a,c,l,u,h,d,p,f,_,g,m,y,v,w,b,k,T,E,I;const S=e.state;n=e.next_in,E=e.input,i=n+(e.avail_in-5),r=e.next_out,I=e.output,s=r-(t-e.avail_out),o=r+(e.avail_out-257),a=S.dmax,c=S.wsize,l=S.whave,u=S.wnext,h=S.window,d=S.hold,p=S.bits,f=S.lencode,_=S.distcode,g=(1<<S.lenbits)-1,m=(1<<S.distbits)-1;e:do{p<15&&(d+=E[n++]<<p,p+=8,d+=E[n++]<<p,p+=8),y=f[d&g];t:for(;;){if(v=y>>>24,d>>>=v,p-=v,v=y>>>16&255,0===v)I[r++]=65535&y;else{if(!(16&v)){if(0==(64&v)){y=f[(65535&y)+(d&(1<<v)-1)];continue t}if(32&v){S.mode=12;break e}e.msg="invalid literal/length code",S.mode=30;break e}w=65535&y,v&=15,v&&(p<v&&(d+=E[n++]<<p,p+=8),w+=d&(1<<v)-1,d>>>=v,p-=v),p<15&&(d+=E[n++]<<p,p+=8,d+=E[n++]<<p,p+=8),y=_[d&m];n:for(;;){if(v=y>>>24,d>>>=v,p-=v,v=y>>>16&255,!(16&v)){if(0==(64&v)){y=_[(65535&y)+(d&(1<<v)-1)];continue n}e.msg="invalid distance code",S.mode=30;break e}if(b=65535&y,v&=15,p<v&&(d+=E[n++]<<p,p+=8,p<v&&(d+=E[n++]<<p,p+=8)),b+=d&(1<<v)-1,b>a){e.msg="invalid distance too far back",S.mode=30;break e}if(d>>>=v,p-=v,v=r-s,b>v){if(v=b-v,v>l&&S.sane){e.msg="invalid distance too far back",S.mode=30;break e}if(k=0,T=h,0===u){if(k+=c-v,v<w){w-=v;do{I[r++]=h[k++]}while(--v);k=r-b,T=I}}else if(u<v){if(k+=c+u-v,v-=u,v<w){w-=v;do{I[r++]=h[k++]}while(--v);if(k=0,u<w){v=u,w-=v;do{I[r++]=h[k++]}while(--v);k=r-b,T=I}}}else if(k+=u-v,v<w){w-=v;do{I[r++]=h[k++]}while(--v);k=r-b,T=I}for(;w>2;)I[r++]=T[k++],I[r++]=T[k++],I[r++]=T[k++],w-=3;w&&(I[r++]=T[k++],w>1&&(I[r++]=T[k++]))}else{k=r-b;do{I[r++]=I[k++],I[r++]=I[k++],I[r++]=I[k++],w-=3}while(w>2);w&&(I[r++]=I[k++],w>1&&(I[r++]=I[k++]))}break}}break}}while(n<i&&r<o);w=p>>3,n-=w,p-=w<<3,d&=(1<<p)-1,e.next_in=n,e.next_out=r,e.avail_in=n<i?i-n+5:5-(n-i),e.avail_out=r<o?o-r+257:257-(r-o),S.hold=d,S.bits=p}},7387:(e,t,n)=>{"use strict";const i=n(5775),r=n(2576),s=n(400),o=n(1017),{Z_FINISH:a,Z_BLOCK:c,Z_TREES:l,Z_OK:u,Z_STREAM_END:h,Z_NEED_DICT:d,Z_STREAM_ERROR:p,Z_DATA_ERROR:f,Z_MEM_ERROR:_,Z_BUF_ERROR:g,Z_DEFLATED:m}=n(8681),y=12,v=30,w=e=>(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24);function b(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const k=e=>{if(!e||!e.state)return p;const t=e.state;return e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=1,t.last=0,t.havedict=0,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new Int32Array(852),t.distcode=t.distdyn=new Int32Array(592),t.sane=1,t.back=-1,u},T=e=>{if(!e||!e.state)return p;const t=e.state;return t.wsize=0,t.whave=0,t.wnext=0,k(e)},E=(e,t)=>{let n;if(!e||!e.state)return p;const i=e.state;return t<0?(n=0,t=-t):(n=1+(t>>4),t<48&&(t&=15)),t&&(t<8||t>15)?p:(null!==i.window&&i.wbits!==t&&(i.window=null),i.wrap=n,i.wbits=t,T(e))},I=(e,t)=>{if(!e)return p;const n=new b;e.state=n,n.window=null;const i=E(e,t);return i!==u&&(e.state=null),i};let S,C,x=!0;const A=e=>{if(x){S=new Int32Array(512),C=new Int32Array(32);let t=0;for(;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(o(1,e.lens,0,288,S,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;o(2,e.lens,0,32,C,0,e.work,{bits:5}),x=!1}e.lencode=S,e.lenbits=9,e.distcode=C,e.distbits=5},N=(e,t,n,i)=>{let r;const s=e.state;return null===s.window&&(s.wsize=1<<s.wbits,s.wnext=0,s.whave=0,s.window=new Uint8Array(s.wsize)),i>=s.wsize?(s.window.set(t.subarray(n-s.wsize,n),0),s.wnext=0,s.whave=s.wsize):(r=s.wsize-s.wnext,r>i&&(r=i),s.window.set(t.subarray(n-i,n-i+r),s.wnext),(i-=r)?(s.window.set(t.subarray(n-i,n),0),s.wnext=i,s.whave=s.wsize):(s.wnext+=r,s.wnext===s.wsize&&(s.wnext=0),s.whave<s.wsize&&(s.whave+=r))),0};e.exports.inflateReset=T,e.exports.inflateReset2=E,e.exports.inflateResetKeep=k,e.exports.inflateInit=e=>I(e,15),e.exports.inflateInit2=I,e.exports.inflate=(e,t)=>{let n,b,k,T,E,I,S,C,x,P,O,R,D,z,M,L,U,F,j,q,B,W,V=0;const H=new Uint8Array(4);let K,$;const G=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(!e||!e.state||!e.output||!e.input&&0!==e.avail_in)return p;n=e.state,n.mode===y&&(n.mode=13),E=e.next_out,k=e.output,S=e.avail_out,T=e.next_in,b=e.input,I=e.avail_in,C=n.hold,x=n.bits,P=I,O=S,W=u;e:for(;;)switch(n.mode){case 1:if(0===n.wrap){n.mode=13;break}for(;x<16;){if(0===I)break e;I--,C+=b[T++]<<x,x+=8}if(2&n.wrap&&35615===C){n.check=0,H[0]=255&C,H[1]=C>>>8&255,n.check=r(n.check,H,2,0),C=0,x=0,n.mode=2;break}if(n.flags=0,n.head&&(n.head.done=!1),!(1&n.wrap)||(((255&C)<<8)+(C>>8))%31){e.msg="incorrect header check",n.mode=v;break}if((15&C)!==m){e.msg="unknown compression method",n.mode=v;break}if(C>>>=4,x-=4,B=8+(15&C),0===n.wbits)n.wbits=B;else if(B>n.wbits){e.msg="invalid window size",n.mode=v;break}n.dmax=1<<n.wbits,e.adler=n.check=1,n.mode=512&C?10:y,C=0,x=0;break;case 2:for(;x<16;){if(0===I)break e;I--,C+=b[T++]<<x,x+=8}if(n.flags=C,(255&n.flags)!==m){e.msg="unknown compression method",n.mode=v;break}if(57344&n.flags){e.msg="unknown header flags set",n.mode=v;break}n.head&&(n.head.text=C>>8&1),512&n.flags&&(H[0]=255&C,H[1]=C>>>8&255,n.check=r(n.check,H,2,0)),C=0,x=0,n.mode=3;case 3:for(;x<32;){if(0===I)break e;I--,C+=b[T++]<<x,x+=8}n.head&&(n.head.time=C),512&n.flags&&(H[0]=255&C,H[1]=C>>>8&255,H[2]=C>>>16&255,H[3]=C>>>24&255,n.check=r(n.check,H,4,0)),C=0,x=0,n.mode=4;case 4:for(;x<16;){if(0===I)break e;I--,C+=b[T++]<<x,x+=8}n.head&&(n.head.xflags=255&C,n.head.os=C>>8),512&n.flags&&(H[0]=255&C,H[1]=C>>>8&255,n.check=r(n.check,H,2,0)),C=0,x=0,n.mode=5;case 5:if(1024&n.flags){for(;x<16;){if(0===I)break e;I--,C+=b[T++]<<x,x+=8}n.length=C,n.head&&(n.head.extra_len=C),512&n.flags&&(H[0]=255&C,H[1]=C>>>8&255,n.check=r(n.check,H,2,0)),C=0,x=0}else n.head&&(n.head.extra=null);n.mode=6;case 6:if(1024&n.flags&&(R=n.length,R>I&&(R=I),R&&(n.head&&(B=n.head.extra_len-n.length,n.head.extra||(n.head.extra=new Uint8Array(n.head.extra_len)),n.head.extra.set(b.subarray(T,T+R),B)),512&n.flags&&(n.check=r(n.check,b,R,T)),I-=R,T+=R,n.length-=R),n.length))break e;n.length=0,n.mode=7;case 7:if(2048&n.flags){if(0===I)break e;R=0;do{B=b[T+R++],n.head&&B&&n.length<65536&&(n.head.name+=String.fromCharCode(B))}while(B&&R<I);if(512&n.flags&&(n.check=r(n.check,b,R,T)),I-=R,T+=R,B)break e}else n.head&&(n.head.name=null);n.length=0,n.mode=8;case 8:if(4096&n.flags){if(0===I)break e;R=0;do{B=b[T+R++],n.head&&B&&n.length<65536&&(n.head.comment+=String.fromCharCode(B))}while(B&&R<I);if(512&n.flags&&(n.check=r(n.check,b,R,T)),I-=R,T+=R,B)break e}else n.head&&(n.head.comment=null);n.mode=9;case 9:if(512&n.flags){for(;x<16;){if(0===I)break e;I--,C+=b[T++]<<x,x+=8}if(C!==(65535&n.check)){e.msg="header crc mismatch",n.mode=v;break}C=0,x=0}n.head&&(n.head.hcrc=n.flags>>9&1,n.head.done=!0),e.adler=n.check=0,n.mode=y;break;case 10:for(;x<32;){if(0===I)break e;I--,C+=b[T++]<<x,x+=8}e.adler=n.check=w(C),C=0,x=0,n.mode=11;case 11:if(0===n.havedict)return e.next_out=E,e.avail_out=S,e.next_in=T,e.avail_in=I,n.hold=C,n.bits=x,d;e.adler=n.check=1,n.mode=y;case y:if(t===c||t===l)break e;case 13:if(n.last){C>>>=7&x,x-=7&x,n.mode=27;break}for(;x<3;){if(0===I)break e;I--,C+=b[T++]<<x,x+=8}switch(n.last=1&C,C>>>=1,x-=1,3&C){case 0:n.mode=14;break;case 1:if(A(n),n.mode=20,t===l){C>>>=2,x-=2;break e}break;case 2:n.mode=17;break;case 3:e.msg="invalid block type",n.mode=v}C>>>=2,x-=2;break;case 14:for(C>>>=7&x,x-=7&x;x<32;){if(0===I)break e;I--,C+=b[T++]<<x,x+=8}if((65535&C)!=(C>>>16^65535)){e.msg="invalid stored block lengths",n.mode=v;break}if(n.length=65535&C,C=0,x=0,n.mode=15,t===l)break e;case 15:n.mode=16;case 16:if(R=n.length,R){if(R>I&&(R=I),R>S&&(R=S),0===R)break e;k.set(b.subarray(T,T+R),E),I-=R,T+=R,S-=R,E+=R,n.length-=R;break}n.mode=y;break;case 17:for(;x<14;){if(0===I)break e;I--,C+=b[T++]<<x,x+=8}if(n.nlen=257+(31&C),C>>>=5,x-=5,n.ndist=1+(31&C),C>>>=5,x-=5,n.ncode=4+(15&C),C>>>=4,x-=4,n.nlen>286||n.ndist>30){e.msg="too many length or distance symbols",n.mode=v;break}n.have=0,n.mode=18;case 18:for(;n.have<n.ncode;){for(;x<3;){if(0===I)break e;I--,C+=b[T++]<<x,x+=8}n.lens[G[n.have++]]=7&C,C>>>=3,x-=3}for(;n.have<19;)n.lens[G[n.have++]]=0;if(n.lencode=n.lendyn,n.lenbits=7,K={bits:n.lenbits},W=o(0,n.lens,0,19,n.lencode,0,n.work,K),n.lenbits=K.bits,W){e.msg="invalid code lengths set",n.mode=v;break}n.have=0,n.mode=19;case 19:for(;n.have<n.nlen+n.ndist;){for(;V=n.lencode[C&(1<<n.lenbits)-1],M=V>>>24,L=V>>>16&255,U=65535&V,!(M<=x);){if(0===I)break e;I--,C+=b[T++]<<x,x+=8}if(U<16)C>>>=M,x-=M,n.lens[n.have++]=U;else{if(16===U){for($=M+2;x<$;){if(0===I)break e;I--,C+=b[T++]<<x,x+=8}if(C>>>=M,x-=M,0===n.have){e.msg="invalid bit length repeat",n.mode=v;break}B=n.lens[n.have-1],R=3+(3&C),C>>>=2,x-=2}else if(17===U){for($=M+3;x<$;){if(0===I)break e;I--,C+=b[T++]<<x,x+=8}C>>>=M,x-=M,B=0,R=3+(7&C),C>>>=3,x-=3}else{for($=M+7;x<$;){if(0===I)break e;I--,C+=b[T++]<<x,x+=8}C>>>=M,x-=M,B=0,R=11+(127&C),C>>>=7,x-=7}if(n.have+R>n.nlen+n.ndist){e.msg="invalid bit length repeat",n.mode=v;break}for(;R--;)n.lens[n.have++]=B}}if(n.mode===v)break;if(0===n.lens[256]){e.msg="invalid code -- missing end-of-block",n.mode=v;break}if(n.lenbits=9,K={bits:n.lenbits},W=o(1,n.lens,0,n.nlen,n.lencode,0,n.work,K),n.lenbits=K.bits,W){e.msg="invalid literal/lengths set",n.mode=v;break}if(n.distbits=6,n.distcode=n.distdyn,K={bits:n.distbits},W=o(2,n.lens,n.nlen,n.ndist,n.distcode,0,n.work,K),n.distbits=K.bits,W){e.msg="invalid distances set",n.mode=v;break}if(n.mode=20,t===l)break e;case 20:n.mode=21;case 21:if(I>=6&&S>=258){e.next_out=E,e.avail_out=S,e.next_in=T,e.avail_in=I,n.hold=C,n.bits=x,s(e,O),E=e.next_out,k=e.output,S=e.avail_out,T=e.next_in,b=e.input,I=e.avail_in,C=n.hold,x=n.bits,n.mode===y&&(n.back=-1);break}for(n.back=0;V=n.lencode[C&(1<<n.lenbits)-1],M=V>>>24,L=V>>>16&255,U=65535&V,!(M<=x);){if(0===I)break e;I--,C+=b[T++]<<x,x+=8}if(L&&0==(240&L)){for(F=M,j=L,q=U;V=n.lencode[q+((C&(1<<F+j)-1)>>F)],M=V>>>24,L=V>>>16&255,U=65535&V,!(F+M<=x);){if(0===I)break e;I--,C+=b[T++]<<x,x+=8}C>>>=F,x-=F,n.back+=F}if(C>>>=M,x-=M,n.back+=M,n.length=U,0===L){n.mode=26;break}if(32&L){n.back=-1,n.mode=y;break}if(64&L){e.msg="invalid literal/length code",n.mode=v;break}n.extra=15&L,n.mode=22;case 22:if(n.extra){for($=n.extra;x<$;){if(0===I)break e;I--,C+=b[T++]<<x,x+=8}n.length+=C&(1<<n.extra)-1,C>>>=n.extra,x-=n.extra,n.back+=n.extra}n.was=n.length,n.mode=23;case 23:for(;V=n.distcode[C&(1<<n.distbits)-1],M=V>>>24,L=V>>>16&255,U=65535&V,!(M<=x);){if(0===I)break e;I--,C+=b[T++]<<x,x+=8}if(0==(240&L)){for(F=M,j=L,q=U;V=n.distcode[q+((C&(1<<F+j)-1)>>F)],M=V>>>24,L=V>>>16&255,U=65535&V,!(F+M<=x);){if(0===I)break e;I--,C+=b[T++]<<x,x+=8}C>>>=F,x-=F,n.back+=F}if(C>>>=M,x-=M,n.back+=M,64&L){e.msg="invalid distance code",n.mode=v;break}n.offset=U,n.extra=15&L,n.mode=24;case 24:if(n.extra){for($=n.extra;x<$;){if(0===I)break e;I--,C+=b[T++]<<x,x+=8}n.offset+=C&(1<<n.extra)-1,C>>>=n.extra,x-=n.extra,n.back+=n.extra}if(n.offset>n.dmax){e.msg="invalid distance too far back",n.mode=v;break}n.mode=25;case 25:if(0===S)break e;if(R=O-S,n.offset>R){if(R=n.offset-R,R>n.whave&&n.sane){e.msg="invalid distance too far back",n.mode=v;break}R>n.wnext?(R-=n.wnext,D=n.wsize-R):D=n.wnext-R,R>n.length&&(R=n.length),z=n.window}else z=k,D=E-n.offset,R=n.length;R>S&&(R=S),S-=R,n.length-=R;do{k[E++]=z[D++]}while(--R);0===n.length&&(n.mode=21);break;case 26:if(0===S)break e;k[E++]=n.length,S--,n.mode=21;break;case 27:if(n.wrap){for(;x<32;){if(0===I)break e;I--,C|=b[T++]<<x,x+=8}if(O-=S,e.total_out+=O,n.total+=O,O&&(e.adler=n.check=n.flags?r(n.check,k,O,E-O):i(n.check,k,O,E-O)),O=S,(n.flags?C:w(C))!==n.check){e.msg="incorrect data check",n.mode=v;break}C=0,x=0}n.mode=28;case 28:if(n.wrap&&n.flags){for(;x<32;){if(0===I)break e;I--,C+=b[T++]<<x,x+=8}if(C!==(4294967295&n.total)){e.msg="incorrect length check",n.mode=v;break}C=0,x=0}n.mode=29;case 29:W=h;break e;case v:W=f;break e;case 31:return _;default:return p}return e.next_out=E,e.avail_out=S,e.next_in=T,e.avail_in=I,n.hold=C,n.bits=x,(n.wsize||O!==e.avail_out&&n.mode<v&&(n.mode<27||t!==a))&&N(e,e.output,e.next_out,O-e.avail_out)?(n.mode=31,_):(P-=e.avail_in,O-=e.avail_out,e.total_in+=P,e.total_out+=O,n.total+=O,n.wrap&&O&&(e.adler=n.check=n.flags?r(n.check,k,O,e.next_out-O):i(n.check,k,O,e.next_out-O)),e.data_type=n.bits+(n.last?64:0)+(n.mode===y?128:0)+(20===n.mode||15===n.mode?256:0),(0===P&&0===O||t===a)&&W===u&&(W=g),W)},e.exports.inflateEnd=e=>{if(!e||!e.state)return p;let t=e.state;return t.window&&(t.window=null),e.state=null,u},e.exports.inflateGetHeader=(e,t)=>{if(!e||!e.state)return p;const n=e.state;return 0==(2&n.wrap)?p:(n.head=t,t.done=!1,u)},e.exports.inflateSetDictionary=(e,t)=>{const n=t.length;let r,s,o;return e&&e.state?(r=e.state,0!==r.wrap&&11!==r.mode?p:11===r.mode&&(s=1,s=i(s,t,n,0),s!==r.check)?f:(o=N(e,t,n,n),o?(r.mode=31,_):(r.havedict=1,u))):p},e.exports.inflateInfo="pako inflate (from Nodeca project)"},1017:e=>{"use strict";const t=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),n=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),i=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),r=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]);e.exports=(e,s,o,a,c,l,u,h)=>{const d=h.bits;let p,f,_,g,m,y,v=0,w=0,b=0,k=0,T=0,E=0,I=0,S=0,C=0,x=0,A=null,N=0;const P=new Uint16Array(16),O=new Uint16Array(16);let R,D,z,M=null,L=0;for(v=0;v<=15;v++)P[v]=0;for(w=0;w<a;w++)P[s[o+w]]++;for(T=d,k=15;k>=1&&0===P[k];k--);if(T>k&&(T=k),0===k)return c[l++]=20971520,c[l++]=20971520,h.bits=1,0;for(b=1;b<k&&0===P[b];b++);for(T<b&&(T=b),S=1,v=1;v<=15;v++)if(S<<=1,S-=P[v],S<0)return-1;if(S>0&&(0===e||1!==k))return-1;for(O[1]=0,v=1;v<15;v++)O[v+1]=O[v]+P[v];for(w=0;w<a;w++)0!==s[o+w]&&(u[O[s[o+w]]++]=w);if(0===e?(A=M=u,y=19):1===e?(A=t,N-=257,M=n,L-=257,y=256):(A=i,M=r,y=-1),x=0,w=0,v=b,m=l,E=T,I=0,_=-1,C=1<<T,g=C-1,1===e&&C>852||2===e&&C>592)return 1;for(;;){R=v-I,u[w]<y?(D=0,z=u[w]):u[w]>y?(D=M[L+u[w]],z=A[N+u[w]]):(D=96,z=0),p=1<<v-I,f=1<<E,b=f;do{f-=p,c[m+(x>>I)+f]=R<<24|D<<16|z|0}while(0!==f);for(p=1<<v-1;x&p;)p>>=1;if(0!==p?(x&=p-1,x+=p):x=0,w++,0==--P[v]){if(v===k)break;v=s[o+u[w]]}if(v>T&&(x&g)!==_){for(0===I&&(I=T),m+=b,E=v-I,S=1<<E;E+I<k&&(S-=P[E+I],!(S<=0));)E++,S<<=1;if(C+=1<<E,1===e&&C>852||2===e&&C>592)return 1;_=x&g,c[_]=T<<24|E<<16|m-l|0}}return 0!==x&&(c[m+x]=v-I<<24|64<<16|0),h.bits=T,0}},2587:e=>{"use strict";e.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},1443:e=>{"use strict";function t(e){let t=e.length;for(;--t>=0;)e[t]=0}const n=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),i=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),r=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),s=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),o=new Array(576);t(o);const a=new Array(60);t(a);const c=new Array(512);t(c);const l=new Array(256);t(l);const u=new Array(29);t(u);const h=new Array(30);function d(e,t,n,i,r){this.static_tree=e,this.extra_bits=t,this.extra_base=n,this.elems=i,this.max_length=r,this.has_stree=e&&e.length}let p,f,_;function g(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}t(h);const m=e=>e<256?c[e]:c[256+(e>>>7)],y=(e,t)=>{e.pending_buf[e.pending++]=255&t,e.pending_buf[e.pending++]=t>>>8&255},v=(e,t,n)=>{e.bi_valid>16-n?(e.bi_buf|=t<<e.bi_valid&65535,y(e,e.bi_buf),e.bi_buf=t>>16-e.bi_valid,e.bi_valid+=n-16):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=n)},w=(e,t,n)=>{v(e,n[2*t],n[2*t+1])},b=(e,t)=>{let n=0;do{n|=1&e,e>>>=1,n<<=1}while(--t>0);return n>>>1},k=(e,t,n)=>{const i=new Array(16);let r,s,o=0;for(r=1;r<=15;r++)i[r]=o=o+n[r-1]<<1;for(s=0;s<=t;s++){let t=e[2*s+1];0!==t&&(e[2*s]=b(i[t]++,t))}},T=e=>{let t;for(t=0;t<286;t++)e.dyn_ltree[2*t]=0;for(t=0;t<30;t++)e.dyn_dtree[2*t]=0;for(t=0;t<19;t++)e.bl_tree[2*t]=0;e.dyn_ltree[512]=1,e.opt_len=e.static_len=0,e.last_lit=e.matches=0},E=e=>{e.bi_valid>8?y(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0},I=(e,t,n,i)=>{const r=2*t,s=2*n;return e[r]<e[s]||e[r]===e[s]&&i[t]<=i[n]},S=(e,t,n)=>{const i=e.heap[n];let r=n<<1;for(;r<=e.heap_len&&(r<e.heap_len&&I(t,e.heap[r+1],e.heap[r],e.depth)&&r++,!I(t,i,e.heap[r],e.depth));)e.heap[n]=e.heap[r],n=r,r<<=1;e.heap[n]=i},C=(e,t,r)=>{let s,o,a,c,d=0;if(0!==e.last_lit)do{s=e.pending_buf[e.d_buf+2*d]<<8|e.pending_buf[e.d_buf+2*d+1],o=e.pending_buf[e.l_buf+d],d++,0===s?w(e,o,t):(a=l[o],w(e,a+256+1,t),c=n[a],0!==c&&(o-=u[a],v(e,o,c)),s--,a=m(s),w(e,a,r),c=i[a],0!==c&&(s-=h[a],v(e,s,c)))}while(d<e.last_lit);w(e,256,t)},x=(e,t)=>{const n=t.dyn_tree,i=t.stat_desc.static_tree,r=t.stat_desc.has_stree,s=t.stat_desc.elems;let o,a,c,l=-1;for(e.heap_len=0,e.heap_max=573,o=0;o<s;o++)0!==n[2*o]?(e.heap[++e.heap_len]=l=o,e.depth[o]=0):n[2*o+1]=0;for(;e.heap_len<2;)c=e.heap[++e.heap_len]=l<2?++l:0,n[2*c]=1,e.depth[c]=0,e.opt_len--,r&&(e.static_len-=i[2*c+1]);for(t.max_code=l,o=e.heap_len>>1;o>=1;o--)S(e,n,o);c=s;do{o=e.heap[1],e.heap[1]=e.heap[e.heap_len--],S(e,n,1),a=e.heap[1],e.heap[--e.heap_max]=o,e.heap[--e.heap_max]=a,n[2*c]=n[2*o]+n[2*a],e.depth[c]=(e.depth[o]>=e.depth[a]?e.depth[o]:e.depth[a])+1,n[2*o+1]=n[2*a+1]=c,e.heap[1]=c++,S(e,n,1)}while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],((e,t)=>{const n=t.dyn_tree,i=t.max_code,r=t.stat_desc.static_tree,s=t.stat_desc.has_stree,o=t.stat_desc.extra_bits,a=t.stat_desc.extra_base,c=t.stat_desc.max_length;let l,u,h,d,p,f,_=0;for(d=0;d<=15;d++)e.bl_count[d]=0;for(n[2*e.heap[e.heap_max]+1]=0,l=e.heap_max+1;l<573;l++)u=e.heap[l],d=n[2*n[2*u+1]+1]+1,d>c&&(d=c,_++),n[2*u+1]=d,u>i||(e.bl_count[d]++,p=0,u>=a&&(p=o[u-a]),f=n[2*u],e.opt_len+=f*(d+p),s&&(e.static_len+=f*(r[2*u+1]+p)));if(0!==_){do{for(d=c-1;0===e.bl_count[d];)d--;e.bl_count[d]--,e.bl_count[d+1]+=2,e.bl_count[c]--,_-=2}while(_>0);for(d=c;0!==d;d--)for(u=e.bl_count[d];0!==u;)h=e.heap[--l],h>i||(n[2*h+1]!==d&&(e.opt_len+=(d-n[2*h+1])*n[2*h],n[2*h+1]=d),u--)}})(e,t),k(n,l,e.bl_count)},A=(e,t,n)=>{let i,r,s=-1,o=t[1],a=0,c=7,l=4;for(0===o&&(c=138,l=3),t[2*(n+1)+1]=65535,i=0;i<=n;i++)r=o,o=t[2*(i+1)+1],++a<c&&r===o||(a<l?e.bl_tree[2*r]+=a:0!==r?(r!==s&&e.bl_tree[2*r]++,e.bl_tree[32]++):a<=10?e.bl_tree[34]++:e.bl_tree[36]++,a=0,s=r,0===o?(c=138,l=3):r===o?(c=6,l=3):(c=7,l=4))},N=(e,t,n)=>{let i,r,s=-1,o=t[1],a=0,c=7,l=4;for(0===o&&(c=138,l=3),i=0;i<=n;i++)if(r=o,o=t[2*(i+1)+1],!(++a<c&&r===o)){if(a<l)do{w(e,r,e.bl_tree)}while(0!=--a);else 0!==r?(r!==s&&(w(e,r,e.bl_tree),a--),w(e,16,e.bl_tree),v(e,a-3,2)):a<=10?(w(e,17,e.bl_tree),v(e,a-3,3)):(w(e,18,e.bl_tree),v(e,a-11,7));a=0,s=r,0===o?(c=138,l=3):r===o?(c=6,l=3):(c=7,l=4)}};let P=!1;const O=(e,t,n,i)=>{v(e,0+(i?1:0),3),((e,t,n,i)=>{E(e),y(e,n),y(e,~n),e.pending_buf.set(e.window.subarray(t,t+n),e.pending),e.pending+=n})(e,t,n)};e.exports._tr_init=e=>{P||((()=>{let e,t,s,g,m;const y=new Array(16);for(s=0,g=0;g<28;g++)for(u[g]=s,e=0;e<1<<n[g];e++)l[s++]=g;for(l[s-1]=g,m=0,g=0;g<16;g++)for(h[g]=m,e=0;e<1<<i[g];e++)c[m++]=g;for(m>>=7;g<30;g++)for(h[g]=m<<7,e=0;e<1<<i[g]-7;e++)c[256+m++]=g;for(t=0;t<=15;t++)y[t]=0;for(e=0;e<=143;)o[2*e+1]=8,e++,y[8]++;for(;e<=255;)o[2*e+1]=9,e++,y[9]++;for(;e<=279;)o[2*e+1]=7,e++,y[7]++;for(;e<=287;)o[2*e+1]=8,e++,y[8]++;for(k(o,287,y),e=0;e<30;e++)a[2*e+1]=5,a[2*e]=b(e,5);p=new d(o,n,257,286,15),f=new d(a,i,0,30,15),_=new d(new Array(0),r,0,19,7)})(),P=!0),e.l_desc=new g(e.dyn_ltree,p),e.d_desc=new g(e.dyn_dtree,f),e.bl_desc=new g(e.bl_tree,_),e.bi_buf=0,e.bi_valid=0,T(e)},e.exports._tr_stored_block=O,e.exports._tr_flush_block=(e,t,n,i)=>{let r,c,l=0;e.level>0?(2===e.strm.data_type&&(e.strm.data_type=(e=>{let t,n=4093624447;for(t=0;t<=31;t++,n>>>=1)if(1&n&&0!==e.dyn_ltree[2*t])return 0;if(0!==e.dyn_ltree[18]||0!==e.dyn_ltree[20]||0!==e.dyn_ltree[26])return 1;for(t=32;t<256;t++)if(0!==e.dyn_ltree[2*t])return 1;return 0})(e)),x(e,e.l_desc),x(e,e.d_desc),l=(e=>{let t;for(A(e,e.dyn_ltree,e.l_desc.max_code),A(e,e.dyn_dtree,e.d_desc.max_code),x(e,e.bl_desc),t=18;t>=3&&0===e.bl_tree[2*s[t]+1];t--);return e.opt_len+=3*(t+1)+5+5+4,t})(e),r=e.opt_len+3+7>>>3,c=e.static_len+3+7>>>3,c<=r&&(r=c)):r=c=n+5,n+4<=r&&-1!==t?O(e,t,n,i):4===e.strategy||c===r?(v(e,2+(i?1:0),3),C(e,o,a)):(v(e,4+(i?1:0),3),((e,t,n,i)=>{let r;for(v(e,t-257,5),v(e,n-1,5),v(e,i-4,4),r=0;r<i;r++)v(e,e.bl_tree[2*s[r]+1],3);N(e,e.dyn_ltree,t-1),N(e,e.dyn_dtree,n-1)})(e,e.l_desc.max_code+1,e.d_desc.max_code+1,l+1),C(e,e.dyn_ltree,e.dyn_dtree)),T(e),i&&E(e)},e.exports._tr_tally=(e,t,n)=>(e.pending_buf[e.d_buf+2*e.last_lit]=t>>>8&255,e.pending_buf[e.d_buf+2*e.last_lit+1]=255&t,e.pending_buf[e.l_buf+e.last_lit]=255&n,e.last_lit++,0===t?e.dyn_ltree[2*n]++:(e.matches++,t--,e.dyn_ltree[2*(l[n]+256+1)]++,e.dyn_dtree[2*m(t)]++),e.last_lit===e.lit_bufsize-1),e.exports._tr_align=e=>{v(e,2,3),w(e,256,o),(e=>{16===e.bi_valid?(y(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=255&e.bi_buf,e.bi_buf>>=8,e.bi_valid-=8)})(e)}},4213:e=>{"use strict";e.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},9105:function(e){e.exports=function(){"use strict";function e(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function t(t){for(var n=1;n<arguments.length;n++){var i=null!=arguments[n]?arguments[n]:{};n%2?e(Object(i),!0).forEach((function(e){s(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):e(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function r(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e){return{all:e=e||new Map,on:function(t,n){var i=e.get(t);i?i.push(n):e.set(t,[n])},off:function(t,n){var i=e.get(t);i&&(n?i.splice(i.indexOf(n)>>>0,1):e.set(t,[]))},emit:function(t,n){var i=e.get(t);i&&i.slice().map((function(e){e(n)})),(i=e.get("*"))&&i.slice().map((function(e){e(t,n)}))}}}var a="expiry",c=function(e){if(e)throw new Error("Cannot use disposed instance.")},l={expiryCheckInterval:100},u=function(){function e(){var i=this,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};n(this,e),s(this,"expire",(function(){c(i.disposed);for(var e=Date.now(),t=e;t>=i.lastExpiredTime;t-=1){var n=i.queue[t];n&&(delete i.queue[t],n.forEach((function(e){var t=e.key;return(0,e.onExpire)(t)})))}i.lastExpiredTime=e})),this.config=t(t({},l),r),this.queue={},this.disposed=!1,this.lastExpiredTime=Date.now()-1;var o=this.config.expiryCheckInterval;this.timer=setInterval(this.expire,o)}return r(e,[{key:"add",value:function(e,t,n){return c(this.disposed),this.queue[e]||(this.queue[e]=[]),this.queue[e].push({key:t,onExpire:n}),!0}},{key:"remove",value:function(e,t){c(this.disposed);var n=this.queue[e];if(n){var i=n.filter((function(e){return e.key!==t}));return i.length?this.queue[e]=i:delete this.queue[e],!0}return!1}},{key:"dispose",value:function(){return c(this.disposed),clearInterval(this.timer),this.timer=null,this.queue={},this.disposed=!0,!0}}]),e}(),h={defaultCacheExpiryIn:6e4,expiryCheckInterval:100};return function(){function e(){var i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:u;n(this,e),this.config=t(t({},h),i);var s=o(),a=[s.on,s.off,s.emit];this.on=a[0],this.off=a[1],this.emit=a[2],this.cacheStore={},this.disposed=!1;var c=this.config.expiryCheckInterval;this.cacheExpirer=new r({expiryCheckInterval:c})}return r(e,[{key:"put",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.config.defaultCacheExpiryIn;c(this.disposed),this.cacheStore[t]&&this.remove(t);var r=Date.now(),s=i?r+i:null,o={value:n,addedAt:r,expiryAt:s};if(this.cacheStore[t]=o,s){var l=function(){e.remove(t),e.emit(a,{key:t,data:e.cacheStore[t]})};this.cacheExpirer.add(s,t,l)}return this.emit("add",{key:t,data:o}),o}},{key:"get",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";c(this.disposed);var t=this.cacheStore[e];return t?(this.emit("get",{key:e,data:t}),t):null}},{key:"remove",value:function(e){c(this.disposed);var t=this.cacheStore[e];if(t){delete this.cacheStore[e];var n=t.expiryAt;return this.cacheExpirer.remove(n,e),this.emit("remove",{key:e,data:t}),!0}return!1}},{key:"dispose",value:function(){var e=this;return c(this.disposed),Object.keys(this.cacheStore).forEach((function(t){return e.remove(t)})),this.emit("clear",{}),this.cacheExpirer.dispose(),this.disposed=!0,!0}}]),e}()}()},7588:e=>{var t=function(e){"use strict";var t,n=Object.prototype,i=n.hasOwnProperty,r="function"==typeof Symbol?Symbol:{},s=r.iterator||"@@iterator",o=r.asyncIterator||"@@asyncIterator",a=r.toStringTag||"@@toStringTag";function c(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(e){c=function(e,t,n){return e[t]=n}}function l(e,t,n,i){var r=t&&t.prototype instanceof g?t:g,s=Object.create(r.prototype),o=new x(i||[]);return s._invoke=function(e,t,n){var i=h;return function(r,s){if(i===p)throw new Error("Generator is already running");if(i===f){if("throw"===r)throw s;return N()}for(n.method=r,n.arg=s;;){var o=n.delegate;if(o){var a=I(o,n);if(a){if(a===_)continue;return a}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(i===h)throw i=f,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i=p;var c=u(e,t,n);if("normal"===c.type){if(i=n.done?f:d,c.arg===_)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(i=f,n.method="throw",n.arg=c.arg)}}}(e,n,o),s}function u(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=l;var h="suspendedStart",d="suspendedYield",p="executing",f="completed",_={};function g(){}function m(){}function y(){}var v={};c(v,s,(function(){return this}));var w=Object.getPrototypeOf,b=w&&w(w(A([])));b&&b!==n&&i.call(b,s)&&(v=b);var k=y.prototype=g.prototype=Object.create(v);function T(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function E(e,t){function n(r,s,o,a){var c=u(e[r],e,s);if("throw"!==c.type){var l=c.arg,h=l.value;return h&&"object"==typeof h&&i.call(h,"__await")?t.resolve(h.__await).then((function(e){n("next",e,o,a)}),(function(e){n("throw",e,o,a)})):t.resolve(h).then((function(e){l.value=e,o(l)}),(function(e){return n("throw",e,o,a)}))}a(c.arg)}var r;this._invoke=function(e,i){function s(){return new t((function(t,r){n(e,i,t,r)}))}return r=r?r.then(s,s):s()}}function I(e,n){var i=e.iterator[n.method];if(i===t){if(n.delegate=null,"throw"===n.method){if(e.iterator.return&&(n.method="return",n.arg=t,I(e,n),"throw"===n.method))return _;n.method="throw",n.arg=new TypeError("The iterator does not provide a 'throw' method")}return _}var r=u(i,e.iterator,n.arg);if("throw"===r.type)return n.method="throw",n.arg=r.arg,n.delegate=null,_;var s=r.arg;return s?s.done?(n[e.resultName]=s.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,_):s:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,_)}function S(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function C(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function x(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(S,this),this.reset(!0)}function A(e){if(e){var n=e[s];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,o=function n(){for(;++r<e.length;)if(i.call(e,r))return n.value=e[r],n.done=!1,n;return n.value=t,n.done=!0,n};return o.next=o}}return{next:N}}function N(){return{value:t,done:!0}}return m.prototype=y,c(k,"constructor",y),c(y,"constructor",m),m.displayName=c(y,a,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===m||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,y):(e.__proto__=y,c(e,a,"GeneratorFunction")),e.prototype=Object.create(k),e},e.awrap=function(e){return{__await:e}},T(E.prototype),c(E.prototype,o,(function(){return this})),e.AsyncIterator=E,e.async=function(t,n,i,r,s){void 0===s&&(s=Promise);var o=new E(l(t,n,i,r),s);return e.isGeneratorFunction(n)?o:o.next().then((function(e){return e.done?e.value:o.next()}))},T(k),c(k,a,"Generator"),c(k,s,(function(){return this})),c(k,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function n(){for(;t.length;){var i=t.pop();if(i in e)return n.value=i,n.done=!1,n}return n.done=!0,n}},e.values=A,x.prototype={constructor:x,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(C),!e)for(var n in this)"t"===n.charAt(0)&&i.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function r(i,r){return a.type="throw",a.arg=e,n.next=i,r&&(n.method="next",n.arg=t),!!r}for(var s=this.tryEntries.length-1;s>=0;--s){var o=this.tryEntries[s],a=o.completion;if("root"===o.tryLoc)return r("end");if(o.tryLoc<=this.prev){var c=i.call(o,"catchLoc"),l=i.call(o,"finallyLoc");if(c&&l){if(this.prev<o.catchLoc)return r(o.catchLoc,!0);if(this.prev<o.finallyLoc)return r(o.finallyLoc)}else if(c){if(this.prev<o.catchLoc)return r(o.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return r(o.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&i.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var s=r;break}}s&&("break"===e||"continue"===e)&&s.tryLoc<=t&&t<=s.finallyLoc&&(s=null);var o=s?s.completion:{};return o.type=e,o.arg=t,s?(this.method="next",this.next=s.finallyLoc,_):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),_},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),C(n),_}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var i=n.completion;if("throw"===i.type){var r=i.arg;C(n)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(e,n,i){return this.delegate={iterator:A(e),resultName:n,nextLoc:i},"next"===this.method&&(this.arg=t),_}},e}(e.exports);try{regeneratorRuntime=t}catch(e){"object"==typeof globalThis?globalThis.regeneratorRuntime=t:Function("r","regeneratorRuntime = r")(t)}},1303:(e,t,n)=>{"use strict";var i=n(6356),r=(n(7588),n(4683));const s=function(e,t){if(!e)throw o(t)},o=function(e){return new Error("Firebase Database (${JSCORE_VERSION}) INTERNAL ASSERT FAILED: "+e)},a=function(e){const t=[];let n=0;for(let i=0;i<e.length;i++){let r=e.charCodeAt(i);r<128?t[n++]=r:r<2048?(t[n++]=r>>6|192,t[n++]=63&r|128):55296==(64512&r)&&i+1<e.length&&56320==(64512&e.charCodeAt(i+1))?(r=65536+((1023&r)<<10)+(1023&e.charCodeAt(++i)),t[n++]=r>>18|240,t[n++]=r>>12&63|128,t[n++]=r>>6&63|128,t[n++]=63&r|128):(t[n++]=r>>12|224,t[n++]=r>>6&63|128,t[n++]=63&r|128)}return t},c={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let t=0;t<e.length;t+=3){const r=e[t],s=t+1<e.length,o=s?e[t+1]:0,a=t+2<e.length,c=a?e[t+2]:0,l=r>>2,u=(3&r)<<4|o>>4;let h=(15&o)<<2|c>>6,d=63&c;a||(d=64,s||(h=64)),i.push(n[l],n[u],n[h],n[d])}return i.join("")},encodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(a(e),t)},decodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):function(e){const t=[];let n=0,i=0;for(;n<e.length;){const r=e[n++];if(r<128)t[i++]=String.fromCharCode(r);else if(r>191&&r<224){const s=e[n++];t[i++]=String.fromCharCode((31&r)<<6|63&s)}else if(r>239&&r<365){const s=((7&r)<<18|(63&e[n++])<<12|(63&e[n++])<<6|63&e[n++])-65536;t[i++]=String.fromCharCode(55296+(s>>10)),t[i++]=String.fromCharCode(56320+(1023&s))}else{const s=e[n++],o=e[n++];t[i++]=String.fromCharCode((15&r)<<12|(63&s)<<6|63&o)}}return t.join("")}(this.decodeStringToByteArray(e,t))},decodeStringToByteArray(e,t){this.init_();const n=t?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let t=0;t<e.length;){const r=n[e.charAt(t++)],s=t<e.length?n[e.charAt(t)]:0;++t;const o=t<e.length?n[e.charAt(t)]:64;++t;const a=t<e.length?n[e.charAt(t)]:64;if(++t,null==r||null==s||null==o||null==a)throw Error();const c=r<<2|s>>4;if(i.push(c),64!==o){const e=s<<4&240|o>>2;if(i.push(e),64!==a){const e=o<<6&192|a;i.push(e)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}},l=function(e){try{return c.decodeString(e,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function u(e){return h(void 0,e)}function h(e,t){if(!(t instanceof Object))return t;switch(t.constructor){case Date:return new Date(t.getTime());case Object:void 0===e&&(e={});break;case Array:e=[];break;default:return t}for(const n in t)t.hasOwnProperty(n)&&"__proto__"!==n&&(e[n]=h(e[n],t[n]));return e}class d{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}wrapCallback(e){return(t,n)=>{t?this.reject(t):this.resolve(n),"function"==typeof e&&(this.promise.catch((()=>{})),1===e.length?e(t):e(t,n))}}}function p(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function f(){return"undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(p())}function _(){const e="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof e&&void 0!==e.id}function g(){return"object"==typeof navigator&&"ReactNative"===navigator.product}class m extends Error{constructor(e,t,n){super(t),this.code=e,this.customData=n,this.name="FirebaseError",Object.setPrototypeOf(this,m.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,y.prototype.create)}}class y{constructor(e,t,n){this.service=e,this.serviceName=t,this.errors=n}create(e,...t){const n=t[0]||{},i=`${this.service}/${e}`,r=this.errors[e],s=r?function(e,t){return e.replace(v,((e,n)=>{const i=t[n];return null!=i?String(i):`<${n}?>`}))}(r,n):"Error",o=`${this.serviceName}: ${s} (${i}).`;return new m(i,o,n)}}const v=/\{\$([^}]+)}/g;function w(e){return JSON.parse(e)}function b(e){return JSON.stringify(e)}const k=function(e){let t={},n={},i={},r="";try{const s=e.split(".");t=w(l(s[0])||""),n=w(l(s[1])||""),r=s[2],i=n.d||{},delete n.d}catch(e){}return{header:t,claims:n,data:i,signature:r}};function T(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function E(e,t){return Object.prototype.hasOwnProperty.call(e,t)?e[t]:void 0}function I(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}function S(e,t,n){const i={};for(const r in e)Object.prototype.hasOwnProperty.call(e,r)&&(i[r]=t.call(n,e[r],r,e));return i}function C(e,t){if(e===t)return!0;const n=Object.keys(e),i=Object.keys(t);for(const r of n){if(!i.includes(r))return!1;const n=e[r],s=t[r];if(x(n)&&x(s)){if(!C(n,s))return!1}else if(n!==s)return!1}for(const e of i)if(!n.includes(e))return!1;return!0}function x(e){return null!==e&&"object"==typeof e}function A(e){const t=[];for(const[n,i]of Object.entries(e))Array.isArray(i)?i.forEach((e=>{t.push(encodeURIComponent(n)+"="+encodeURIComponent(e))})):t.push(encodeURIComponent(n)+"="+encodeURIComponent(i));return t.length?"&"+t.join("&"):""}function N(e){const t={};return e.replace(/^\?/,"").split("&").forEach((e=>{if(e){const[n,i]=e.split("=");t[decodeURIComponent(n)]=decodeURIComponent(i)}})),t}function P(e){const t=e.indexOf("?");if(!t)return"";const n=e.indexOf("#",t);return e.substring(t,n>0?n:void 0)}class O{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=64,this.pad_[0]=128;for(let e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(e,t){t||(t=0);const n=this.W_;if("string"==typeof e)for(let i=0;i<16;i++)n[i]=e.charCodeAt(t)<<24|e.charCodeAt(t+1)<<16|e.charCodeAt(t+2)<<8|e.charCodeAt(t+3),t+=4;else for(let i=0;i<16;i++)n[i]=e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3],t+=4;for(let e=16;e<80;e++){const t=n[e-3]^n[e-8]^n[e-14]^n[e-16];n[e]=4294967295&(t<<1|t>>>31)}let i,r,s=this.chain_[0],o=this.chain_[1],a=this.chain_[2],c=this.chain_[3],l=this.chain_[4];for(let e=0;e<80;e++){e<40?e<20?(i=c^o&(a^c),r=1518500249):(i=o^a^c,r=1859775393):e<60?(i=o&a|c&(o|a),r=2400959708):(i=o^a^c,r=3395469782);const t=(s<<5|s>>>27)+i+l+r+n[e]&4294967295;l=c,c=a,a=4294967295&(o<<30|o>>>2),o=s,s=t}this.chain_[0]=this.chain_[0]+s&4294967295,this.chain_[1]=this.chain_[1]+o&4294967295,this.chain_[2]=this.chain_[2]+a&4294967295,this.chain_[3]=this.chain_[3]+c&4294967295,this.chain_[4]=this.chain_[4]+l&4294967295}update(e,t){if(null==e)return;void 0===t&&(t=e.length);const n=t-this.blockSize;let i=0;const r=this.buf_;let s=this.inbuf_;for(;i<t;){if(0===s)for(;i<=n;)this.compress_(e,i),i+=this.blockSize;if("string"==typeof e){for(;i<t;)if(r[s]=e.charCodeAt(i),++s,++i,s===this.blockSize){this.compress_(r),s=0;break}}else for(;i<t;)if(r[s]=e[i],++s,++i,s===this.blockSize){this.compress_(r),s=0;break}}this.inbuf_=s,this.total_+=t}digest(){const e=[];let t=8*this.total_;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let e=this.blockSize-1;e>=56;e--)this.buf_[e]=255&t,t/=256;this.compress_(this.buf_);let n=0;for(let t=0;t<5;t++)for(let i=24;i>=0;i-=8)e[n]=this.chain_[t]>>i&255,++n;return e}}class R{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then((()=>{e(this)})).catch((e=>{this.error(e)}))}next(e){this.forEachObserver((t=>{t.next(e)}))}error(e){this.forEachObserver((t=>{t.error(e)})),this.close(e)}complete(){this.forEachObserver((e=>{e.complete()})),this.close()}subscribe(e,t,n){let i;if(void 0===e&&void 0===t&&void 0===n)throw new Error("Missing Observer.");i=function(e,t){if("object"!=typeof e||null===e)return!1;for(const t of["next","error","complete"])if(t in e&&"function"==typeof e[t])return!0;return!1}(e)?e:{next:e,error:t,complete:n},void 0===i.next&&(i.next=D),void 0===i.error&&(i.error=D),void 0===i.complete&&(i.complete=D);const r=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then((()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch(e){}})),this.observers.push(i),r}unsubscribeOne(e){void 0!==this.observers&&void 0!==this.observers[e]&&(delete this.observers[e],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then((()=>{if(void 0!==this.observers&&void 0!==this.observers[e])try{t(this.observers[e])}catch(e){"undefined"!=typeof console&&console.error&&console.error(e)}}))}close(e){this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then((()=>{this.observers=void 0,this.onNoObservers=void 0})))}}function D(){}function z(e,t){return`${e} failed: ${t} argument `}const M=function(e){let t=0;for(let n=0;n<e.length;n++){const i=e.charCodeAt(n);i<128?t++:i<2048?t+=2:i>=55296&&i<=56319?(t+=4,n++):t+=3}return t};function L(e,t=1e3,n=2){const i=t*Math.pow(n,e),r=Math.round(.5*i*(Math.random()-.5)*2);return Math.min(144e5,i+r)}function U(e){return e&&e._delegate?e._delegate:e}class F{constructor(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const j="[DEFAULT]";class q{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const e=new d;if(this.instancesDeferred.set(t,e),this.isInitialized(t)||this.shouldAutoInitialize())try{const n=this.getOrInitializeService({instanceIdentifier:t});n&&e.resolve(n)}catch(e){}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const n=this.normalizeInstanceIdentifier(null==e?void 0:e.identifier),i=null!==(t=null==e?void 0:e.optional)&&void 0!==t&&t;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(i)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(e){if(i)return null;throw e}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,this.shouldAutoInitialize()){if(function(e){return"EAGER"===e.instantiationMode}(e))try{this.getOrInitializeService({instanceIdentifier:j})}catch(e){}for(const[e,t]of this.instancesDeferred.entries()){const n=this.normalizeInstanceIdentifier(e);try{const e=this.getOrInitializeService({instanceIdentifier:n});t.resolve(e)}catch(e){}}}}clearInstance(e="[DEFAULT]"){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter((e=>"INTERNAL"in e)).map((e=>e.INTERNAL.delete())),...e.filter((e=>"_delete"in e)).map((e=>e._delete()))])}isComponentSet(){return null!=this.component}isInitialized(e="[DEFAULT]"){return this.instances.has(e)}getOptions(e="[DEFAULT]"){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:n,options:t});for(const[e,t]of this.instancesDeferred.entries())n===this.normalizeInstanceIdentifier(e)&&t.resolve(i);return i}onInit(e,t){var n;const i=this.normalizeInstanceIdentifier(t),r=null!==(n=this.onInitCallbacks.get(i))&&void 0!==n?n:new Set;r.add(e),this.onInitCallbacks.set(i,r);const s=this.instances.get(i);return s&&e(s,i),()=>{r.delete(e)}}invokeOnInitCallbacks(e,t){const n=this.onInitCallbacks.get(t);if(n)for(const i of n)try{i(e,t)}catch(e){}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:(i=e,i===j?void 0:i),options:t}),this.instances.set(e,n),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch(e){}var i;return n||null}normalizeInstanceIdentifier(e="[DEFAULT]"){return this.component?this.component.multipleInstances?e:j:e}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class B{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new q(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}const W=[];var V;!function(e){e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT"}(V||(V={}));const H={debug:V.DEBUG,verbose:V.VERBOSE,info:V.INFO,warn:V.WARN,error:V.ERROR,silent:V.SILENT},K=V.INFO,$={[V.DEBUG]:"log",[V.VERBOSE]:"log",[V.INFO]:"info",[V.WARN]:"warn",[V.ERROR]:"error"},G=(e,t,...n)=>{if(t<e.logLevel)return;const i=(new Date).toISOString(),r=$[t];if(!r)throw new Error(`Attempted to log a message with an invalid logType (value: ${t})`);console[r](`[${i}]  ${e.name}:`,...n)};class J{constructor(e){this.name=e,this._logLevel=K,this._logHandler=G,this._userLogHandler=null,W.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in V))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel="string"==typeof e?H[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if("function"!=typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,V.DEBUG,...e),this._logHandler(this,V.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,V.VERBOSE,...e),this._logHandler(this,V.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,V.INFO,...e),this._logHandler(this,V.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,V.WARN,...e),this._logHandler(this,V.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,V.ERROR,...e),this._logHandler(this,V.ERROR,...e)}}class Z{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map((e=>{if(function(e){const t=e.getComponent();return"VERSION"===(null==t?void 0:t.type)}(e)){const t=e.getImmediate();return`${t.library}/${t.version}`}return null})).filter((e=>e)).join(" ")}}const Y="@firebase/app",Q="0.7.10",X=new J("@firebase/app"),ee={[Y]:"fire-core","@firebase/app-compat":"fire-core-compat","@firebase/analytics":"fire-analytics","@firebase/analytics-compat":"fire-analytics-compat","@firebase/app-check":"fire-app-check","@firebase/app-check-compat":"fire-app-check-compat","@firebase/auth":"fire-auth","@firebase/auth-compat":"fire-auth-compat","@firebase/database":"fire-rtdb","@firebase/database-compat":"fire-rtdb-compat","@firebase/functions":"fire-fn","@firebase/functions-compat":"fire-fn-compat","@firebase/installations":"fire-iid","@firebase/installations-compat":"fire-iid-compat","@firebase/messaging":"fire-fcm","@firebase/messaging-compat":"fire-fcm-compat","@firebase/performance":"fire-perf","@firebase/performance-compat":"fire-perf-compat","@firebase/remote-config":"fire-rc","@firebase/remote-config-compat":"fire-rc-compat","@firebase/storage":"fire-gcs","@firebase/storage-compat":"fire-gcs-compat","@firebase/firestore":"fire-fst","@firebase/firestore-compat":"fire-fst-compat","fire-js":"fire-js",firebase:"fire-js-all"},te=new Map,ne=new Map;function ie(e,t){try{e.container.addComponent(t)}catch(n){X.debug(`Component ${t.name} failed to register with FirebaseApp ${e.name}`,n)}}function re(e){const t=e.name;if(ne.has(t))return X.debug(`There were multiple attempts to register component ${t}.`),!1;ne.set(t,e);for(const t of te.values())ie(t,e);return!0}function se(e,t){return e.container.getProvider(t)}const oe=new y("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function."});class ae{constructor(e,t,n){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new F("app",(()=>this),"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw oe.create("app-deleted",{appName:this._name})}}const ce="9.6.0";function le(e="[DEFAULT]"){const t=te.get(e);if(!t)throw oe.create("no-app",{appName:e});return t}function ue(e,t,n){var i;let r=null!==(i=ee[e])&&void 0!==i?i:e;n&&(r+=`-${n}`);const s=r.match(/\s|\//),o=t.match(/\s|\//);if(s||o){const e=[`Unable to register library "${r}" with version "${t}":`];return s&&e.push(`library name "${r}" contains illegal characters (whitespace or "/")`),s&&o&&e.push("and"),o&&e.push(`version name "${t}" contains illegal characters (whitespace or "/")`),void X.warn(e.join(" "))}re(new F(`${r}-version`,(()=>({library:r,version:t})),"VERSION"))}function he(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n}re(new F("platform-logger",(e=>new Z(e)),"PRIVATE")),ue(Y,Q,""),ue(Y,Q,"esm2017"),ue("fire-js",""),ue("firebase","9.6.0","app"),Object.create,Object.create;const de=function(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}},pe=new y("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),fe=new J("@firebase/auth");function _e(e,...t){fe.logLevel<=V.ERROR&&fe.error(`Auth (9.6.0): ${e}`,...t)}function ge(e,...t){throw ye(e,...t)}function me(e,...t){return ye(e,...t)}function ye(e,...t){if("string"!=typeof e){const n=t[0],i=[...t.slice(1)];return i[0]&&(i[0].appName=e.name),e._errorFactory.create(n,...i)}return pe.create(e,...t)}function ve(e,t,...n){if(!e)throw ye(t,...n)}function we(e){const t="INTERNAL ASSERTION FAILED: "+e;throw _e(t),new Error(t)}function be(e,t){e||we(t)}const ke=new Map;function Te(e){be(e instanceof Function,"Expected a class definition");let t=ke.get(e);return t?(be(t instanceof e,"Instance stored in cache mismatched with class"),t):(t=new e,ke.set(e,t),t)}function Ee(){var e;return"undefined"!=typeof self&&(null===(e=self.location)||void 0===e?void 0:e.href)||""}function Ie(){var e;return"undefined"!=typeof self&&(null===(e=self.location)||void 0===e?void 0:e.protocol)||null}class Se{constructor(e,t){this.shortDelay=e,this.longDelay=t,be(t>e,"Short delay should be less than long delay!"),this.isMobile=f()||g()}get(){return"undefined"!=typeof navigator&&navigator&&"onLine"in navigator&&"boolean"==typeof navigator.onLine&&("http:"===Ie()||"https:"===Ie()||_()||"connection"in navigator)&&!navigator.onLine?Math.min(5e3,this.shortDelay):this.isMobile?this.longDelay:this.shortDelay}}function Ce(e,t){be(e.emulator,"Emulator should always be set here");const{url:n}=e.emulator;return t?`${n}${t.startsWith("/")?t.slice(1):t}`:n}class xe{static initialize(e,t,n){this.fetchImpl=e,t&&(this.headersImpl=t),n&&(this.responseImpl=n)}static fetch(){return this.fetchImpl?this.fetchImpl:"undefined"!=typeof self&&"fetch"in self?self.fetch:void we("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:"undefined"!=typeof self&&"Headers"in self?self.Headers:void we("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:"undefined"!=typeof self&&"Response"in self?self.Response:void we("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const Ae={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"internal-error",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error"},Ne=new Se(3e4,6e4);function Pe(e,t){return e.tenantId&&!t.tenantId?Object.assign(Object.assign({},t),{tenantId:e.tenantId}):t}async function Oe(e,t,n,i,r={}){return Re(e,r,(()=>{let r={},s={};i&&("GET"===t?s=i:r={body:JSON.stringify(i)});const o=A(Object.assign({key:e.config.apiKey},s)).slice(1),a=new(xe.headers());return a.set("Content-Type","application/json"),a.set("X-Client-Version",e._getSdkClientVersion()),e.languageCode&&a.set("X-Firebase-Locale",e.languageCode),xe.fetch()(ze(e,e.config.apiHost,n,o),Object.assign({method:t,headers:a,referrerPolicy:"no-referrer"},r))}))}async function Re(e,t,n){e._canInitEmulator=!1;const i=Object.assign(Object.assign({},Ae),t);try{const t=new Me(e),r=await Promise.race([n(),t.promise]);t.clearNetworkTimeout();const s=await r.json();if("needConfirmation"in s)throw Le(e,"account-exists-with-different-credential",s);if(r.ok&&!("errorMessage"in s))return s;{const t=r.ok?s.errorMessage:s.error.message,[n,o]=t.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===n)throw Le(e,"credential-already-in-use",s);if("EMAIL_EXISTS"===n)throw Le(e,"email-already-in-use",s);const a=i[n]||n.toLowerCase().replace(/[_\s]+/g,"-");if(o)throw function(e,t,n){const i=Object.assign(Object.assign({},de()),{[t]:n});return new y("auth","Firebase",i).create(t,{appName:e.name})}(e,a,o);ge(e,a)}}catch(t){if(t instanceof m)throw t;ge(e,"network-request-failed")}}async function De(e,t,n,i,r={}){const s=await Oe(e,t,n,i,r);return"mfaPendingCredential"in s&&ge(e,"multi-factor-auth-required",{_serverResponse:s}),s}function ze(e,t,n,i){const r=`${t}${n}?${i}`;return e.config.emulator?Ce(e.config,r):`${e.config.apiScheme}://${r}`}class Me{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise(((e,t)=>{this.timer=setTimeout((()=>t(me(this.auth,"timeout"))),Ne.get())}))}clearNetworkTimeout(){clearTimeout(this.timer)}}function Le(e,t,n){const i={appName:e.name};n.email&&(i.email=n.email),n.phoneNumber&&(i.phoneNumber=n.phoneNumber);const r=me(e,t,i);return r.customData._tokenResponse=n,r}function Ue(e){if(e)try{const t=new Date(Number(e));if(!isNaN(t.getTime()))return t.toUTCString()}catch(e){}}function Fe(e){return 1e3*Number(e)}function je(e){const[t,n,i]=e.split(".");if(void 0===t||void 0===n||void 0===i)return _e("JWT malformed, contained fewer than 3 sections"),null;try{const e=l(n);return e?JSON.parse(e):(_e("Failed to decode base64 JWT payload"),null)}catch(e){return _e("Caught error parsing JWT payload as JSON",e),null}}async function qe(e,t,n=!1){if(n)return t;try{return await t}catch(t){throw t instanceof m&&function({code:e}){return"auth/user-disabled"===e||"auth/user-token-expired"===e}(t)&&e.auth.currentUser===e&&await e.auth.signOut(),t}}class Be{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const e=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),e}{this.errorBackoff=3e4;const e=(null!==(t=this.user.stsTokenManager.expirationTime)&&void 0!==t?t:0)-Date.now()-3e5;return Math.max(0,e)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout((async()=>{await this.iteration()}),t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){return void("auth/network-request-failed"===e.code&&this.schedule(!0))}this.schedule()}}class We{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Ue(this.lastLoginAt),this.creationTime=Ue(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function Ve(e){var t;const n=e.auth,i=await e.getIdToken(),r=await qe(e,async function(e,t){return Oe(e,"POST","/v1/accounts:lookup",t)}(n,{idToken:i}));ve(null==r?void 0:r.users.length,n,"internal-error");const s=r.users[0];e._notifyReloadListener(s);const o=(null===(t=s.providerUserInfo)||void 0===t?void 0:t.length)?s.providerUserInfo.map((e=>{var{providerId:t}=e,n=he(e,["providerId"]);return{providerId:t,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}})):[],a=(c=e.providerData,l=o,[...c.filter((e=>!l.some((t=>t.providerId===e.providerId)))),...l]);var c,l;const u=e.isAnonymous,h=!(e.email&&s.passwordHash||(null==a?void 0:a.length)),d=!!u&&h,p={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:a,metadata:new We(s.createdAt,s.lastLoginAt),isAnonymous:d};Object.assign(e,p)}class He{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){ve(e.idToken,"internal-error"),ve(void 0!==e.idToken,"internal-error"),ve(void 0!==e.refreshToken,"internal-error");const t="expiresIn"in e&&void 0!==e.expiresIn?Number(e.expiresIn):function(e){const t=je(e);return ve(t,"internal-error"),ve(void 0!==t.exp,"internal-error"),ve(void 0!==t.iat,"internal-error"),Number(t.exp)-Number(t.iat)}(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}async getToken(e,t=!1){return ve(!this.accessToken||this.refreshToken,e,"user-token-expired"),t||!this.accessToken||this.isExpired?this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null:this.accessToken}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:n,refreshToken:i,expiresIn:r}=await async function(e,t){const n=await Re(e,{},(()=>{const n=A({grant_type:"refresh_token",refresh_token:t}).slice(1),{tokenApiHost:i,apiKey:r}=e.config,s=ze(e,i,"/v1/token",`key=${r}`);return xe.fetch()(s,{method:"POST",headers:{"X-Client-Version":e._getSdkClientVersion(),"Content-Type":"application/x-www-form-urlencoded"},body:n})}));return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}(e,t);this.updateTokensAndExpiration(n,i,Number(r))}updateTokensAndExpiration(e,t,n){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+1e3*n}static fromJSON(e,t){const{refreshToken:n,accessToken:i,expirationTime:r}=t,s=new He;return n&&(ve("string"==typeof n,"internal-error",{appName:e}),s.refreshToken=n),i&&(ve("string"==typeof i,"internal-error",{appName:e}),s.accessToken=i),r&&(ve("number"==typeof r,"internal-error",{appName:e}),s.expirationTime=r),s}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new He,this.toJSON())}_performRefresh(){return we("not implemented")}}function Ke(e,t){ve("string"==typeof e||void 0===e,"internal-error",{appName:t})}class $e{constructor(e){var{uid:t,auth:n,stsTokenManager:i}=e,r=he(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.emailVerified=!1,this.isAnonymous=!1,this.tenantId=null,this.providerData=[],this.proactiveRefresh=new Be(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=n,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=r.displayName||null,this.email=r.email||null,this.emailVerified=r.emailVerified||!1,this.phoneNumber=r.phoneNumber||null,this.photoURL=r.photoURL||null,this.isAnonymous=r.isAnonymous||!1,this.tenantId=r.tenantId||null,this.metadata=new We(r.createdAt||void 0,r.lastLoginAt||void 0)}async getIdToken(e){const t=await qe(this,this.stsTokenManager.getToken(this.auth,e));return ve(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return async function(e,t=!1){const n=U(e),i=await n.getIdToken(t),r=je(i);ve(r&&r.exp&&r.auth_time&&r.iat,n.auth,"internal-error");const s="object"==typeof r.firebase?r.firebase:void 0,o=null==s?void 0:s.sign_in_provider;return{claims:r,token:i,authTime:Ue(Fe(r.auth_time)),issuedAtTime:Ue(Fe(r.iat)),expirationTime:Ue(Fe(r.exp)),signInProvider:o||null,signInSecondFactor:(null==s?void 0:s.sign_in_second_factor)||null}}(this,e)}reload(){return async function(e){const t=U(e);await Ve(t),await t.auth._persistUserIfCurrent(t),t.auth._notifyListenersIfCurrent(t)}(this)}_assign(e){this!==e&&(ve(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map((e=>Object.assign({},e))),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){return new $e(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}))}_onReload(e){ve(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),t&&await Ve(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){const e=await this.getIdToken();return await qe(this,async function(e,t){return Oe(e,"POST","/v1/accounts:delete",t)}(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map((e=>Object.assign({},e))),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var n,i,r,s,o,a,c,l;const u=null!==(n=t.displayName)&&void 0!==n?n:void 0,h=null!==(i=t.email)&&void 0!==i?i:void 0,d=null!==(r=t.phoneNumber)&&void 0!==r?r:void 0,p=null!==(s=t.photoURL)&&void 0!==s?s:void 0,f=null!==(o=t.tenantId)&&void 0!==o?o:void 0,_=null!==(a=t._redirectEventId)&&void 0!==a?a:void 0,g=null!==(c=t.createdAt)&&void 0!==c?c:void 0,m=null!==(l=t.lastLoginAt)&&void 0!==l?l:void 0,{uid:y,emailVerified:v,isAnonymous:w,providerData:b,stsTokenManager:k}=t;ve(y&&k,e,"internal-error");const T=He.fromJSON(this.name,k);ve("string"==typeof y,e,"internal-error"),Ke(u,e.name),Ke(h,e.name),ve("boolean"==typeof v,e,"internal-error"),ve("boolean"==typeof w,e,"internal-error"),Ke(d,e.name),Ke(p,e.name),Ke(f,e.name),Ke(_,e.name),Ke(g,e.name),Ke(m,e.name);const E=new $e({uid:y,auth:e,email:h,emailVerified:v,displayName:u,isAnonymous:w,photoURL:p,phoneNumber:d,tenantId:f,stsTokenManager:T,createdAt:g,lastLoginAt:m});return b&&Array.isArray(b)&&(E.providerData=b.map((e=>Object.assign({},e)))),_&&(E._redirectEventId=_),E}static async _fromIdTokenResponse(e,t,n=!1){const i=new He;i.updateFromServerResponse(t);const r=new $e({uid:t.localId,auth:e,stsTokenManager:i,isAnonymous:n});return await Ve(r),r}}class Ge{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return void 0===t?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}Ge.type="NONE";const Je=Ge;function Ze(e,t,n){return`firebase:${e}:${t}:${n}`}class Ye{constructor(e,t,n){this.persistence=e,this.auth=t,this.userKey=n;const{config:i,name:r}=this.auth;this.fullUserKey=Ze(this.userKey,i.apiKey,r),this.fullPersistenceKey=Ze("persistence",i.apiKey,r),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?$e._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();return await this.removeCurrentUser(),this.persistence=e,t?this.setCurrentUser(t):void 0}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,n="authUser"){if(!t.length)return new Ye(Te(Je),e,n);const i=(await Promise.all(t.map((async e=>{if(await e._isAvailable())return e})))).filter((e=>e));let r=i[0]||Te(Je);const s=Ze(n,e.config.apiKey,e.name);let o=null;for(const n of t)try{const t=await n._get(s);if(t){const i=$e._fromJSON(e,t);n!==r&&(o=i),r=n;break}}catch(e){}const a=i.filter((e=>e._shouldAllowMigration));return r._shouldAllowMigration&&a.length?(r=a[0],o&&await r._set(s,o.toJSON()),await Promise.all(t.map((async e=>{if(e!==r)try{await e._remove(s)}catch(e){}}))),new Ye(r,e,n)):new Ye(r,e,n)}}function Qe(e){const t=e.toLowerCase();if(t.includes("opera/")||t.includes("opr/")||t.includes("opios/"))return"Opera";if(nt(t))return"IEMobile";if(t.includes("msie")||t.includes("trident/"))return"IE";if(t.includes("edge/"))return"Edge";if(Xe(t))return"Firefox";if(t.includes("silk/"))return"Silk";if(rt(t))return"Blackberry";if(st(t))return"Webos";if(et(t))return"Safari";if((t.includes("chrome/")||tt(t))&&!t.includes("edge/"))return"Chrome";if(it(t))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=e.match(t);if(2===(null==n?void 0:n.length))return n[1]}return"Other"}function Xe(e=p()){return/firefox\//i.test(e)}function et(e=p()){const t=e.toLowerCase();return t.includes("safari/")&&!t.includes("chrome/")&&!t.includes("crios/")&&!t.includes("android")}function tt(e=p()){return/crios\//i.test(e)}function nt(e=p()){return/iemobile/i.test(e)}function it(e=p()){return/android/i.test(e)}function rt(e=p()){return/blackberry/i.test(e)}function st(e=p()){return/webos/i.test(e)}function ot(e=p()){return/iphone|ipad|ipod/i.test(e)}function at(e=p()){return ot(e)||it(e)||st(e)||rt(e)||/windows phone/i.test(e)||nt(e)}function ct(e,t=[]){let n;switch(e){case"Browser":n=Qe(p());break;case"Worker":n=`${Qe(p())}-${e}`;break;default:n=e}return`${n}/JsCore/9.6.0/${t.length?t.join(","):"FirebaseCore-web"}`}class lt{constructor(e,t){this.app=e,this.config=t,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new ht(this),this.idTokenSubscription=new ht(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=pe,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=t.sdkClientVersion}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Te(t)),this._initializationPromise=this.queue((async()=>{var n,i;this._deleted||(this.persistenceManager=await Ye.create(this,e),this._deleted||((null===(n=this._popupRedirectResolver)||void 0===n?void 0:n._shouldInitProactively)&&await this._popupRedirectResolver._initialize(this),await this.initializeCurrentUser(t),this.lastNotifiedUid=(null===(i=this.currentUser)||void 0===i?void 0:i.uid)||null,this._deleted||(this._isInitialized=!0)))})),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();return this.currentUser||e?this.currentUser&&e&&this.currentUser.uid===e.uid?(this._currentUser._assign(e),void await this.currentUser.getIdToken()):void await this._updateCurrentUser(e):void 0}async initializeCurrentUser(e){var t;let n=await this.assertedPersistence.getCurrentUser();if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const i=null===(t=this.redirectUser)||void 0===t?void 0:t._redirectEventId,r=null==n?void 0:n._redirectEventId,s=await this.tryRedirectSignIn(e);i&&i!==r||!(null==s?void 0:s.user)||(n=s.user)}return n?n._redirectEventId?(ve(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===n._redirectEventId?this.directlySetCurrentUser(n):this.reloadAndSetCurrentUserOrClear(n)):this.reloadAndSetCurrentUserOrClear(n):this.directlySetCurrentUser(null)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch(e){await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await Ve(e)}catch(e){if("auth/network-request-failed"!==e.code)return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=function(){if("undefined"==typeof navigator)return null;const e=navigator;return e.languages&&e.languages[0]||e.language||null}()}async _delete(){this._deleted=!0}async updateCurrentUser(e){const t=e?U(e):null;return t&&ve(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e){if(!this._deleted)return e&&ve(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),this.queue((async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()}))}async signOut(){return(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null)}setPersistence(e){return this.queue((async()=>{await this.assertedPersistence.setPersistence(Te(e))}))}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new y("auth","Firebase",e())}onAuthStateChanged(e,t,n){return this.registerStateListener(this.authStateSubscription,e,t,n)}onIdTokenChanged(e,t,n){return this.registerStateListener(this.idTokenSubscription,e,t,n)}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(e=this._currentUser)||void 0===e?void 0:e.toJSON()}}async _setRedirectUser(e,t){const n=await this.getOrInitRedirectPersistenceManager(t);return null===e?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&Te(e)||this._popupRedirectResolver;ve(t,this,"argument-error"),this.redirectPersistenceManager=await Ye.create(this,[Te(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,n;return this._isInitialized&&await this.queue((async()=>{})),(null===(t=this._currentUser)||void 0===t?void 0:t._redirectEventId)===e?this._currentUser:(null===(n=this.redirectUser)||void 0===n?void 0:n._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue((async()=>this.directlySetCurrentUser(e)))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=null!==(t=null===(e=this.currentUser)||void 0===e?void 0:e.uid)&&void 0!==t?t:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,n,i){if(this._deleted)return()=>{};const r="function"==typeof t?t:t.next.bind(t),s=this._isInitialized?Promise.resolve():this._initializationPromise;return ve(s,this,"internal-error"),s.then((()=>r(this.currentUser))),"function"==typeof t?e.addObserver(t,n,i):e.addObserver(t)}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&(this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh()),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return ve(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){e&&!this.frameworks.includes(e)&&(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=ct(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}_getSdkClientVersion(){return this.clientVersion}}function ut(e){return U(e)}class ht{constructor(e){this.auth=e,this.observer=null,this.addObserver=function(e,t){const n=new R(e,void 0);return n.subscribe.bind(n)}((e=>this.observer=e))}get next(){return ve(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}class dt{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return we("not implemented")}_getIdTokenResponse(e){return we("not implemented")}_linkToIdToken(e,t){return we("not implemented")}_getReauthenticationResolver(e){return we("not implemented")}}class pt extends dt{constructor(e,t,n,i=null){super("password",n),this._email=e,this._password=t,this._tenantId=i}static _fromEmailAndPassword(e,t){return new pt(e,t,"password")}static _fromEmailAndCode(e,t,n=null){return new pt(e,t,"emailLink",n)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t="string"==typeof e?JSON.parse(e):e;if((null==t?void 0:t.email)&&(null==t?void 0:t.password)){if("password"===t.signInMethod)return this._fromEmailAndPassword(t.email,t.password);if("emailLink"===t.signInMethod)return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":return async function(e,t){return De(e,"POST","/v1/accounts:signInWithPassword",Pe(e,t))}(e,{returnSecureToken:!0,email:this._email,password:this._password});case"emailLink":return async function(e,t){return De(e,"POST","/v1/accounts:signInWithEmailLink",Pe(e,t))}(e,{email:this._email,oobCode:this._password});default:ge(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":return async function(e,t){return Oe(e,"POST","/v1/accounts:update",t)}(e,{idToken:t,returnSecureToken:!0,email:this._email,password:this._password});case"emailLink":return async function(e,t){return De(e,"POST","/v1/accounts:signInWithEmailLink",Pe(e,t))}(e,{idToken:t,email:this._email,oobCode:this._password});default:ge(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function ft(e,t){return De(e,"POST","/v1/accounts:signInWithIdp",Pe(e,t))}class _t extends dt{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new _t(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):ge("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t="string"==typeof e?JSON.parse(e):e,{providerId:n,signInMethod:i}=t,r=he(t,["providerId","signInMethod"]);if(!n||!i)return null;const s=new _t(n,i);return s.idToken=r.idToken||void 0,s.accessToken=r.accessToken||void 0,s.secret=r.secret,s.nonce=r.nonce,s.pendingToken=r.pendingToken||null,s}_getIdTokenResponse(e){return ft(e,this.buildRequest())}_linkToIdToken(e,t){const n=this.buildRequest();return n.idToken=t,ft(e,n)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,ft(e,t)}buildRequest(){const e={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=A(t)}return e}}const gt={USER_NOT_FOUND:"user-not-found"};class mt extends dt{constructor(e){super("phone","phone"),this.params=e}static _fromVerification(e,t){return new mt({verificationId:e,verificationCode:t})}static _fromTokenResponse(e,t){return new mt({phoneNumber:e,temporaryProof:t})}_getIdTokenResponse(e){return async function(e,t){return De(e,"POST","/v1/accounts:signInWithPhoneNumber",Pe(e,t))}(e,this._makeVerificationRequest())}_linkToIdToken(e,t){return async function(e,t){const n=await De(e,"POST","/v1/accounts:signInWithPhoneNumber",Pe(e,t));if(n.temporaryProof)throw Le(e,"account-exists-with-different-credential",n);return n}(e,Object.assign({idToken:t},this._makeVerificationRequest()))}_getReauthenticationResolver(e){return async function(e,t){return De(e,"POST","/v1/accounts:signInWithPhoneNumber",Pe(e,Object.assign(Object.assign({},t),{operation:"REAUTH"})),gt)}(e,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:e,phoneNumber:t,verificationId:n,verificationCode:i}=this.params;return e&&t?{temporaryProof:e,phoneNumber:t}:{sessionInfo:n,code:i}}toJSON(){const e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}static fromJSON(e){"string"==typeof e&&(e=JSON.parse(e));const{verificationId:t,verificationCode:n,phoneNumber:i,temporaryProof:r}=e;return n||t||i||r?new mt({verificationId:t,verificationCode:n,phoneNumber:i,temporaryProof:r}):null}}class yt{constructor(e){var t,n,i,r,s,o;const a=N(P(e)),c=null!==(t=a.apiKey)&&void 0!==t?t:null,l=null!==(n=a.oobCode)&&void 0!==n?n:null,u=function(e){switch(e){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(i=a.mode)&&void 0!==i?i:null);ve(c&&l&&u,"argument-error"),this.apiKey=c,this.operation=u,this.code=l,this.continueUrl=null!==(r=a.continueUrl)&&void 0!==r?r:null,this.languageCode=null!==(s=a.languageCode)&&void 0!==s?s:null,this.tenantId=null!==(o=a.tenantId)&&void 0!==o?o:null}static parseLink(e){const t=function(e){const t=N(P(e)).link,n=t?N(P(t)).deep_link_id:null,i=N(P(e)).deep_link_id;return(i?N(P(i)).link:null)||i||n||t||e}(e);try{return new yt(t)}catch(e){return null}}}class vt{constructor(){this.providerId=vt.PROVIDER_ID}static credential(e,t){return pt._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const n=yt.parseLink(t);return ve(n,"argument-error"),pt._fromEmailAndCode(e,n.code,n.tenantId)}}vt.PROVIDER_ID="password",vt.EMAIL_PASSWORD_SIGN_IN_METHOD="password",vt.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class wt{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class bt extends wt{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class kt extends bt{constructor(){super("facebook.com")}static credential(e){return _t._fromParams({providerId:kt.PROVIDER_ID,signInMethod:kt.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return kt.credentialFromTaggedObject(e)}static credentialFromError(e){return kt.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e))return null;if(!e.oauthAccessToken)return null;try{return kt.credential(e.oauthAccessToken)}catch(e){return null}}}kt.FACEBOOK_SIGN_IN_METHOD="facebook.com",kt.PROVIDER_ID="facebook.com";class Tt extends bt{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return _t._fromParams({providerId:Tt.PROVIDER_ID,signInMethod:Tt.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Tt.credentialFromTaggedObject(e)}static credentialFromError(e){return Tt.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:n}=e;if(!t&&!n)return null;try{return Tt.credential(t,n)}catch(e){return null}}}Tt.GOOGLE_SIGN_IN_METHOD="google.com",Tt.PROVIDER_ID="google.com";class Et extends bt{constructor(){super("github.com")}static credential(e){return _t._fromParams({providerId:Et.PROVIDER_ID,signInMethod:Et.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Et.credentialFromTaggedObject(e)}static credentialFromError(e){return Et.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e))return null;if(!e.oauthAccessToken)return null;try{return Et.credential(e.oauthAccessToken)}catch(e){return null}}}Et.GITHUB_SIGN_IN_METHOD="github.com",Et.PROVIDER_ID="github.com";class It extends bt{constructor(){super("twitter.com")}static credential(e,t){return _t._fromParams({providerId:It.PROVIDER_ID,signInMethod:It.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return It.credentialFromTaggedObject(e)}static credentialFromError(e){return It.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:n}=e;if(!t||!n)return null;try{return It.credential(t,n)}catch(e){return null}}}It.TWITTER_SIGN_IN_METHOD="twitter.com",It.PROVIDER_ID="twitter.com";class St{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,n,i=!1){const r=await $e._fromIdTokenResponse(e,n,i),s=Ct(n);return new St({user:r,providerId:s,_tokenResponse:n,operationType:t})}static async _forOperation(e,t,n){await e._updateTokensIfNecessary(n,!0);const i=Ct(n);return new St({user:e,providerId:i,_tokenResponse:n,operationType:t})}}function Ct(e){return e.providerId?e.providerId:"phoneNumber"in e?"phone":null}class xt extends m{constructor(e,t,n,i){var r;super(t.code,t.message),this.operationType=n,this.user=i,Object.setPrototypeOf(this,xt.prototype),this.customData={appName:e.name,tenantId:null!==(r=e.tenantId)&&void 0!==r?r:void 0,_serverResponse:t.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,t,n,i){return new xt(e,t,n,i)}}function At(e,t,n,i){return("reauthenticate"===t?n._getReauthenticationResolver(e):n._getIdTokenResponse(e)).catch((n=>{if("auth/multi-factor-auth-required"===n.code)throw xt._fromErrorAndOperation(e,n,t,i);throw n}))}new WeakMap;const Nt="__sak";class Pt{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Nt,"1"),this.storage.removeItem(Nt),Promise.resolve(!0)):Promise.resolve(!1)}catch(e){return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}class Ot extends Pt{constructor(){super((()=>window.localStorage),"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=function(){const e=p();return et(e)||ot(e)}()&&function(){try{return!(!window||window===window.top)}catch(e){return!1}}(),this.fallbackToPolling=at(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const n=this.storage.getItem(t),i=this.localCache[t];n!==i&&e(t,i,n)}}onStorageEvent(e,t=!1){if(!e.key)return void this.forAllChangedKeys(((e,t,n)=>{this.notifyListeners(e,n)}));const n=e.key;if(t?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){const i=this.storage.getItem(n);if(e.newValue!==i)null!==e.newValue?this.storage.setItem(n,e.newValue):this.storage.removeItem(n);else if(this.localCache[n]===e.newValue&&!t)return}const i=()=>{const e=this.storage.getItem(n);(t||this.localCache[n]!==e)&&this.notifyListeners(n,e)},r=this.storage.getItem(n);!function(){const e=p();return e.indexOf("MSIE ")>=0||e.indexOf("Trident/")>=0}()||10!==document.documentMode||r===e.newValue||e.newValue===e.oldValue?i():setTimeout(i,10)}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const e of Array.from(n))e(t?JSON.parse(t):t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval((()=>{this.forAllChangedKeys(((e,t,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:n}),!0)}))}),1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}Ot.type="LOCAL";const Rt=Ot;class Dt extends Pt{constructor(){super((()=>window.sessionStorage),"SESSION")}_addListener(e,t){}_removeListener(e,t){}}Dt.type="SESSION";const zt=Dt;class Mt{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find((t=>t.isListeningto(e)));if(t)return t;const n=new Mt(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:n,eventType:i,data:r}=t.data,s=this.handlersMap[i];if(!(null==s?void 0:s.size))return;t.ports[0].postMessage({status:"ack",eventId:n,eventType:i});const o=Array.from(s).map((async e=>e(t.origin,r))),a=await function(e){return Promise.all(e.map((async e=>{try{return{fulfilled:!0,value:await e}}catch(e){return{fulfilled:!1,reason:e}}})))}(o);t.ports[0].postMessage({status:"done",eventId:n,eventType:i,response:a})}_subscribe(e,t){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),t&&0!==this.handlersMap[e].size||delete this.handlersMap[e],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}function Lt(e="",t=10){let n="";for(let e=0;e<t;e++)n+=Math.floor(10*Math.random());return e+n}Mt.receivers=[];class Ut{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,n=50){const i="undefined"!=typeof MessageChannel?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let r,s;return new Promise(((o,a)=>{const c=Lt("",20);i.port1.start();const l=setTimeout((()=>{a(new Error("unsupported_event"))}),n);s={messageChannel:i,onMessage(e){const t=e;if(t.data.eventId===c)switch(t.data.status){case"ack":clearTimeout(l),r=setTimeout((()=>{a(new Error("timeout"))}),3e3);break;case"done":clearTimeout(r),o(t.data.response);break;default:clearTimeout(l),clearTimeout(r),a(new Error("invalid_response"))}}},this.handlers.add(s),i.port1.addEventListener("message",s.onMessage),this.target.postMessage({eventType:e,eventId:c,data:t},[i.port2])})).finally((()=>{s&&this.removeMessageHandler(s)}))}}function Ft(){return window}function jt(){return void 0!==Ft().WorkerGlobalScope&&"function"==typeof Ft().importScripts}const qt="firebaseLocalStorageDb",Bt="firebaseLocalStorage",Wt="fbase_key";class Vt{constructor(e){this.request=e}toPromise(){return new Promise(((e,t)=>{this.request.addEventListener("success",(()=>{e(this.request.result)})),this.request.addEventListener("error",(()=>{t(this.request.error)}))}))}}function Ht(e,t){return e.transaction([Bt],t?"readwrite":"readonly").objectStore(Bt)}function Kt(){const e=indexedDB.open(qt,1);return new Promise(((t,n)=>{e.addEventListener("error",(()=>{n(e.error)})),e.addEventListener("upgradeneeded",(()=>{const t=e.result;try{t.createObjectStore(Bt,{keyPath:Wt})}catch(e){n(e)}})),e.addEventListener("success",(async()=>{const n=e.result;n.objectStoreNames.contains(Bt)?t(n):(n.close(),await function(){const e=indexedDB.deleteDatabase(qt);return new Vt(e).toPromise()}(),t(await Kt()))}))}))}async function $t(e,t,n){const i=Ht(e,!0).put({[Wt]:t,value:n});return new Vt(i).toPromise()}function Gt(e,t){const n=Ht(e,!0).delete(t);return new Vt(n).toPromise()}class Jt{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then((()=>{}),(()=>{}))}async _openDb(){return this.db||(this.db=await Kt()),this.db}async _withRetries(e){let t=0;for(;;)try{const t=await this._openDb();return await e(t)}catch(e){if(t++>3)throw e;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return jt()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Mt._getInstance(jt()?self:null),this.receiver._subscribe("keyChanged",(async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)}))),this.receiver._subscribe("ping",(async(e,t)=>["keyChanged"]))}async initializeSender(){var e,t;if(this.activeServiceWorker=await async function(){if(!(null===navigator||void 0===navigator?void 0:navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch(e){return null}}(),!this.activeServiceWorker)return;this.sender=new Ut(this.activeServiceWorker);const n=await this.sender._send("ping",{},800);n&&(null===(e=n[0])||void 0===e?void 0:e.fulfilled)&&(null===(t=n[0])||void 0===t?void 0:t.value.includes("keyChanged"))&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){var t;if(this.sender&&this.activeServiceWorker&&((null===(t=null===navigator||void 0===navigator?void 0:navigator.serviceWorker)||void 0===t?void 0:t.controller)||null)===this.activeServiceWorker)try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch(t){}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Kt();return await $t(e,Nt,"1"),await Gt(e,Nt),!0}catch(e){}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite((async()=>(await this._withRetries((n=>$t(n,e,t))),this.localCache[e]=t,this.notifyServiceWorker(e))))}async _get(e){const t=await this._withRetries((t=>async function(e,t){const n=Ht(e,!1).get(t),i=await new Vt(n).toPromise();return void 0===i?null:i.value}(t,e)));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite((async()=>(await this._withRetries((t=>Gt(t,e))),delete this.localCache[e],this.notifyServiceWorker(e))))}async _poll(){const e=await this._withRetries((e=>{const t=Ht(e,!1).getAll();return new Vt(t).toPromise()}));if(!e)return[];if(0!==this.pendingWrites)return[];const t=[],n=new Set;for(const{fbase_key:i,value:r}of e)n.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(r)&&(this.notifyListeners(i,r),t.push(i));for(const e of Object.keys(this.localCache))this.localCache[e]&&!n.has(e)&&(this.notifyListeners(e,null),t.push(e));return t}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const e of Array.from(n))e(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval((async()=>this._poll()),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&this.stopPolling()}}Jt.type="LOCAL";const Zt=Jt;function Yt(e){return`__${e}${Math.floor(1e6*Math.random())}`}Yt("rcb"),new Se(3e4,6e4);class Qt{constructor(e){this.providerId=Qt.PROVIDER_ID,this.auth=ut(e)}verifyPhoneNumber(e,t){return async function(e,t,n){var i;const r=await n.verify();try{let s;if(ve("string"==typeof r,e,"argument-error"),ve("recaptcha"===n.type,e,"argument-error"),s="string"==typeof t?{phoneNumber:t}:t,"session"in s){const t=s.session;if("phoneNumber"in s){ve("enroll"===t.type,e,"internal-error");const n=await function(e,t){return Oe(e,"POST","/v2/accounts/mfaEnrollment:start",Pe(e,t))}(e,{idToken:t.credential,phoneEnrollmentInfo:{phoneNumber:s.phoneNumber,recaptchaToken:r}});return n.phoneSessionInfo.sessionInfo}{ve("signin"===t.type,e,"internal-error");const n=(null===(i=s.multiFactorHint)||void 0===i?void 0:i.uid)||s.multiFactorUid;ve(n,e,"missing-multi-factor-info");const o=await function(e,t){return Oe(e,"POST","/v2/accounts/mfaSignIn:start",Pe(e,t))}(e,{mfaPendingCredential:t.credential,mfaEnrollmentId:n,phoneSignInInfo:{recaptchaToken:r}});return o.phoneResponseInfo.sessionInfo}}{const{sessionInfo:t}=await async function(e,t){return Oe(e,"POST","/v1/accounts:sendVerificationCode",Pe(e,t))}(e,{phoneNumber:s.phoneNumber,recaptchaToken:r});return t}}finally{n._reset()}}(this.auth,e,U(t))}static credential(e,t){return mt._fromVerification(e,t)}static credentialFromResult(e){const t=e;return Qt.credentialFromTaggedObject(t)}static credentialFromError(e){return Qt.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{phoneNumber:t,temporaryProof:n}=e;return t&&n?mt._fromTokenResponse(t,n):null}}Qt.PROVIDER_ID="phone",Qt.PHONE_SIGN_IN_METHOD="phone";class Xt extends dt{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return ft(e,this._buildIdpRequest())}_linkToIdToken(e,t){return ft(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return ft(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function en(e){return async function(e,t,n=!1){const i="signIn",r=await At(e,i,t),s=await St._fromIdTokenResponse(e,i,r);return n||await e._updateCurrentUser(s.user),s}(e.auth,new Xt(e),e.bypassAuthState)}function tn(e){const{auth:t,user:n}=e;return ve(n,t,"internal-error"),async function(e,t,n=!1){const{auth:i}=e,r="reauthenticate";try{const s=await qe(e,At(i,r,t,e),n);ve(s.idToken,i,"internal-error");const o=je(s.idToken);ve(o,i,"internal-error");const{sub:a}=o;return ve(e.uid===a,i,"user-mismatch"),St._forOperation(e,r,s)}catch(e){throw"auth/user-not-found"===(null==e?void 0:e.code)&&ge(i,"user-mismatch"),e}}(n,new Xt(e),e.bypassAuthState)}async function nn(e){const{auth:t,user:n}=e;return ve(n,t,"internal-error"),async function(e,t,n=!1){const i=await qe(e,t._linkToIdToken(e.auth,await e.getIdToken()),n);return St._forOperation(e,"link",i)}(n,new Xt(e),e.bypassAuthState)}class rn{constructor(e,t,n,i,r=!1){this.auth=e,this.resolver=n,this.user=i,this.bypassAuthState=r,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise((async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(e){this.reject(e)}}))}async onAuthEvent(e){const{urlResponse:t,sessionId:n,postBody:i,tenantId:r,error:s,type:o}=e;if(s)return void this.reject(s);const a={auth:this.auth,requestUri:t,sessionId:n,tenantId:r||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(o)(a))}catch(e){this.reject(e)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return en;case"linkViaPopup":case"linkViaRedirect":return nn;case"reauthViaPopup":case"reauthViaRedirect":return tn;default:ge(this.auth,"internal-error")}}resolve(e){be(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){be(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const sn=new Se(2e3,1e4);class on extends rn{constructor(e,t,n,i,r){super(e,t,i,r),this.provider=n,this.authWindow=null,this.pollId=null,on.currentPopupAction&&on.currentPopupAction.cancel(),on.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return ve(e,this.auth,"internal-error"),e}async onExecution(){be(1===this.filter.length,"Popup operations only handle one event");const e=Lt();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch((e=>{this.reject(e)})),this.resolver._isIframeWebStorageSupported(this.auth,(e=>{e||this.reject(me(this.auth,"web-storage-unsupported"))})),this.pollUserCancellation()}get eventId(){var e;return(null===(e=this.authWindow)||void 0===e?void 0:e.associatedEvent)||null}cancel(){this.reject(me(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,on.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,n;(null===(n=null===(t=this.authWindow)||void 0===t?void 0:t.window)||void 0===n?void 0:n.closed)?this.pollId=window.setTimeout((()=>{this.pollId=null,this.reject(me(this.auth,"popup-closed-by-user"))}),2e3):this.pollId=window.setTimeout(e,sn.get())};e()}}on.currentPopupAction=null;const an=new Map;class cn extends rn{constructor(e,t,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,n),this.eventId=null}async execute(){let e=an.get(this.auth._key());if(!e){try{const t=await async function(e,t){const n=function(e){return Ze("pendingRedirect",e.config.apiKey,e.name)}(t),i=function(e){return Te(e._redirectPersistence)}(e);if(!await i._isAvailable())return!1;const r="true"===await i._get(n);return await i._remove(n),r}(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(t)}catch(t){e=()=>Promise.reject(t)}an.set(this.auth._key(),e)}return this.bypassAuthState||an.set(this.auth._key(),(()=>Promise.resolve(null))),e()}async onAuthEvent(e){if("signInViaRedirect"===e.type)return super.onAuthEvent(e);if("unknown"!==e.type){if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}else this.resolve(null)}async onExecution(){}cleanUp(){}}async function ln(e,t,n=!1){const i=ut(e),r=function(e,t){return t?Te(t):(ve(e._popupRedirectResolver,e,"argument-error"),e._popupRedirectResolver)}(i,t),s=new cn(i,r,n),o=await s.execute();return o&&!n&&(delete o.user._redirectEventId,await i._persistUserIfCurrent(o.user),await i._setRedirectUser(null,t)),o}class un{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach((n=>{this.isEventForConsumer(e,n)&&(t=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))})),this.hasHandledPotentialRedirect||!function(e){switch(e.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return dn(e);default:return!1}}(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var n;if(e.error&&!dn(e)){const i=(null===(n=e.error.code)||void 0===n?void 0:n.split("auth/")[1])||"internal-error";t.onError(me(this.auth,i))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const n=null===t.eventId||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(hn(e))}saveEventToCache(e){this.cachedEventUids.add(hn(e)),this.lastProcessedEventTime=Date.now()}}function hn(e){return[e.type,e.eventId,e.sessionId,e.tenantId].filter((e=>e)).join("-")}function dn({type:e,error:t}){return"unknown"===e&&"auth/no-auth-event"===(null==t?void 0:t.code)}const pn=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,fn=/^https?/;function _n(e){const t=Ee(),{protocol:n,hostname:i}=new URL(t);if(e.startsWith("chrome-extension://")){const r=new URL(e);return""===r.hostname&&""===i?"chrome-extension:"===n&&e.replace("chrome-extension://","")===t.replace("chrome-extension://",""):"chrome-extension:"===n&&r.hostname===i}if(!fn.test(n))return!1;if(pn.test(e))return i===e;const r=e.replace(/\./g,"\\.");return new RegExp("^(.+\\."+r+"|"+r+")$","i").test(i)}const gn=new Se(3e4,6e4);function mn(){const e=Ft().___jsl;if(null==e?void 0:e.H)for(const t of Object.keys(e.H))if(e.H[t].r=e.H[t].r||[],e.H[t].L=e.H[t].L||[],e.H[t].r=[...e.H[t].L],e.CP)for(let t=0;t<e.CP.length;t++)e.CP[t]=null}let yn=null;function vn(e){return yn=yn||function(e){return new Promise(((t,n)=>{var i,r,s,o;function a(){mn(),gapi.load("gapi.iframes",{callback:()=>{t(gapi.iframes.getContext())},ontimeout:()=>{mn(),n(me(e,"network-request-failed"))},timeout:gn.get()})}if(null===(r=null===(i=Ft().gapi)||void 0===i?void 0:i.iframes)||void 0===r?void 0:r.Iframe)t(gapi.iframes.getContext());else{if(!(null===(s=Ft().gapi)||void 0===s?void 0:s.load)){const t=Yt("iframefcb");return Ft()[t]=()=>{gapi.load?a():n(me(e,"network-request-failed"))},o=`https://apis.google.com/js/api.js?onload=${t}`,new Promise(((e,t)=>{const n=document.createElement("script");var i,r;n.setAttribute("src",o),n.onload=e,n.onerror=e=>{const n=me("internal-error");n.customData=e,t(n)},n.type="text/javascript",n.charset="UTF-8",(null!==(r=null===(i=document.getElementsByTagName("head"))||void 0===i?void 0:i[0])&&void 0!==r?r:document).appendChild(n)}))}a()}})).catch((e=>{throw yn=null,e}))}(e),yn}const wn=new Se(5e3,15e3),bn={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},kn=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function Tn(e){const t=e.config;ve(t.authDomain,e,"auth-domain-config-required");const n=t.emulator?Ce(t,"emulator/auth/iframe"):`https://${e.config.authDomain}/__/auth/iframe`,i={apiKey:t.apiKey,appName:e.name,v:ce},r=kn.get(e.config.apiHost);r&&(i.eid=r);const s=e._getFrameworks();return s.length&&(i.fw=s.join(",")),`${n}?${A(i).slice(1)}`}const En={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};class In{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch(e){}}}function Sn(e,t,n,i,r,s){ve(e.config.authDomain,e,"auth-domain-config-required"),ve(e.config.apiKey,e,"invalid-api-key");const o={apiKey:e.config.apiKey,appName:e.name,authType:n,redirectUrl:i,v:ce,eventId:r};if(t instanceof wt){t.setDefaultLanguage(e.languageCode),o.providerId=t.providerId||"",I(t.getCustomParameters())||(o.customParameters=JSON.stringify(t.getCustomParameters()));for(const[e,t]of Object.entries(s||{}))o[e]=t}if(t instanceof bt){const e=t.getScopes().filter((e=>""!==e));e.length>0&&(o.scopes=e.join(","))}e.tenantId&&(o.tid=e.tenantId);const a=o;for(const e of Object.keys(a))void 0===a[e]&&delete a[e];return`${function({config:e}){return e.emulator?Ce(e,"emulator/auth/handler"):`https://${e.authDomain}/__/auth/handler`}(e)}?${A(a).slice(1)}`}const Cn="webStorageSupport",xn=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=zt,this._completeRedirectFn=ln}async _openPopup(e,t,n,i){var r;return be(null===(r=this.eventManagers[e._key()])||void 0===r?void 0:r.manager,"_initialize() not called before _openPopup()"),function(e,t,n,i=500,r=600){const s=Math.max((window.screen.availHeight-r)/2,0).toString(),o=Math.max((window.screen.availWidth-i)/2,0).toString();let a="";const c=Object.assign(Object.assign({},En),{width:i.toString(),height:r.toString(),top:s,left:o}),l=p().toLowerCase();n&&(a=tt(l)?"_blank":n),Xe(l)&&(t=t||"http://localhost",c.scrollbars="yes");const u=Object.entries(c).reduce(((e,[t,n])=>`${e}${t}=${n},`),"");if(function(e=p()){var t;return ot(e)&&!!(null===(t=window.navigator)||void 0===t?void 0:t.standalone)}(l)&&"_self"!==a)return function(e,t){const n=document.createElement("a");n.href=e,n.target=t;const i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(i)}(t||"",a),new In(null);const h=window.open(t||"",a,u);ve(h,e,"popup-blocked");try{h.focus()}catch(e){}return new In(h)}(e,Sn(e,t,n,Ee(),i),Lt())}async _openRedirect(e,t,n,i){var r;return await this._originValidation(e),r=Sn(e,t,n,Ee(),i),Ft().location.href=r,new Promise((()=>{}))}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:e,promise:n}=this.eventManagers[t];return e?Promise.resolve(e):(be(n,"If manager is not set, promise should be"),n)}const n=this.initAndGetManager(e);return this.eventManagers[t]={promise:n},n}async initAndGetManager(e){const t=await async function(e){const t=await vn(e),n=Ft().gapi;return ve(n,e,"internal-error"),t.open({where:document.body,url:Tn(e),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:bn,dontclear:!0},(t=>new Promise((async(n,i)=>{await t.restyle({setHideOnLeave:!1});const r=me(e,"network-request-failed"),s=Ft().setTimeout((()=>{i(r)}),wn.get());function o(){Ft().clearTimeout(s),n(t)}t.ping(o).then(o,(()=>{i(r)}))}))))}(e),n=new un(e);return t.register("authEvent",(t=>(ve(null==t?void 0:t.authEvent,e,"invalid-auth-event"),{status:n.onEvent(t.authEvent)?"ACK":"ERROR"})),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=t,n}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Cn,{type:Cn},(n=>{var i;const r=null===(i=null==n?void 0:n[0])||void 0===i?void 0:i.webStorageSupport;void 0!==r&&t(!!r),ge(e,"internal-error")}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=async function(e){if(e.config.emulator)return;const{authorizedDomains:t}=await async function(e,t={}){return Oe(e,"GET","/v1/projects",t)}(e);for(const e of t)try{if(_n(e))return}catch(e){}ge(e,"unauthorized-domain")}(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return at()||et()||ot()}};var An,Nn="@firebase/auth",Pn="0.19.3";class On{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),(null===(e=this.auth.currentUser)||void 0===e?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged((t=>{var n;e((null===(n=t)||void 0===n?void 0:n.stsTokenManager.accessToken)||null)}));this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){ve(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}An="Browser",re(new F("auth",((e,{options:t})=>{const n=e.getProvider("app").getImmediate(),{apiKey:i,authDomain:r}=n.options;return(e=>{ve(i&&!i.includes(":"),"invalid-api-key",{appName:e.name}),ve(!(null==r?void 0:r.includes(":")),"argument-error",{appName:e.name});const n={apiKey:i,authDomain:r,clientPlatform:An,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:ct(An)},s=new lt(e,n);return function(e,t){const n=(null==t?void 0:t.persistence)||[],i=(Array.isArray(n)?n:[n]).map(Te);(null==t?void 0:t.errorMap)&&e._updateErrorMap(t.errorMap),e._initializeWithPersistence(i,null==t?void 0:t.popupRedirectResolver)}(s,t),s})(n)}),"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback(((e,t,n)=>{e.getProvider("auth-internal").initialize()}))),re(new F("auth-internal",(e=>{return t=ut(e.getProvider("auth").getImmediate()),new On(t);var t}),"PRIVATE").setInstantiationMode("EXPLICIT")),ue(Nn,Pn,void 0),ue(Nn,Pn,"esm2017");var Rn=n(1733);const Dn="@firebase/installations",zn="0.5.4",Mn="w:0.5.4",Ln=new y("installations","Installations",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."});function Un(e){return e instanceof m&&e.code.includes("request-failed")}function Fn({projectId:e}){return`https://firebaseinstallations.googleapis.com/v1/projects/${e}/installations`}function jn(e){return{token:e.token,requestStatus:2,expiresIn:(t=e.expiresIn,Number(t.replace("s","000"))),creationTime:Date.now()};var t}async function qn(e,t){const n=(await t.json()).error;return Ln.create("request-failed",{requestName:e,serverCode:n.code,serverMessage:n.message,serverStatus:n.status})}function Bn({apiKey:e}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":e})}async function Wn(e){const t=await e();return t.status>=500&&t.status<600?e():t}function Vn(e){return new Promise((t=>{setTimeout(t,e)}))}const Hn=/^[cdef][\w-]{21}$/;function Kn(){try{const e=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(e),e[0]=112+e[0]%16;const t=function(e){return(t=e,btoa(String.fromCharCode(...t)).replace(/\+/g,"-").replace(/\//g,"_")).substr(0,22);var t}(e);return Hn.test(t)?t:""}catch(e){return""}}function $n(e){return`${e.appName}!${e.appId}`}const Gn=new Map;function Jn(e,t){const n=$n(e);Zn(n,t),function(e,t){const n=(!Yn&&"BroadcastChannel"in self&&(Yn=new BroadcastChannel("[Firebase] FID Change"),Yn.onmessage=e=>{Zn(e.data.key,e.data.fid)}),Yn);n&&n.postMessage({key:e,fid:t}),0===Gn.size&&Yn&&(Yn.close(),Yn=null)}(n,t)}function Zn(e,t){const n=Gn.get(e);if(n)for(const e of n)e(t)}let Yn=null;const Qn="firebase-installations-store";let Xn=null;function ei(){return Xn||(Xn=(0,Rn.openDb)("firebase-installations-database",1,(e=>{0===e.oldVersion&&e.createObjectStore(Qn)}))),Xn}async function ti(e,t){const n=$n(e),i=(await ei()).transaction(Qn,"readwrite"),r=i.objectStore(Qn),s=await r.get(n);return await r.put(t,n),await i.complete,s&&s.fid===t.fid||Jn(e,t.fid),t}async function ni(e){const t=$n(e),n=(await ei()).transaction(Qn,"readwrite");await n.objectStore(Qn).delete(t),await n.complete}async function ii(e,t){const n=$n(e),i=(await ei()).transaction(Qn,"readwrite"),r=i.objectStore(Qn),s=await r.get(n),o=t(s);return void 0===o?await r.delete(n):await r.put(o,n),await i.complete,!o||s&&s.fid===o.fid||Jn(e,o.fid),o}async function ri(e){let t;const n=await ii(e,(n=>{const i=function(e){return ai(e||{fid:Kn(),registrationStatus:0})}(n),r=function(e,t){if(0===t.registrationStatus){if(!navigator.onLine)return{installationEntry:t,registrationPromise:Promise.reject(Ln.create("app-offline"))};const n={fid:t.fid,registrationStatus:1,registrationTime:Date.now()},i=async function(e,t){try{const n=await async function(e,{fid:t}){const n=Fn(e),i=Bn(e),r={fid:t,authVersion:"FIS_v2",appId:e.appId,sdkVersion:Mn},s={method:"POST",headers:i,body:JSON.stringify(r)},o=await Wn((()=>fetch(n,s)));if(o.ok){const e=await o.json();return{fid:e.fid||t,registrationStatus:2,refreshToken:e.refreshToken,authToken:jn(e.authToken)}}throw await qn("Create Installation",o)}(e,t);return ti(e,n)}catch(n){throw Un(n)&&409===n.customData.serverCode?await ni(e):await ti(e,{fid:t.fid,registrationStatus:0}),n}}(e,n);return{installationEntry:n,registrationPromise:i}}return 1===t.registrationStatus?{installationEntry:t,registrationPromise:si(e)}:{installationEntry:t}}(e,i);return t=r.registrationPromise,r.installationEntry}));return""===n.fid?{installationEntry:await t}:{installationEntry:n,registrationPromise:t}}async function si(e){let t=await oi(e);for(;1===t.registrationStatus;)await Vn(100),t=await oi(e);if(0===t.registrationStatus){const{installationEntry:t,registrationPromise:n}=await ri(e);return n||t}return t}function oi(e){return ii(e,(e=>{if(!e)throw Ln.create("installation-not-found");return ai(e)}))}function ai(e){return 1===(t=e).registrationStatus&&t.registrationTime+1e4<Date.now()?{fid:e.fid,registrationStatus:0}:e;var t}async function ci({appConfig:e,platformLoggerProvider:t},n){const i=function(e,{fid:t}){return`${Fn(e)}/${t}/authTokens:generate`}(e,n),r=function(e,{refreshToken:t}){const n=Bn(e);return n.append("Authorization",function(e){return`FIS_v2 ${e}`}(t)),n}(e,n),s=t.getImmediate({optional:!0});s&&r.append("x-firebase-client",s.getPlatformInfoString());const o={installation:{sdkVersion:Mn}},a={method:"POST",headers:r,body:JSON.stringify(o)},c=await Wn((()=>fetch(i,a)));if(c.ok)return jn(await c.json());throw await qn("Generate Auth Token",c)}async function li(e,t=!1){let n;const i=await ii(e.appConfig,(i=>{if(!hi(i))throw Ln.create("not-registered");const r=i.authToken;if(!t&&(2===(s=r).requestStatus&&!function(e){const t=Date.now();return t<e.creationTime||e.creationTime+e.expiresIn<t+36e5}(s)))return i;var s;if(1===r.requestStatus)return n=async function(e,t){let n=await ui(e.appConfig);for(;1===n.authToken.requestStatus;)await Vn(100),n=await ui(e.appConfig);const i=n.authToken;return 0===i.requestStatus?li(e,t):i}(e,t),i;{if(!navigator.onLine)throw Ln.create("app-offline");const t=function(e){const t={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},e),{authToken:t})}(i);return n=async function(e,t){try{const n=await ci(e,t),i=Object.assign(Object.assign({},t),{authToken:n});return await ti(e.appConfig,i),n}catch(n){if(!Un(n)||401!==n.customData.serverCode&&404!==n.customData.serverCode){const n=Object.assign(Object.assign({},t),{authToken:{requestStatus:0}});await ti(e.appConfig,n)}else await ni(e.appConfig);throw n}}(e,t),t}}));return n?await n:i.authToken}function ui(e){return ii(e,(e=>{if(!hi(e))throw Ln.create("not-registered");return 1===(t=e.authToken).requestStatus&&t.requestTime+1e4<Date.now()?Object.assign(Object.assign({},e),{authToken:{requestStatus:0}}):e;var t}))}function hi(e){return void 0!==e&&2===e.registrationStatus}function di(e){return Ln.create("missing-app-config-values",{valueName:e})}const pi="installations";re(new F(pi,(e=>{const t=e.getProvider("app").getImmediate(),n=function(e){if(!e||!e.options)throw di("App Configuration");if(!e.name)throw di("App Name");const t=["projectId","apiKey","appId"];for(const n of t)if(!e.options[n])throw di(n);return{appName:e.name,projectId:e.options.projectId,apiKey:e.options.apiKey,appId:e.options.appId}}(t);return{app:t,appConfig:n,platformLoggerProvider:se(t,"platform-logger"),_delete:()=>Promise.resolve()}}),"PUBLIC")),re(new F("installations-internal",(e=>{const t=se(e.getProvider("app").getImmediate(),pi).getImmediate();return{getId:()=>async function(e){const t=e,{installationEntry:n,registrationPromise:i}=await ri(t.appConfig);return i?i.catch(console.error):li(t).catch(console.error),n.fid}(t),getToken:e=>async function(e,t=!1){const n=e;return await async function(e){const{registrationPromise:t}=await ri(e);t&&await t}(n.appConfig),(await li(n,t)).token}(t,e)}}),"PRIVATE")),ue(Dn,zn),ue(Dn,zn,"esm2017");const fi="analytics",_i="https://www.googletagmanager.com/gtag/js",gi=new J("@firebase/analytics");function mi(e){return Promise.all(e.map((e=>e.catch((e=>e)))))}const yi=new y("analytics","Analytics",{"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-intialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.'}),vi=new class{constructor(e={},t=1e3){this.throttleMetadata=e,this.intervalMillis=t}getThrottleMetadata(e){return this.throttleMetadata[e]}setThrottleMetadata(e,t){this.throttleMetadata[e]=t}deleteThrottleMetadata(e){delete this.throttleMetadata[e]}};function wi(e){return new Headers({Accept:"application/json","x-goog-api-key":e})}async function bi(e,t=vi,n){const{appId:i,apiKey:r,measurementId:s}=e.options;if(!i)throw yi.create("no-app-id");if(!r){if(s)return{measurementId:s,appId:i};throw yi.create("no-api-key")}const o=t.getThrottleMetadata(i)||{backoffCount:0,throttleEndTimeMillis:Date.now()},a=new Ti;return setTimeout((async()=>{a.abort()}),void 0!==n?n:6e4),ki({appId:i,apiKey:r,measurementId:s},o,a,t)}async function ki(e,{throttleEndTimeMillis:t,backoffCount:n},i,r=vi){const{appId:s,measurementId:o}=e;try{await function(e,t){return new Promise(((n,i)=>{const r=Math.max(t-Date.now(),0),s=setTimeout(n,r);e.addEventListener((()=>{clearTimeout(s),i(yi.create("fetch-throttle",{throttleEndTimeMillis:t}))}))}))}(i,t)}catch(e){if(o)return gi.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${o} provided in the "measurementId" field in the local Firebase config. [${e.message}]`),{appId:s,measurementId:o};throw e}try{const t=await async function(e){var t;const{appId:n,apiKey:i}=e,r={method:"GET",headers:wi(i)},s="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig".replace("{app-id}",n),o=await fetch(s,r);if(200!==o.status&&304!==o.status){let e="";try{const n=await o.json();(null===(t=n.error)||void 0===t?void 0:t.message)&&(e=n.error.message)}catch(e){}throw yi.create("config-fetch-failed",{httpStatus:o.status,responseMessage:e})}return o.json()}(e);return r.deleteThrottleMetadata(s),t}catch(t){if(!function(e){if(!(e instanceof m&&e.customData))return!1;const t=Number(e.customData.httpStatus);return 429===t||500===t||503===t||504===t}(t)){if(r.deleteThrottleMetadata(s),o)return gi.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${o} provided in the "measurementId" field in the local Firebase config. [${t.message}]`),{appId:s,measurementId:o};throw t}const a=503===Number(t.customData.httpStatus)?L(n,r.intervalMillis,30):L(n,r.intervalMillis),c={throttleEndTimeMillis:Date.now()+a,backoffCount:n+1};return r.setThrottleMetadata(s,c),gi.debug(`Calling attemptFetch again in ${a} millis`),ki(e,c,i,r)}}class Ti{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach((e=>e()))}}async function Ei(e,t,n,i,r,s,o){var a;const c=bi(e);c.then((t=>{n[t.measurementId]=t.appId,e.options.measurementId&&t.measurementId!==e.options.measurementId&&gi.warn(`The measurement ID in the local Firebase config (${e.options.measurementId}) does not match the measurement ID fetched from the server (${t.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)})).catch((e=>gi.error(e))),t.push(c);const l=async function(){if("object"!=typeof indexedDB)return gi.warn(yi.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;try{await new Promise(((e,t)=>{try{let n=!0;const i="validate-browser-context-for-indexeddb-analytics-module",r=self.indexedDB.open(i);r.onsuccess=()=>{r.result.close(),n||self.indexedDB.deleteDatabase(i),e(!0)},r.onupgradeneeded=()=>{n=!1},r.onerror=()=>{var e;t((null===(e=r.error)||void 0===e?void 0:e.message)||"")}}catch(e){t(e)}}))}catch(e){return gi.warn(yi.create("indexeddb-unavailable",{errorInfo:e}).message),!1}return!0}().then((e=>e?i.getId():void 0)),[u,h]=await Promise.all([c,l]);(function(){const e=window.document.getElementsByTagName("script");for(const t of Object.values(e))if(t.src&&t.src.includes(_i))return t;return null})()||function(e,t){const n=document.createElement("script");n.src=`${_i}?l=${e}&id=${t}`,n.async=!0,document.head.appendChild(n)}(s,u.measurementId),r("js",new Date);const d=null!==(a=null==o?void 0:o.config)&&void 0!==a?a:{};return d.origin="firebase",d.update=!0,null!=h&&(d.firebase_id=h),r("config",u.measurementId,d),u.measurementId}class Ii{constructor(e){this.app=e}_delete(){return delete Si[this.app.options.appId],Promise.resolve()}}let Si={},Ci=[];const xi={};let Ai,Ni,Pi="dataLayer",Oi=!1;function Ri(e,t,n){!function(){const e=[];if(_()&&e.push("This is a browser extension environment."),"undefined"!=typeof navigator&&navigator.cookieEnabled||e.push("Cookies are not available."),e.length>0){const t=e.map(((e,t)=>`(${t+1}) ${e}`)).join(" "),n=yi.create("invalid-analytics-context",{errorInfo:t});gi.warn(n.message)}}();const i=e.options.appId;if(!i)throw yi.create("no-app-id");if(!e.options.apiKey){if(!e.options.measurementId)throw yi.create("no-api-key");gi.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${e.options.measurementId} provided in the "measurementId" field in the local Firebase config.`)}if(null!=Si[i])throw yi.create("already-exists",{id:i});if(!Oi){!function(e){let t=[];Array.isArray(window.dataLayer)?t=window.dataLayer:window.dataLayer=t}();const{wrappedGtag:e,gtagCore:t}=function(e,t,n,i,r){let s=function(...e){window.dataLayer.push(arguments)};return window.gtag&&"function"==typeof window.gtag&&(s=window.gtag),window.gtag=function(e,t,n,i){return async function(r,s,o){try{"event"===r?await async function(e,t,n,i,r){try{let s=[];if(r&&r.send_to){let e=r.send_to;Array.isArray(e)||(e=[e]);const i=await mi(n);for(const n of e){const e=i.find((e=>e.measurementId===n)),r=e&&t[e.appId];if(!r){s=[];break}s.push(r)}}0===s.length&&(s=Object.values(t)),await Promise.all(s),e("event",i,r||{})}catch(e){gi.error(e)}}(e,t,n,s,o):"config"===r?await async function(e,t,n,i,r,s){const o=i[r];try{if(o)await t[o];else{const e=(await mi(n)).find((e=>e.measurementId===r));e&&await t[e.appId]}}catch(e){gi.error(e)}e("config",r,s)}(e,t,n,i,s,o):e("set",s)}catch(e){gi.error(e)}}}(s,e,t,n),{gtagCore:s,wrappedGtag:window.gtag}}(Si,Ci,xi);Ni=e,Ai=t,Oi=!0}return Si[i]=Ei(e,Ci,xi,t,Ai,Pi,n),new Ii(e)}const Di="@firebase/analytics",zi="0.7.4";re(new F(fi,((e,{options:t})=>Ri(e.getProvider("app").getImmediate(),e.getProvider("installations-internal").getImmediate(),t)),"PUBLIC")),re(new F("analytics-internal",(function(e){try{const t=e.getProvider(fi).getImmediate();return{logEvent:(e,n,i)=>function(e,t,n,i){e=U(e),async function(e,t,n,i,r){if(r&&r.global)e("event",n,i);else{const r=await t;e("event",n,Object.assign(Object.assign({},i),{send_to:r}))}}(Ni,Si[e.app.options.appId],t,n,i).catch((e=>gi.error(e)))}(t,e,n,i)}}catch(e){throw yi.create("interop-component-reg-failed",{reason:e})}}),"PRIVATE")),ue(Di,zi),ue(Di,zi,"esm2017");const Mi="@firebase/database",Li="0.12.4";let Ui="";class Fi{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,t){null==t?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),b(t))}get(e){const t=this.domStorage_.getItem(this.prefixedName_(e));return null==t?null:w(t)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}}class ji{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,t){null==t?delete this.cache_[e]:this.cache_[e]=t}get(e){return T(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}}const qi=function(e){try{if("undefined"!=typeof window&&void 0!==window[e]){const t=window[e];return t.setItem("firebase:sentinel","cache"),t.removeItem("firebase:sentinel"),new Fi(t)}}catch(e){}return new ji},Bi=qi("localStorage"),Wi=qi("sessionStorage"),Vi=new J("@firebase/database"),Hi=function(){let e=1;return function(){return e++}}(),Ki=function(e){const t=function(e){const t=[];let n=0;for(let i=0;i<e.length;i++){let r=e.charCodeAt(i);if(r>=55296&&r<=56319){const t=r-55296;i++,s(i<e.length,"Surrogate pair missing trail surrogate."),r=65536+(t<<10)+(e.charCodeAt(i)-56320)}r<128?t[n++]=r:r<2048?(t[n++]=r>>6|192,t[n++]=63&r|128):r<65536?(t[n++]=r>>12|224,t[n++]=r>>6&63|128,t[n++]=63&r|128):(t[n++]=r>>18|240,t[n++]=r>>12&63|128,t[n++]=r>>6&63|128,t[n++]=63&r|128)}return t}(e),n=new O;n.update(t);const i=n.digest();return c.encodeByteArray(i)},$i=function(...e){let t="";for(let n=0;n<e.length;n++){const i=e[n];Array.isArray(i)||i&&"object"==typeof i&&"number"==typeof i.length?t+=$i.apply(null,i):t+="object"==typeof i?b(i):i,t+=" "}return t};let Gi=null,Ji=!0;const Zi=function(...e){if(!0===Ji&&(Ji=!1,null===Gi&&!0===Wi.get("logging_enabled")&&(t=!0,s(!n||!0===t||!1===t,"Can't turn on custom loggers persistently."),!0===t?(Vi.logLevel=V.VERBOSE,Gi=Vi.log.bind(Vi),n&&Wi.set("logging_enabled",!0)):"function"==typeof t?Gi=t:(Gi=null,Wi.remove("logging_enabled")))),Gi){const t=$i.apply(null,e);Gi(t)}var t,n},Yi=function(e){return function(...t){Zi(e,...t)}},Qi=function(...e){const t="FIREBASE INTERNAL ERROR: "+$i(...e);Vi.error(t)},Xi=function(...e){const t=`FIREBASE FATAL ERROR: ${$i(...e)}`;throw Vi.error(t),new Error(t)},er=function(...e){const t="FIREBASE WARNING: "+$i(...e);Vi.warn(t)},tr=function(e){return"number"==typeof e&&(e!=e||e===Number.POSITIVE_INFINITY||e===Number.NEGATIVE_INFINITY)},nr="[MIN_NAME]",ir="[MAX_NAME]",rr=function(e,t){if(e===t)return 0;if(e===nr||t===ir)return-1;if(t===nr||e===ir)return 1;{const n=dr(e),i=dr(t);return null!==n?null!==i?n-i==0?e.length-t.length:n-i:-1:null!==i?1:e<t?-1:1}},sr=function(e,t){return e===t?0:e<t?-1:1},or=function(e,t){if(t&&e in t)return t[e];throw new Error("Missing required key ("+e+") in object: "+b(t))},ar=function(e){if("object"!=typeof e||null===e)return b(e);const t=[];for(const n in e)t.push(n);t.sort();let n="{";for(let i=0;i<t.length;i++)0!==i&&(n+=","),n+=b(t[i]),n+=":",n+=ar(e[t[i]]);return n+="}",n},cr=function(e,t){const n=e.length;if(n<=t)return[e];const i=[];for(let r=0;r<n;r+=t)r+t>n?i.push(e.substring(r,n)):i.push(e.substring(r,r+t));return i};function lr(e,t){for(const n in e)e.hasOwnProperty(n)&&t(n,e[n])}const ur=function(e){s(!tr(e),"Invalid JSON number");let t,n,i,r,o;0===e?(n=0,i=0,t=1/e==-1/0?1:0):(t=e<0,(e=Math.abs(e))>=Math.pow(2,-1022)?(r=Math.min(Math.floor(Math.log(e)/Math.LN2),1023),n=r+1023,i=Math.round(e*Math.pow(2,52-r)-Math.pow(2,52))):(n=0,i=Math.round(e/Math.pow(2,-1074))));const a=[];for(o=52;o;o-=1)a.push(i%2?1:0),i=Math.floor(i/2);for(o=11;o;o-=1)a.push(n%2?1:0),n=Math.floor(n/2);a.push(t?1:0),a.reverse();const c=a.join("");let l="";for(o=0;o<64;o+=8){let e=parseInt(c.substr(o,8),2).toString(16);1===e.length&&(e="0"+e),l+=e}return l.toLowerCase()},hr=new RegExp("^-?(0*)\\d{1,10}$"),dr=function(e){if(hr.test(e)){const t=Number(e);if(t>=-2147483648&&t<=2147483647)return t}return null},pr=function(e){try{e()}catch(e){setTimeout((()=>{const t=e.stack||"";throw er("Exception was thrown by user callback.",t),e}),Math.floor(0))}},fr=function(e,t){const n=setTimeout(e,t);return"object"==typeof n&&n.unref&&n.unref(),n};class _r{constructor(e,t){this.appName_=e,this.appCheckProvider=t,this.appCheck=null==t?void 0:t.getImmediate({optional:!0}),this.appCheck||null==t||t.get().then((e=>this.appCheck=e))}getToken(e){return this.appCheck?this.appCheck.getToken(e):new Promise(((t,n)=>{setTimeout((()=>{this.appCheck?this.getToken(e).then(t,n):t(null)}),0)}))}addTokenChangeListener(e){var t;null===(t=this.appCheckProvider)||void 0===t||t.get().then((t=>t.addTokenListener(e)))}notifyForInvalidToken(){er(`Provided AppCheck credentials for the app named "${this.appName_}" are invalid. This usually indicates your app was not initialized correctly.`)}}class gr{constructor(e,t,n){this.appName_=e,this.firebaseOptions_=t,this.authProvider_=n,this.auth_=null,this.auth_=n.getImmediate({optional:!0}),this.auth_||n.onInit((e=>this.auth_=e))}getToken(e){return this.auth_?this.auth_.getToken(e).catch((e=>e&&"auth/token-not-initialized"===e.code?(Zi("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(e))):new Promise(((t,n)=>{setTimeout((()=>{this.auth_?this.getToken(e).then(t,n):t(null)}),0)}))}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then((t=>t.addAuthTokenListener(e)))}removeTokenChangeListener(e){this.authProvider_.get().then((t=>t.removeAuthTokenListener(e)))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',er(e)}}class mr{constructor(e){this.accessToken=e}getToken(e){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(e){e(this.accessToken)}removeTokenChangeListener(e){}notifyForInvalidToken(){}}mr.OWNER="owner";const yr=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,vr="websocket",wr="long_polling";class br{constructor(e,t,n,i,r=!1,s="",o=!1){this.secure=t,this.namespace=n,this.webSocketOnly=i,this.nodeAdmin=r,this.persistenceKey=s,this.includeNamespaceInQueryParams=o,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=Bi.get("host:"+e)||this._host}isCacheableHost(){return"s-"===this.internalHost.substr(0,2)}isCustomHost(){return"firebaseio.com"!==this._domain&&"firebaseio-demo.com"!==this._domain}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&Bi.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){const e=this.secure?"https://":"http://",t=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${t}`}}function kr(e,t,n){let i;if(s("string"==typeof t,"typeof type must == string"),s("object"==typeof n,"typeof params must == object"),t===vr)i=(e.secure?"wss://":"ws://")+e.internalHost+"/.ws?";else{if(t!==wr)throw new Error("Unknown connection type: "+t);i=(e.secure?"https://":"http://")+e.internalHost+"/.lp?"}(function(e){return e.host!==e.internalHost||e.isCustomHost()||e.includeNamespaceInQueryParams})(e)&&(n.ns=e.namespace);const r=[];return lr(n,((e,t)=>{r.push(e+"="+t)})),i+r.join("&")}class Tr{constructor(){this.counters_={}}incrementCounter(e,t=1){T(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=t}get(){return u(this.counters_)}}const Er={},Ir={};function Sr(e){const t=e.toString();return Er[t]||(Er[t]=new Tr),Er[t]}class Cr{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,t){this.closeAfterResponse=e,this.onClose=t,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,t){for(this.pendingResponses[e]=t;this.pendingResponses[this.currentResponseNum];){const e=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let t=0;t<e.length;++t)e[t]&&pr((()=>{this.onMessage_(e[t])}));if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}class xr{constructor(e,t,n,i,r,s,o){this.connId=e,this.repoInfo=t,this.applicationId=n,this.appCheckToken=i,this.authToken=r,this.transportSessionId=s,this.lastSessionId=o,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=Yi(e),this.stats_=Sr(t),this.urlFn=e=>(this.appCheckToken&&(e.ac=this.appCheckToken),kr(t,wr,e))}open(e,t){this.curSegmentNum=0,this.onDisconnect_=t,this.myPacketOrderer=new Cr(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout((()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null}),Math.floor(3e4)),function(e){if("complete"===document.readyState)e();else{let t=!1;const n=function(){document.body?t||(t=!0,e()):setTimeout(n,Math.floor(10))};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",(()=>{"complete"===document.readyState&&n()})),window.attachEvent("onload",n))}}((()=>{if(this.isClosed_)return;this.scriptTagHolder=new Ar(((...e)=>{const[t,n,i,r,s]=e;if(this.incrementIncomingBytes_(e),this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,"start"===t)this.id=n,this.password=i;else{if("close"!==t)throw new Error("Unrecognized command received: "+t);n?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(n,(()=>{this.onClosed_()}))):this.onClosed_()}}),((...e)=>{const[t,n]=e;this.incrementIncomingBytes_(e),this.myPacketOrderer.handleResponse(t,n)}),(()=>{this.onClosed_()}),this.urlFn);const e={start:"t"};e.ser=Math.floor(1e8*Math.random()),this.scriptTagHolder.uniqueCallbackIdentifier&&(e.cb=this.scriptTagHolder.uniqueCallbackIdentifier),e.v="5",this.transportSessionId&&(e.s=this.transportSessionId),this.lastSessionId&&(e.ls=this.lastSessionId),this.applicationId&&(e.p=this.applicationId),this.appCheckToken&&(e.ac=this.appCheckToken),"undefined"!=typeof location&&location.hostname&&yr.test(location.hostname)&&(e.r="f");const t=this.urlFn(e);this.log_("Connecting via long-poll to "+t),this.scriptTagHolder.addTag(t,(()=>{}))}))}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){xr.forceAllow_=!0}static forceDisallow(){xr.forceDisallow_=!0}static isAvailable(){return!(!xr.forceAllow_&&(xr.forceDisallow_||"undefined"==typeof document||null==document.createElement||"object"==typeof window&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href)||"object"==typeof Windows&&"object"==typeof Windows.UI))}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){const t=b(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);const n=function(e){const t=a(e);return c.encodeByteArray(t,!0)}(t),i=cr(n,1840);for(let e=0;e<i.length;e++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,i.length,i[e]),this.curSegmentNum++}addDisconnectPingFrame(e,t){this.myDisconnFrame=document.createElement("iframe");const n={dframe:"t"};n.id=e,n.pw=t,this.myDisconnFrame.src=this.urlFn(n),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){const t=b(e).length;this.bytesReceived+=t,this.stats_.incrementCounter("bytes_received",t)}}class Ar{constructor(e,t,n,i){this.onDisconnect=n,this.urlFn=i,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(1e8*Math.random()),this.sendNewPolls=!0;{this.uniqueCallbackIdentifier=Hi(),window["pLPCommand"+this.uniqueCallbackIdentifier]=e,window["pRTLPCB"+this.uniqueCallbackIdentifier]=t,this.myIFrame=Ar.createIFrame_();let n="";this.myIFrame.src&&"javascript:"===this.myIFrame.src.substr(0,"javascript:".length)&&(n='<script>document.domain="'+document.domain+'";<\/script>');const i="<html><body>"+n+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(i),this.myIFrame.doc.close()}catch(e){Zi("frame writing exception"),e.stack&&Zi(e.stack),Zi(e)}}}static createIFrame_(){const e=document.createElement("iframe");if(e.style.display="none",!document.body)throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";document.body.appendChild(e);try{e.contentWindow.document||Zi("No IE domain setting required")}catch(t){const n=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+n+"';document.close();})())"}return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.innerHTML="",setTimeout((()=>{null!==this.myIFrame&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)}),Math.floor(0)));const e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,t){for(this.myID=e,this.myPW=t,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const e={};e.id=this.myID,e.pw=this.myPW,e.ser=this.currentSerial;let t=this.urlFn(e),n="",i=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+30+n.length<=1870;){const e=this.pendingSegs.shift();n=n+"&seg"+i+"="+e.seg+"&ts"+i+"="+e.ts+"&d"+i+"="+e.d,i++}return t+=n,this.addLongPollTag_(t,this.currentSerial),!0}return!1}enqueueSegment(e,t,n){this.pendingSegs.push({seg:e,ts:t,d:n}),this.alive&&this.newRequest_()}addLongPollTag_(e,t){this.outstandingRequests.add(t);const n=()=>{this.outstandingRequests.delete(t),this.newRequest_()},i=setTimeout(n,Math.floor(25e3));this.addTag(e,(()=>{clearTimeout(i),n()}))}addTag(e,t){setTimeout((()=>{try{if(!this.sendNewPolls)return;const n=this.myIFrame.doc.createElement("script");n.type="text/javascript",n.async=!0,n.src=e,n.onload=n.onreadystatechange=function(){const e=n.readyState;e&&"loaded"!==e&&"complete"!==e||(n.onload=n.onreadystatechange=null,n.parentNode&&n.parentNode.removeChild(n),t())},n.onerror=()=>{Zi("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(n)}catch(e){}}),Math.floor(1))}}let Nr=null;"undefined"!=typeof MozWebSocket?Nr=MozWebSocket:"undefined"!=typeof WebSocket&&(Nr=WebSocket);class Pr{constructor(e,t,n,i,r,s,o){this.connId=e,this.applicationId=n,this.appCheckToken=i,this.authToken=r,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=Yi(this.connId),this.stats_=Sr(t),this.connURL=Pr.connectionURL_(t,s,o,i),this.nodeAdmin=t.nodeAdmin}static connectionURL_(e,t,n,i){const r={v:"5"};return"undefined"!=typeof location&&location.hostname&&yr.test(location.hostname)&&(r.r="f"),t&&(r.s=t),n&&(r.ls=n),i&&(r.ac=i),kr(e,vr,r)}open(e,t){this.onDisconnect=t,this.onMessage=e,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,Bi.set("previous_websocket_failure",!0);try{{const e={headers:{"X-Firebase-GMPID":this.applicationId||"","X-Firebase-AppCheck":this.appCheckToken||""}};this.mySock=new Nr(this.connURL,[],e)}}catch(e){this.log_("Error instantiating WebSocket.");const t=e.message||e.data;return t&&this.log_(t),void this.onClosed_()}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=e=>{this.handleIncomingFrame(e)},this.mySock.onerror=e=>{this.log_("WebSocket error.  Closing connection.");const t=e.message||e.data;t&&this.log_(t),this.onClosed_()}}start(){}static forceDisallow(){Pr.forceDisallow_=!0}static isAvailable(){let e=!1;if("undefined"!=typeof navigator&&navigator.userAgent){const t=/Android ([0-9]{0,}\.[0-9]{0,})/,n=navigator.userAgent.match(t);n&&n.length>1&&parseFloat(n[1])<4.4&&(e=!0)}return!e&&null!==Nr&&!Pr.forceDisallow_}static previouslyFailed(){return Bi.isInMemoryStorage||!0===Bi.get("previous_websocket_failure")}markConnectionHealthy(){Bi.remove("previous_websocket_failure")}appendFrame_(e){if(this.frames.push(e),this.frames.length===this.totalFrames){const e=this.frames.join("");this.frames=null;const t=w(e);this.onMessage(t)}}handleNewFrameCount_(e){this.totalFrames=e,this.frames=[]}extractFrameCount_(e){if(s(null===this.frames,"We already have a frame buffer"),e.length<=6){const t=Number(e);if(!isNaN(t))return this.handleNewFrameCount_(t),null}return this.handleNewFrameCount_(1),e}handleIncomingFrame(e){if(null===this.mySock)return;const t=e.data;if(this.bytesReceived+=t.length,this.stats_.incrementCounter("bytes_received",t.length),this.resetKeepAlive(),null!==this.frames)this.appendFrame_(t);else{const e=this.extractFrameCount_(t);null!==e&&this.appendFrame_(e)}}send(e){this.resetKeepAlive();const t=b(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);const n=cr(t,16384);n.length>1&&this.sendString_(String(n.length));for(let e=0;e<n.length;e++)this.sendString_(n[e])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval((()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()}),Math.floor(45e3))}sendString_(e){try{this.mySock.send(e)}catch(e){this.log_("Exception thrown from WebSocket.send():",e.message||e.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}Pr.responsesRequiredToBeHealthy=2,Pr.healthyTimeout=3e4;class Or{constructor(e){this.initTransports_(e)}static get ALL_TRANSPORTS(){return[xr,Pr]}initTransports_(e){const t=Pr&&Pr.isAvailable();let n=t&&!Pr.previouslyFailed();if(e.webSocketOnly&&(t||er("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),n=!0),n)this.transports_=[Pr];else{const e=this.transports_=[];for(const t of Or.ALL_TRANSPORTS)t&&t.isAvailable()&&e.push(t)}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}class Rr{constructor(e,t,n,i,r,s,o,a,c,l){this.id=e,this.repoInfo_=t,this.applicationId_=n,this.appCheckToken_=i,this.authToken_=r,this.onMessage_=s,this.onReady_=o,this.onDisconnect_=a,this.onKill_=c,this.lastSessionId=l,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=Yi("c:"+this.id+":"),this.transportManager_=new Or(t),this.log_("Connection created"),this.start_()}start_(){const e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.conn_),n=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout((()=>{this.conn_&&this.conn_.open(t,n)}),Math.floor(0));const i=e.healthyTimeout||0;i>0&&(this.healthyTimeout_=fr((()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>102400?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>10240?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))}),Math.floor(i)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return t=>{e===this.conn_?this.onConnectionLost_(t):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return t=>{2!==this.state_&&(e===this.rx_?this.onPrimaryMessageReceived_(t):e===this.secondaryConn_?this.onSecondaryMessageReceived_(t):this.log_("message on old connection"))}}sendRequest(e){const t={t:"d",d:e};this.sendData_(t)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if("t"in e){const t=e.t;"a"===t?this.upgradeIfSecondaryHealthy_():"r"===t?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),this.tx_!==this.secondaryConn_&&this.rx_!==this.secondaryConn_||this.close()):"o"===t&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){const t=or("t",e),n=or("d",e);if("c"===t)this.onSecondaryControl_(n);else{if("d"!==t)throw new Error("Unknown protocol layer: "+t);this.pendingDataMessages.push(n)}}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:"p",d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:"a",d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:"n",d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){const t=or("t",e),n=or("d",e);"c"===t?this.onControl_(n):"d"===t&&this.onDataMessage_(n)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){const t=or("t",e);if("d"in e){const n=e.d;if("h"===t)this.onHandshake_(n);else if("n"===t){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let e=0;e<this.pendingDataMessages.length;++e)this.onDataMessage_(this.pendingDataMessages[e]);this.pendingDataMessages=[],this.tryCleanupConnection()}else"s"===t?this.onConnectionShutdown_(n):"r"===t?this.onReset_(n):"e"===t?Qi("Server Error: "+n):"o"===t?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):Qi("Unknown control packet command: "+t)}}onHandshake_(e){const t=e.ts,n=e.v,i=e.h;this.sessionId=e.s,this.repoInfo_.host=i,0===this.state_&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,t),"5"!==n&&er("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.secondaryConn_),n=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(t,n),fr((()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())}),Math.floor(6e4))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,1===this.state_?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,t){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(t,this.sessionId),this.onReady_=null),0===this.primaryResponsesRequired_?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):fr((()=>{this.sendPingOnPrimaryIfNecessary_()}),Math.floor(5e3))}sendPingOnPrimaryIfNecessary_(){this.isHealthy_||1!==this.state_||(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:"p",d:{}}}))}onSecondaryConnectionLost_(){const e=this.secondaryConn_;this.secondaryConn_=null,this.tx_!==e&&this.rx_!==e||this.close()}onConnectionLost_(e){this.conn_=null,e||0!==this.state_?1===this.state_&&this.log_("Realtime connection lost."):(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(Bi.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(1!==this.state_)throw"Connection is not connected";this.tx_.send(e)}close(){2!==this.state_&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}class Dr{put(e,t,n,i){}merge(e,t,n,i){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,t,n){}onDisconnectMerge(e,t,n){}onDisconnectCancel(e,t){}reportStats(e){}}class zr{constructor(e){this.allowedEvents_=e,this.listeners_={},s(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...t){if(Array.isArray(this.listeners_[e])){const n=[...this.listeners_[e]];for(let e=0;e<n.length;e++)n[e].callback.apply(n[e].context,t)}}on(e,t,n){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:t,context:n});const i=this.getInitialEvent(e);i&&t.apply(n,i)}off(e,t,n){this.validateEventType_(e);const i=this.listeners_[e]||[];for(let e=0;e<i.length;e++)if(i[e].callback===t&&(!n||n===i[e].context))return void i.splice(e,1)}validateEventType_(e){s(this.allowedEvents_.find((t=>t===e)),"Unknown event: "+e)}}class Mr extends zr{constructor(){super(["online"]),this.online_=!0,"undefined"==typeof window||void 0===window.addEventListener||f()||(window.addEventListener("online",(()=>{this.online_||(this.online_=!0,this.trigger("online",!0))}),!1),window.addEventListener("offline",(()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))}),!1))}static getInstance(){return new Mr}getInitialEvent(e){return s("online"===e,"Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}}class Lr{constructor(e,t){if(void 0===t){this.pieces_=e.split("/");let t=0;for(let e=0;e<this.pieces_.length;e++)this.pieces_[e].length>0&&(this.pieces_[t]=this.pieces_[e],t++);this.pieces_.length=t,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=t}toString(){let e="";for(let t=this.pieceNum_;t<this.pieces_.length;t++)""!==this.pieces_[t]&&(e+="/"+this.pieces_[t]);return e||"/"}}function Ur(){return new Lr("")}function Fr(e){return e.pieceNum_>=e.pieces_.length?null:e.pieces_[e.pieceNum_]}function jr(e){return e.pieces_.length-e.pieceNum_}function qr(e){let t=e.pieceNum_;return t<e.pieces_.length&&t++,new Lr(e.pieces_,t)}function Br(e){return e.pieceNum_<e.pieces_.length?e.pieces_[e.pieces_.length-1]:null}function Wr(e,t=0){return e.pieces_.slice(e.pieceNum_+t)}function Vr(e){if(e.pieceNum_>=e.pieces_.length)return null;const t=[];for(let n=e.pieceNum_;n<e.pieces_.length-1;n++)t.push(e.pieces_[n]);return new Lr(t,0)}function Hr(e,t){const n=[];for(let t=e.pieceNum_;t<e.pieces_.length;t++)n.push(e.pieces_[t]);if(t instanceof Lr)for(let e=t.pieceNum_;e<t.pieces_.length;e++)n.push(t.pieces_[e]);else{const e=t.split("/");for(let t=0;t<e.length;t++)e[t].length>0&&n.push(e[t])}return new Lr(n,0)}function Kr(e){return e.pieceNum_>=e.pieces_.length}function $r(e,t){const n=Fr(e),i=Fr(t);if(null===n)return t;if(n===i)return $r(qr(e),qr(t));throw new Error("INTERNAL ERROR: innerPath ("+t+") is not within outerPath ("+e+")")}function Gr(e,t){const n=Wr(e,0),i=Wr(t,0);for(let e=0;e<n.length&&e<i.length;e++){const t=rr(n[e],i[e]);if(0!==t)return t}return n.length===i.length?0:n.length<i.length?-1:1}function Jr(e,t){if(jr(e)!==jr(t))return!1;for(let n=e.pieceNum_,i=t.pieceNum_;n<=e.pieces_.length;n++,i++)if(e.pieces_[n]!==t.pieces_[i])return!1;return!0}function Zr(e,t){let n=e.pieceNum_,i=t.pieceNum_;if(jr(e)>jr(t))return!1;for(;n<e.pieces_.length;){if(e.pieces_[n]!==t.pieces_[i])return!1;++n,++i}return!0}class Yr{constructor(e,t){this.errorPrefix_=t,this.parts_=Wr(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let e=0;e<this.parts_.length;e++)this.byteLength_+=M(this.parts_[e]);Qr(this)}}function Qr(e){if(e.byteLength_>768)throw new Error(e.errorPrefix_+"has a key path longer than 768 bytes ("+e.byteLength_+").");if(e.parts_.length>32)throw new Error(e.errorPrefix_+"path specified exceeds the maximum depth that can be written (32) or object contains a cycle "+Xr(e))}function Xr(e){return 0===e.parts_.length?"":"in property '"+e.parts_.join(".")+"'"}class es extends zr{constructor(){let e,t;super(["visible"]),"undefined"!=typeof document&&void 0!==document.addEventListener&&(void 0!==document.hidden?(t="visibilitychange",e="hidden"):void 0!==document.mozHidden?(t="mozvisibilitychange",e="mozHidden"):void 0!==document.msHidden?(t="msvisibilitychange",e="msHidden"):void 0!==document.webkitHidden&&(t="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,t&&document.addEventListener(t,(()=>{const t=!document[e];t!==this.visible_&&(this.visible_=t,this.trigger("visible",t))}),!1)}static getInstance(){return new es}getInitialEvent(e){return s("visible"===e,"Unknown event type: "+e),[this.visible_]}}const ts=1e3;class ns extends Dr{constructor(e,t,n,i,r,s,o,a){if(super(),this.repoInfo_=e,this.applicationId_=t,this.onDataUpdate_=n,this.onConnectStatus_=i,this.onServerInfoUpdate_=r,this.authTokenProvider_=s,this.appCheckTokenProvider_=o,this.authOverride_=a,this.id=ns.nextPersistentConnectionId_++,this.log_=Yi("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=ts,this.maxReconnectDelay_=3e5,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,a)throw new Error("Auth override specified in options, but not supported on non Node.js platforms");es.getInstance().on("visible",this.onVisible_,this),-1===e.host.indexOf("fblocal")&&Mr.getInstance().on("online",this.onOnline_,this)}sendRequest(e,t,n){const i=++this.requestNumber_,r={r:i,a:e,b:t};this.log_(b(r)),s(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(r),n&&(this.requestCBHash_[i]=n)}get(e){this.initConnection_();const t=new d,n={p:e._path.toString(),q:e._queryObject},i={action:"g",request:n,onComplete:e=>{const i=e.d;"ok"===e.s?(this.onDataUpdate_(n.p,i,!1,null),t.resolve(i)):t.reject(i)}};this.outstandingGets_.push(i),this.outstandingGetCount_++;const r=this.outstandingGets_.length-1;return this.connected_||setTimeout((()=>{const e=this.outstandingGets_[r];void 0!==e&&i===e&&(delete this.outstandingGets_[r],this.outstandingGetCount_--,0===this.outstandingGetCount_&&(this.outstandingGets_=[]),this.log_("get "+r+" timed out on connection"),t.reject(new Error("Client is offline.")))}),3e3),this.connected_&&this.sendGet_(r),t.promise}listen(e,t,n,i){this.initConnection_();const r=e._queryIdentifier,o=e._path.toString();this.log_("Listen called for "+o+" "+r),this.listens.has(o)||this.listens.set(o,new Map),s(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"listen() called for non-default but complete query"),s(!this.listens.get(o).has(r),"listen() called twice for same path/queryId.");const a={onComplete:i,hashFn:t,query:e,tag:n};this.listens.get(o).set(r,a),this.connected_&&this.sendListen_(a)}sendGet_(e){const t=this.outstandingGets_[e];this.sendRequest("g",t.request,(n=>{delete this.outstandingGets_[e],this.outstandingGetCount_--,0===this.outstandingGetCount_&&(this.outstandingGets_=[]),t.onComplete&&t.onComplete(n)}))}sendListen_(e){const t=e.query,n=t._path.toString(),i=t._queryIdentifier;this.log_("Listen on "+n+" for "+i);const r={p:n};e.tag&&(r.q=t._queryObject,r.t=e.tag),r.h=e.hashFn(),this.sendRequest("q",r,(r=>{const s=r.d,o=r.s;ns.warnOnListenWarnings_(s,t),(this.listens.get(n)&&this.listens.get(n).get(i))===e&&(this.log_("listen response",r),"ok"!==o&&this.removeListen_(n,i),e.onComplete&&e.onComplete(o,s))}))}static warnOnListenWarnings_(e,t){if(e&&"object"==typeof e&&T(e,"w")){const n=E(e,"w");if(Array.isArray(n)&&~n.indexOf("no_index")){const e='".indexOn": "'+t._queryParams.getIndex().toString()+'"',n=t._path.toString();er(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${e} at ${n} to your security rules for better performance.`)}}}refreshAuthToken(e){this.authToken_=e,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},(()=>{})),this.reduceReconnectDelayIfAdminCredential_(e)}reduceReconnectDelayIfAdminCredential_(e){(e&&40===e.length||function(e){const t=k(e).claims;return"object"==typeof t&&!0===t.admin}(e))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=3e4)}refreshAppCheckToken(e){this.appCheckToken_=e,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},(()=>{}))}tryAuth(){if(this.connected_&&this.authToken_){const e=this.authToken_,t=function(e){const t=k(e).claims;return!!t&&"object"==typeof t&&t.hasOwnProperty("iat")}(e)?"auth":"gauth",n={cred:e};null===this.authOverride_?n.noauth=!0:"object"==typeof this.authOverride_&&(n.authvar=this.authOverride_),this.sendRequest(t,n,(t=>{const n=t.s,i=t.d||"error";this.authToken_===e&&("ok"===n?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(n,i))}))}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},(e=>{const t=e.s,n=e.d||"error";"ok"===t?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(t,n)}))}unlisten(e,t){const n=e._path.toString(),i=e._queryIdentifier;this.log_("Unlisten called for "+n+" "+i),s(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(n,i)&&this.connected_&&this.sendUnlisten_(n,i,e._queryObject,t)}sendUnlisten_(e,t,n,i){this.log_("Unlisten on "+e+" for "+t);const r={p:e};i&&(r.q=n,r.t=i),this.sendRequest("n",r)}onDisconnectPut(e,t,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",e,t,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"o",data:t,onComplete:n})}onDisconnectMerge(e,t,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",e,t,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"om",data:t,onComplete:n})}onDisconnectCancel(e,t){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",e,null,t):this.onDisconnectRequestQueue_.push({pathString:e,action:"oc",data:null,onComplete:t})}sendOnDisconnect_(e,t,n,i){const r={p:t,d:n};this.log_("onDisconnect "+e,r),this.sendRequest(e,r,(e=>{i&&setTimeout((()=>{i(e.s,e.d)}),Math.floor(0))}))}put(e,t,n,i){this.putInternal("p",e,t,n,i)}merge(e,t,n,i){this.putInternal("m",e,t,n,i)}putInternal(e,t,n,i,r){this.initConnection_();const s={p:t,d:n};void 0!==r&&(s.h=r),this.outstandingPuts_.push({action:e,request:s,onComplete:i}),this.outstandingPutCount_++;const o=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(o):this.log_("Buffering put: "+t)}sendPut_(e){const t=this.outstandingPuts_[e].action,n=this.outstandingPuts_[e].request,i=this.outstandingPuts_[e].onComplete;this.outstandingPuts_[e].queued=this.connected_,this.sendRequest(t,n,(n=>{this.log_(t+" response",n),delete this.outstandingPuts_[e],this.outstandingPutCount_--,0===this.outstandingPutCount_&&(this.outstandingPuts_=[]),i&&i(n.s,n.d)}))}reportStats(e){if(this.connected_){const t={c:e};this.log_("reportStats",t),this.sendRequest("s",t,(e=>{if("ok"!==e.s){const t=e.d;this.log_("reportStats","Error sending stats: "+t)}}))}}onDataMessage_(e){if("r"in e){this.log_("from server: "+b(e));const t=e.r,n=this.requestCBHash_[t];n&&(delete this.requestCBHash_[t],n(e.b))}else{if("error"in e)throw"A server-side error has occurred: "+e.error;"a"in e&&this.onDataPush_(e.a,e.b)}}onDataPush_(e,t){this.log_("handleServerMessage",e,t),"d"===e?this.onDataUpdate_(t.p,t.d,!1,t.t):"m"===e?this.onDataUpdate_(t.p,t.d,!0,t.t):"c"===e?this.onListenRevoked_(t.p,t.q):"ac"===e?this.onAuthRevoked_(t.s,t.d):"apc"===e?this.onAppCheckRevoked_(t.s,t.d):"sd"===e?this.onSecurityDebugPacket_(t):Qi("Unrecognized action received from server: "+b(e)+"\nAre you using the latest client?")}onReady_(e,t){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=(new Date).getTime(),this.handleTimestamp_(e),this.lastSessionId=t,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(e){s(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout((()=>{this.establishConnectionTimer_=null,this.establishConnection_()}),Math.floor(e))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(e){e&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=ts,this.realtime_||this.scheduleConnect_(0)),this.visible_=e}onOnline_(e){e?(this.log_("Browser went online."),this.reconnectDelay_=ts,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&((new Date).getTime()-this.lastConnectionEstablishedTime_>3e4&&(this.reconnectDelay_=ts),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=(new Date).getTime());const e=(new Date).getTime()-this.lastConnectionAttemptTime_;let t=Math.max(0,this.reconnectDelay_-e);t=Math.random()*t,this.log_("Trying to reconnect in "+t+"ms"),this.scheduleConnect_(t),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,1.3*this.reconnectDelay_)}this.onConnectStatus_(!1)}async establishConnection_(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=(new Date).getTime(),this.lastConnectionEstablishedTime_=null;const e=this.onDataMessage_.bind(this),t=this.onReady_.bind(this),n=this.onRealtimeDisconnect_.bind(this),i=this.id+":"+ns.nextConnectionId_++,r=this.lastSessionId;let o=!1,a=null;const c=function(){a?a.close():(o=!0,n())},l=function(e){s(a,"sendRequest call when we're not connected not allowed."),a.sendRequest(e)};this.realtime_={close:c,sendRequest:l};const u=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{const[s,c]=await Promise.all([this.authTokenProvider_.getToken(u),this.appCheckTokenProvider_.getToken(u)]);o?Zi("getToken() completed but was canceled"):(Zi("getToken() completed. Creating connection."),this.authToken_=s&&s.accessToken,this.appCheckToken_=c&&c.token,a=new Rr(i,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,e,t,n,(e=>{er(e+" ("+this.repoInfo_.toString()+")"),this.interrupt("server_kill")}),r))}catch(e){this.log_("Failed to get token: "+e),o||(this.repoInfo_.nodeAdmin&&er(e),c())}}}interrupt(e){Zi("Interrupting connection for reason: "+e),this.interruptReasons_[e]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(e){Zi("Resuming connection for reason: "+e),delete this.interruptReasons_[e],I(this.interruptReasons_)&&(this.reconnectDelay_=ts,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(e){const t=e-(new Date).getTime();this.onServerInfoUpdate_({serverTimeOffset:t})}cancelSentTransactions_(){for(let e=0;e<this.outstandingPuts_.length;e++){const t=this.outstandingPuts_[e];t&&"h"in t.request&&t.queued&&(t.onComplete&&t.onComplete("disconnect"),delete this.outstandingPuts_[e],this.outstandingPutCount_--)}0===this.outstandingPutCount_&&(this.outstandingPuts_=[])}onListenRevoked_(e,t){let n;n=t?t.map((e=>ar(e))).join("$"):"default";const i=this.removeListen_(e,n);i&&i.onComplete&&i.onComplete("permission_denied")}removeListen_(e,t){const n=new Lr(e).toString();let i;if(this.listens.has(n)){const e=this.listens.get(n);i=e.get(t),e.delete(t),0===e.size&&this.listens.delete(n)}else i=void 0;return i}onAuthRevoked_(e,t){Zi("Auth token revoked: "+e+"/"+t),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),"invalid_token"!==e&&"permission_denied"!==e||(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=3&&(this.reconnectDelay_=3e4,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(e,t){Zi("App check token revoked: "+e+"/"+t),this.appCheckToken_=null,this.forceTokenRefresh_=!0,"invalid_token"!==e&&"permission_denied"!==e||(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=3&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(e){this.securityDebugCallback_?this.securityDebugCallback_(e):"msg"in e&&console.log("FIREBASE: "+e.msg.replace("\n","\nFIREBASE: "))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const e of this.listens.values())for(const t of e.values())this.sendListen_(t);for(let e=0;e<this.outstandingPuts_.length;e++)this.outstandingPuts_[e]&&this.sendPut_(e);for(;this.onDisconnectRequestQueue_.length;){const e=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(e.action,e.pathString,e.data,e.onComplete)}for(let e=0;e<this.outstandingGets_.length;e++)this.outstandingGets_[e]&&this.sendGet_(e)}sendConnectStats_(){const e={};let t="js";e["sdk."+t+"."+Ui.replace(/\./g,"-")]=1,f()?e["framework.cordova"]=1:g()&&(e["framework.reactnative"]=1),this.reportStats(e)}shouldReconnect_(){const e=Mr.getInstance().currentlyOnline();return I(this.interruptReasons_)&&e}}ns.nextPersistentConnectionId_=0,ns.nextConnectionId_=0;class is{constructor(e,t){this.name=e,this.node=t}static Wrap(e,t){return new is(e,t)}}class rs{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,t){const n=new is(nr,e),i=new is(nr,t);return 0!==this.compare(n,i)}minPost(){return is.MIN}}let ss;class os extends rs{static get __EMPTY_NODE(){return ss}static set __EMPTY_NODE(e){ss=e}compare(e,t){return rr(e.name,t.name)}isDefinedOn(e){throw o("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,t){return!1}minPost(){return is.MIN}maxPost(){return new is(ir,ss)}makePost(e,t){return s("string"==typeof e,"KeyIndex indexValue must always be a string."),new is(e,ss)}toString(){return".key"}}const as=new os;class cs{constructor(e,t,n,i,r=null){this.isReverse_=i,this.resultGenerator_=r,this.nodeStack_=[];let s=1;for(;!e.isEmpty();)if(e=e,s=t?n(e.key,t):1,i&&(s*=-1),s<0)e=this.isReverse_?e.left:e.right;else{if(0===s){this.nodeStack_.push(e);break}this.nodeStack_.push(e),e=this.isReverse_?e.right:e.left}}getNext(){if(0===this.nodeStack_.length)return null;let e,t=this.nodeStack_.pop();if(e=this.resultGenerator_?this.resultGenerator_(t.key,t.value):{key:t.key,value:t.value},this.isReverse_)for(t=t.left;!t.isEmpty();)this.nodeStack_.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack_.push(t),t=t.left;return e}hasNext(){return this.nodeStack_.length>0}peek(){if(0===this.nodeStack_.length)return null;const e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}}class ls{constructor(e,t,n,i,r){this.key=e,this.value=t,this.color=null!=n?n:ls.RED,this.left=null!=i?i:us.EMPTY_NODE,this.right=null!=r?r:us.EMPTY_NODE}copy(e,t,n,i,r){return new ls(null!=e?e:this.key,null!=t?t:this.value,null!=n?n:this.color,null!=i?i:this.left,null!=r?r:this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||!!e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let i=this;const r=n(e,i.key);return i=r<0?i.copy(null,null,null,i.left.insert(e,t,n),null):0===r?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,n)),i.fixUp_()}removeMin_(){if(this.left.isEmpty())return us.EMPTY_NODE;let e=this;return e.left.isRed_()||e.left.left.isRed_()||(e=e.moveRedLeft_()),e=e.copy(null,null,null,e.left.removeMin_(),null),e.fixUp_()}remove(e,t){let n,i;if(n=this,t(e,n.key)<0)n.left.isEmpty()||n.left.isRed_()||n.left.left.isRed_()||(n=n.moveRedLeft_()),n=n.copy(null,null,null,n.left.remove(e,t),null);else{if(n.left.isRed_()&&(n=n.rotateRight_()),n.right.isEmpty()||n.right.isRed_()||n.right.left.isRed_()||(n=n.moveRedRight_()),0===t(e,n.key)){if(n.right.isEmpty())return us.EMPTY_NODE;i=n.right.min_(),n=n.copy(i.key,i.value,null,null,n.right.removeMin_())}n=n.copy(null,null,null,null,n.right.remove(e,t))}return n.fixUp_()}isRed_(){return this.color}fixUp_(){let e=this;return e.right.isRed_()&&!e.left.isRed_()&&(e=e.rotateLeft_()),e.left.isRed_()&&e.left.left.isRed_()&&(e=e.rotateRight_()),e.left.isRed_()&&e.right.isRed_()&&(e=e.colorFlip_()),e}moveRedLeft_(){let e=this.colorFlip_();return e.right.left.isRed_()&&(e=e.copy(null,null,null,null,e.right.rotateRight_()),e=e.rotateLeft_(),e=e.colorFlip_()),e}moveRedRight_(){let e=this.colorFlip_();return e.left.left.isRed_()&&(e=e.rotateRight_(),e=e.colorFlip_()),e}rotateLeft_(){const e=this.copy(null,null,ls.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight_(){const e=this.copy(null,null,ls.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip_(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth_(){const e=this.check_();return Math.pow(2,e)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const e=this.left.check_();if(e!==this.right.check_())throw new Error("Black depths differ");return e+(this.isRed_()?0:1)}}ls.RED=!0,ls.BLACK=!1;class us{constructor(e,t=us.EMPTY_NODE){this.comparator_=e,this.root_=t}insert(e,t){return new us(this.comparator_,this.root_.insert(e,t,this.comparator_).copy(null,null,ls.BLACK,null,null))}remove(e){return new us(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,ls.BLACK,null,null))}get(e){let t,n=this.root_;for(;!n.isEmpty();){if(t=this.comparator_(e,n.key),0===t)return n.value;t<0?n=n.left:t>0&&(n=n.right)}return null}getPredecessorKey(e){let t,n=this.root_,i=null;for(;!n.isEmpty();){if(t=this.comparator_(e,n.key),0===t){if(n.left.isEmpty())return i?i.key:null;for(n=n.left;!n.right.isEmpty();)n=n.right;return n.key}t<0?n=n.left:t>0&&(i=n,n=n.right)}throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new cs(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,t){return new cs(this.root_,e,this.comparator_,!1,t)}getReverseIteratorFrom(e,t){return new cs(this.root_,e,this.comparator_,!0,t)}getReverseIterator(e){return new cs(this.root_,null,this.comparator_,!0,e)}}function hs(e,t){return rr(e.name,t.name)}function ds(e,t){return rr(e,t)}let ps;us.EMPTY_NODE=new class{copy(e,t,n,i,r){return this}insert(e,t,n){return new ls(e,t,null)}remove(e,t){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}};const fs=function(e){return"number"==typeof e?"number:"+ur(e):"string:"+e},_s=function(e){if(e.isLeafNode()){const t=e.val();s("string"==typeof t||"number"==typeof t||"object"==typeof t&&T(t,".sv"),"Priority must be a string or number.")}else s(e===ps||e.isEmpty(),"priority of unexpected type.");s(e===ps||e.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};let gs,ms,ys;class vs{constructor(e,t=vs.__childrenNodeConstructor.EMPTY_NODE){this.value_=e,this.priorityNode_=t,this.lazyHash_=null,s(void 0!==this.value_&&null!==this.value_,"LeafNode shouldn't be created with null/undefined value."),_s(this.priorityNode_)}static set __childrenNodeConstructor(e){gs=e}static get __childrenNodeConstructor(){return gs}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(e){return new vs(this.value_,e)}getImmediateChild(e){return".priority"===e?this.priorityNode_:vs.__childrenNodeConstructor.EMPTY_NODE}getChild(e){return Kr(e)?this:".priority"===Fr(e)?this.priorityNode_:vs.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(e,t){return null}updateImmediateChild(e,t){return".priority"===e?this.updatePriority(t):t.isEmpty()&&".priority"!==e?this:vs.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(e,t).updatePriority(this.priorityNode_)}updateChild(e,t){const n=Fr(e);return null===n?t:t.isEmpty()&&".priority"!==n?this:(s(".priority"!==n||1===jr(e),".priority must be the last token in a path"),this.updateImmediateChild(n,vs.__childrenNodeConstructor.EMPTY_NODE.updateChild(qr(e),t)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(e,t){return!1}val(e){return e&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(null===this.lazyHash_){let e="";this.priorityNode_.isEmpty()||(e+="priority:"+fs(this.priorityNode_.val())+":");const t=typeof this.value_;e+=t+":",e+="number"===t?ur(this.value_):this.value_,this.lazyHash_=Ki(e)}return this.lazyHash_}getValue(){return this.value_}compareTo(e){return e===vs.__childrenNodeConstructor.EMPTY_NODE?1:e instanceof vs.__childrenNodeConstructor?-1:(s(e.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(e))}compareToLeafNode_(e){const t=typeof e.value_,n=typeof this.value_,i=vs.VALUE_TYPE_ORDER.indexOf(t),r=vs.VALUE_TYPE_ORDER.indexOf(n);return s(i>=0,"Unknown leaf type: "+t),s(r>=0,"Unknown leaf type: "+n),i===r?"object"===n?0:this.value_<e.value_?-1:this.value_===e.value_?0:1:r-i}withIndex(){return this}isIndexed(){return!0}equals(e){if(e===this)return!0;if(e.isLeafNode()){const t=e;return this.value_===t.value_&&this.priorityNode_.equals(t.priorityNode_)}return!1}}vs.VALUE_TYPE_ORDER=["object","boolean","number","string"];const ws=new class extends rs{compare(e,t){const n=e.node.getPriority(),i=t.node.getPriority(),r=n.compareTo(i);return 0===r?rr(e.name,t.name):r}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,t){return!e.getPriority().equals(t.getPriority())}minPost(){return is.MIN}maxPost(){return new is(ir,new vs("[PRIORITY-POST]",ys))}makePost(e,t){const n=ms(e);return new is(t,new vs("[PRIORITY-POST]",n))}toString(){return".priority"}},bs=Math.log(2);class ks{constructor(e){var t;this.count=(t=e+1,parseInt(Math.log(t)/bs,10)),this.current_=this.count-1;const n=(i=this.count,parseInt(Array(i+1).join("1"),2));var i;this.bits_=e+1&n}nextBitIsOne(){const e=!(this.bits_&1<<this.current_);return this.current_--,e}}const Ts=function(e,t,n,i){e.sort(t);const r=function(t,i){const s=i-t;let o,a;if(0===s)return null;if(1===s)return o=e[t],a=n?n(o):o,new ls(a,o.node,ls.BLACK,null,null);{const c=parseInt(s/2,10)+t,l=r(t,c),u=r(c+1,i);return o=e[c],a=n?n(o):o,new ls(a,o.node,ls.BLACK,l,u)}},s=function(t){let i=null,s=null,o=e.length;const a=function(t,i){const s=o-t,a=o;o-=t;const l=r(s+1,a),u=e[s],h=n?n(u):u;c(new ls(h,u.node,i,null,l))},c=function(e){i?(i.left=e,i=e):(s=e,i=e)};for(let e=0;e<t.count;++e){const n=t.nextBitIsOne(),i=Math.pow(2,t.count-(e+1));n?a(i,ls.BLACK):(a(i,ls.BLACK),a(i,ls.RED))}return s}(new ks(e.length));return new us(i||t,s)};let Es;const Is={};class Ss{constructor(e,t){this.indexes_=e,this.indexSet_=t}static get Default(){return s(Is&&ws,"ChildrenNode.ts has not been loaded"),Es=Es||new Ss({".priority":Is},{".priority":ws}),Es}get(e){const t=E(this.indexes_,e);if(!t)throw new Error("No index defined for "+e);return t instanceof us?t:null}hasIndex(e){return T(this.indexSet_,e.toString())}addIndex(e,t){s(e!==as,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const n=[];let i=!1;const r=t.getIterator(is.Wrap);let o,a=r.getNext();for(;a;)i=i||e.isDefinedOn(a.node),n.push(a),a=r.getNext();o=i?Ts(n,e.getCompare()):Is;const c=e.toString(),l=Object.assign({},this.indexSet_);l[c]=e;const u=Object.assign({},this.indexes_);return u[c]=o,new Ss(u,l)}addToIndexes(e,t){const n=S(this.indexes_,((n,i)=>{const r=E(this.indexSet_,i);if(s(r,"Missing index implementation for "+i),n===Is){if(r.isDefinedOn(e.node)){const n=[],i=t.getIterator(is.Wrap);let s=i.getNext();for(;s;)s.name!==e.name&&n.push(s),s=i.getNext();return n.push(e),Ts(n,r.getCompare())}return Is}{const i=t.get(e.name);let r=n;return i&&(r=r.remove(new is(e.name,i))),r.insert(e,e.node)}}));return new Ss(n,this.indexSet_)}removeFromIndexes(e,t){const n=S(this.indexes_,(n=>{if(n===Is)return n;{const i=t.get(e.name);return i?n.remove(new is(e.name,i)):n}}));return new Ss(n,this.indexSet_)}}let Cs;class xs{constructor(e,t,n){this.children_=e,this.priorityNode_=t,this.indexMap_=n,this.lazyHash_=null,this.priorityNode_&&_s(this.priorityNode_),this.children_.isEmpty()&&s(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}static get EMPTY_NODE(){return Cs||(Cs=new xs(new us(ds),null,Ss.Default))}isLeafNode(){return!1}getPriority(){return this.priorityNode_||Cs}updatePriority(e){return this.children_.isEmpty()?this:new xs(this.children_,e,this.indexMap_)}getImmediateChild(e){if(".priority"===e)return this.getPriority();{const t=this.children_.get(e);return null===t?Cs:t}}getChild(e){const t=Fr(e);return null===t?this:this.getImmediateChild(t).getChild(qr(e))}hasChild(e){return null!==this.children_.get(e)}updateImmediateChild(e,t){if(s(t,"We should always be passing snapshot nodes"),".priority"===e)return this.updatePriority(t);{const n=new is(e,t);let i,r;t.isEmpty()?(i=this.children_.remove(e),r=this.indexMap_.removeFromIndexes(n,this.children_)):(i=this.children_.insert(e,t),r=this.indexMap_.addToIndexes(n,this.children_));const s=i.isEmpty()?Cs:this.priorityNode_;return new xs(i,s,r)}}updateChild(e,t){const n=Fr(e);if(null===n)return t;{s(".priority"!==Fr(e)||1===jr(e),".priority must be the last token in a path");const i=this.getImmediateChild(n).updateChild(qr(e),t);return this.updateImmediateChild(n,i)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(e){if(this.isEmpty())return null;const t={};let n=0,i=0,r=!0;if(this.forEachChild(ws,((s,o)=>{t[s]=o.val(e),n++,r&&xs.INTEGER_REGEXP_.test(s)?i=Math.max(i,Number(s)):r=!1})),!e&&r&&i<2*n){const e=[];for(const n in t)e[n]=t[n];return e}return e&&!this.getPriority().isEmpty()&&(t[".priority"]=this.getPriority().val()),t}hash(){if(null===this.lazyHash_){let e="";this.getPriority().isEmpty()||(e+="priority:"+fs(this.getPriority().val())+":"),this.forEachChild(ws,((t,n)=>{const i=n.hash();""!==i&&(e+=":"+t+":"+i)})),this.lazyHash_=""===e?"":Ki(e)}return this.lazyHash_}getPredecessorChildName(e,t,n){const i=this.resolveIndex_(n);if(i){const n=i.getPredecessorKey(new is(e,t));return n?n.name:null}return this.children_.getPredecessorKey(e)}getFirstChildName(e){const t=this.resolveIndex_(e);if(t){const e=t.minKey();return e&&e.name}return this.children_.minKey()}getFirstChild(e){const t=this.getFirstChildName(e);return t?new is(t,this.children_.get(t)):null}getLastChildName(e){const t=this.resolveIndex_(e);if(t){const e=t.maxKey();return e&&e.name}return this.children_.maxKey()}getLastChild(e){const t=this.getLastChildName(e);return t?new is(t,this.children_.get(t)):null}forEachChild(e,t){const n=this.resolveIndex_(e);return n?n.inorderTraversal((e=>t(e.name,e.node))):this.children_.inorderTraversal(t)}getIterator(e){return this.getIteratorFrom(e.minPost(),e)}getIteratorFrom(e,t){const n=this.resolveIndex_(t);if(n)return n.getIteratorFrom(e,(e=>e));{const n=this.children_.getIteratorFrom(e.name,is.Wrap);let i=n.peek();for(;null!=i&&t.compare(i,e)<0;)n.getNext(),i=n.peek();return n}}getReverseIterator(e){return this.getReverseIteratorFrom(e.maxPost(),e)}getReverseIteratorFrom(e,t){const n=this.resolveIndex_(t);if(n)return n.getReverseIteratorFrom(e,(e=>e));{const n=this.children_.getReverseIteratorFrom(e.name,is.Wrap);let i=n.peek();for(;null!=i&&t.compare(i,e)>0;)n.getNext(),i=n.peek();return n}}compareTo(e){return this.isEmpty()?e.isEmpty()?0:-1:e.isLeafNode()||e.isEmpty()?1:e===As?-1:0}withIndex(e){if(e===as||this.indexMap_.hasIndex(e))return this;{const t=this.indexMap_.addIndex(e,this.children_);return new xs(this.children_,this.priorityNode_,t)}}isIndexed(e){return e===as||this.indexMap_.hasIndex(e)}equals(e){if(e===this)return!0;if(e.isLeafNode())return!1;{const t=e;if(this.getPriority().equals(t.getPriority())){if(this.children_.count()===t.children_.count()){const e=this.getIterator(ws),n=t.getIterator(ws);let i=e.getNext(),r=n.getNext();for(;i&&r;){if(i.name!==r.name||!i.node.equals(r.node))return!1;i=e.getNext(),r=n.getNext()}return null===i&&null===r}return!1}return!1}}resolveIndex_(e){return e===as?null:this.indexMap_.get(e.toString())}}xs.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/;const As=new class extends xs{constructor(){super(new us(ds),xs.EMPTY_NODE,Ss.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return xs.EMPTY_NODE}isEmpty(){return!1}};function Ns(e,t=null){if(null===e)return xs.EMPTY_NODE;if("object"==typeof e&&".priority"in e&&(t=e[".priority"]),s(null===t||"string"==typeof t||"number"==typeof t||"object"==typeof t&&".sv"in t,"Invalid priority type found: "+typeof t),"object"==typeof e&&".value"in e&&null!==e[".value"]&&(e=e[".value"]),"object"!=typeof e||".sv"in e)return new vs(e,Ns(t));if(e instanceof Array){let n=xs.EMPTY_NODE;return lr(e,((t,i)=>{if(T(e,t)&&"."!==t.substring(0,1)){const e=Ns(i);!e.isLeafNode()&&e.isEmpty()||(n=n.updateImmediateChild(t,e))}})),n.updatePriority(Ns(t))}{const n=[];let i=!1;if(lr(e,((e,t)=>{if("."!==e.substring(0,1)){const r=Ns(t);r.isEmpty()||(i=i||!r.getPriority().isEmpty(),n.push(new is(e,r)))}})),0===n.length)return xs.EMPTY_NODE;const r=Ts(n,hs,(e=>e.name),ds);if(i){const e=Ts(n,ws.getCompare());return new xs(r,Ns(t),new Ss({".priority":e},{".priority":ws}))}return new xs(r,Ns(t),Ss.Default)}}Object.defineProperties(is,{MIN:{value:new is(nr,xs.EMPTY_NODE)},MAX:{value:new is(ir,As)}}),os.__EMPTY_NODE=xs.EMPTY_NODE,vs.__childrenNodeConstructor=xs,ps=As,ys=As,function(e){ms=e}(Ns);class Ps extends rs{constructor(e){super(),this.indexPath_=e,s(!Kr(e)&&".priority"!==Fr(e),"Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,t){const n=this.extractChild(e.node),i=this.extractChild(t.node),r=n.compareTo(i);return 0===r?rr(e.name,t.name):r}makePost(e,t){const n=Ns(e),i=xs.EMPTY_NODE.updateChild(this.indexPath_,n);return new is(t,i)}maxPost(){const e=xs.EMPTY_NODE.updateChild(this.indexPath_,As);return new is(ir,e)}toString(){return Wr(this.indexPath_,0).join("/")}}const Os=new class extends rs{compare(e,t){const n=e.node.compareTo(t.node);return 0===n?rr(e.name,t.name):n}isDefinedOn(e){return!0}indexedValueChanged(e,t){return!e.equals(t)}minPost(){return is.MIN}maxPost(){return is.MAX}makePost(e,t){const n=Ns(e);return new is(t,n)}toString(){return".value"}};function Rs(e){return{type:"value",snapshotNode:e}}function Ds(e,t){return{type:"child_added",snapshotNode:t,childName:e}}function zs(e,t){return{type:"child_removed",snapshotNode:t,childName:e}}function Ms(e,t,n){return{type:"child_changed",snapshotNode:t,childName:e,oldSnap:n}}class Ls{constructor(e){this.index_=e}updateChild(e,t,n,i,r,o){s(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");const a=e.getImmediateChild(t);return a.getChild(i).equals(n.getChild(i))&&a.isEmpty()===n.isEmpty()?e:(null!=o&&(n.isEmpty()?e.hasChild(t)?o.trackChildChange(zs(t,a)):s(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):a.isEmpty()?o.trackChildChange(Ds(t,n)):o.trackChildChange(Ms(t,n,a))),e.isLeafNode()&&n.isEmpty()?e:e.updateImmediateChild(t,n).withIndex(this.index_))}updateFullNode(e,t,n){return null!=n&&(e.isLeafNode()||e.forEachChild(ws,((e,i)=>{t.hasChild(e)||n.trackChildChange(zs(e,i))})),t.isLeafNode()||t.forEachChild(ws,((t,i)=>{if(e.hasChild(t)){const r=e.getImmediateChild(t);r.equals(i)||n.trackChildChange(Ms(t,i,r))}else n.trackChildChange(Ds(t,i))}))),t.withIndex(this.index_)}updatePriority(e,t){return e.isEmpty()?xs.EMPTY_NODE:e.updatePriority(t)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}}class Us{constructor(e){this.indexedFilter_=new Ls(e.getIndex()),this.index_=e.getIndex(),this.startPost_=Us.getStartPost_(e),this.endPost_=Us.getEndPost_(e)}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){return this.index_.compare(this.getStartPost(),e)<=0&&this.index_.compare(e,this.getEndPost())<=0}updateChild(e,t,n,i,r,s){return this.matches(new is(t,n))||(n=xs.EMPTY_NODE),this.indexedFilter_.updateChild(e,t,n,i,r,s)}updateFullNode(e,t,n){t.isLeafNode()&&(t=xs.EMPTY_NODE);let i=t.withIndex(this.index_);i=i.updatePriority(xs.EMPTY_NODE);const r=this;return t.forEachChild(ws,((e,t)=>{r.matches(new is(e,t))||(i=i.updateImmediateChild(e,xs.EMPTY_NODE))})),this.indexedFilter_.updateFullNode(e,i,n)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){const t=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),t)}return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){const t=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),t)}return e.getIndex().maxPost()}}class Fs{constructor(e){this.rangedFilter_=new Us(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft()}updateChild(e,t,n,i,r,s){return this.rangedFilter_.matches(new is(t,n))||(n=xs.EMPTY_NODE),e.getImmediateChild(t).equals(n)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,t,n,i,r,s):this.fullLimitUpdateChild_(e,t,n,r,s)}updateFullNode(e,t,n){let i;if(t.isLeafNode()||t.isEmpty())i=xs.EMPTY_NODE.withIndex(this.index_);else if(2*this.limit_<t.numChildren()&&t.isIndexed(this.index_)){let e;i=xs.EMPTY_NODE.withIndex(this.index_),e=this.reverse_?t.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):t.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let n=0;for(;e.hasNext()&&n<this.limit_;){const t=e.getNext();let r;if(r=this.reverse_?this.index_.compare(this.rangedFilter_.getStartPost(),t)<=0:this.index_.compare(t,this.rangedFilter_.getEndPost())<=0,!r)break;i=i.updateImmediateChild(t.name,t.node),n++}}else{let e,n,r,s;if(i=t.withIndex(this.index_),i=i.updatePriority(xs.EMPTY_NODE),this.reverse_){s=i.getReverseIterator(this.index_),e=this.rangedFilter_.getEndPost(),n=this.rangedFilter_.getStartPost();const t=this.index_.getCompare();r=(e,n)=>t(n,e)}else s=i.getIterator(this.index_),e=this.rangedFilter_.getStartPost(),n=this.rangedFilter_.getEndPost(),r=this.index_.getCompare();let o=0,a=!1;for(;s.hasNext();){const t=s.getNext();!a&&r(e,t)<=0&&(a=!0),a&&o<this.limit_&&r(t,n)<=0?o++:i=i.updateImmediateChild(t.name,xs.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,i,n)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,t,n,i,r){let o;if(this.reverse_){const e=this.index_.getCompare();o=(t,n)=>e(n,t)}else o=this.index_.getCompare();const a=e;s(a.numChildren()===this.limit_,"");const c=new is(t,n),l=this.reverse_?a.getFirstChild(this.index_):a.getLastChild(this.index_),u=this.rangedFilter_.matches(c);if(a.hasChild(t)){const e=a.getImmediateChild(t);let s=i.getChildAfterChild(this.index_,l,this.reverse_);for(;null!=s&&(s.name===t||a.hasChild(s.name));)s=i.getChildAfterChild(this.index_,s,this.reverse_);const h=null==s?1:o(s,c);if(u&&!n.isEmpty()&&h>=0)return null!=r&&r.trackChildChange(Ms(t,n,e)),a.updateImmediateChild(t,n);{null!=r&&r.trackChildChange(zs(t,e));const n=a.updateImmediateChild(t,xs.EMPTY_NODE);return null!=s&&this.rangedFilter_.matches(s)?(null!=r&&r.trackChildChange(Ds(s.name,s.node)),n.updateImmediateChild(s.name,s.node)):n}}return n.isEmpty()?e:u&&o(l,c)>=0?(null!=r&&(r.trackChildChange(zs(l.name,l.node)),r.trackChildChange(Ds(t,n))),a.updateImmediateChild(t,n).updateImmediateChild(l.name,xs.EMPTY_NODE)):e}}class js{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=ws}hasStart(){return this.startSet_}hasStartAfter(){return this.startAfterSet_}hasEndBefore(){return this.endBeforeSet_}isViewFromLeft(){return""===this.viewFrom_?this.startSet_:"l"===this.viewFrom_}getIndexStartValue(){return s(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return s(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:nr}hasEnd(){return this.endSet_}getIndexEndValue(){return s(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return s(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:ir}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&""!==this.viewFrom_}getLimit(){return s(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===ws}copy(){const e=new js;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}}function qs(e){const t={};if(e.isDefault())return t;let n;return e.index_===ws?n="$priority":e.index_===Os?n="$value":e.index_===as?n="$key":(s(e.index_ instanceof Ps,"Unrecognized index type!"),n=e.index_.toString()),t.orderBy=b(n),e.startSet_&&(t.startAt=b(e.indexStartValue_),e.startNameSet_&&(t.startAt+=","+b(e.indexStartName_))),e.endSet_&&(t.endAt=b(e.indexEndValue_),e.endNameSet_&&(t.endAt+=","+b(e.indexEndName_))),e.limitSet_&&(e.isViewFromLeft()?t.limitToFirst=e.limit_:t.limitToLast=e.limit_),t}function Bs(e){const t={};if(e.startSet_&&(t.sp=e.indexStartValue_,e.startNameSet_&&(t.sn=e.indexStartName_)),e.endSet_&&(t.ep=e.indexEndValue_,e.endNameSet_&&(t.en=e.indexEndName_)),e.limitSet_){t.l=e.limit_;let n=e.viewFrom_;""===n&&(n=e.isViewFromLeft()?"l":"r"),t.vf=n}return e.index_!==ws&&(t.i=e.index_.toString()),t}class Ws extends Dr{constructor(e,t,n,i){super(),this.repoInfo_=e,this.onDataUpdate_=t,this.authTokenProvider_=n,this.appCheckTokenProvider_=i,this.log_=Yi("p:rest:"),this.listens_={}}reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,t){return void 0!==t?"tag$"+t:(s(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}listen(e,t,n,i){const r=e._path.toString();this.log_("Listen called for "+r+" "+e._queryIdentifier);const s=Ws.getListenId_(e,n),o={};this.listens_[s]=o;const a=qs(e._queryParams);this.restRequest_(r+".json",a,((e,t)=>{let a=t;if(404===e&&(a=null,e=null),null===e&&this.onDataUpdate_(r,a,!1,n),E(this.listens_,s)===o){let t;t=e?401===e?"permission_denied":"rest_error:"+e:"ok",i(t,null)}}))}unlisten(e,t){const n=Ws.getListenId_(e,t);delete this.listens_[n]}get(e){const t=qs(e._queryParams),n=e._path.toString(),i=new d;return this.restRequest_(n+".json",t,((e,t)=>{let r=t;404===e&&(r=null,e=null),null===e?(this.onDataUpdate_(n,r,!1,null),i.resolve(r)):i.reject(new Error(r))})),i.promise}refreshAuthToken(e){}restRequest_(e,t={},n){return t.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then((([i,r])=>{i&&i.accessToken&&(t.auth=i.accessToken),r&&r.token&&(t.ac=r.token);const s=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+A(t);this.log_("Sending REST request for "+s);const o=new XMLHttpRequest;o.onreadystatechange=()=>{if(n&&4===o.readyState){this.log_("REST Response for "+s+" received. status:",o.status,"response:",o.responseText);let e=null;if(o.status>=200&&o.status<300){try{e=w(o.responseText)}catch(e){er("Failed to parse JSON response for "+s+": "+o.responseText)}n(null,e)}else 401!==o.status&&404!==o.status&&er("Got unsuccessful REST response for "+s+" Status: "+o.status),n(o.status);n=null}},o.open("GET",s,!0),o.send()}))}}class Vs{constructor(){this.rootNode_=xs.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,t){this.rootNode_=this.rootNode_.updateChild(e,t)}}function Hs(){return{value:null,children:new Map}}function Ks(e,t,n){if(Kr(t))e.value=n,e.children.clear();else if(null!==e.value)e.value=e.value.updateChild(t,n);else{const i=Fr(t);e.children.has(i)||e.children.set(i,Hs()),Ks(e.children.get(i),t=qr(t),n)}}function $s(e,t,n){null!==e.value?n(t,e.value):function(e,t){e.children.forEach(((e,n)=>{t(n,e)}))}(e,((e,i)=>{$s(i,new Lr(t.toString()+"/"+e),n)}))}class Gs{constructor(e){this.collection_=e,this.last_=null}get(){const e=this.collection_.get(),t=Object.assign({},e);return this.last_&&lr(this.last_,((e,n)=>{t[e]=t[e]-n})),this.last_=e,t}}class Js{constructor(e,t){this.server_=t,this.statsToReport_={},this.statsListener_=new Gs(e);const n=1e4+2e4*Math.random();fr(this.reportStats_.bind(this),Math.floor(n))}reportStats_(){const e=this.statsListener_.get(),t={};let n=!1;lr(e,((e,i)=>{i>0&&T(this.statsToReport_,e)&&(t[e]=i,n=!0)})),n&&this.server_.reportStats(t),fr(this.reportStats_.bind(this),Math.floor(2*Math.random()*3e5))}}var Zs,Ys;function Qs(e){return{fromUser:!1,fromServer:!0,queryId:e,tagged:!0}}(Ys=Zs||(Zs={}))[Ys.OVERWRITE=0]="OVERWRITE",Ys[Ys.MERGE=1]="MERGE",Ys[Ys.ACK_USER_WRITE=2]="ACK_USER_WRITE",Ys[Ys.LISTEN_COMPLETE=3]="LISTEN_COMPLETE";class Xs{constructor(e,t,n){this.path=e,this.affectedTree=t,this.revert=n,this.type=Zs.ACK_USER_WRITE,this.source={fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}operationForChild(e){if(Kr(this.path)){if(null!=this.affectedTree.value)return s(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const t=this.affectedTree.subtree(new Lr(e));return new Xs(Ur(),t,this.revert)}}return s(Fr(this.path)===e,"operationForChild called for unrelated child."),new Xs(qr(this.path),this.affectedTree,this.revert)}}class eo{constructor(e,t){this.source=e,this.path=t,this.type=Zs.LISTEN_COMPLETE}operationForChild(e){return Kr(this.path)?new eo(this.source,Ur()):new eo(this.source,qr(this.path))}}class to{constructor(e,t,n){this.source=e,this.path=t,this.snap=n,this.type=Zs.OVERWRITE}operationForChild(e){return Kr(this.path)?new to(this.source,Ur(),this.snap.getImmediateChild(e)):new to(this.source,qr(this.path),this.snap)}}class no{constructor(e,t,n){this.source=e,this.path=t,this.children=n,this.type=Zs.MERGE}operationForChild(e){if(Kr(this.path)){const t=this.children.subtree(new Lr(e));return t.isEmpty()?null:t.value?new to(this.source,Ur(),t.value):new no(this.source,Ur(),t)}return s(Fr(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new no(this.source,qr(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}class io{constructor(e,t,n){this.node_=e,this.fullyInitialized_=t,this.filtered_=n}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(Kr(e))return this.isFullyInitialized()&&!this.filtered_;const t=Fr(e);return this.isCompleteForChild(t)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}}class ro{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}}function so(e,t,n,i,r,s){const a=i.filter((e=>e.type===n));a.sort(((t,n)=>function(e,t,n){if(null==t.childName||null==n.childName)throw o("Should only compare child_ events.");const i=new is(t.childName,t.snapshotNode),r=new is(n.childName,n.snapshotNode);return e.index_.compare(i,r)}(e,t,n))),a.forEach((n=>{const i=function(e,t,n){return"value"===t.type||"child_removed"===t.type||(t.prevName=n.getPredecessorChildName(t.childName,t.snapshotNode,e.index_)),t}(e,n,s);r.forEach((r=>{r.respondsTo(n.type)&&t.push(r.createEvent(i,e.query_))}))}))}function oo(e,t){return{eventCache:e,serverCache:t}}function ao(e,t,n,i){return oo(new io(t,n,i),e.serverCache)}function co(e,t,n,i){return oo(e.eventCache,new io(t,n,i))}function lo(e){return e.eventCache.isFullyInitialized()?e.eventCache.getNode():null}function uo(e){return e.serverCache.isFullyInitialized()?e.serverCache.getNode():null}let ho;class po{constructor(e,t=(()=>(ho||(ho=new us(sr)),ho))()){this.value=e,this.children=t}static fromObject(e){let t=new po(null);return lr(e,((e,n)=>{t=t.set(new Lr(e),n)})),t}isEmpty(){return null===this.value&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,t){if(null!=this.value&&t(this.value))return{path:Ur(),value:this.value};if(Kr(e))return null;{const n=Fr(e),i=this.children.get(n);if(null!==i){const r=i.findRootMostMatchingPathAndValue(qr(e),t);return null!=r?{path:Hr(new Lr(n),r.path),value:r.value}:null}return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,(()=>!0))}subtree(e){if(Kr(e))return this;{const t=Fr(e),n=this.children.get(t);return null!==n?n.subtree(qr(e)):new po(null)}}set(e,t){if(Kr(e))return new po(t,this.children);{const n=Fr(e),i=(this.children.get(n)||new po(null)).set(qr(e),t),r=this.children.insert(n,i);return new po(this.value,r)}}remove(e){if(Kr(e))return this.children.isEmpty()?new po(null):new po(null,this.children);{const t=Fr(e),n=this.children.get(t);if(n){const i=n.remove(qr(e));let r;return r=i.isEmpty()?this.children.remove(t):this.children.insert(t,i),null===this.value&&r.isEmpty()?new po(null):new po(this.value,r)}return this}}get(e){if(Kr(e))return this.value;{const t=Fr(e),n=this.children.get(t);return n?n.get(qr(e)):null}}setTree(e,t){if(Kr(e))return t;{const n=Fr(e),i=(this.children.get(n)||new po(null)).setTree(qr(e),t);let r;return r=i.isEmpty()?this.children.remove(n):this.children.insert(n,i),new po(this.value,r)}}fold(e){return this.fold_(Ur(),e)}fold_(e,t){const n={};return this.children.inorderTraversal(((i,r)=>{n[i]=r.fold_(Hr(e,i),t)})),t(e,this.value,n)}findOnPath(e,t){return this.findOnPath_(e,Ur(),t)}findOnPath_(e,t,n){const i=!!this.value&&n(t,this.value);if(i)return i;if(Kr(e))return null;{const i=Fr(e),r=this.children.get(i);return r?r.findOnPath_(qr(e),Hr(t,i),n):null}}foreachOnPath(e,t){return this.foreachOnPath_(e,Ur(),t)}foreachOnPath_(e,t,n){if(Kr(e))return this;{this.value&&n(t,this.value);const i=Fr(e),r=this.children.get(i);return r?r.foreachOnPath_(qr(e),Hr(t,i),n):new po(null)}}foreach(e){this.foreach_(Ur(),e)}foreach_(e,t){this.children.inorderTraversal(((n,i)=>{i.foreach_(Hr(e,n),t)})),this.value&&t(e,this.value)}foreachChild(e){this.children.inorderTraversal(((t,n)=>{n.value&&e(t,n.value)}))}}class fo{constructor(e){this.writeTree_=e}static empty(){return new fo(new po(null))}}function _o(e,t,n){if(Kr(t))return new fo(new po(n));{const i=e.writeTree_.findRootMostValueAndPath(t);if(null!=i){const r=i.path;let s=i.value;const o=$r(r,t);return s=s.updateChild(o,n),new fo(e.writeTree_.set(r,s))}{const i=new po(n),r=e.writeTree_.setTree(t,i);return new fo(r)}}}function go(e,t,n){let i=e;return lr(n,((e,n)=>{i=_o(i,Hr(t,e),n)})),i}function mo(e,t){if(Kr(t))return fo.empty();{const n=e.writeTree_.setTree(t,new po(null));return new fo(n)}}function yo(e,t){return null!=vo(e,t)}function vo(e,t){const n=e.writeTree_.findRootMostValueAndPath(t);return null!=n?e.writeTree_.get(n.path).getChild($r(n.path,t)):null}function wo(e){const t=[],n=e.writeTree_.value;return null!=n?n.isLeafNode()||n.forEachChild(ws,((e,n)=>{t.push(new is(e,n))})):e.writeTree_.children.inorderTraversal(((e,n)=>{null!=n.value&&t.push(new is(e,n.value))})),t}function bo(e,t){if(Kr(t))return e;{const n=vo(e,t);return new fo(null!=n?new po(n):e.writeTree_.subtree(t))}}function ko(e){return e.writeTree_.isEmpty()}function To(e,t){return Eo(Ur(),e.writeTree_,t)}function Eo(e,t,n){if(null!=t.value)return n.updateChild(e,t.value);{let i=null;return t.children.inorderTraversal(((t,r)=>{".priority"===t?(s(null!==r.value,"Priority writes must always be leaf nodes"),i=r.value):n=Eo(Hr(e,t),r,n)})),n.getChild(e).isEmpty()||null===i||(n=n.updateChild(Hr(e,".priority"),i)),n}}function Io(e,t){return Mo(t,e)}function So(e,t){if(e.snap)return Zr(e.path,t);for(const n in e.children)if(e.children.hasOwnProperty(n)&&Zr(Hr(e.path,n),t))return!0;return!1}function Co(e){return e.visible}function xo(e,t,n){let i=fo.empty();for(let r=0;r<e.length;++r){const s=e[r];if(t(s)){const e=s.path;let t;if(s.snap)Zr(n,e)?(t=$r(n,e),i=_o(i,t,s.snap)):Zr(e,n)&&(t=$r(e,n),i=_o(i,Ur(),s.snap.getChild(t)));else{if(!s.children)throw o("WriteRecord should have .snap or .children");if(Zr(n,e))t=$r(n,e),i=go(i,t,s.children);else if(Zr(e,n))if(t=$r(e,n),Kr(t))i=go(i,Ur(),s.children);else{const e=E(s.children,Fr(t));if(e){const n=e.getChild(qr(t));i=_o(i,Ur(),n)}}}}}return i}function Ao(e,t,n,i,r){if(i||r){const s=bo(e.visibleWrites,t);if(!r&&ko(s))return n;if(r||null!=n||yo(s,Ur())){const s=function(e){return(e.visible||r)&&(!i||!~i.indexOf(e.writeId))&&(Zr(e.path,t)||Zr(t,e.path))};return To(xo(e.allWrites,s,t),n||xs.EMPTY_NODE)}return null}{const i=vo(e.visibleWrites,t);if(null!=i)return i;{const i=bo(e.visibleWrites,t);return ko(i)?n:null!=n||yo(i,Ur())?To(i,n||xs.EMPTY_NODE):null}}}function No(e,t,n,i){return Ao(e.writeTree,e.treePath,t,n,i)}function Po(e,t){return function(e,t,n){let i=xs.EMPTY_NODE;const r=vo(e.visibleWrites,t);if(r)return r.isLeafNode()||r.forEachChild(ws,((e,t)=>{i=i.updateImmediateChild(e,t)})),i;if(n){const r=bo(e.visibleWrites,t);return n.forEachChild(ws,((e,t)=>{const n=To(bo(r,new Lr(e)),t);i=i.updateImmediateChild(e,n)})),wo(r).forEach((e=>{i=i.updateImmediateChild(e.name,e.node)})),i}return wo(bo(e.visibleWrites,t)).forEach((e=>{i=i.updateImmediateChild(e.name,e.node)})),i}(e.writeTree,e.treePath,t)}function Oo(e,t,n,i){return function(e,t,n,i,r){s(i||r,"Either existingEventSnap or existingServerSnap must exist");const o=Hr(t,n);if(yo(e.visibleWrites,o))return null;{const t=bo(e.visibleWrites,o);return ko(t)?r.getChild(n):To(t,r.getChild(n))}}(e.writeTree,e.treePath,t,n,i)}function Ro(e,t){return function(e,t){return vo(e.visibleWrites,t)}(e.writeTree,Hr(e.treePath,t))}function Do(e,t,n){return function(e,t,n,i){const r=Hr(t,n),s=vo(e.visibleWrites,r);return null!=s?s:i.isCompleteForChild(n)?To(bo(e.visibleWrites,r),i.getNode().getImmediateChild(n)):null}(e.writeTree,e.treePath,t,n)}function zo(e,t){return Mo(Hr(e.treePath,t),e.writeTree)}function Mo(e,t){return{treePath:e,writeTree:t}}class Lo{constructor(){this.changeMap=new Map}trackChildChange(e){const t=e.type,n=e.childName;s("child_added"===t||"child_changed"===t||"child_removed"===t,"Only child changes supported for tracking"),s(".priority"!==n,"Only non-priority child changes can be tracked.");const i=this.changeMap.get(n);if(i){const r=i.type;if("child_added"===t&&"child_removed"===r)this.changeMap.set(n,Ms(n,e.snapshotNode,i.snapshotNode));else if("child_removed"===t&&"child_added"===r)this.changeMap.delete(n);else if("child_removed"===t&&"child_changed"===r)this.changeMap.set(n,zs(n,i.oldSnap));else if("child_changed"===t&&"child_added"===r)this.changeMap.set(n,Ds(n,e.snapshotNode));else{if("child_changed"!==t||"child_changed"!==r)throw o("Illegal combination of changes: "+e+" occurred after "+i);this.changeMap.set(n,Ms(n,e.snapshotNode,i.oldSnap))}}else this.changeMap.set(n,e)}getChanges(){return Array.from(this.changeMap.values())}}const Uo=new class{getCompleteChild(e){return null}getChildAfterChild(e,t,n){return null}};class Fo{constructor(e,t,n=null){this.writes_=e,this.viewCache_=t,this.optCompleteServerCache_=n}getCompleteChild(e){const t=this.viewCache_.eventCache;if(t.isCompleteForChild(e))return t.getNode().getImmediateChild(e);{const t=null!=this.optCompleteServerCache_?new io(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return Do(this.writes_,e,t)}}getChildAfterChild(e,t,n){const i=null!=this.optCompleteServerCache_?this.optCompleteServerCache_:uo(this.viewCache_),r=function(e,t,n,i,r,s){return function(e,t,n,i,r,s,o){let a;const c=bo(e.visibleWrites,t),l=vo(c,Ur());if(null!=l)a=l;else{if(null==n)return[];a=To(c,n)}if(a=a.withIndex(o),a.isEmpty()||a.isLeafNode())return[];{const e=[],t=o.getCompare(),n=s?a.getReverseIteratorFrom(i,o):a.getIteratorFrom(i,o);let c=n.getNext();for(;c&&e.length<r;)0!==t(c,i)&&e.push(c),c=n.getNext();return e}}(e.writeTree,e.treePath,t,n,i,r,s)}(this.writes_,i,t,1,n,e);return 0===r.length?null:r[0]}}function jo(e,t,n,i,r,o){const a=t.eventCache;if(null!=Ro(i,n))return t;{let c,l;if(Kr(n))if(s(t.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),t.serverCache.isFiltered()){const n=uo(t),r=Po(i,n instanceof xs?n:xs.EMPTY_NODE);c=e.filter.updateFullNode(t.eventCache.getNode(),r,o)}else{const n=No(i,uo(t));c=e.filter.updateFullNode(t.eventCache.getNode(),n,o)}else{const u=Fr(n);if(".priority"===u){s(1===jr(n),"Can't have a priority with additional path components");const r=a.getNode();l=t.serverCache.getNode();const o=Oo(i,n,r,l);c=null!=o?e.filter.updatePriority(r,o):a.getNode()}else{const s=qr(n);let h;if(a.isCompleteForChild(u)){l=t.serverCache.getNode();const e=Oo(i,n,a.getNode(),l);h=null!=e?a.getNode().getImmediateChild(u).updateChild(s,e):a.getNode().getImmediateChild(u)}else h=Do(i,u,t.serverCache);c=null!=h?e.filter.updateChild(a.getNode(),u,h,s,r,o):a.getNode()}}return ao(t,c,a.isFullyInitialized()||Kr(n),e.filter.filtersNodes())}}function qo(e,t,n,i,r,s,o,a){const c=t.serverCache;let l;const u=o?e.filter:e.filter.getIndexedFilter();if(Kr(n))l=u.updateFullNode(c.getNode(),i,null);else if(u.filtersNodes()&&!c.isFiltered()){const e=c.getNode().updateChild(n,i);l=u.updateFullNode(c.getNode(),e,null)}else{const e=Fr(n);if(!c.isCompleteForPath(n)&&jr(n)>1)return t;const r=qr(n),s=c.getNode().getImmediateChild(e).updateChild(r,i);l=".priority"===e?u.updatePriority(c.getNode(),s):u.updateChild(c.getNode(),e,s,r,Uo,null)}const h=co(t,l,c.isFullyInitialized()||Kr(n),u.filtersNodes());return jo(e,h,n,r,new Fo(r,h,s),a)}function Bo(e,t,n,i,r,s,o){const a=t.eventCache;let c,l;const u=new Fo(r,t,s);if(Kr(n))l=e.filter.updateFullNode(t.eventCache.getNode(),i,o),c=ao(t,l,!0,e.filter.filtersNodes());else{const r=Fr(n);if(".priority"===r)l=e.filter.updatePriority(t.eventCache.getNode(),i),c=ao(t,l,a.isFullyInitialized(),a.isFiltered());else{const s=qr(n),l=a.getNode().getImmediateChild(r);let h;if(Kr(s))h=i;else{const e=u.getCompleteChild(r);h=null!=e?".priority"===Br(s)&&e.getChild(Vr(s)).isEmpty()?e:e.updateChild(s,i):xs.EMPTY_NODE}c=l.equals(h)?t:ao(t,e.filter.updateChild(a.getNode(),r,h,s,u,o),a.isFullyInitialized(),e.filter.filtersNodes())}}return c}function Wo(e,t){return e.eventCache.isCompleteForChild(t)}function Vo(e,t,n){return n.foreach(((e,n)=>{t=t.updateChild(e,n)})),t}function Ho(e,t,n,i,r,s,o,a){if(t.serverCache.getNode().isEmpty()&&!t.serverCache.isFullyInitialized())return t;let c,l=t;c=Kr(n)?i:new po(null).setTree(n,i);const u=t.serverCache.getNode();return c.children.inorderTraversal(((n,i)=>{if(u.hasChild(n)){const c=Vo(0,t.serverCache.getNode().getImmediateChild(n),i);l=qo(e,l,new Lr(n),c,r,s,o,a)}})),c.children.inorderTraversal(((n,i)=>{const c=!t.serverCache.isCompleteForChild(n)&&void 0===i.value;if(!u.hasChild(n)&&!c){const c=Vo(0,t.serverCache.getNode().getImmediateChild(n),i);l=qo(e,l,new Lr(n),c,r,s,o,a)}})),l}class Ko{constructor(e,t){this.query_=e,this.eventRegistrations_=[];const n=this.query_._queryParams,i=new Ls(n.getIndex()),r=(s=n).loadsAllData()?new Ls(s.getIndex()):s.hasLimit()?new Fs(s):new Us(s);var s;this.processor_=function(e){return{filter:e}}(r);const o=t.serverCache,a=t.eventCache,c=i.updateFullNode(xs.EMPTY_NODE,o.getNode(),null),l=r.updateFullNode(xs.EMPTY_NODE,a.getNode(),null),u=new io(c,o.isFullyInitialized(),i.filtersNodes()),h=new io(l,a.isFullyInitialized(),r.filtersNodes());this.viewCache_=oo(h,u),this.eventGenerator_=new ro(this.query_)}get query(){return this.query_}}function $o(e,t){const n=uo(e.viewCache_);return n&&(e.query._queryParams.loadsAllData()||!Kr(t)&&!n.getImmediateChild(Fr(t)).isEmpty())?n.getChild(t):null}function Go(e){return 0===e.eventRegistrations_.length}function Jo(e,t,n){const i=[];if(n){s(null==t,"A cancel should cancel all event registrations.");const r=e.query._path;e.eventRegistrations_.forEach((e=>{const t=e.createCancelEvent(n,r);t&&i.push(t)}))}if(t){let n=[];for(let i=0;i<e.eventRegistrations_.length;++i){const r=e.eventRegistrations_[i];if(r.matches(t)){if(t.hasAnyCallback()){n=n.concat(e.eventRegistrations_.slice(i+1));break}}else n.push(r)}e.eventRegistrations_=n}else e.eventRegistrations_=[];return i}function Zo(e,t,n,i){t.type===Zs.MERGE&&null!==t.source.queryId&&(s(uo(e.viewCache_),"We should always have a full cache before handling merges"),s(lo(e.viewCache_),"Missing event cache, even though we have a server cache"));const r=e.viewCache_,a=function(e,t,n,i,r){const a=new Lo;let c,l;if(n.type===Zs.OVERWRITE){const o=n;o.source.fromUser?c=Bo(e,t,o.path,o.snap,i,r,a):(s(o.source.fromServer,"Unknown source."),l=o.source.tagged||t.serverCache.isFiltered()&&!Kr(o.path),c=qo(e,t,o.path,o.snap,i,r,l,a))}else if(n.type===Zs.MERGE){const o=n;o.source.fromUser?c=function(e,t,n,i,r,s,o){let a=t;return i.foreach(((i,c)=>{const l=Hr(n,i);Wo(t,Fr(l))&&(a=Bo(e,a,l,c,r,s,o))})),i.foreach(((i,c)=>{const l=Hr(n,i);Wo(t,Fr(l))||(a=Bo(e,a,l,c,r,s,o))})),a}(e,t,o.path,o.children,i,r,a):(s(o.source.fromServer,"Unknown source."),l=o.source.tagged||t.serverCache.isFiltered(),c=Ho(e,t,o.path,o.children,i,r,l,a))}else if(n.type===Zs.ACK_USER_WRITE){const o=n;c=o.revert?function(e,t,n,i,r,o){let a;if(null!=Ro(i,n))return t;{const c=new Fo(i,t,r),l=t.eventCache.getNode();let u;if(Kr(n)||".priority"===Fr(n)){let n;if(t.serverCache.isFullyInitialized())n=No(i,uo(t));else{const e=t.serverCache.getNode();s(e instanceof xs,"serverChildren would be complete if leaf node"),n=Po(i,e)}n=n,u=e.filter.updateFullNode(l,n,o)}else{const r=Fr(n);let s=Do(i,r,t.serverCache);null==s&&t.serverCache.isCompleteForChild(r)&&(s=l.getImmediateChild(r)),u=null!=s?e.filter.updateChild(l,r,s,qr(n),c,o):t.eventCache.getNode().hasChild(r)?e.filter.updateChild(l,r,xs.EMPTY_NODE,qr(n),c,o):l,u.isEmpty()&&t.serverCache.isFullyInitialized()&&(a=No(i,uo(t)),a.isLeafNode()&&(u=e.filter.updateFullNode(u,a,o)))}return a=t.serverCache.isFullyInitialized()||null!=Ro(i,Ur()),ao(t,u,a,e.filter.filtersNodes())}}(e,t,o.path,i,r,a):function(e,t,n,i,r,s,o){if(null!=Ro(r,n))return t;const a=t.serverCache.isFiltered(),c=t.serverCache;if(null!=i.value){if(Kr(n)&&c.isFullyInitialized()||c.isCompleteForPath(n))return qo(e,t,n,c.getNode().getChild(n),r,s,a,o);if(Kr(n)){let i=new po(null);return c.getNode().forEachChild(as,((e,t)=>{i=i.set(new Lr(e),t)})),Ho(e,t,n,i,r,s,a,o)}return t}{let l=new po(null);return i.foreach(((e,t)=>{const i=Hr(n,e);c.isCompleteForPath(i)&&(l=l.set(e,c.getNode().getChild(i)))})),Ho(e,t,n,l,r,s,a,o)}}(e,t,o.path,o.affectedTree,i,r,a)}else{if(n.type!==Zs.LISTEN_COMPLETE)throw o("Unknown operation type: "+n.type);c=function(e,t,n,i,r){const s=t.serverCache;return jo(e,co(t,s.getNode(),s.isFullyInitialized()||Kr(n),s.isFiltered()),n,i,Uo,r)}(e,t,n.path,i,a)}const u=a.getChanges();return function(e,t,n){const i=t.eventCache;if(i.isFullyInitialized()){const r=i.getNode().isLeafNode()||i.getNode().isEmpty(),s=lo(e);(n.length>0||!e.eventCache.isFullyInitialized()||r&&!i.getNode().equals(s)||!i.getNode().getPriority().equals(s.getPriority()))&&n.push(Rs(lo(t)))}}(t,c,u),{viewCache:c,changes:u}}(e.processor_,r,t,n,i);var c,l;return c=e.processor_,l=a.viewCache,s(l.eventCache.getNode().isIndexed(c.filter.getIndex()),"Event snap not indexed"),s(l.serverCache.getNode().isIndexed(c.filter.getIndex()),"Server snap not indexed"),s(a.viewCache.serverCache.isFullyInitialized()||!r.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),e.viewCache_=a.viewCache,Yo(e,a.changes,a.viewCache.eventCache.getNode(),null)}function Yo(e,t,n,i){const r=i?[i]:e.eventRegistrations_;return function(e,t,n,i){const r=[],s=[];return t.forEach((t=>{var n;"child_changed"===t.type&&e.index_.indexedValueChanged(t.oldSnap,t.snapshotNode)&&s.push((n=t.childName,{type:"child_moved",snapshotNode:t.snapshotNode,childName:n}))})),so(e,r,"child_removed",t,i,n),so(e,r,"child_added",t,i,n),so(e,r,"child_moved",s,i,n),so(e,r,"child_changed",t,i,n),so(e,r,"value",t,i,n),r}(e.eventGenerator_,t,n,r)}let Qo,Xo;class ea{constructor(){this.views=new Map}}function ta(e,t,n,i){const r=t.source.queryId;if(null!==r){const o=e.views.get(r);return s(null!=o,"SyncTree gave us an op for an invalid query."),Zo(o,t,n,i)}{let r=[];for(const s of e.views.values())r=r.concat(Zo(s,t,n,i));return r}}function na(e,t,n,i,r,s){const o=function(e,t,n,i,r){const s=t._queryIdentifier,o=e.views.get(s);if(!o){let e=No(n,r?i:null),s=!1;e?s=!0:i instanceof xs?(e=Po(n,i),s=!1):(e=xs.EMPTY_NODE,s=!1);const o=oo(new io(e,s,!1),new io(i,r,!1));return new Ko(t,o)}return o}(e,t,i,r,s);return e.views.has(t._queryIdentifier)||e.views.set(t._queryIdentifier,o),function(e,t){e.eventRegistrations_.push(t)}(o,n),function(e,t){const n=e.viewCache_.eventCache,i=[];return n.getNode().isLeafNode()||n.getNode().forEachChild(ws,((e,t)=>{i.push(Ds(e,t))})),n.isFullyInitialized()&&i.push(Rs(n.getNode())),Yo(e,i,n.getNode(),t)}(o,n)}function ia(e){const t=[];for(const n of e.views.values())n.query._queryParams.loadsAllData()||t.push(n);return t}function ra(e,t){let n=null;for(const i of e.views.values())n=n||$o(i,t);return n}function sa(e,t){if(t._queryParams.loadsAllData())return ca(e);{const n=t._queryIdentifier;return e.views.get(n)}}function oa(e,t){return null!=sa(e,t)}function aa(e){return null!=ca(e)}function ca(e){for(const t of e.views.values())if(t.query._queryParams.loadsAllData())return t;return null}let la=1;class ua{constructor(e){this.listenProvider_=e,this.syncPointTree_=new po(null),this.pendingWriteTree_={visibleWrites:fo.empty(),allWrites:[],lastWriteId:-1},this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function ha(e,t,n,i,r){return function(e,t,n,i,r){s(i>e.lastWriteId,"Stacking an older write on top of newer ones"),void 0===r&&(r=!0),e.allWrites.push({path:t,snap:n,writeId:i,visible:r}),r&&(e.visibleWrites=_o(e.visibleWrites,t,n)),e.lastWriteId=i}(e.pendingWriteTree_,t,n,i,r),r?ma(e,new to({fromUser:!0,fromServer:!1,queryId:null,tagged:!1},t,n)):[]}function da(e,t,n=!1){const i=function(e,t){for(let n=0;n<e.allWrites.length;n++){const i=e.allWrites[n];if(i.writeId===t)return i}return null}(e.pendingWriteTree_,t);if(function(e,t){const n=e.allWrites.findIndex((e=>e.writeId===t));s(n>=0,"removeWrite called with nonexistent writeId.");const i=e.allWrites[n];e.allWrites.splice(n,1);let r=i.visible,o=!1,a=e.allWrites.length-1;for(;r&&a>=0;){const t=e.allWrites[a];t.visible&&(a>=n&&So(t,i.path)?r=!1:Zr(i.path,t.path)&&(o=!0)),a--}return!!r&&(o?(function(e){e.visibleWrites=xo(e.allWrites,Co,Ur()),e.allWrites.length>0?e.lastWriteId=e.allWrites[e.allWrites.length-1].writeId:e.lastWriteId=-1}(e),!0):(i.snap?e.visibleWrites=mo(e.visibleWrites,i.path):lr(i.children,(t=>{e.visibleWrites=mo(e.visibleWrites,Hr(i.path,t))})),!0))}(e.pendingWriteTree_,t)){let t=new po(null);return null!=i.snap?t=t.set(Ur(),!0):lr(i.children,(e=>{t=t.set(new Lr(e),!0)})),ma(e,new Xs(i.path,t,n))}return[]}function pa(e,t,n){return ma(e,new to({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},t,n))}function fa(e,t,n,i){const r=t._path,o=e.syncPointTree_.get(r);let a=[];if(o&&("default"===t._queryIdentifier||oa(o,t))){const c=function(e,t,n,i){const r=t._queryIdentifier,o=[];let a=[];const c=aa(e);if("default"===r)for(const[t,r]of e.views.entries())a=a.concat(Jo(r,n,i)),Go(r)&&(e.views.delete(t),r.query._queryParams.loadsAllData()||o.push(r.query));else{const t=e.views.get(r);t&&(a=a.concat(Jo(t,n,i)),Go(t)&&(e.views.delete(r),t.query._queryParams.loadsAllData()||o.push(t.query)))}return c&&!aa(e)&&o.push(new(s(Qo,"Reference.ts has not been loaded"),Qo)(t._repo,t._path)),{removed:o,events:a}}(o,t,n,i);0===o.views.size&&(e.syncPointTree_=e.syncPointTree_.remove(r));const l=c.removed;a=c.events;const u=-1!==l.findIndex((e=>e._queryParams.loadsAllData())),h=e.syncPointTree_.findOnPath(r,((e,t)=>aa(t)));if(u&&!h){const t=e.syncPointTree_.subtree(r);if(!t.isEmpty()){const n=function(e){return e.fold(((e,t,n)=>{if(t&&aa(t))return[ca(t)];{let e=[];return t&&(e=ia(t)),lr(n,((t,n)=>{e=e.concat(n)})),e}}))}(t);for(let t=0;t<n.length;++t){const i=n[t],r=i.query,s=wa(e,i);e.listenProvider_.startListening(Sa(r),ba(e,r),s.hashFn,s.onComplete)}}}if(!h&&l.length>0&&!i)if(u){const n=null;e.listenProvider_.stopListening(Sa(t),n)}else l.forEach((t=>{const n=e.queryToTagMap.get(ka(t));e.listenProvider_.stopListening(Sa(t),n)}));!function(e,t){for(let n=0;n<t.length;++n){const i=t[n];if(!i._queryParams.loadsAllData()){const t=ka(i),n=e.queryToTagMap.get(t);e.queryToTagMap.delete(t),e.tagToQueryMap.delete(n)}}}(e,l)}return a}function _a(e,t,n){const i=t._path;let r=null,o=!1;e.syncPointTree_.foreachOnPath(i,((e,t)=>{const n=$r(e,i);r=r||ra(t,n),o=o||aa(t)}));let a,c=e.syncPointTree_.get(i);c?(o=o||aa(c),r=r||ra(c,Ur())):(c=new ea,e.syncPointTree_=e.syncPointTree_.set(i,c)),null!=r?a=!0:(a=!1,r=xs.EMPTY_NODE,e.syncPointTree_.subtree(i).foreachChild(((e,t)=>{const n=ra(t,Ur());n&&(r=r.updateImmediateChild(e,n))})));const l=oa(c,t);if(!l&&!t._queryParams.loadsAllData()){const n=ka(t);s(!e.queryToTagMap.has(n),"View does not exist, but we have a tag");const i=la++;e.queryToTagMap.set(n,i),e.tagToQueryMap.set(i,n)}let u=na(c,t,n,Io(e.pendingWriteTree_,i),r,a);if(!l&&!o){const n=sa(c,t);u=u.concat(function(e,t,n){const i=t._path,r=ba(e,t),o=wa(e,n),a=e.listenProvider_.startListening(Sa(t),r,o.hashFn,o.onComplete),c=e.syncPointTree_.subtree(i);if(r)s(!aa(c.value),"If we're adding a query, it shouldn't be shadowed");else{const t=c.fold(((e,t,n)=>{if(!Kr(e)&&t&&aa(t))return[ca(t).query];{let e=[];return t&&(e=e.concat(ia(t).map((e=>e.query)))),lr(n,((t,n)=>{e=e.concat(n)})),e}}));for(let n=0;n<t.length;++n){const i=t[n];e.listenProvider_.stopListening(Sa(i),ba(e,i))}}return a}(e,t,n))}return u}function ga(e,t,n){const i=e.pendingWriteTree_,r=e.syncPointTree_.findOnPath(t,((e,n)=>{const i=ra(n,$r(e,t));if(i)return i}));return Ao(i,t,r,n,!0)}function ma(e,t){return ya(t,e.syncPointTree_,null,Io(e.pendingWriteTree_,Ur()))}function ya(e,t,n,i){if(Kr(e.path))return va(e,t,n,i);{const r=t.get(Ur());null==n&&null!=r&&(n=ra(r,Ur()));let s=[];const o=Fr(e.path),a=e.operationForChild(o),c=t.children.get(o);if(c&&a){const e=n?n.getImmediateChild(o):null,t=zo(i,o);s=s.concat(ya(a,c,e,t))}return r&&(s=s.concat(ta(r,e,i,n))),s}}function va(e,t,n,i){const r=t.get(Ur());null==n&&null!=r&&(n=ra(r,Ur()));let s=[];return t.children.inorderTraversal(((t,r)=>{const o=n?n.getImmediateChild(t):null,a=zo(i,t),c=e.operationForChild(t);c&&(s=s.concat(va(c,r,o,a)))})),r&&(s=s.concat(ta(r,e,i,n))),s}function wa(e,t){const n=t.query,i=ba(e,n);return{hashFn:()=>{const e=function(e){return e.viewCache_.serverCache.getNode()}(t)||xs.EMPTY_NODE;return e.hash()},onComplete:t=>{if("ok"===t)return i?function(e,t,n){const i=Ta(e,n);if(i){const n=Ea(i),r=n.path,s=n.queryId,o=$r(r,t);return Ia(e,r,new eo(Qs(s),o))}return[]}(e,n._path,i):function(e,t){return ma(e,new eo({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},t))}(e,n._path);{const i=function(e,t){let n="Unknown Error";"too_big"===e?n="The data requested exceeds the maximum size that can be accessed with a single request.":"permission_denied"===e?n="Client doesn't have permission to access the desired data.":"unavailable"===e&&(n="The service is unavailable");const i=new Error(e+" at "+t._path.toString()+": "+n);return i.code=e.toUpperCase(),i}(t,n);return fa(e,n,null,i)}}}}function ba(e,t){const n=ka(t);return e.queryToTagMap.get(n)}function ka(e){return e._path.toString()+"$"+e._queryIdentifier}function Ta(e,t){return e.tagToQueryMap.get(t)}function Ea(e){const t=e.indexOf("$");return s(-1!==t&&t<e.length-1,"Bad queryKey."),{queryId:e.substr(t+1),path:new Lr(e.substr(0,t))}}function Ia(e,t,n){const i=e.syncPointTree_.get(t);return s(i,"Missing sync point for query tag that we're tracking"),ta(i,n,Io(e.pendingWriteTree_,t),null)}function Sa(e){return e._queryParams.loadsAllData()&&!e._queryParams.isDefault()?new(s(Xo,"Reference.ts has not been loaded"),Xo)(e._repo,e._path):e}class Ca{constructor(e){this.node_=e}getImmediateChild(e){const t=this.node_.getImmediateChild(e);return new Ca(t)}node(){return this.node_}}class xa{constructor(e,t){this.syncTree_=e,this.path_=t}getImmediateChild(e){const t=Hr(this.path_,e);return new xa(this.syncTree_,t)}node(){return ga(this.syncTree_,this.path_)}}const Aa=function(e,t,n){return e&&"object"==typeof e?(s(".sv"in e,"Unexpected leaf node or priority contents"),"string"==typeof e[".sv"]?Na(e[".sv"],t,n):"object"==typeof e[".sv"]?Pa(e[".sv"],t):void s(!1,"Unexpected server value: "+JSON.stringify(e,null,2))):e},Na=function(e,t,n){if("timestamp"===e)return n.timestamp;s(!1,"Unexpected server value: "+e)},Pa=function(e,t,n){e.hasOwnProperty("increment")||s(!1,"Unexpected server value: "+JSON.stringify(e,null,2));const i=e.increment;"number"!=typeof i&&s(!1,"Unexpected increment value: "+i);const r=t.node();if(s(null!=r,"Expected ChildrenNode.EMPTY_NODE for nulls"),!r.isLeafNode())return i;const o=r.getValue();return"number"!=typeof o?i:o+i},Oa=function(e,t,n,i){return Da(t,new xa(n,e),i)},Ra=function(e,t,n){return Da(e,new Ca(t),n)};function Da(e,t,n){const i=e.getPriority().val(),r=Aa(i,t.getImmediateChild(".priority"),n);let s;if(e.isLeafNode()){const i=e,s=Aa(i.getValue(),t,n);return s!==i.getValue()||r!==i.getPriority().val()?new vs(s,Ns(r)):e}{const i=e;return s=i,r!==i.getPriority().val()&&(s=s.updatePriority(new vs(r))),i.forEachChild(ws,((e,i)=>{const r=Da(i,t.getImmediateChild(e),n);r!==i&&(s=s.updateImmediateChild(e,r))})),s}}class za{constructor(e="",t=null,n={children:{},childCount:0}){this.name=e,this.parent=t,this.node=n}}function Ma(e,t){let n=t instanceof Lr?t:new Lr(t),i=e,r=Fr(n);for(;null!==r;){const e=E(i.node.children,r)||{children:{},childCount:0};i=new za(r,i,e),n=qr(n),r=Fr(n)}return i}function La(e){return e.node.value}function Ua(e,t){e.node.value=t,Wa(e)}function Fa(e){return e.node.childCount>0}function ja(e,t){lr(e.node.children,((n,i)=>{t(new za(n,e,i))}))}function qa(e,t,n,i){n&&!i&&t(e),ja(e,(e=>{qa(e,t,!0,i)})),n&&i&&t(e)}function Ba(e){return new Lr(null===e.parent?e.name:Ba(e.parent)+"/"+e.name)}function Wa(e){null!==e.parent&&function(e,t,n){const i=function(e){return void 0===La(e)&&!Fa(e)}(n),r=T(e.node.children,t);i&&r?(delete e.node.children[t],e.node.childCount--,Wa(e)):i||r||(e.node.children[t]=n.node,e.node.childCount++,Wa(e))}(e.parent,e.name,e)}const Va=/[\[\].#$\/\u0000-\u001F\u007F]/,Ha=/[\[\].#$\u0000-\u001F\u007F]/,Ka=10485760,$a=function(e){return"string"==typeof e&&0!==e.length&&!Va.test(e)},Ga=function(e){return"string"==typeof e&&0!==e.length&&!Ha.test(e)},Ja=function(e,t,n){const i=n instanceof Lr?new Yr(n,e):n;if(void 0===t)throw new Error(e+"contains undefined "+Xr(i));if("function"==typeof t)throw new Error(e+"contains a function "+Xr(i)+" with contents = "+t.toString());if(tr(t))throw new Error(e+"contains "+t.toString()+" "+Xr(i));if("string"==typeof t&&t.length>Ka/3&&M(t)>Ka)throw new Error(e+"contains a string greater than 10485760 utf8 bytes "+Xr(i)+" ('"+t.substring(0,50)+"...')");if(t&&"object"==typeof t){let n=!1,r=!1;if(lr(t,((t,s)=>{if(".value"===t)n=!0;else if(".priority"!==t&&".sv"!==t&&(r=!0,!$a(t)))throw new Error(e+" contains an invalid key ("+t+") "+Xr(i)+'.  Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');!function(e,t){e.parts_.length>0&&(e.byteLength_+=1),e.parts_.push(t),e.byteLength_+=M(t),Qr(e)}(i,t),Ja(e,s,i),function(e){const t=e.parts_.pop();e.byteLength_-=M(t),e.parts_.length>0&&(e.byteLength_-=1)}(i)})),n&&r)throw new Error(e+' contains ".value" child '+Xr(i)+" in addition to actual children.")}},Za=function(e,t,n,i){if(i&&void 0===t)return;const r=z(e,"values");if(!t||"object"!=typeof t||Array.isArray(t))throw new Error(r+" must be an object containing the children to replace.");const s=[];lr(t,((e,t)=>{const i=new Lr(e);if(Ja(r,t,Hr(n,i)),".priority"===Br(i)&&!(null===(o=t)||"string"==typeof o||"number"==typeof o&&!tr(o)||o&&"object"==typeof o&&T(o,".sv")))throw new Error(r+"contains an invalid value for '"+i.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");var o;s.push(i)})),function(e,t){let n,i;for(n=0;n<t.length;n++){i=t[n];const r=Wr(i);for(let t=0;t<r.length;t++)if(".priority"===r[t]&&t===r.length-1);else if(!$a(r[t]))throw new Error(e+"contains an invalid key ("+r[t]+") in path "+i.toString()+'. Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"')}t.sort(Gr);let r=null;for(n=0;n<t.length;n++){if(i=t[n],null!==r&&Zr(r,i))throw new Error(e+"contains a path "+r.toString()+" that is ancestor of another path "+i.toString());r=i}}(r,s)},Ya=function(e,t,n,i){if(!(i&&void 0===n||Ga(n)))throw new Error(z(e,t)+'was an invalid path = "'+n+'". Paths must be non-empty strings and can\'t contain ".", "#", "$", "[", or "]"')};class Qa{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function Xa(e,t){let n=null;for(let i=0;i<t.length;i++){const r=t[i],s=r.getPath();null===n||Jr(s,n.path)||(e.eventLists_.push(n),n=null),null===n&&(n={events:[],path:s}),n.events.push(r)}n&&e.eventLists_.push(n)}function ec(e,t,n){Xa(e,n),nc(e,(e=>Jr(e,t)))}function tc(e,t,n){Xa(e,n),nc(e,(e=>Zr(e,t)||Zr(t,e)))}function nc(e,t){e.recursionDepth_++;let n=!0;for(let i=0;i<e.eventLists_.length;i++){const r=e.eventLists_[i];r&&(t(r.path)?(ic(e.eventLists_[i]),e.eventLists_[i]=null):n=!1)}n&&(e.eventLists_=[]),e.recursionDepth_--}function ic(e){for(let t=0;t<e.events.length;t++){const n=e.events[t];if(null!==n){e.events[t]=null;const i=n.getEventRunner();Gi&&Zi("event: "+n.toString()),pr(i)}}}class rc{constructor(e,t,n,i){this.repoInfo_=e,this.forceRestClient_=t,this.authTokenProvider_=n,this.appCheckProvider_=i,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new Qa,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=Hs(),this.transactionQueueTree_=new za,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function sc(e,t,n){if(e.stats_=Sr(e.repoInfo_),e.forceRestClient_||("object"==typeof window&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0)e.server_=new Ws(e.repoInfo_,((t,n,i,r)=>{cc(e,t,n,i,r)}),e.authTokenProvider_,e.appCheckProvider_),setTimeout((()=>lc(e,!0)),0);else{if(null!=n){if("object"!=typeof n)throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{b(n)}catch(e){throw new Error("Invalid authOverride provided: "+e)}}e.persistentConnection_=new ns(e.repoInfo_,t,((t,n,i,r)=>{cc(e,t,n,i,r)}),(t=>{lc(e,t)}),(t=>{!function(e,t){lr(t,((t,n)=>{uc(e,t,n)}))}(e,t)}),e.authTokenProvider_,e.appCheckProvider_,n),e.server_=e.persistentConnection_}e.authTokenProvider_.addTokenChangeListener((t=>{e.server_.refreshAuthToken(t)})),e.appCheckProvider_.addTokenChangeListener((t=>{e.server_.refreshAppCheckToken(t.token)})),e.statsReporter_=function(t,n){const i=t.toString();return Ir[i]||(Ir[i]=new Js(e.stats_,e.server_)),Ir[i]}(e.repoInfo_),e.infoData_=new Vs,e.infoSyncTree_=new ua({startListening:(t,n,i,r)=>{let s=[];const o=e.infoData_.getNode(t._path);return o.isEmpty()||(s=pa(e.infoSyncTree_,t._path,o),setTimeout((()=>{r("ok")}),0)),s},stopListening:()=>{}}),uc(e,"connected",!1),e.serverSyncTree_=new ua({startListening:(t,n,i,r)=>(e.server_.listen(t,i,n,((n,i)=>{const s=r(n,i);tc(e.eventQueue_,t._path,s)})),[]),stopListening:(t,n)=>{e.server_.unlisten(t,n)}})}function oc(e){const t=e.infoData_.getNode(new Lr(".info/serverTimeOffset")).val()||0;return(new Date).getTime()+t}function ac(e){return(t=(t={timestamp:oc(e)})||{}).timestamp=t.timestamp||(new Date).getTime(),t;var t}function cc(e,t,n,i,r){e.dataUpdateCount++;const s=new Lr(t);n=e.interceptServerDataCallback_?e.interceptServerDataCallback_(t,n):n;let o=[];if(r)if(i){const t=S(n,(e=>Ns(e)));o=function(e,t,n,i){const r=Ta(e,i);if(r){const i=Ea(r),s=i.path,o=i.queryId,a=$r(s,t),c=po.fromObject(n);return Ia(e,s,new no(Qs(o),a,c))}return[]}(e.serverSyncTree_,s,t,r)}else{const t=Ns(n);o=function(e,t,n,i){const r=Ta(e,i);if(null!=r){const i=Ea(r),s=i.path,o=i.queryId,a=$r(s,t);return Ia(e,s,new to(Qs(o),a,n))}return[]}(e.serverSyncTree_,s,t,r)}else if(i){const t=S(n,(e=>Ns(e)));o=function(e,t,n){const i=po.fromObject(n);return ma(e,new no({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},t,i))}(e.serverSyncTree_,s,t)}else{const t=Ns(n);o=pa(e.serverSyncTree_,s,t)}let a=s;o.length>0&&(a=mc(e,s)),tc(e.eventQueue_,a,o)}function lc(e,t){uc(e,"connected",t),!1===t&&function(e){pc(e,"onDisconnectEvents");const t=ac(e),n=Hs();$s(e.onDisconnect_,Ur(),((i,r)=>{const s=Oa(i,r,e.serverSyncTree_,t);Ks(n,i,s)}));let i=[];$s(n,Ur(),((t,n)=>{i=i.concat(pa(e.serverSyncTree_,t,n));const r=kc(e,t);mc(e,r)})),e.onDisconnect_=Hs(),tc(e.eventQueue_,Ur(),i)}(e)}function uc(e,t,n){const i=new Lr("/.info/"+t),r=Ns(n);e.infoData_.updateSnapshot(i,r);const s=pa(e.infoSyncTree_,i,r);tc(e.eventQueue_,i,s)}function hc(e){return e.nextWriteId_++}function dc(e,t,n){let i;i=".info"===Fr(t._path)?fa(e.infoSyncTree_,t,n):fa(e.serverSyncTree_,t,n),ec(e.eventQueue_,t._path,i)}function pc(e,...t){let n="";e.persistentConnection_&&(n=e.persistentConnection_.id+":"),Zi(n,...t)}function fc(e,t,n,i){t&&pr((()=>{if("ok"===n)t(null);else{const e=(n||"error").toUpperCase();let r=e;i&&(r+=": "+i);const s=new Error(r);s.code=e,t(s)}}))}function _c(e,t,n){return ga(e.serverSyncTree_,t,n)||xs.EMPTY_NODE}function gc(e,t=e.transactionQueueTree_){if(t||bc(e,t),La(t)){const n=vc(e,t);s(n.length>0,"Sending zero length transaction queue"),n.every((e=>0===e.status))&&function(e,t,n){const i=n.map((e=>e.currentWriteId)),r=_c(e,t,i);let o=r;const a=r.hash();for(let e=0;e<n.length;e++){const i=n[e];s(0===i.status,"tryToSendTransactionQueue_: items in queue should all be run."),i.status=1,i.retryCount++;const r=$r(t,i.path);o=o.updateChild(r,i.currentOutputSnapshotRaw)}const c=o.val(!0),l=t;e.server_.put(l.toString(),c,(i=>{pc(e,"transaction put response",{path:l.toString(),status:i});let r=[];if("ok"===i){const i=[];for(let t=0;t<n.length;t++)n[t].status=2,r=r.concat(da(e.serverSyncTree_,n[t].currentWriteId)),n[t].onComplete&&i.push((()=>n[t].onComplete(null,!0,n[t].currentOutputSnapshotResolved))),n[t].unwatcher();bc(e,Ma(e.transactionQueueTree_,t)),gc(e,e.transactionQueueTree_),tc(e.eventQueue_,t,r);for(let e=0;e<i.length;e++)pr(i[e])}else{if("datastale"===i)for(let e=0;e<n.length;e++)3===n[e].status?n[e].status=4:n[e].status=0;else{er("transaction at "+l.toString()+" failed: "+i);for(let e=0;e<n.length;e++)n[e].status=4,n[e].abortReason=i}mc(e,t)}}),a)}(e,Ba(t),n)}else Fa(t)&&ja(t,(t=>{gc(e,t)}))}function mc(e,t){const n=yc(e,t),i=Ba(n);return function(e,t,n){if(0===t.length)return;const i=[];let r=[];const o=t.filter((e=>0===e.status)).map((e=>e.currentWriteId));for(let c=0;c<t.length;c++){const l=t[c],u=$r(n,l.path);let h,d=!1;if(s(null!==u,"rerunTransactionsUnderNode_: relativePath should not be null."),4===l.status)d=!0,h=l.abortReason,r=r.concat(da(e.serverSyncTree_,l.currentWriteId,!0));else if(0===l.status)if(l.retryCount>=25)d=!0,h="maxretry",r=r.concat(da(e.serverSyncTree_,l.currentWriteId,!0));else{const n=_c(e,l.path,o);l.currentInputSnapshot=n;const i=t[c].update(n.val());if(void 0!==i){Ja("transaction failed: Data returned ",i,l.path);let t=Ns(i);"object"==typeof i&&null!=i&&T(i,".priority")||(t=t.updatePriority(n.getPriority()));const s=l.currentWriteId,a=ac(e),c=Ra(t,n,a);l.currentOutputSnapshotRaw=t,l.currentOutputSnapshotResolved=c,l.currentWriteId=hc(e),o.splice(o.indexOf(s),1),r=r.concat(ha(e.serverSyncTree_,l.path,c,l.currentWriteId,l.applyLocally)),r=r.concat(da(e.serverSyncTree_,s,!0))}else d=!0,h="nodata",r=r.concat(da(e.serverSyncTree_,l.currentWriteId,!0))}tc(e.eventQueue_,n,r),r=[],d&&(t[c].status=2,a=t[c].unwatcher,setTimeout(a,Math.floor(0)),t[c].onComplete&&("nodata"===h?i.push((()=>t[c].onComplete(null,!1,t[c].currentInputSnapshot))):i.push((()=>t[c].onComplete(new Error(h),!1,null)))))}var a;bc(e,e.transactionQueueTree_);for(let e=0;e<i.length;e++)pr(i[e]);gc(e,e.transactionQueueTree_)}(e,vc(e,n),i),i}function yc(e,t){let n,i=e.transactionQueueTree_;for(n=Fr(t);null!==n&&void 0===La(i);)i=Ma(i,n),n=Fr(t=qr(t));return i}function vc(e,t){const n=[];return wc(e,t,n),n.sort(((e,t)=>e.order-t.order)),n}function wc(e,t,n){const i=La(t);if(i)for(let e=0;e<i.length;e++)n.push(i[e]);ja(t,(t=>{wc(e,t,n)}))}function bc(e,t){const n=La(t);if(n){let e=0;for(let t=0;t<n.length;t++)2!==n[t].status&&(n[e]=n[t],e++);n.length=e,Ua(t,n.length>0?n:void 0)}ja(t,(t=>{bc(e,t)}))}function kc(e,t){const n=Ba(yc(e,t)),i=Ma(e.transactionQueueTree_,t);return function(e,t,n){let i=e.parent;for(;null!==i;){if(t(i))return!0;i=i.parent}}(i,(t=>{Tc(e,t)})),Tc(e,i),qa(i,(t=>{Tc(e,t)})),n}function Tc(e,t){const n=La(t);if(n){const i=[];let r=[],o=-1;for(let t=0;t<n.length;t++)3===n[t].status||(1===n[t].status?(s(o===t-1,"All SENT items should be at beginning of queue."),o=t,n[t].status=3,n[t].abortReason="set"):(s(0===n[t].status,"Unexpected transaction status in abort"),n[t].unwatcher(),r=r.concat(da(e.serverSyncTree_,n[t].currentWriteId,!0)),n[t].onComplete&&i.push(n[t].onComplete.bind(null,new Error("set"),!1,null))));-1===o?Ua(t,void 0):n.length=o+1,tc(e.eventQueue_,Ba(t),r);for(let e=0;e<i.length;e++)pr(i[e])}}const Ec=function(e,t){const n=Ic(e),i=n.namespace;"firebase.com"===n.domain&&Xi(n.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),i&&"undefined"!==i||"localhost"===n.domain||Xi("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),n.secure||"undefined"!=typeof window&&window.location&&window.location.protocol&&-1!==window.location.protocol.indexOf("https:")&&er("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().");const r="ws"===n.scheme||"wss"===n.scheme;return{repoInfo:new br(n.host,n.secure,i,t,r,"",i!==n.subdomain),path:new Lr(n.pathString)}},Ic=function(e){let t="",n="",i="",r="",s="",o=!0,a="https",c=443;if("string"==typeof e){let l=e.indexOf("//");l>=0&&(a=e.substring(0,l-1),e=e.substring(l+2));let u=e.indexOf("/");-1===u&&(u=e.length);let h=e.indexOf("?");-1===h&&(h=e.length),t=e.substring(0,Math.min(u,h)),u<h&&(r=function(e){let t="";const n=e.split("/");for(let e=0;e<n.length;e++)if(n[e].length>0){let i=n[e];try{i=decodeURIComponent(i.replace(/\+/g," "))}catch(e){}t+="/"+i}return t}(e.substring(u,h)));const d=function(e){const t={};"?"===e.charAt(0)&&(e=e.substring(1));for(const n of e.split("&")){if(0===n.length)continue;const i=n.split("=");2===i.length?t[decodeURIComponent(i[0])]=decodeURIComponent(i[1]):er(`Invalid query segment '${n}' in query '${e}'`)}return t}(e.substring(Math.min(e.length,h)));l=t.indexOf(":"),l>=0?(o="https"===a||"wss"===a,c=parseInt(t.substring(l+1),10)):l=t.length;const p=t.slice(0,l);if("localhost"===p.toLowerCase())n="localhost";else if(p.split(".").length<=2)n=p;else{const e=t.indexOf(".");i=t.substring(0,e).toLowerCase(),n=t.substring(e+1),s=i}"ns"in d&&(s=d.ns)}return{host:t,port:c,domain:n,subdomain:i,secure:o,scheme:a,pathString:r,namespace:s}};class Sc{constructor(e,t,n,i){this.eventType=e,this.eventRegistration=t,this.snapshot=n,this.prevName=i}getPath(){const e=this.snapshot.ref;return"value"===this.eventType?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+b(this.snapshot.exportVal())}}class Cc{constructor(e,t,n){this.eventRegistration=e,this.error=t,this.path=n}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}}class xc{constructor(e,t){this.snapshotCallback=e,this.cancelCallback=t}onValue(e,t){this.snapshotCallback.call(null,e,t)}onCancel(e){return s(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||void 0!==this.snapshotCallback.userCallback&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}}class Ac{constructor(e,t,n,i){this._repo=e,this._path=t,this._queryParams=n,this._orderByCalled=i}get key(){return Kr(this._path)?null:Br(this._path)}get ref(){return new Nc(this._repo,this._path)}get _queryIdentifier(){const e=Bs(this._queryParams),t=ar(e);return"{}"===t?"default":t}get _queryObject(){return Bs(this._queryParams)}isEqual(e){if(!((e=U(e))instanceof Ac))return!1;const t=this._repo===e._repo,n=Jr(this._path,e._path),i=this._queryIdentifier===e._queryIdentifier;return t&&n&&i}toJSON(){return this.toString()}toString(){return this._repo.toString()+function(e){let t="";for(let n=e.pieceNum_;n<e.pieces_.length;n++)""!==e.pieces_[n]&&(t+="/"+encodeURIComponent(String(e.pieces_[n])));return t||"/"}(this._path)}}class Nc extends Ac{constructor(e,t){super(e,t,new js,!1)}get parent(){const e=Vr(this._path);return null===e?null:new Nc(this._repo,e)}get root(){let e=this;for(;null!==e.parent;)e=e.parent;return e}}class Pc{constructor(e,t,n){this._node=e,this.ref=t,this._index=n}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){const t=new Lr(e),n=Rc(this.ref,e);return new Pc(this._node.getChild(t),n,ws)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){return!this._node.isLeafNode()&&!!this._node.forEachChild(this._index,((t,n)=>e(new Pc(n,Rc(this.ref,t),ws))))}hasChild(e){const t=new Lr(e);return!this._node.getChild(t).isEmpty()}hasChildren(){return!this._node.isLeafNode()&&!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}}function Oc(e,t){return(e=U(e))._checkNotDeleted("ref"),void 0!==t?Rc(e._root,t):e._root}function Rc(e,t){var n;return null===Fr((e=U(e))._path)?("child","path",!1,(n=t)&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),Ya("child","path",n,false)):Ya("child","path",t,!1),new Nc(e._repo,Hr(e._path,t))}function Dc(e,t){Za("update",t,e._path,!1);const n=new d;return function(e,t,n,i){pc(e,"update",{path:t.toString(),value:n});let r=!0;const o=ac(e),a={};if(lr(n,((n,i)=>{r=!1,a[n]=Oa(Hr(t,n),Ns(i),e.serverSyncTree_,o)})),r)Zi("update() called with empty data.  Don't do anything."),fc(0,i,"ok",void 0);else{const r=hc(e),o=function(e,t,n,i){!function(e,t,n,i){s(i>e.lastWriteId,"Stacking an older merge on top of newer ones"),e.allWrites.push({path:t,children:n,writeId:i,visible:!0}),e.visibleWrites=go(e.visibleWrites,t,n),e.lastWriteId=i}(e.pendingWriteTree_,t,n,i);const r=po.fromObject(n);return ma(e,new no({fromUser:!0,fromServer:!1,queryId:null,tagged:!1},t,r))}(e.serverSyncTree_,t,a,r);Xa(e.eventQueue_,o),e.server_.merge(t.toString(),n,((n,s)=>{const o="ok"===n;o||er("update at "+t+" failed: "+n);const a=da(e.serverSyncTree_,r,!o),c=a.length>0?mc(e,t):t;tc(e.eventQueue_,c,a),fc(0,i,n,s)})),lr(n,(n=>{const i=kc(e,Hr(t,n));mc(e,i)})),tc(e.eventQueue_,t,[])}}(e._repo,e._path,t,n.wrapCallback((()=>{}))),n.promise}class zc{constructor(e){this.callbackContext=e}respondsTo(e){return"value"===e}createEvent(e,t){const n=t._queryParams.getIndex();return new Sc("value",this,new Pc(e.snapshotNode,new Nc(t._repo,t._path),n))}getEventRunner(e){return"cancel"===e.getEventType()?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,t){return this.callbackContext.hasCancelCallback?new Cc(this,e,t):null}matches(e){return e instanceof zc&&(!e.callbackContext||!this.callbackContext||e.callbackContext.matches(this.callbackContext))}hasAnyCallback(){return null!==this.callbackContext}}class Mc{constructor(e,t){this.eventType=e,this.callbackContext=t}respondsTo(e){let t="children_added"===e?"child_added":e;return t="children_removed"===t?"child_removed":t,this.eventType===t}createCancelEvent(e,t){return this.callbackContext.hasCancelCallback?new Cc(this,e,t):null}createEvent(e,t){s(null!=e.childName,"Child events should have a childName.");const n=Rc(new Nc(t._repo,t._path),e.childName),i=t._queryParams.getIndex();return new Sc(e.type,this,new Pc(e.snapshotNode,n,i),e.prevName)}getEventRunner(e){return"cancel"===e.getEventType()?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,e.prevName)}matches(e){return e instanceof Mc&&this.eventType===e.eventType&&(!this.callbackContext||!e.callbackContext||this.callbackContext.matches(e.callbackContext))}hasAnyCallback(){return!!this.callbackContext}}function Lc(e,t,n,i){return function(e,t,n,i,r){let s;if("object"==typeof i&&(s=void 0,r=i),"function"==typeof i&&(s=i),r&&r.onlyOnce){const t=n,i=(n,i)=>{dc(e._repo,e,a),t(n,i)};i.userCallback=n.userCallback,i.context=n.context,n=i}const o=new xc(n,s||void 0),a="value"===t?new zc(o):new Mc(t,o);return function(e,t,n){let i;i=".info"===Fr(t._path)?_a(e.infoSyncTree_,t,n):_a(e.serverSyncTree_,t,n),ec(e.eventQueue_,t._path,i)}(e._repo,e,a),()=>dc(e._repo,e,a)}(e,"value",t,n,i)}!function(e){s(!Qo,"__referenceConstructor has already been defined"),Qo=e}(Nc),function(e){s(!Xo,"__referenceConstructor has already been defined"),Xo=e}(Nc);const Uc={};function Fc(e,t,n,i,r){let s=i||e.options.databaseURL;void 0===s&&(e.options.projectId||Xi("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),Zi("Using default host for project ",e.options.projectId),s=`${e.options.projectId}-default-rtdb.firebaseio.com`);let o,a,c=Ec(s,r),l=c.repoInfo;"undefined"!=typeof process&&(a=process.env.FIREBASE_DATABASE_EMULATOR_HOST),a?(o=!0,s=`http://${a}?ns=${l.namespace}`,c=Ec(s,r),l=c.repoInfo):o=!c.repoInfo.secure;const u=r&&o?new mr(mr.OWNER):new gr(e.name,e.options,t);(function(e,t){const n=t.path.toString();if("string"!=typeof t.repoInfo.host||0===t.repoInfo.host.length||!$a(t.repoInfo.namespace)&&"localhost"!==t.repoInfo.host.split(":")[0]||0!==n.length&&!function(e){return e&&(e=e.replace(/^\/*\.info(\/|$)/,"/")),Ga(e)}(n))throw new Error(z(e,"url")+'must be a valid firebase URL and the path can\'t contain ".", "#", "$", "[", or "]".')})("Invalid Firebase Database URL",c),Kr(c.path)||Xi("Database URL must point to the root of a Firebase Database (not including a child path).");const h=function(e,t,n,i){let r=Uc[t.name];r||(r={},Uc[t.name]=r);let s=r[e.toURLString()];return s&&Xi("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),s=new rc(e,false,n,i),r[e.toURLString()]=s,s}(l,e,u,new _r(e.name,n));return new jc(h,e)}class jc{constructor(e,t){this._repoInternal=e,this.app=t,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(sc(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new Nc(this._repo,Ur())),this._rootInternal}_delete(){return null!==this._rootInternal&&(function(e,t){const n=Uc[t];n&&n[e.key]===e||Xi(`Database ${t}(${e.repoInfo_}) has already been deleted.`),function(e){e.persistentConnection_&&e.persistentConnection_.interrupt("repo_interrupt")}(e),delete n[e.key]}(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){null===this._rootInternal&&Xi("Cannot call "+e+" on a deleted database.")}}function qc(e,t){const n={};for(const i in e)e.hasOwnProperty(i)&&(n[i]=t(e[i]));return n}function Bc(e){if(null==e)return null;if(e instanceof Number&&(e=e.valueOf()),"number"==typeof e&&isFinite(e))return e;if(!0===e||!1===e)return e;if("[object String]"===Object.prototype.toString.call(e))return e;if(e instanceof Date)return e.toISOString();if(Array.isArray(e))return e.map((e=>Bc(e)));if("function"==typeof e||"object"==typeof e)return qc(e,(e=>Bc(e)));throw new Error("Data cannot be encoded in JSON: "+e)}function Wc(e){if(null==e)return e;if(e["@type"])switch(e["@type"]){case"type.googleapis.com/google.protobuf.Int64Value":case"type.googleapis.com/google.protobuf.UInt64Value":{const t=Number(e.value);if(isNaN(t))throw new Error("Data cannot be decoded from JSON: "+e);return t}default:throw new Error("Data cannot be decoded from JSON: "+e)}return Array.isArray(e)?e.map((e=>Wc(e))):"function"==typeof e||"object"==typeof e?qc(e,(e=>Wc(e))):e}ns.prototype.simpleListen=function(e,t){this.sendRequest("q",{p:e},t)},ns.prototype.echo=function(e,t){this.sendRequest("echo",{d:e},t)},Ui="9.6.0",re(new F("database",((e,{instanceIdentifier:t})=>Fc(e.getProvider("app").getImmediate(),e.getProvider("auth-internal"),e.getProvider("app-check-internal"),t)),"PUBLIC").setMultipleInstances(!0)),ue(Mi,Li,void 0),ue(Mi,Li,"esm2017");const Vc="functions",Hc={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Kc extends m{constructor(e,t,n){super(`functions/${e}`,t||""),this.details=n}}class $c{constructor(e,t,n){this.auth=null,this.messaging=null,this.appCheck=null,this.auth=e.getImmediate({optional:!0}),this.messaging=t.getImmediate({optional:!0}),this.auth||e.get().then((e=>this.auth=e),(()=>{})),this.messaging||t.get().then((e=>this.messaging=e),(()=>{})),this.appCheck||n.get().then((e=>this.appCheck=e),(()=>{}))}async getAuthToken(){if(this.auth)try{const e=await this.auth.getToken();return null==e?void 0:e.accessToken}catch(e){return}}async getMessagingToken(){if(this.messaging&&"Notification"in self&&"granted"===Notification.permission)try{return await this.messaging.getToken()}catch(e){return}}async getAppCheckToken(){if(this.appCheck){const e=await this.appCheck.getToken();return e.error?null:e.token}return null}async getContext(){return{authToken:await this.getAuthToken(),messagingToken:await this.getMessagingToken(),appCheckToken:await this.getAppCheckToken()}}}class Gc{constructor(e,t,n,i,r="us-central1",s){this.app=e,this.fetchImpl=s,this.emulatorOrigin=null,this.contextProvider=new $c(t,n,i),this.cancelAllRequests=new Promise((e=>{this.deleteService=()=>Promise.resolve(e())}));try{const e=new URL(r);this.customDomain=e.origin,this.region="us-central1"}catch(e){this.customDomain=null,this.region=r}}_delete(){return this.deleteService()}_url(e){const t=this.app.options.projectId;return null!==this.emulatorOrigin?`${this.emulatorOrigin}/${t}/${this.region}/${e}`:null!==this.customDomain?`${this.customDomain}/${e}`:`https://${this.region}-${t}.cloudfunctions.net/${e}`}}async function Jc(e,t,n,i){let r;n["Content-Type"]="application/json";try{r=await i(e,{method:"POST",body:JSON.stringify(t),headers:n})}catch(e){return{status:0,json:null}}let s=null;try{s=await r.json()}catch(e){}return{status:r.status,json:s}}const Zc="@firebase/functions",Yc="0.7.6";function Qc(e,t,n){return function(e,t,n){return i=>async function(e,t,n,i){const r=e._url(t),s={data:n=Bc(n)},o={},a=await e.contextProvider.getContext();a.authToken&&(o.Authorization="Bearer "+a.authToken),a.messagingToken&&(o["Firebase-Instance-ID-Token"]=a.messagingToken),null!==a.appCheckToken&&(o["X-Firebase-AppCheck"]=a.appCheckToken);const c=function(e){let t=null;return{promise:new Promise(((n,i)=>{t=setTimeout((()=>{i(new Kc("deadline-exceeded","deadline-exceeded"))}),e)})),cancel:()=>{t&&clearTimeout(t)}}}(i.timeout||7e4),l=await Promise.race([Jc(r,s,o,e.fetchImpl),c.promise,e.cancelAllRequests]);if(c.cancel(),!l)throw new Kc("cancelled","Firebase Functions instance was deleted.");const u=function(e,t){let n,i=function(e){if(e>=200&&e<300)return"ok";switch(e){case 0:case 500:return"internal";case 400:return"invalid-argument";case 401:return"unauthenticated";case 403:return"permission-denied";case 404:return"not-found";case 409:return"aborted";case 429:return"resource-exhausted";case 499:return"cancelled";case 501:return"unimplemented";case 503:return"unavailable";case 504:return"deadline-exceeded"}return"unknown"}(e),r=i;try{const e=t&&t.error;if(e){const t=e.status;if("string"==typeof t){if(!Hc[t])return new Kc("internal","internal");i=Hc[t],r=t}const s=e.message;"string"==typeof s&&(r=s),n=e.details,void 0!==n&&(n=Wc(n))}}catch(e){}return"ok"===i?null:new Kc(i,r,n)}(l.status,l.json);if(u)throw u;if(!l.json)throw new Kc("internal","Response is not valid JSON object.");let h=l.json.data;if(void 0===h&&(h=l.json.result),void 0===h)throw new Kc("internal","Response is missing data field.");return{data:Wc(h)}}(e,t,i,n||{})}(U(e),t,n)}var Xc;Xc=fetch.bind(self),re(new F(Vc,((e,{instanceIdentifier:t})=>{const n=e.getProvider("app").getImmediate(),i=e.getProvider("auth-internal"),r=e.getProvider("messaging-internal"),s=e.getProvider("app-check-internal");return new Gc(n,i,r,s,t,Xc)}),"PUBLIC").setMultipleInstances(!0)),ue(Zc,Yc,void 0),ue(Zc,Yc,"esm2017");var el={apiKey:"AIzaSyBe1CQlVamPQSYOmguNTsvqNvssUvN-8xU",authDomain:"zany-gumballs.firebaseapp.com",databaseURL:"https://zany-gumballs-default-rtdb.firebaseio.com",projectId:"zany-gumballs",storageBucket:"zany-gumballs.appspot.com",messagingSenderId:"172092464993",appId:"1:172092464993:web:eec3b3b589104ef0be6f20",measurementId:"G-62E2MJ32C7"},tl=["330504","330501","330495","330490","330487","295563","295562","295561","295560","295559","295558","295557","254475","234211","119963","119799","112103","112098","112093","112091","112090","112089","112083","112076","110470","110469","110468","110467","110463","110456","110454","110449","110444","110419","110416","110413","110410","110406","110405","110404","110401","110395","110391","110389","110385","110384","110381","110379"],nl=["clunk_bw","me_bw","link_bw","chum_bw","nan_bw","zim","rye","rafe","kay","ice","bae","abe","bop_saves_galaxy","mooch_bw","dave","eke_two_sides","pi","pam","kipp","grey","jill","holt","fuse","elle","yam","trish","stan","sis","shar","sauce","rush","roy","prim","nan","mooch","mike","me","link","kells","jet","hue","faith","eke","dapp","clunk","chum","bud","bop"];function il(e,t,n,i,r,s,o){try{var a=e[s](o),c=a.value}catch(e){return void n(e)}a.done?t(c):Promise.resolve(c).then(i,r)}function rl(e){return function(){var t=this,n=arguments;return new Promise((function(i,r){var s=e.apply(t,n);function o(e){il(s,i,r,o,a,"next",e)}function a(e){il(s,i,r,o,a,"throw",e)}o(void 0)}))}}function sl(e){return function(e){if(Array.isArray(e))return ol(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return ol(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ol(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ol(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}document.addEventListener("DOMContentLoaded",(function(){var e,t,n,s,o=document.querySelector(".grid"),a="zanygumballs",c=document.getElementsByClassName("score"),l=document.getElementById("progress-front"),u=document.getElementById("moves-left"),h=document.getElementById("section-login"),d=document.getElementById("btn-menu"),p=document.querySelector(".links"),f=document.getElementById("chance-bar").getElementsByClassName("chnc"),_=(f.length,document.getElementsByClassName("chances-left")),g=document.getElementById("login-result"),m=document.getElementById("login"),y=document.getElementById("enter"),v=(document.getElementById("asset-wrapper"),document.getElementById("rank")),w=document.getElementById("score-prev"),b=[],k=0,T=30,E=J(),I=b[E],S="",x="",A=!0,N=!0,P=0,O=sessionStorage.getItem("userLoggedIn"),R='<img src="./imgs/transparent.png" class="img-gumball" alt="" />',D=new Audio("./audios/bubble_pop_pitch_sharp2.mp3"),z=new Audio("./audios/plop.mp3"),M=function(e,t={}){"object"!=typeof t&&(t={name:t});const n=Object.assign({name:"[DEFAULT]",automaticDataCollectionEnabled:!1},t),i=n.name;if("string"!=typeof i||!i)throw oe.create("bad-app-name",{appName:String(i)});const r=te.get(i);if(r){if(C(e,r.options)&&C(n,r.config))return r;throw oe.create("duplicate-app",{appName:i})}const s=new B(i);for(const e of ne.values())s.addComponent(e);const o=new ae(e,n,s);return te.set(i,o),o}(el);(async function(e){var t;const n=ut(e);if(await n._initializationPromise,null===(t=n.currentUser)||void 0===t?void 0:t.isAnonymous)return new St({user:n.currentUser,providerId:null,operationType:"signIn"});const i=await async function(e,t){return De(e,"POST","/v1/accounts:signUp",Pe(e,t))}(n,{returnSecureToken:!0}),r=await St._fromIdTokenResponse(n,"signIn",i,!0);return await n._updateCurrentUser(r.user),r})(function(e=le()){const t=se(e,"auth");return t.isInitialized()?t.getImmediate():function(e,t){const n=se(e,"auth");if(n.isInitialized()){const e=n.getImmediate();if(C(n.getOptions(),null!=t?t:{}))return e;ge(e,"already-initialized")}return n.initialize({options:t})}(e,{popupRedirectResolver:xn,persistence:[Zt,Rt,zt]})}()).then((function(){console.log("signed in")})).catch((function(e){console.log(e.message)})),function(e=le()){const t=se(e=U(e),fi);t.isInitialized()?t.getImmediate():function(e,t={}){const n=se(e,fi);if(n.isInitialized()){const e=n.getImmediate();if(C(t,n.getOptions()))return e;throw yi.create("already-initialized")}n.initialize({options:t})}(e)}(M);var L,F=function(e=le(),t){return se(e,"database").getImmediate({identifier:t})}(M),j=function(e=le(),t="us-central1"){return se(U(e),Vc).getImmediate({identifier:t})}(M,"us-central1"),q=(Qc(j,"saveScore"),Qc(j,"removeOneChance")),W=Qc(j,"addNewUser");d.addEventListener("click",(function(){p.classList.toggle("show-links")})),O&&(h.style.display="none",s=sessionStorage.getItem("userAddress"),m.textContent=s,(L=t=[]).push.apply(L,sl(JSON.parse(sessionStorage.getItem("userStickerTemplateIds")))),ue());var V=new i.WaxJS({rpcEndpoint:"https://wax.greymass.com"});function H(){return(H=rl(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,V.login();case 3:y.textContent=V.userAccount,s=(s=V.userAccount).replace(/\./g,"_"),ue(),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),console.log(e.t0);case 12:case"end":return e.stop()}}),e,null,[[0,9]])})))).apply(this,arguments)}y.addEventListener("click",(function(){return H.apply(this,arguments)}));var K=new r.ExplorerApi("https://wax.api.atomicassets.io","atomicassets",{fetch});function $(){return($=rl(regeneratorRuntime.mark((function e(){var n,i,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,K.getAccountCollection(V.userAccount,a);case 3:n=e.sent,i=n.templates,r=[],i.forEach((function(e){r.push(e.template_id)})),t=[],r.forEach((function(e){tl.includes(e)&&t.push(e)})),t.length>=6?(sessionStorage.setItem("userLoggedIn",!0),sessionStorage.setItem("userAddress",s),sessionStorage.setItem("userStickerTemplateIds",JSON.stringify(t)),h.style.display="none",m.textContent=s,G()):(g.style.display="block",g.textContent="Sorry you can't enter you need at least 6 zany gumballs to play the game, you have ".concat(t.length," as of now")),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(0),console.log(e.t0);case 15:case"end":return e.stop()}}),e,null,[[0,12]])})))).apply(this,arguments)}function G(){b=[];var i,r=[];r.push.apply(r,sl(t));for(var a=0;a<6;a++){var h=(i=r)[Math.floor(Math.random()*i.length)];b.push(nl[tl.indexOf(h)]);var d=r.indexOf(h);-1!=d&&r.splice(d,1)}!function(){o.innerHTML="",e=[];for(var t=0;t<64;t++)Z(t)}(),n>0&&(function(){var t,i,r,o,a,h;function d(){p.call(this),console.log(this.id,"dragstart")}function p(){r=this.querySelector(".img-gumball").getAttribute("src"),h=this.querySelector(".img-gumball").getAttribute("alt"),t=parseInt(this.id)}function f(e){e.preventDefault(),console.log(this.id,"dragover")}function _(e){e.preventDefault(),console.log(this.id,"dragenter")}function g(){console.log(this.id,"dragleave")}function m(e){e.preventDefault(),y.call(this),console.log(this.id,"drop")}function y(){i=parseInt(this.id),o=this.querySelector(".img-gumball").getAttribute("src"),a=this.querySelector(".img-gumball").getAttribute("alt");var d,p=!1;t!==i-1&&t!==i+1||(t%8==0&&i<t?d=t:i%8==0&&t<i&&(d=i)),d&&(p=0!==t&&0!==i||t!==i-1&&t!==i+1);var f=[t-1,t-8,t+1,t+8].includes(i);if((i||r)&&f&&!p?(console.log(0),e[t].innerHTML='<img class="img-gumball" src="'.concat(o,'" alt="').concat(a,'" />'),e[i].innerHTML='<img class="img-gumball" src="'.concat(r,'" alt="').concat(h,'" />'),ee(),ie(),X(),Q(),i=null,r=null,a!==h&&(T-=1)):!i&&!o||f&&!p?(console.log(2),e[t].innerHTML='<img class="img-gumball" src="'.concat(r,'" alt="').concat(h,'" />')):(console.log(1),e[t].innerHTML='<img class="img-gumball" src="'.concat(r,'" alt="').concat(h,'" />'),e[i].innerHTML='<img class="img-gumball" src="'.concat(o,'" alt="').concat(a,'" />')),T>=1)T>28&&q({user_id:s}).then((function(e){console.log(e.data.chances_left)})).catch((function(e){console.log(e.message)}));else{T=n>0?30:0;var _=5,g=document.getElementById("interval");g.style.display="grid";var m=document.getElementById("timer");m.textContent=_;var y=window.setInterval((function(){_>0?(_--,m.textContent=_.toString()):(k=0,l.style.width="0rem",sl(c).forEach((function(e){e.textContent=k})),ce(),he(),G(),g.style.display="none",clearInterval(y))}),1e3)}u.textContent=T.toString()}function v(){console.log(this.id,"dragend")}function w(){console.log(this.id,"clicked"),""===S?(S=this.id,this.style.backgroundColor="aquamarine",p.call(this)):(x=this.id,this.style.backgroundColor="goldenrod",y.call(this),e[S].style.backgroundColor="",e[x].style.backgroundColor="",S="",x="")}e.forEach((function(e){return e.addEventListener("dragstart",d)})),e.forEach((function(e){return e.addEventListener("dragend",v)})),e.forEach((function(e){return e.addEventListener("dragover",f)})),e.forEach((function(e){return e.addEventListener("dragenter",_)})),e.forEach((function(e){return e.addEventListener("dragleave",g)})),e.forEach((function(e){return e.addEventListener("drop",m)})),e.forEach((function(e){return e.addEventListener("click",w)}))}(),window.setInterval((function(){!function(){for(var t=0;t<=63;t++)if("./imgs/transparent.png"===e[t].querySelector(".img-gumball").getAttribute("src")){if(t>=8)e[t].innerHTML=e[t-8].innerHTML,e[t-8].innerHTML=R;else if(t<=7){var n=J();e[t].innerHTML='<img src="./imgs/'.concat(b[n],'.png" class="img-gumball" alt="').concat(b[n],'" />')}D.play()}}(),ee(),ie(),X(),Q()}),250)),Lc(Oc(F),(function(e){var t=e.val();console.log(t),function(e){var t=[],n=Object.keys(e),i=[];n.forEach((function(t){i.push(e[t].score)}));var r=[];if(r.push.apply(r,i),i.sort((function(e,t){return t-e})),i.forEach((function(e){var i=r.indexOf(e),s=n[i];t.push(s),r[i]=""})),t.includes(s)){var o=t.indexOf(s);P=i[o].toString(),N&&(ce(),N=!1),v.textContent=(o+1).toString()}else v.textContent="No Rank"}(t)}))}function J(){return Math.floor(Math.random()*b.length)}function Z(e){E=J(),e>8?b[E]!=document.getElementById(e-2).getElementsByTagName("img")[0].getAttribute("alt")&&b[E]!=document.getElementById(e-8).getElementsByTagName("img")[0].getAttribute("alt")?Y(e):Z(e):b[E]!=I?Y(e):Z(e)}function Y(t){var n=document.createElement("div");n.setAttribute("draggable",!0),n.setAttribute("id",t),n.innerHTML='<img class="img-gumball" src="./imgs/'.concat(b[E],'.png" alt="').concat(b[E],'" />'),I=b[E],o.appendChild(n),e.push(n)}function Q(t){for(var i=function(t){var i=[t,t+1,t+2],r=e[t].querySelector(".img-gumball").getAttribute("alt"),s=""===e[t].querySelector(".img-gumball").getAttribute("alt");(i[0]+1)%8!=0&&(i[1]+1)%8!=0&&i.every((function(t){return e[t].querySelector(".img-gumball").getAttribute("alt")===r&&!s}))&&(z.play(),i.forEach((function(t){e[t].style.backgroundColor="goldenrod"})),setTimeout((function(){n>-1&&re(3),i.forEach((function(t){e[t].style.backgroundColor="",e[t].innerHTML=R}))}),150))},r=0;r<=61;r++)i(r)}function X(){for(var t=function(t){var i=[t,t-8,t+8],r=e[t].querySelector(".img-gumball").getAttribute("alt"),s=""===e[t].querySelector(".img-gumball").getAttribute("alt");i.every((function(t){return e[t].querySelector(".img-gumball").getAttribute("alt")===r&&!s}))&&(z.play(),i.forEach((function(t){e[t].style.backgroundColor="goldenrod"})),n>-1&&re(3),setTimeout((function(){i.forEach((function(t){e[t].innerHTML=R,e[t].style.backgroundColor=""}))}),150))},i=8;i<=55;i++)t(i)}function ee(){for(var t=function(t){var i=[t,t+1,t+2,t+3],r=e[t].querySelector(".img-gumball").getAttribute("alt"),s=""===e[t].querySelector(".img-gumball").getAttribute("alt");(i[0]+1)%8!=0&&(i[1]+1)%8!=0&&(i[2]+1)%8!=0&&i.every((function(t){return e[t].querySelector(".img-gumball").getAttribute("alt")===r&&!s}))&&(z.play(),i.forEach((function(t){e[t].style.backgroundColor="goldenrod"})),setTimeout((function(){n>-1&&re(4),i.forEach((function(t){e[t].innerHTML=R,e[t].style.backgroundColor=""}))}),150))},i=0;i<=60;i++)t(i)}function ie(){for(var t=function(t){var i=[t,t-8,t+8,t+16],r=e[t].querySelector(".img-gumball").getAttribute("alt"),s=""===e[t].querySelector(".img-gumball").getAttribute("alt");i.every((function(t){return e[t].querySelector(".img-gumball").getAttribute("alt")===r&&!s}))&&(z.play(),i.forEach((function(t){e[t].style.backgroundColor="goldenrod"})),setTimeout((function(){n>-1&&re(4),i.forEach((function(t){e[t].innerHTML=R,e[t].style.backgroundColor=""}))}),150))},i=8;i<=47;i++)t(i)}function re(e){var t,n=.06*(k+=e);l.style.width=n+"rem",sl(c).forEach((function(e){e.textContent=k})),t={score:k},Dc(Oc(F,s),t).then((function(){})).catch((function(e){console.log(e)}))}function ce(){w.textContent=P}function ue(){Lc(Oc(F,s),(function(e){if(e.exists()){var t=e.val();n=t.chances_left,A&&O?(A=!1,he(),G()):A&&!O&&(A=!1,he(),function(){$.apply(this,arguments)}()),console.log("server - chances left",n)}else W({user_id:s}).then((function(e){n=e.data.chances_left})).catch((function(e){return console.log(e)}))}))}function he(){console.log("chances left",n),sl(_).forEach((function(e){e.textContent=n.toString()}));for(var e=4;e>=n;e--)f[e].style.display="none"}}))}},t={};function n(i){var r=t[i];if(void 0!==r)return r.exports;var s=t[i]={id:i,loaded:!1,exports:{}};return e[i].call(s.exports,s,s.exports,n),s.loaded=!0,s.exports}n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),n(7588),n(1303)})();