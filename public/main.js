/*! For license information please see main.js.LICENSE.txt */
(()=>{var e={1733:function(e,t){!function(e){"use strict";function t(e){return Array.prototype.slice.call(e)}function n(e){return new Promise((function(t,n){e.onsuccess=function(){t(e.result)},e.onerror=function(){n(e.error)}}))}function r(e,t,r){var i,s=new Promise((function(s,o){n(i=e[t].apply(e,r)).then(s,o)}));return s.request=i,s}function i(e,t,n){var i=r(e,t,n);return i.then((function(e){if(e)return new u(e,i.request)}))}function s(e,t,n){n.forEach((function(n){Object.defineProperty(e.prototype,n,{get:function(){return this[t][n]},set:function(e){this[t][n]=e}})}))}function o(e,t,n,i){i.forEach((function(i){i in n.prototype&&(e.prototype[i]=function(){return r(this[t],i,arguments)})}))}function a(e,t,n,r){r.forEach((function(r){r in n.prototype&&(e.prototype[r]=function(){return this[t][r].apply(this[t],arguments)})}))}function c(e,t,n,r){r.forEach((function(r){r in n.prototype&&(e.prototype[r]=function(){return i(this[t],r,arguments)})}))}function l(e){this._index=e}function u(e,t){this._cursor=e,this._request=t}function h(e){this._store=e}function d(e){this._tx=e,this.complete=new Promise((function(t,n){e.oncomplete=function(){t()},e.onerror=function(){n(e.error)},e.onabort=function(){n(e.error)}}))}function p(e,t,n){this._db=e,this.oldVersion=t,this.transaction=new d(n)}function f(e){this._db=e}s(l,"_index",["name","keyPath","multiEntry","unique"]),o(l,"_index",IDBIndex,["get","getKey","getAll","getAllKeys","count"]),c(l,"_index",IDBIndex,["openCursor","openKeyCursor"]),s(u,"_cursor",["direction","key","primaryKey","value"]),o(u,"_cursor",IDBCursor,["update","delete"]),["advance","continue","continuePrimaryKey"].forEach((function(e){e in IDBCursor.prototype&&(u.prototype[e]=function(){var t=this,r=arguments;return Promise.resolve().then((function(){return t._cursor[e].apply(t._cursor,r),n(t._request).then((function(e){if(e)return new u(e,t._request)}))}))})})),h.prototype.createIndex=function(){return new l(this._store.createIndex.apply(this._store,arguments))},h.prototype.index=function(){return new l(this._store.index.apply(this._store,arguments))},s(h,"_store",["name","keyPath","indexNames","autoIncrement"]),o(h,"_store",IDBObjectStore,["put","add","delete","clear","get","getAll","getKey","getAllKeys","count"]),c(h,"_store",IDBObjectStore,["openCursor","openKeyCursor"]),a(h,"_store",IDBObjectStore,["deleteIndex"]),d.prototype.objectStore=function(){return new h(this._tx.objectStore.apply(this._tx,arguments))},s(d,"_tx",["objectStoreNames","mode"]),a(d,"_tx",IDBTransaction,["abort"]),p.prototype.createObjectStore=function(){return new h(this._db.createObjectStore.apply(this._db,arguments))},s(p,"_db",["name","version","objectStoreNames"]),a(p,"_db",IDBDatabase,["deleteObjectStore","close"]),f.prototype.transaction=function(){return new d(this._db.transaction.apply(this._db,arguments))},s(f,"_db",["name","version","objectStoreNames"]),a(f,"_db",IDBDatabase,["close"]),["openCursor","openKeyCursor"].forEach((function(e){[h,l].forEach((function(n){e in n.prototype&&(n.prototype[e.replace("open","iterate")]=function(){var n=t(arguments),r=n[n.length-1],i=this._store||this._index,s=i[e].apply(i,n.slice(0,-1));s.onsuccess=function(){r(s.result)}})}))})),[l,h].forEach((function(e){e.prototype.getAll||(e.prototype.getAll=function(e,t){var n=this,r=[];return new Promise((function(i){n.iterateCursor(e,(function(e){e?(r.push(e.value),void 0===t||r.length!=t?e.continue():i(r)):i(r)}))}))})})),e.openDb=function(e,t,n){var i=r(indexedDB,"open",[e,t]),s=i.request;return s&&(s.onupgradeneeded=function(e){n&&n(new p(s.result,e.oldVersion,s.transaction))}),i.then((function(e){return new f(e)}))},e.deleteDb=function(e){return r(indexedDB,"deleteDatabase",[e])},Object.defineProperty(e,"__esModule",{value:!0})}(t)},3340:function(e,t){"use strict";var n=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.WaxEventSource=class{constructor(e){this.waxSigningURL=e,this.timeout=()=>n(this,void 0,void 0,(function*(){return new Promise(((e,t)=>setTimeout((()=>t(new Error("Timeout"))),5e3)))})),this.openEventSource=this.openEventSource.bind(this),this.onceEvent=this.onceEvent.bind(this)}openPopup(e){return n(this,void 0,void 0,(function*(){const t=yield window.open(e,"WaxPopup","height=800,width=600");if(t)return t;throw new Error("Unable to open popup window")}))}openEventSource(e,t,r){return n(this,void 0,void 0,(function*(){const i=r||(yield this.openPopup(e));if(!i)throw new Error("Unable to open a popup window");if(void 0===t)return i;const s=this.onceEvent(i,this.waxSigningURL,(e=>n(this,void 0,void 0,(function*(){"READY"===e.data.type&&i.postMessage(t,this.waxSigningURL)}))),"READY");return yield Promise.race([s,this.timeout()]).catch((e=>{if("Timeout"!==e.message)throw e;i.postMessage(t,this.waxSigningURL)})),i}))}onceEvent(e,t,r,i){return n(this,void 0,void 0,(function*(){return new Promise(((s,o)=>{window.addEventListener("message",(function a(c){return n(this,void 0,void 0,(function*(){if(c.origin===t&&c.source===e&&"object"==typeof c.data&&(!i||c.data.type&&c.data.type===i)){try{s(yield r(c))}catch(e){o(e)}window.removeEventListener("message",a,!1)}}))}),!1)}))}))}}},7975:function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const i=n(3340);t.WaxSigningApi=class{constructor(e,t){this.waxSigningURL=e,this.waxAutoSigningURL=t,this.waxEventSource=new i.WaxEventSource(e)}login(){return r(this,void 0,void 0,(function*(){if(this.user||(yield this.loginViaWindow()),this.user)return this.user;throw new Error("Login failed")}))}tryAutologin(){return r(this,void 0,void 0,(function*(){if(this.user)return!0;try{return yield this.loginViaEndpoint(),!0}catch(e){return!1}}))}prepareTransaction(e){return r(this,void 0,void 0,(function*(){this.canAutoSign(e)||(this.signingWindow=yield this.waxEventSource.openPopup(`${this.waxSigningURL}/cloud-wallet/signing/`))}))}signing(e,t,n=!1){return r(this,void 0,void 0,(function*(){if(this.canAutoSign(e))try{return yield this.signViaEndpoint(t,n)}catch(e){}return yield this.signViaWindow(t,this.signingWindow,n)}))}loginViaWindow(){return r(this,void 0,void 0,(function*(){const e=yield this.waxEventSource.openEventSource(`${this.waxSigningURL}/cloud-wallet/login/`);return this.waxEventSource.onceEvent(e,this.waxSigningURL,this.receiveLogin.bind(this),void 0)}))}loginViaEndpoint(){return r(this,void 0,void 0,(function*(){const e=yield fetch(`${this.waxAutoSigningURL}login`,{credentials:"include",method:"get"});if(!e.ok)throw new Error(`Login Endpoint Error ${e.status} ${e.statusText}`);const t=yield e.json();if(t.processed&&t.processed.except)throw new Error(t);return this.receiveLogin({data:t})}))}signViaEndpoint(e,t=!1){return r(this,void 0,void 0,(function*(){const n=new AbortController;setTimeout((()=>n.abort()),5e3);const r=yield fetch(`${this.waxAutoSigningURL}signing`,{body:JSON.stringify({freeBandwidth:!t,transaction:Object.values(e)}),credentials:"include",headers:{"Content-Type":"application/json"},method:"POST",signal:n.signal});if(!r.ok)throw this.whitelistedContracts=[],new Error(`Signing Endpoint Error ${r.status} ${r.statusText}`);const i=yield r.json();if(i.processed&&i.processed.except)throw this.whitelistedContracts=[],new Error(`Error returned from signing endpoint: ${JSON.stringify(i)}`);return this.receiveSignatures({data:i})}))}signViaWindow(e,t,n=!1){return r(this,void 0,void 0,(function*(){const r=yield this.waxEventSource.openEventSource(`${this.waxSigningURL}/cloud-wallet/signing/`,{freeBandwidth:!n,transaction:e,type:"TRANSACTION"},t);return this.waxEventSource.onceEvent(r,this.waxSigningURL,this.receiveSignatures.bind(this),"TX_SIGNED")}))}receiveLogin(e){return r(this,void 0,void 0,(function*(){const{verified:t,userAccount:n,pubKeys:r,whitelistedContracts:i}=e.data;if(!t)throw new Error("User declined to share their user account");if(!n||!r)throw new Error("User does not have a blockchain account");return this.whitelistedContracts=i||[],this.user={account:n,keys:r},!0}))}receiveSignatures(e){return r(this,void 0,void 0,(function*(){if("TX_SIGNED"===e.data.type){const{verified:t,signatures:n,whitelistedContracts:r,serializedTransaction:i}=e.data;if(!t||!n)throw new Error("User declined to sign the transaction");return this.whitelistedContracts=r||[],{serializedTransaction:i,signatures:n}}throw new Error(`Unexpected response received when attempting signing: ${JSON.stringify(e.data)}`)}))}canAutoSign(e){const t=navigator.userAgent.toLowerCase();return!(-1===t.search("chrome")&&t.search("safari")>=0||e.actions.find((e=>!this.isWhitelisted(e))))}isWhitelisted(e){return!(!this.whitelistedContracts||!this.whitelistedContracts.find((t=>t.contract===e.account&&("eosio.token"!==e.account||"transfer"!==e.name||t.recipients.includes(e.data.to)))))}}},6356:function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const i=n(7678),s=n(7975);function o(e,t,n){const{actions:r}=t,{actions:i}=n;if(JSON.stringify(r)!==JSON.stringify(i.slice(i.length-r.length)))throw new Error(`Augmented transaction actions has modified actions from the original.\nOriginal: ${JSON.stringify(r,void 0,2)}\nAugmented: ${JSON.stringify(i,void 0,2)}`);for(const t of i.slice(0,i.length-r.length))if(t.authorization.find((t=>t.actor===e.account)))throw new Error(`Augmented transaction actions has an extra action from the original authorizing the user.\nOriginal: ${JSON.stringify(r,void 0,2)}\nAugmented: ${JSON.stringify(i,void 0,2)}`)}t.WaxJS=class{constructor({rpcEndpoint:e,tryAutoLogin:t=!0,userAccount:n,pubKeys:a,apiSigner:c,waxSigningURL:l="https://all-access.wax.io",waxAutoSigningURL:u="https://api-idm.wax.io/v1/accounts/auto-accept/",eosApiArgs:h={},freeBandwidth:d=!0,verifyTx:p=o}){this.signingApi=new s.WaxSigningApi(l,u),this.rpc=new i.JsonRpc(e),this.waxSigningURL=l,this.waxAutoSigningURL=u,this.apiSigner=c,this.eosApiArgs=h,this.freeBandwidth=d,this.verifyTx=p,n&&Array.isArray(a)?this.receiveLogin({account:n,keys:a}):t&&this.signingApi.tryAutologin().then((e=>r(this,void 0,void 0,(function*(){e&&this.receiveLogin(yield this.signingApi.login())}))))}get userAccount(){return this.user&&this.user.account}get pubKeys(){return this.user&&this.user.keys}login(){return r(this,void 0,void 0,(function*(){return this.user||this.receiveLogin(yield this.signingApi.login()),this.user.account}))}isAutoLoginAvailable(){return r(this,void 0,void 0,(function*(){return!!this.user||!!(yield this.signingApi.tryAutologin())&&(this.receiveLogin(yield this.signingApi.login()),!0)}))}receiveLogin(e){this.user=e;const t={getAvailableKeys:()=>r(this,void 0,void 0,(function*(){return[...this.user.keys,...this.apiSigner&&(yield this.apiSigner.getAvailableKeys())||[]]})),sign:e=>r(this,void 0,void 0,(function*(){const t=yield this.api.deserializeTransactionWithActions(e.serializedTransaction),{serializedTransaction:n,signatures:r}=yield this.signingApi.signing(t,e.serializedTransaction,!this.freeBandwidth),i=yield this.api.deserializeTransactionWithActions(n);return this.verifyTx(this.user,t,i),e.serializedTransaction=n,{serializedTransaction:n,signatures:[...r,...this.apiSigner&&(yield this.apiSigner.sign(e)).signatures||[]]}}))};this.api=new i.Api(Object.assign(Object.assign({},this.eosApiArgs),{rpc:this.rpc,signatureProvider:t}));const n=this.api.transact.bind(this.api);this.api.transact=(e,t)=>r(this,void 0,void 0,(function*(){return yield this.signingApi.prepareTransaction(e),yield n(e,t)}))}}},146:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=r(n(7809)),s=r(n(2334));function o(e,t){var n;const r={};for(const e of t){const t=null!==(n=e.type)&&void 0!==n?n:"data";"number"==typeof e.value?r[t+":number."+e.key]=String(e.value):"boolean"==typeof e.value?r[t+":bool."+e.key]=e.value?"true":"false":r[t+"."+e.key]=e.value}return Object.assign({},e,r)}t.default=class{constructor(e,t,n){this.endpoint=e,this.namespace=t,n.fetch?this.fetchBuiltin=n.fetch:this.fetchBuiltin=window.fetch,this.action=(async()=>new i.default((await this.getConfig()).contract,this))()}async getConfig(){return await this.fetchEndpoint("/v1/config",{})}async getAssets(e={},t=1,n=100,r=[]){return await this.fetchEndpoint("/v1/assets",Object.assign({page:t,limit:n},o(e,r)))}async countAssets(e,t=[]){return await this.countEndpoint("/v1/assets",o(e,t))}async getAsset(e){return await this.fetchEndpoint("/v1/assets/"+e,{})}async getAssetStats(e){return await this.fetchEndpoint("/v1/assets/"+e+"/stats",{})}async getAssetLogs(e,t=1,n=100,r="desc"){return await this.fetchEndpoint("/v1/assets/"+e+"/logs",{page:t,limit:n,order:r})}async getCollections(e={},t=1,n=100){return await this.fetchEndpoint("/v1/collections",Object.assign({page:t,limit:n},e))}async countCollections(e={}){return await this.countEndpoint("/v1/collections",e)}async getCollection(e){return await this.fetchEndpoint("/v1/collections/"+e,{})}async getCollectionStats(e){return await this.fetchEndpoint("/v1/collections/"+e+"/stats",{})}async getCollectionLogs(e,t=1,n=100,r="desc"){return await this.fetchEndpoint("/v1/collections/"+e+"/logs",{page:t,limit:n,order:r})}async getSchemas(e={},t=1,n=100){return await this.fetchEndpoint("/v1/schemas",Object.assign({page:t,limit:n},e))}async countSchemas(e={}){return await this.countEndpoint("/v1/schemas",e)}async getSchema(e,t){return await this.fetchEndpoint("/v1/schemas/"+e+"/"+t,{})}async getSchemaStats(e,t){return await this.fetchEndpoint("/v1/schemas/"+e+"/"+t+"/stats",{})}async getSchemaLogs(e,t,n=1,r=100,i="desc"){return await this.fetchEndpoint("/v1/schemas/"+e+"/"+t+"/logs",{page:n,limit:r,order:i})}async getTemplates(e={},t=1,n=100,r=[]){return await this.fetchEndpoint("/v1/templates",Object.assign({page:t,limit:n},o(e,r)))}async countTemplates(e={},t=[]){return await this.countEndpoint("/v1/templates",o(e,t))}async getTemplate(e,t){return await this.fetchEndpoint("/v1/templates/"+e+"/"+t,{})}async getTemplateStats(e,t){return await this.fetchEndpoint("/v1/templates/"+e+"/"+t+"/stats",{})}async getTemplateLogs(e,t,n=1,r=100,i="desc"){return await this.fetchEndpoint("/v1/templates/"+e+"/"+t+"/logs",{page:n,limit:r,order:i})}async getTransfers(e={},t=1,n=100){return await this.fetchEndpoint("/v1/transfers",Object.assign({page:t,limit:n},e))}async countTransfers(e={}){return await this.countEndpoint("/v1/transfers",e)}async getOffers(e={},t=1,n=100){return await this.fetchEndpoint("/v1/offers",Object.assign({page:t,limit:n},e))}async countOffers(e={}){return await this.countEndpoint("/v1/offers",e)}async getOffer(e){return await this.fetchEndpoint("/v1/offers/"+e,{})}async getAccounts(e={},t=1,n=100){return await this.fetchEndpoint("/v1/accounts",Object.assign({page:t,limit:n},e))}async getBurns(e={},t=1,n=100){return await this.fetchEndpoint("/v1/burns",Object.assign({page:t,limit:n},e))}async countAccounts(e={}){return await this.countEndpoint("/v1/accounts",e)}async getAccount(e,t={}){return await this.fetchEndpoint("/v1/accounts/"+e,t)}async getAccountCollection(e,t){return await this.fetchEndpoint("/v1/accounts/"+e+"/"+t,{})}async getAccountBurns(e,t={}){return await this.fetchEndpoint("/v1/burns/"+e,t)}async fetchEndpoint(e,t){let n,r;const i=this.fetchBuiltin,o=Object.keys(t).map((e=>{let n=t[e];return!0===n&&(n="true"),!1===n&&(n="false"),e+"="+encodeURIComponent(n)})).join("&");try{n=await i(this.endpoint+"/"+this.namespace+e+(o.length>0?"?"+o:"")),r=await n.json()}catch(e){throw new s.default(e.message,500)}if(200!==n.status)throw new s.default(r.message,n.status);if(!r.success)throw new s.default(r.message,n.status);return r.data}async countEndpoint(e,t){const n=await this.fetchEndpoint(e+"/_count",t);return parseInt(n,10)}}},3100:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=n(5821),s=r(n(3427)),o=r(n(9893)),a=r(n(2929));t.default=class{constructor(e,t,n,r,i,c,l,u=!0){this.api=e,this.owner=t,this.id=n,this._data=new Promise((async(i,s)=>{if(r)i(r);else try{i(await e.queue.fetchAsset(t,n,u))}catch(e){s(e)}})),this._template=new Promise((async(t,n)=>{if(l)t(l);else try{const n=await this._data;if(Number(n.template_id)<0)return t(null);t(new a.default(e,n.collection_name,n.template_id,void 0,void 0,u))}catch(e){n(e)}})),this._collection=new Promise((async(t,n)=>{if(i)t(i);else try{const n=await this._data;t(new s.default(e,n.collection_name,void 0,u))}catch(e){n(e)}})),this._schema=new Promise((async(t,n)=>{if(c)t(c);else try{const n=await this._data;t(new o.default(e,n.collection_name,n.schema_name,void 0,u))}catch(e){n(e)}}))}async template(){return await this._template}async collection(){return await this._collection}async schema(){return await this._schema}async backedTokens(){return(await this._data).backed_tokens}async immutableData(){const e=await this.schema(),t=await this._data;return i.deserialize(t.immutable_serialized_data,await e.format())}async mutableData(){const e=await this.schema(),t=await this._data;return i.deserialize(t.mutable_serialized_data,await e.format())}async data(){const e=await this.mutableData(),t=await this.immutableData(),n=await this.template(),r=n?await n.immutableData():{};return Object.assign({},e,t,r)}async toObject(){const e=await this.template(),t=await this.collection(),n=await this.schema();return{asset_id:this.id,collection:await t.toObject(),schema:await n.toObject(),template:e?await e.toObject():null,backedTokens:await this.backedTokens(),immutableData:await this.immutableData(),mutableData:await this.mutableData(),data:await this.data()}}}},2236:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=r(n(9105));t.default=class{constructor(){this.cache=new i.default({expiryCheckInterval:6e4})}getAsset(e,t){return t&&(t.mutable_serialized_data=new Uint8Array(t.mutable_serialized_data),t.immutable_serialized_data=new Uint8Array(t.immutable_serialized_data)),this.access("assets",e,t)}deleteAsset(e){this.delete("assets",e)}getTemplate(e,t,n){return n&&(n.immutable_serialized_data=new Uint8Array(n.immutable_serialized_data)),this.access("templates",e+":"+t,n)}deleteTemplate(e,t){this.delete("templates",e+":"+t)}getSchema(e,t,n){return this.access("schemas",e+":"+t,n)}deleteSchema(e,t){this.delete("schemas",e+":"+t)}getCollection(e,t){return this.access("collections",e,t)}deleteCollection(e){this.delete("collections",e)}getOffer(e,t){return this.access("offers",e,t)}deleteOffer(e){this.delete("offers",e)}access(e,t,n){if(void 0===n){const n=this.cache.get(e+":"+t);return null===n?null:n.value}return this.cache.put(e+":"+t,n,9e5),n}delete(e,t){this.cache.remove(e+":"+t)}}},3427:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(2643),i=n(5821);t.default=class{constructor(e,t,n,r=!0){this.api=e,this.name=t,this._data=new Promise((async(i,s)=>{if(n)i(n);else try{i(await e.queue.fetchCollection(t,r))}catch(e){s(e)}}))}async author(){return(await this._data).author}async allowNotify(){return(await this._data).allow_notify}async authorizedAccounts(){return(await this._data).authorized_accounts}async notifyAccounts(){return(await this._data).notify_accounts}async marketFee(){return Number((await this._data).market_fee)}async data(){return i.deserialize((await this._data).serialized_data,r.ObjectSchema((await this.api.config()).collection_format))}async toObject(){return{collection_name:this.name,author:await this.author(),allowNotify:await this.allowNotify(),authorizedAccounts:await this.authorizedAccounts(),notifyAccounts:await this.notifyAccounts(),marketFee:await this.marketFee(),data:await this.data()}}}},2613:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=r(n(3100));t.default=class{constructor(e,t,n,r,s,o=!0){this.api=e,this.id=t,this._data=new Promise((async(e,r)=>{if(n)e(n);else try{e(await this.api.queue.fetchOffer(t,o))}catch(e){r(e)}})),this._senderAssets=new Promise((async(e,t)=>{if(r)e(r);else try{const t=await this._data,n=await this.api.queue.fetchAccountAssets(t.sender);return e(t.sender_asset_ids.map((e=>{const r=n.find((t=>t.asset_id===e));return r?new i.default(this.api,t.sender,e,r,void 0,void 0,void 0,o):e})))}catch(e){return t(e)}})),this._recipientAssets=new Promise((async(e,t)=>{if(s)e(s);else try{const t=await this._data,n=await this.api.queue.fetchAccountAssets(t.recipient);return e(t.recipient_asset_ids.map((e=>{const r=n.find((t=>t.asset_id===e));return r?new i.default(this.api,t.recipient,e,r,void 0,void 0,void 0,o):e})))}catch(e){return t(e)}}))}async sender(){return(await this._data).sender}async recipient(){return(await this._data).recipient}async senderAssets(){return await this._senderAssets}async recipientAssets(){return await this._recipientAssets}async memo(){return(await this._data).memo}async toObject(){return{offer_id:this.id,sender:{account:await this.sender(),assets:await Promise.all((await this.senderAssets()).map((async e=>"string"==typeof e?e:await e.toObject())))},recipient:{account:await this.recipient(),assets:await Promise.all((await this.recipientAssets()).map((async e=>"string"==typeof e?e:await e.toObject())))},memo:await this.memo()}}}},6970:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=class{constructor(e,t=4){this.api=e,this.requestLimit=t,this.elements=[],this.interval=null,this.preloadedCollections={}}async fetchAsset(e,t,n=!0){return await this.fetch_single_row("assets",e,t,(e=>n||void 0!==e?this.api.cache.getAsset(t,e):null))}async fetchAccountAssets(e){return(await this.fetch_all_rows("assets",e,"asset_id")).map((e=>this.api.cache.getAsset(e.asset_id,e)))}async fetchTemplate(e,t,n=!0){return await this.fetch_single_row("templates",e,t,(r=>n||void 0!==r?this.api.cache.getTemplate(e,t,r):null))}async fetchSchema(e,t,n=!0){return await this.fetch_single_row("schemas",e,t,(r=>n||void 0!==r?this.api.cache.getSchema(e,t,r):null))}async fetchCollection(e,t=!0){return await this.fetch_single_row("collections",this.api.contract,e,(n=>t||void 0!==n?this.api.cache.getCollection(e,n):null))}async fetchCollectionSchemas(e){return(await this.fetch_all_rows("schemas",e,"schema_name")).map((t=>this.api.cache.getSchema(e,t.schema_name,t)))}async fetchCollectionTemplates(e){return(await this.fetch_all_rows("templates",e,"template_id")).map((t=>this.api.cache.getTemplate(e,String(t.template_id),t)))}async preloadCollection(e,t=!0){(!t||!this.preloadedCollections[e]||this.preloadedCollections[e]+9e5<Date.now())&&(await this.fetchCollectionSchemas(e),await this.fetchCollectionTemplates(e))}async fetchOffer(e,t=!0){return await this.fetch_single_row("offers",this.api.contract,e,(n=>t||void 0!==n?this.api.cache.getOffer(e,n):null))}async fetchAccountOffers(e){const t=await Promise.all([this.fetch_all_rows("offers",this.api.contract,"offer_sender",e,e,2,"name"),this.fetch_all_rows("offers",this.api.contract,"offer_recipient",e,e,3,"name")]);return t[0].concat(t[1]).map((e=>this.api.cache.getOffer(e.offer_id,e)))}dequeue(){this.interval||(this.interval=setInterval((async()=>{this.elements.length>0?this.elements.shift()():(clearInterval(this.interval),this.interval=null)}),Math.ceil(1e3/this.requestLimit)))}async fetch_single_row(e,t,n,r,i=1,s=""){return new Promise(((o,a)=>{let c=r();if(null!==c)return o(c);this.elements.push((async()=>{if(c=r(),null!==c)return o(c);try{const c={code:this.api.contract,table:e,scope:t,limit:1,lower_bound:n,upper_bound:n,index_position:i,key_type:s},l=await this.api.getTableRows(c);return 0===l.rows.length?a(new Error("Row not found for "+JSON.stringify(c))):o(r(l.rows[0]))}catch(e){return a(e)}})),this.dequeue()}))}async fetch_all_rows(e,t,n,r="",i="",s=1,o=""){return new Promise((async(a,c)=>{this.elements.push((async()=>{const l=await this.api.getTableRows({code:this.api.contract,scope:t,table:e,lower_bound:r,upper_bound:i,limit:1e3,index_position:s,key_type:o});l.more&&1===s?(this.elements.unshift((async()=>{try{const r=await this.fetch_all_rows(e,t,n,l.rows[l.rows.length-1][n],i,s,o);r.length>0&&r.shift(),a(l.rows.concat(r))}catch(e){c(e)}})),this.dequeue()):a(l.rows)})),this.dequeue()}))}}},9893:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=n(2643),s=r(n(3427));t.default=class{constructor(e,t,n,r,i=!0){this.api=e,this.collection=t,this.name=n,this._data=new Promise((async(s,o)=>{if(r)s(r);else try{s(await e.queue.fetchSchema(t,n,i))}catch(e){o(e)}})),this._collection=new Promise((async(n,r)=>{try{n(new s.default(e,t,void 0,i))}catch(e){r(e)}}))}async format(){return i.ObjectSchema((await this._data).format)}async rawFormat(){return(await this._data).format}async toObject(){return{collection_name:this.collection,schema_name:this.name,format:await this.rawFormat()}}}},2929:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=n(5821),s=r(n(9893));t.default=class{constructor(e,t,n,r,i,o=!0){this.api=e,this.collection=t,this.id=n,this._data=new Promise((async(i,s)=>{if(r)i(r);else try{i(await e.queue.fetchTemplate(t,n,o))}catch(e){s(e)}})),this._schema=new Promise((async(e,n)=>{if(i)e(i);else try{const n=await this._data;e(new s.default(this.api,t,n.schema_name,void 0,o))}catch(e){n(e)}}))}async schema(){return await this._schema}async immutableData(){const e=await this._schema;return i.deserialize((await this._data).immutable_serialized_data,await e.format())}async isTransferable(){return(await this._data).transferable}async isBurnable(){return(await this._data).burnable}async maxSupply(){return(await this._data).max_supply}async circulation(){return(await this._data).issued_supply}async toObject(){return{collection_name:this.collection,template_id:this.id,schema:await(await this.schema()).toObject(),immutableData:await this.immutableData(),transferable:await this.isTransferable(),burnable:await this.isBurnable(),maxSupply:await this.maxSupply(),circulation:await this.circulation()}}}},5310:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=r(n(910)),s=r(n(9398)),o=r(n(3100)),a=r(n(2236)),c=r(n(3427)),l=r(n(2613)),u=r(n(6970)),h=r(n(9893)),d=r(n(2929));t.default=class{constructor(e,t,r={rateLimit:4}){this.endpoint=e,this.contract=t,r.fetch?this.fetchBuiltin=r.fetch:this.fetchBuiltin=n.g.fetch,this.queue=new u.default(this,r.rateLimit),this.cache=new a.default,this.action=new i.default(this),this._config=new Promise((async(e,t)=>{try{const n=await this.getTableRows({code:this.contract,scope:this.contract,table:"config"});return 1!==n.rows.length?t("invalid config"):e(n.rows[0])}catch(e){t(e)}}))}async config(){return await this._config}async getAsset(e,t,n=!0){n||this.cache.deleteAsset(t);const r=await this.queue.fetchAsset(e,t,n);return new o.default(this,e,t,r,void 0,void 0,void 0,n)}async getTemplate(e,t,n=!0){n||this.cache.deleteTemplate(e,t);const r=await this.queue.fetchTemplate(e,t,n);return new d.default(this,e,t,r,void 0,n)}async getCollection(e,t=!0){t||this.cache.deleteCollection(e);const n=await this.queue.fetchCollection(e,t);return new c.default(this,e,n,t)}async getCollectionTemplates(e){return(await this.queue.fetchCollectionTemplates(e)).map((t=>new d.default(this,e,String(t.template_id),t,void 0)))}async getCollectionsSchemas(e){return(await this.queue.fetchCollectionSchemas(e)).map((t=>new h.default(this,e,t.schema_name,void 0)))}async getSchema(e,t,n=!0){n||this.cache.deleteSchema(e,t);const r=await this.queue.fetchSchema(e,t,n);return new h.default(this,e,t,r,n)}async getOffer(e,t=!0){t||this.cache.deleteOffer(e);const n=await this.queue.fetchOffer(e,t);return new l.default(this,e,n,void 0,void 0,t)}async getAccountOffers(e){return(await this.queue.fetchAccountOffers(e)).map((e=>new l.default(this,e.offer_id,e,void 0,void 0)))}async getAccountAssets(e){return(await this.queue.fetchAccountAssets(e)).map((t=>new o.default(this,e,t.asset_id,t,void 0,void 0,void 0)))}async getCollectionInventory(e,t){return await this.queue.preloadCollection(e,!0),(await this.queue.fetchAccountAssets(t)).filter((t=>t.collection_name===e)).map((e=>new o.default(this,t,e.asset_id,e,void 0,void 0,void 0)))}async preloadCollection(e,t=!0){await this.queue.preloadCollection(e,t)}async getTableRows({code:e,scope:t,table:n,table_key:r="",lower_bound:i="",upper_bound:s="",index_position:o=1,key_type:a=""}){return await this.fetchRpc("/v1/chain/get_table_rows",{code:e,scope:t,table:n,table_key:r,lower_bound:i,upper_bound:s,index_position:o,key_type:a,limit:101,reverse:!1,show_payer:!1,json:!0})}async fetchRpc(e,t){let n,r;try{const i=this.fetchBuiltin;n=await i(this.endpoint+e,{body:JSON.stringify(t),method:"POST"}),r=await n.json()}catch(e){throw e.isFetchError=!0,e}if(r.processed&&r.processed.except||!n.ok)throw new s.default(r);return r}}},7809:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(522);class i extends r.ActionGenerator{constructor(e,t){super(e),this.api=t,this.config=t.getConfig()}async createcol(e,t,n,i,s,o,a,c){return super.createcol(e,t,n,i,s,o,a,r.toAttributeMap(c,(await this.config).collection_format))}async createtempl(e,t,n,i,s,o,a,c){const l=await this.api.getSchema(n,i),u=r.toAttributeMap(c,l.format);return super.createtempl(e,t,n,i,s,o,a,u)}async mintasset(e,t,n,i,s,o,a,c,l){const u=await this.api.getSchema(n,i),h=r.toAttributeMap(a,u.format),d=r.toAttributeMap(c,u.format);return super.mintasset(e,t,n,i,s,o,h,d,l)}async setassetdata(e,t,n,i,s){const o=await this.api.getAsset(i),a=r.toAttributeMap(s,o.schema.format);return super.setassetdata(e,t,n,i,a)}async setcoldata(e,t,n){const i=r.toAttributeMap(n,(await this.config).collection_format);return super.setcoldata(e,t,i)}}t.default=i},522:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.toAttributeMap=t.ActionGenerator=void 0;const i=r(n(9338));t.ActionGenerator=class{constructor(e){this.contract=e}async acceptoffer(e,t){return this._pack(e,"acceptoffer",{offer_id:t})}async addcolauth(e,t,n){return this._pack(e,"addcolauth",{collection_name:t,account_to_add:n})}async addconftoken(e,t,n){return this._pack(e,"addconftoken",{token_contract:t,token_symbol:n})}async addnotifyacc(e,t,n){return this._pack(e,"addnotifyacc",{collection_name:t,account_to_add:n})}async announcedepo(e,t,n){return this._pack(e,"announcedepo",{owner:t,symbol_to_announce:n})}async backasset(e,t,n,r,i){return this._pack(e,"backasset",{payer:t,asset_owner:n,asset_id:r,token_to_back:i})}async burnasset(e,t,n){return this._pack(e,"burnasset",{asset_owner:t,asset_id:n})}async canceloffer(e,t){return this._pack(e,"canceloffer",{offer_id:t})}async createcol(e,t,n,r,i,s,o,a){return this._pack(e,"createcol",{author:t,collection_name:n,allow_notify:r,authorized_accounts:i,notify_accounts:s,market_fee:o,data:a})}async createoffer(e,t,n,r,i,s){return this._pack(e,"createoffer",{sender:t,recipient:n,sender_asset_ids:r,recipient_asset_ids:i,memo:s})}async createtempl(e,t,n,r,i,s,o,a){return this._pack(e,"createtempl",{authorized_creator:t,collection_name:n,schema_name:r,transferable:i,burnable:s,max_supply:o,immutable_data:a})}async createschema(e,t,n,r,i){return this._pack(e,"createschema",{authorized_creator:t,collection_name:n,schema_name:r,schema_format:i})}async declineoffer(e,t){return this._pack(e,"declineoffer",{offer_id:t})}async extendschema(e,t,n,r,i){return this._pack(e,"extendschema",{authorized_editor:t,collection_name:n,schema_name:r,schema_format_extension:i})}async forbidnotify(e,t){return this._pack(e,"forbidnotify",{collection_name:t})}async locktemplate(e,t,n,r){return this._pack(e,"locktemplate",{authorized_editor:t,collection_name:n,template_id:r})}async mintasset(e,t,n,r,i,s,o,a,c){return this._pack(e,"mintasset",{authorized_minter:t,collection_name:n,schema_name:r,template_id:i,new_asset_owner:s,immutable_data:o,mutable_data:a,tokens_to_back:c})}async payofferram(e,t,n){return this._pack(e,"payofferram",{payer:t,offer_id:n})}async remcolauth(e,t,n){return this._pack(e,"remcolauth",{collection_name:t,account_to_remove:n})}async remnotifyacc(e,t,n){return this._pack(e,"remnotifyacc",{collection_name:t,account_to_remove:n})}async setassetdata(e,t,n,r,i){return this._pack(e,"setassetdata",{authorized_editor:t,asset_owner:n,asset_id:r,new_mutable_data:i})}async setcoldata(e,t,n){return this._pack(e,"setcoldata",{collection_name:t,data:n})}async setmarketfee(e,t,n){return this._pack(e,"setmarketfee",{collection_name:t,market_fee:n})}async transfer(e,t,n,r,i){return this._pack(e,"transfer",{from:t,to:n,asset_ids:r,memo:i})}async withdraw(e,t,n){return this._pack(e,"withdraw",{owner:t,token_to_withdraw:n})}_pack(e,t,n){return[{account:this.contract,name:t,authorization:e,data:n}]}},t.toAttributeMap=function(e,t){const n={},r=[];for(const e of t)n[e.name]=e.type;const s=Object.keys(e);for(const t of s){if(void 0!==n[t])throw new i.default("field not defined in schema");r.push({key:t,value:[n[t],e[t]]})}return r}},910:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(522);class i extends r.ActionGenerator{constructor(e){super(e.contract),this.api=e}async createcol(e,t,n,i,s,o,a,c){const l=await this.api.config();return super.createcol(e,t,n,i,s,o,a,r.toAttributeMap(c,l.collection_format))}async createtempl(e,t,n,i,s,o,a,c){const l=await this.api.getSchema(n,i),u=r.toAttributeMap(c,await l.rawFormat());return super.createtempl(e,t,n,i,s,o,a,u)}async mintasset(e,t,n,i,s,o,a,c,l){const u=await this.api.getTemplate(n,s),h=r.toAttributeMap(a,await(await u.schema()).rawFormat()),d=r.toAttributeMap(c,await(await u.schema()).rawFormat());return super.mintasset(e,t,n,i,s,o,h,d,l)}async setassetdata(e,t,n,i,s){const o=await this.api.getAsset(n,i),a=await o.schema(),c=r.toAttributeMap(s,await a.rawFormat());return super.setassetdata(e,t,n,i,c)}async setcoldata(e,t,n){const i=r.toAttributeMap(n,(await this.api.config()).collection_format);return super.setcoldata(e,t,i)}}t.default=i},2334:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});class n extends Error{constructor(e,t){super(e),this.message=e,this.status=t,this.isApiError=!0}}t.default=n},1100:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});class n extends Error{}t.default=n},9398:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});class n extends Error{constructor(e){e.error&&e.error.details&&e.error.details.length&&e.error.details[0].message?super(e.error.details[0].message):e.processed&&e.processed.except&&e.processed.except.message?super(e.processed.except.message):super(e.message),this.json=e}}t.default=n},9312:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});class n extends Error{}t.default=n},9338:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});class n extends Error{}t.default=n},2197:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=r(n(9312)),s=n(5480);t.default=class{constructor(e){this.attributes=e,this.reserved=4}deserialize(e,t=!1){const n={};for(;e.position<e.data.length;){const r=s.varint_decode(e);if(r.equals(0))break;const i=this.getAttribute(r.toJSNumber(),!t);i&&(n[i.name]=i.value.deserialize(e))}return n}serialize(e){const t=[];for(let n=0;n<this.attributes.length;n++){const r=this.attributes[n];void 0!==e[r.name]&&(t.push(s.varint_encode(n+this.reserved)),t.push(r.value.serialize(e[r.name])))}return t.push(s.varint_encode(0)),s.concat_byte_arrays(t)}getAttribute(e,t=!0){const n=e-this.reserved;if(!(n>=this.attributes.length))return this.attributes[Number(n)];if(t)throw new i.default("attribute does not exists")}}},524:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=r(n(9312)),s=n(4683);t.default=class{constructor(e){if(void 0===s.ParserTypes[e])throw new i.default(`attribute type '${e}' not defined`);this.parser=s.ParserTypes[e]}deserialize(e){return this.parser.deserialize(e)}serialize(e){return this.parser.serialize(e)}}},2508:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(5480);t.default=class{constructor(e){this.element=e}deserialize(e){const t=r.varint_decode(e).toJSNumber(),n=[];for(let r=0;r<t;r++)n.push(this.element.deserialize(e));return n}serialize(e){const t=[r.varint_encode(e.length)];for(const n of e)t.push(this.element.serialize(n));return r.concat_byte_arrays(t)}}},2643:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.ObjectSchema=void 0;const i=r(n(9312)),s=r(n(2197)),o=r(n(524)),a=r(n(2508));function c(e,t){const n=[];let r=t[e];void 0===r&&(r=[]),delete t[e];for(const e of r)n.push({name:e.name,value:l(e.type,t)});return new s.default(n)}function l(e,t){if(e.endsWith("[]"))return new a.default(l(e.substring(0,e.length-2),t));if(e.startsWith("object{")&&e.endsWith("}")){const n=parseInt(e.substring(7,e.length-1),10);if(isNaN(n))throw new i.default(`invalid type '${e}'`);return c(n,t)}return new o.default(e)}t.ObjectSchema=function(e){const t={};for(const n of e){const e=void 0===n.parent?0:n.parent;void 0===t[e]&&(t[e]=[]),t[e].push(n)}return c(0,t)}},5480:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.byte_vector_to_int=t.int_to_byte_vector=t.concat_byte_arrays=t.hex_encode=t.hex_decode=t.base58_encode=t.base58_decode=t.zigzag_decode=t.zigzag_encode=t.integer_unsign=t.integer_sign=t.varint_decode=t.varint_encode=void 0;const i=r(n(4574)),s=r(n(1100)),o=r(n(9338)),a=r(n(6607));t.varint_encode=function(e){const t=[];let n=i.default(e);if(n.lesser(0))throw new o.default("cant pack negative integer");for(;;){const e=n.and(127);if(n=n.shiftRight(7),n.equals(0)){t.push(e.toJSNumber());break}t.push(e.toJSNumber()+128)}return new Uint8Array(t)},t.varint_decode=function(e){let t=i.default(0);for(let n=0;;n++){if(e.position>=e.data.length)throw new s.default("failed to unpack integer");const r=i.default(e.data[e.position]);if(e.position+=1,r.lesser(128)){t=t.plus(r.shiftLeft(7*n));break}t=t.plus(r.and(127).shiftLeft(7*n))}return t},t.integer_sign=function(e,t){const n=i.default(e);if(n.greaterOrEquals(i.default(2).pow(8*t-1)))throw new Error("cannot sign integer: too big");return n.greaterOrEquals(0)?n:n.negate().xor(i.default(2).pow(8*t).minus(1)).plus(1)},t.integer_unsign=function(e,t){const n=i.default(e);if(n.greater(i.default(2).pow(8*t)))throw new Error("cannot unsign integer: too big");return n.greater(i.default(2).pow(8*t-1))?n.minus(1).xor(i.default(2).pow(8*t).minus(1)).negate():n},t.zigzag_encode=function(e){const t=i.default(e);return t.lesser(0)?t.plus(1).multiply(-2).plus(1):t.multiply(2)},t.zigzag_decode=function(e){const t=i.default(e);return t.mod(2).equals(0)?t.divmod(2).quotient:t.divmod(2).quotient.multiply(-1).minus(1)};const c=new a.default("123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz");t.base58_decode=function(e){return c.decode(e)},t.base58_encode=function(e){return c.encode(e)},t.hex_decode=function(e){const t=e.match(/.{1,2}/g);return t?new Uint8Array(t.map((e=>parseInt(e,16)))):new Uint8Array(0)},t.hex_encode=function(e){return e.reduce(((e,t)=>e+t.toString(16).padStart(2,"0")),"")},t.concat_byte_arrays=function(e){const t=new Uint8Array(e.reduce(((e,t)=>e+t.length),0));let n=0;for(const r of e)t.set(r,n),n+=r.length;return t},t.int_to_byte_vector=function(e){const t=[];let n=i.default(e);for(;n.notEquals(0);)t.push(n.and(255).toJSNumber()),n=n.shiftRight(8);return new Uint8Array(t)},t.byte_vector_to_int=function(e){let t=i.default(0);for(let n=0;n<e.length;n++)t=t.plus(i.default(e[n]).shiftLeft(8*n));return t.toJSNumber()}},6607:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=class{constructor(e){if(this.ALPHABET=e,e.length>=255)throw new TypeError("Alphabet too long");this.BASE_MAP=new Uint8Array(256);for(let e=0;e<this.BASE_MAP.length;e++)this.BASE_MAP[e]=255;for(let t=0;t<e.length;t++){const n=e.charAt(t),r=n.charCodeAt(0);if(255!==this.BASE_MAP[r])throw new TypeError(n+" is ambiguous");this.BASE_MAP[r]=t}this.BASE=e.length,this.LEADER=e.charAt(0),this.FACTOR=Math.log(this.BASE)/Math.log(256),this.iFACTOR=Math.log(256)/Math.log(this.BASE)}encode(e){if(0===e.length)return"";let t=0,n=0,r=0;const i=e.length;for(;r!==i&&0===e[r];)r++,t++;const s=(i-r)*this.iFACTOR+1>>>0,o=new Uint8Array(s);for(;r!==i;){let t=e[r],i=0;for(let e=s-1;(0!==t||i<n)&&-1!==e;e--,i++)t+=256*o[e]>>>0,o[e]=t%this.BASE>>>0,t=t/this.BASE>>>0;if(0!==t)throw new Error("Non-zero carry");n=i,r++}let a=s-n;for(;a!==s&&0===o[a];)a++;let c=this.LEADER.repeat(t);for(;a<s;++a)c+=this.ALPHABET.charAt(o[a]);return c}decode(e){const t=this.decodeUnsafe(e);if(t)return t;throw new Error("Non-base"+this.BASE+" character")}decodeUnsafe(e){if(0===e.length)return new Uint8Array(0);let t=0;if(" "===e[t])return new Uint8Array(0);let n=0,r=0;for(;e[t]===this.LEADER;)n++,t++;const i=(e.length-t)*this.FACTOR+1>>>0,s=new Uint8Array(i);for(;e[t];){let n=this.BASE_MAP[e.charCodeAt(t)];if(255===n)return new Uint8Array(0);let o=0;for(let e=i-1;(0!==n||o<r)&&-1!==e;e--,o++)n+=this.BASE*s[e]>>>0,s[e]=n%256>>>0,n=n/256>>>0;if(0!==n)throw new Error("Non-zero carry");r=o,t++}if(" "===e[t])return new Uint8Array(0);let o=i-r;for(;o!==i&&0===s[o];)o++;const a=new Uint8Array(n+(i-o));a.fill(0,0,n);let c=n;for(;o!==i;)a[c++]=s[o++];return a}}},9694:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.prepare=void 0;class n{constructor(e,t=0){this.data=e,this.position=t}}t.default=n,t.prepare=function(e){return new n(e,0)}},4301:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=r(n(1321));class s extends i.default{constructor(){super(1)}deserialize(e){return 1===super.deserialize(e)[0]?1:0}serialize(e){return super.serialize(new Uint8Array([e?1:0]))}}t.default=s},944:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.ByteParser=void 0;const i=r(n(4661));class s extends i.default{deserialize(e){return super.deserialize(e)}serialize(e){return super.serialize(e)}}t.ByteParser=s},3308:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=r(n(4574)),s=r(n(1321));class o extends s.default{deserialize(e){const t=super.deserialize(e).reverse();let n=i.default(0);for(const e of t)n=n.shiftLeft(8),n=n.plus(e);return this.size<=6?n.toJSNumber():n.toString()}serialize(e){let t=i.default(e);const n=[];for(let e=0;e<this.size;e++)n.push(t.and(255).toJSNumber()),t=t.shiftRight(8);return super.serialize(new Uint8Array(n))}}t.default=o},1321:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=r(n(1100)),s=r(n(9338));t.default=class{constructor(e){this.size=e}deserialize(e){e.position+=this.size;const t=e.data.slice(e.position-this.size,e.position);if(t.length!==this.size)throw new i.default("FixedParser: read past end");return t}serialize(e){if(e.length!==this.size)throw new s.default("input data does not conform fixed size");return e}}},1380:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=r(n(1321)),s=n(31);class o extends i.default{constructor(e){super(e?8:4),this.isDouble=e}deserialize(e){return this.isDouble?s.readDoubleLE(super.deserialize(e)):s.readFloatLE(super.deserialize(e))}serialize(e){let t=[];return this.isDouble?(s.writeDoubleLE(t,e),super.serialize(new Uint8Array(t))):(s.writeFloatLE(t,e),super.serialize(new Uint8Array(t)))}}t.default=o},1734:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=n(5480),s=r(n(4661));class o extends s.default{deserialize(e){return i.base58_encode(super.deserialize(e))}serialize(e){return super.serialize(i.base58_decode(e))}}t.default=o},5618:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=r(n(4661));class s extends i.default{deserialize(e){return(new TextDecoder).decode(super.deserialize(e))}serialize(e){return super.serialize((new TextEncoder).encode(e))}}t.default=s},3671:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=r(n(4574)),s=r(n(1100)),o=r(n(9338)),a=n(5480);t.default=class{constructor(e,t){this.size=e,this.unsigned=t}deserialize(e){let t=a.varint_decode(e);if(this.unsigned||(t=a.zigzag_decode(t)),t.greaterOrEquals(i.default(2).pow(8*this.size-(this.unsigned?0:1))))throw new s.default("number '"+t.toString()+"' too large for given type");return this.size<=6?t.toJSNumber():t.toString()}serialize(e){let t=i.default(e);if(t.greaterOrEquals(i.default(2).pow(8*this.size-(this.unsigned?0:1))))throw new o.default("number '"+t.toString()+"' too large for given type");return this.unsigned||(t=a.zigzag_encode(t)),a.varint_encode(t)}}},4661:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=r(n(1100)),s=n(5480);t.default=class{deserialize(e){const t=s.varint_decode(e).toJSNumber();e.position+=t;const n=e.data.slice(e.position-t,e.position);if(n.length!==t)throw new i.default("VariableParser: read past end");return n}serialize(e){return s.concat_byte_arrays([s.varint_encode(e.length),e])}}},9795:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.ParserTypes=void 0;const i=r(n(4301)),s=n(944),o=r(n(3308)),a=r(n(1380)),c=r(n(1734)),l=r(n(5618)),u=r(n(3671));t.ParserTypes={int8:new u.default(1,!1),int16:new u.default(2,!1),int32:new u.default(4,!1),int64:new u.default(8,!1),uint8:new u.default(1,!0),uint16:new u.default(2,!0),uint32:new u.default(4,!0),uint64:new u.default(8,!0),fixed8:new o.default(1),fixed16:new o.default(2),fixed32:new o.default(4),fixed64:new o.default(8),bool:new i.default,bytes:new s.ByteParser,string:new l.default,image:new l.default,ipfs:new c.default,float:new a.default(!1),double:new a.default(!0)}},5821:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.deserialize=t.serialize=void 0;const i=r(n(2197)),s=n(5480),o=r(n(9694));t.serialize=function(e,t){const n=t.serialize(e);return t instanceof i.default?n.slice(0,n.length-1):n},t.deserialize=function(e,t){t instanceof i.default&&(e=s.concat_byte_arrays([e,s.varint_encode(0)]));const n=new o.default(e,0);return t.deserialize(n)}},4683:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.ActionGenerator=t.ExplorerActionGenerator=t.RpcActionGenerator=t.ParserTypes=t.serialize=t.deserialize=t.ObjectSchema=t.ExplorerApi=t.RpcApi=void 0;const i=r(n(7809));t.ExplorerActionGenerator=i.default;const s=n(522);Object.defineProperty(t,"ActionGenerator",{enumerable:!0,get:function(){return s.ActionGenerator}});const o=r(n(910));t.RpcActionGenerator=o.default;const a=r(n(146));t.ExplorerApi=a.default;const c=r(n(5310));t.RpcApi=c.default;const l=n(2643);Object.defineProperty(t,"ObjectSchema",{enumerable:!0,get:function(){return l.ObjectSchema}});const u=n(5821);Object.defineProperty(t,"deserialize",{enumerable:!0,get:function(){return u.deserialize}}),Object.defineProperty(t,"serialize",{enumerable:!0,get:function(){return u.serialize}});const h=n(9795);Object.defineProperty(t,"ParserTypes",{enumerable:!0,get:function(){return h.ParserTypes}})},31:function(e){"use strict";var t,n,r,i,s,o,a,c,l,u,h,d,p=!1;function f(e,t,n){var r=e[t++],i=e[t++],s=e[t++],o=e[t];return"bige"===n?256*(256*(256*r+i)+s)+o:256*(256*(256*o+s)+i)+r}function _(e,t,n,r){var i=t>>>24&255,s=t>>16&255,o=t>>8&255,a=255&t;"bige"===r?(e[n++]=i,e[n++]=s,e[n++]=o,e[n]=a):(e[n++]=a,e[n++]=o,e[n++]=s,e[n]=i)}function m(e,t,n,r,i){"bige"===i?(_(e,t,r,i),_(e,n,r+4,i)):(_(e,n,r,i),_(e,t,r+4,i))}"function"==typeof Float32Array&&(l=new Float32Array(1),u=new Uint8Array(l.buffer),l[0]=-1,p=0===u[3],t=function(e,t){return(t=t||0)<0||t+4>e.length?0:(u[0]=e[t++],u[1]=e[t++],u[2]=e[t++],u[3]=e[t],l[0])},r=function(e,t){return(t=t||0)<0||t+4>e.length?0:(u[3]=e[t++],u[2]=e[t++],u[1]=e[t++],u[0]=e[t],l[0])},n=function(e,t,n){n=n||0,l[0]=t,e[n++]=u[0],e[n++]=u[1],e[n++]=u[2],e[n]=u[3]},i=function(e,t,n){n=n||0,l[0]=t,e[n++]=u[3],e[n++]=u[2],e[n++]=u[1],e[n]=u[0]}),"function"==typeof Float64Array&&(h=new Float64Array(1),d=new Uint8Array(h.buffer),s=function(e,t){return(t=t||0)<0||t+8>e.length?0:(d[0]=e[t+0],d[1]=e[t+1],d[2]=e[t+2],d[3]=e[t+3],d[4]=e[t+4],d[5]=e[t+5],d[6]=e[t+6],d[7]=e[t+7],h[0])},a=function(e,t){return(t=t||0)<0||t+8>e.length?0:(d[7]=e[t+0],d[6]=e[t+1],d[5]=e[t+2],d[4]=e[t+3],d[3]=e[t+4],d[2]=e[t+5],d[1]=e[t+6],d[0]=e[t+7],h[0])},o=function(e,t,n){n=n||0,h[0]=t,e[n+0]=d[0],e[n+1]=d[1],e[n+2]=d[2],e[n+3]=d[3],e[n+4]=d[4],e[n+5]=d[5],e[n+6]=d[6],e[n+7]=d[7]},c=function(e,t,n){n=n||0,h[0]=t,e[n+0]=d[7],e[n+1]=d[6],e[n+2]=d[5],e[n+3]=d[4],e[n+4]=d[3],e[n+5]=d[2],e[n+6]=d[1],e[n+7]=d[0]});for(var g=new Array,y=0;y<1200;y++)g[y]=Math.pow(2,y);var v=new Array;for(y=0;y<1200;y++)v[y]=Math.pow(2,-y);function w(e){return e>=0?g[e]:v[-e]}function b(e,t,n){var r,i,s=f(e,t,n),o=f(e,t+4,n);"bige"===n?(r=s,i=o):(r=o,i=s);var a=4294967296*(1048575&r)+i,c=(2146435072&r)>>>20;return(r>>31||1)*(0===c?a?a*w(-1074):0:c<2047?a>=0?(1+2220446049250313e-31*a)*w(c-1023):0:a?NaN:1/0)}w(-1023);var k=Math.pow(2,-23),E=Math.pow(2,-127);function T(e,t,n){var r=f(e,t,n),i=8388607&r,s=(2139095040&r)>>>23;return(r>>31||1)*(0===s?i?i*k*2*E:0:s<255?(1+i*k)*w(s-127):i?NaN:1/0)}var S={exp:0,mant:0};function I(e){var t=0;return e>=2?(e*=w(-(t=x(1,e))))>=2&&(e/=2,t+=1):e<1&&((t=x(e,2))<=1023?e*=w(t):(e*=w(t-100),e*=w(100)),t=-t),S.exp=t,S.mant=e,S}var C=Math.pow(2,192);function x(e,t){for(var n=0;e*C<t;)e*=C,n+=192;for(;0x10000000000000000*e<t;)e*=0x10000000000000000,n+=64;for(;65536*e<t;)e*=65536,n+=16;for(;64*e<t;)e*=64,n+=6;for(;2*e<t;)e*=2,n+=1;return n}function A(e,t){return(e*=t)-Math.floor(e)!=.5||1&e?e+.5:e}function N(e,t,n,r){var i,s=0;t<0&&(s=2147483648,t=-t),t&&t<1/0?((i=I(t)).exp+=127,i.exp<=0?i.exp<=-25?(i.mant=0,i.exp=0):(i.mant=A(i.mant,w(22+i.exp)),i.exp=0,i.mant>=8388608&&(i.mant-=8388608,i.exp+=1)):(i.mant=A(i.mant-1,8388608),i.mant>=8388608&&(i.mant-=8388608,i.exp+=1),i.exp>254&&(i.mant=0,i.exp=255)),_(e,s|i.exp<<23|i.mant,n,r)):_(e,0===t?1/t<0?2147483648:0:t===1/0?2139095040|s:2143289344,n,r)}new Uint8Array(8);var P=Math.pow(2,52);function O(e,t,n,r){var i,s,o,a=0;t<0&&(a=2147483648,t=-t),t&&t<1/0?((i=I(t)).exp+=1023,i.exp<=0?(i.mant*=w(51+i.exp),i.exp=0):i.mant=(i.mant-1)*P,m(e,s=a|i.exp<<20|i.mant/4294967296,o=i.mant>>>0,n,r)):(0===t?(s=1/t<0?2147483648:0,o=0):t===1/0?(s=a+2146435072,o=0):(s=2146959360,o=0),m(e,s,o,n,r))}(function l(){var u=e.exports||this;u.readWord=f,u.writeWord=_,u.writeDoubleWord=m,u.readFloat=T,u.writeFloat=N,u.readDouble=b,u.writeDouble=O,u._useFloatArray=function(e){u._usingFloatArray=e,e?("full"==e&&(u.readFloatLE=p?r:t),u.writeFloatLE=p?i:n,"full"==e&&(u.readFloatBE=p?t:r),u.writeFloatBE=p?n:i,u.readDoubleLE=p?a:s,u.writeDoubleLE=p?c:o,u.readDoubleBE=p?s:a,u.writeDoubleBE=p?o:c):(u._usingFloatArray="",u.readFloatLE=function(e,t){return u.readFloat(e,t||0,"le")},u.writeFloatLE=function(e,t,n){u.writeFloat(e,t,n||0,"le")},u.readFloatBE=function(e,t){return u.readFloat(e,t||0,"bige")},u.writeFloatBE=function(e,t,n){u.writeFloat(e,t,n||0,"bige")},u.readDoubleLE=function(e,t){return u.readDouble(e,t||0,"le")},u.writeDoubleLE=function(e,t,n){u.writeDouble(e,t,n||0,"le")},u.readDoubleBE=function(e,t){return u.readDouble(e,t||0,"bige")},u.writeDoubleBE=function(e,t,n){u.writeDouble(e,t,n||0,"bige")})},u._getBigeCpu=function(){return p},u._setBigeCpu=function(e){p=e},u._useFloatArray(!1),u._useFloatArray(t&&s&&"fastest"),l.prototype=u}).call(this)},4574:(e,t,n)=>{var r;e=n.nmd(e);var i=function(e){"use strict";var t=1e7,n=9007199254740992,r=d(n),s="0123456789abcdefghijklmnopqrstuvwxyz",o="function"==typeof BigInt;function a(e,t,n,r){return void 0===e?a[0]:void 0===t||10==+t&&!n?J(e):V(e,t,n,r)}function c(e,t){this.value=e,this.sign=t,this.isSmall=!1}function l(e){this.value=e,this.sign=e<0,this.isSmall=!0}function u(e){this.value=e}function h(e){return-n<e&&e<n}function d(e){return e<1e7?[e]:e<1e14?[e%1e7,Math.floor(e/1e7)]:[e%1e7,Math.floor(e/1e7)%1e7,Math.floor(e/1e14)]}function p(e){f(e);var n=e.length;if(n<4&&N(e,r)<0)switch(n){case 0:return 0;case 1:return e[0];case 2:return e[0]+e[1]*t;default:return e[0]+(e[1]+e[2]*t)*t}return e}function f(e){for(var t=e.length;0===e[--t];);e.length=t+1}function _(e){for(var t=new Array(e),n=-1;++n<e;)t[n]=0;return t}function m(e){return e>0?Math.floor(e):Math.ceil(e)}function g(e,n){var r,i,s=e.length,o=n.length,a=new Array(s),c=0,l=t;for(i=0;i<o;i++)c=(r=e[i]+n[i]+c)>=l?1:0,a[i]=r-c*l;for(;i<s;)c=(r=e[i]+c)===l?1:0,a[i++]=r-c*l;return c>0&&a.push(c),a}function y(e,t){return e.length>=t.length?g(e,t):g(t,e)}function v(e,n){var r,i,s=e.length,o=new Array(s),a=t;for(i=0;i<s;i++)r=e[i]-a+n,n=Math.floor(r/a),o[i]=r-n*a,n+=1;for(;n>0;)o[i++]=n%a,n=Math.floor(n/a);return o}function w(e,n){var r,i,s=e.length,o=n.length,a=new Array(s),c=0,l=t;for(r=0;r<o;r++)(i=e[r]-c-n[r])<0?(i+=l,c=1):c=0,a[r]=i;for(r=o;r<s;r++){if(!((i=e[r]-c)<0)){a[r++]=i;break}i+=l,a[r]=i}for(;r<s;r++)a[r]=e[r];return f(a),a}function b(e,n,r){var i,s,o=e.length,a=new Array(o),u=-n,h=t;for(i=0;i<o;i++)s=e[i]+u,u=Math.floor(s/h),s%=h,a[i]=s<0?s+h:s;return"number"==typeof(a=p(a))?(r&&(a=-a),new l(a)):new c(a,r)}function k(e,n){var r,i,s,o,a=e.length,c=n.length,l=_(a+c),u=t;for(s=0;s<a;++s){o=e[s];for(var h=0;h<c;++h)r=o*n[h]+l[s+h],i=Math.floor(r/u),l[s+h]=r-i*u,l[s+h+1]+=i}return f(l),l}function E(e,n){var r,i,s=e.length,o=new Array(s),a=t,c=0;for(i=0;i<s;i++)r=e[i]*n+c,c=Math.floor(r/a),o[i]=r-c*a;for(;c>0;)o[i++]=c%a,c=Math.floor(c/a);return o}function T(e,t){for(var n=[];t-- >0;)n.push(0);return n.concat(e)}function S(e,t){var n=Math.max(e.length,t.length);if(n<=30)return k(e,t);n=Math.ceil(n/2);var r=e.slice(n),i=e.slice(0,n),s=t.slice(n),o=t.slice(0,n),a=S(i,o),c=S(r,s),l=S(y(i,r),y(o,s)),u=y(y(a,T(w(w(l,a),c),n)),T(c,2*n));return f(u),u}function I(e,n,r){return new c(e<t?E(n,e):k(n,d(e)),r)}function C(e){var n,r,i,s,o=e.length,a=_(o+o),c=t;for(i=0;i<o;i++){r=0-(s=e[i])*s;for(var l=i;l<o;l++)n=s*e[l]*2+a[i+l]+r,r=Math.floor(n/c),a[i+l]=n-r*c;a[i+o]=r}return f(a),a}function x(e,t){var n,r,i,s,o=e.length,a=_(o);for(i=0,n=o-1;n>=0;--n)i=(s=1e7*i+e[n])-(r=m(s/t))*t,a[n]=0|r;return[a,0|i]}function A(e,n){var r,i=J(n);if(o)return[new u(e.value/i.value),new u(e.value%i.value)];var s,h=e.value,g=i.value;if(0===g)throw new Error("Cannot divide by zero");if(e.isSmall)return i.isSmall?[new l(m(h/g)),new l(h%g)]:[a[0],e];if(i.isSmall){if(1===g)return[e,a[0]];if(-1==g)return[e.negate(),a[0]];var y=Math.abs(g);if(y<t){s=p((r=x(h,y))[0]);var v=r[1];return e.sign&&(v=-v),"number"==typeof s?(e.sign!==i.sign&&(s=-s),[new l(s),new l(v)]):[new c(s,e.sign!==i.sign),new l(v)]}g=d(y)}var b=N(h,g);if(-1===b)return[a[0],e];if(0===b)return[a[e.sign===i.sign?1:-1],a[0]];r=h.length+g.length<=200?function(e,n){var r,i,s,o,a,c,l,u=e.length,h=n.length,d=t,f=_(n.length),m=n[h-1],g=Math.ceil(d/(2*m)),y=E(e,g),v=E(n,g);for(y.length<=u&&y.push(0),v.push(0),m=v[h-1],i=u-h;i>=0;i--){for(r=d-1,y[i+h]!==m&&(r=Math.floor((y[i+h]*d+y[i+h-1])/m)),s=0,o=0,c=v.length,a=0;a<c;a++)s+=r*v[a],l=Math.floor(s/d),o+=y[i+a]-(s-l*d),s=l,o<0?(y[i+a]=o+d,o=-1):(y[i+a]=o,o=0);for(;0!==o;){for(r-=1,s=0,a=0;a<c;a++)(s+=y[i+a]-d+v[a])<0?(y[i+a]=s+d,s=0):(y[i+a]=s,s=1);o+=s}f[i]=r}return y=x(y,g)[0],[p(f),p(y)]}(h,g):function(e,n){for(var r,i,s,o,a,c=e.length,l=n.length,u=[],h=[],d=t;c;)if(h.unshift(e[--c]),f(h),N(h,n)<0)u.push(0);else{s=h[(i=h.length)-1]*d+h[i-2],o=n[l-1]*d+n[l-2],i>l&&(s=(s+1)*d),r=Math.ceil(s/o);do{if(N(a=E(n,r),h)<=0)break;r--}while(r);u.push(r),h=w(h,a)}return u.reverse(),[p(u),p(h)]}(h,g),s=r[0];var k=e.sign!==i.sign,T=r[1],S=e.sign;return"number"==typeof s?(k&&(s=-s),s=new l(s)):s=new c(s,k),"number"==typeof T?(S&&(T=-T),T=new l(T)):T=new c(T,S),[s,T]}function N(e,t){if(e.length!==t.length)return e.length>t.length?1:-1;for(var n=e.length-1;n>=0;n--)if(e[n]!==t[n])return e[n]>t[n]?1:-1;return 0}function P(e){var t=e.abs();return!t.isUnit()&&(!!(t.equals(2)||t.equals(3)||t.equals(5))||!(t.isEven()||t.isDivisibleBy(3)||t.isDivisibleBy(5))&&(!!t.lesser(49)||void 0))}function O(e,t){for(var n,r,s,o=e.prev(),a=o,c=0;a.isEven();)a=a.divide(2),c++;e:for(r=0;r<t.length;r++)if(!e.lesser(t[r])&&!(s=i(t[r]).modPow(a,e)).isUnit()&&!s.equals(o)){for(n=c-1;0!=n;n--){if((s=s.square().mod(e)).isUnit())return!1;if(s.equals(o))continue e}return!1}return!0}c.prototype=Object.create(a.prototype),l.prototype=Object.create(a.prototype),u.prototype=Object.create(a.prototype),c.prototype.add=function(e){var t=J(e);if(this.sign!==t.sign)return this.subtract(t.negate());var n=this.value,r=t.value;return t.isSmall?new c(v(n,Math.abs(r)),this.sign):new c(y(n,r),this.sign)},c.prototype.plus=c.prototype.add,l.prototype.add=function(e){var t=J(e),n=this.value;if(n<0!==t.sign)return this.subtract(t.negate());var r=t.value;if(t.isSmall){if(h(n+r))return new l(n+r);r=d(Math.abs(r))}return new c(v(r,Math.abs(n)),n<0)},l.prototype.plus=l.prototype.add,u.prototype.add=function(e){return new u(this.value+J(e).value)},u.prototype.plus=u.prototype.add,c.prototype.subtract=function(e){var t=J(e);if(this.sign!==t.sign)return this.add(t.negate());var n=this.value,r=t.value;return t.isSmall?b(n,Math.abs(r),this.sign):function(e,t,n){var r;return N(e,t)>=0?r=w(e,t):(r=w(t,e),n=!n),"number"==typeof(r=p(r))?(n&&(r=-r),new l(r)):new c(r,n)}(n,r,this.sign)},c.prototype.minus=c.prototype.subtract,l.prototype.subtract=function(e){var t=J(e),n=this.value;if(n<0!==t.sign)return this.add(t.negate());var r=t.value;return t.isSmall?new l(n-r):b(r,Math.abs(n),n>=0)},l.prototype.minus=l.prototype.subtract,u.prototype.subtract=function(e){return new u(this.value-J(e).value)},u.prototype.minus=u.prototype.subtract,c.prototype.negate=function(){return new c(this.value,!this.sign)},l.prototype.negate=function(){var e=this.sign,t=new l(-this.value);return t.sign=!e,t},u.prototype.negate=function(){return new u(-this.value)},c.prototype.abs=function(){return new c(this.value,!1)},l.prototype.abs=function(){return new l(Math.abs(this.value))},u.prototype.abs=function(){return new u(this.value>=0?this.value:-this.value)},c.prototype.multiply=function(e){var n,r,i,s=J(e),o=this.value,l=s.value,u=this.sign!==s.sign;if(s.isSmall){if(0===l)return a[0];if(1===l)return this;if(-1===l)return this.negate();if((n=Math.abs(l))<t)return new c(E(o,n),u);l=d(n)}return new c(-.012*(r=o.length)-.012*(i=l.length)+15e-6*r*i>0?S(o,l):k(o,l),u)},c.prototype.times=c.prototype.multiply,l.prototype._multiplyBySmall=function(e){return h(e.value*this.value)?new l(e.value*this.value):I(Math.abs(e.value),d(Math.abs(this.value)),this.sign!==e.sign)},c.prototype._multiplyBySmall=function(e){return 0===e.value?a[0]:1===e.value?this:-1===e.value?this.negate():I(Math.abs(e.value),this.value,this.sign!==e.sign)},l.prototype.multiply=function(e){return J(e)._multiplyBySmall(this)},l.prototype.times=l.prototype.multiply,u.prototype.multiply=function(e){return new u(this.value*J(e).value)},u.prototype.times=u.prototype.multiply,c.prototype.square=function(){return new c(C(this.value),!1)},l.prototype.square=function(){var e=this.value*this.value;return h(e)?new l(e):new c(C(d(Math.abs(this.value))),!1)},u.prototype.square=function(e){return new u(this.value*this.value)},c.prototype.divmod=function(e){var t=A(this,e);return{quotient:t[0],remainder:t[1]}},u.prototype.divmod=l.prototype.divmod=c.prototype.divmod,c.prototype.divide=function(e){return A(this,e)[0]},u.prototype.over=u.prototype.divide=function(e){return new u(this.value/J(e).value)},l.prototype.over=l.prototype.divide=c.prototype.over=c.prototype.divide,c.prototype.mod=function(e){return A(this,e)[1]},u.prototype.mod=u.prototype.remainder=function(e){return new u(this.value%J(e).value)},l.prototype.remainder=l.prototype.mod=c.prototype.remainder=c.prototype.mod,c.prototype.pow=function(e){var t,n,r,i=J(e),s=this.value,o=i.value;if(0===o)return a[1];if(0===s)return a[0];if(1===s)return a[1];if(-1===s)return i.isEven()?a[1]:a[-1];if(i.sign)return a[0];if(!i.isSmall)throw new Error("The exponent "+i.toString()+" is too large.");if(this.isSmall&&h(t=Math.pow(s,o)))return new l(m(t));for(n=this,r=a[1];!0&o&&(r=r.times(n),--o),0!==o;)o/=2,n=n.square();return r},l.prototype.pow=c.prototype.pow,u.prototype.pow=function(e){var t=J(e),n=this.value,r=t.value,i=BigInt(0),s=BigInt(1),o=BigInt(2);if(r===i)return a[1];if(n===i)return a[0];if(n===s)return a[1];if(n===BigInt(-1))return t.isEven()?a[1]:a[-1];if(t.isNegative())return new u(i);for(var c=this,l=a[1];(r&s)===s&&(l=l.times(c),--r),r!==i;)r/=o,c=c.square();return l},c.prototype.modPow=function(e,t){if(e=J(e),(t=J(t)).isZero())throw new Error("Cannot take modPow with modulus 0");var n=a[1],r=this.mod(t);for(e.isNegative()&&(e=e.multiply(a[-1]),r=r.modInv(t));e.isPositive();){if(r.isZero())return a[0];e.isOdd()&&(n=n.multiply(r).mod(t)),e=e.divide(2),r=r.square().mod(t)}return n},u.prototype.modPow=l.prototype.modPow=c.prototype.modPow,c.prototype.compareAbs=function(e){var t=J(e),n=this.value,r=t.value;return t.isSmall?1:N(n,r)},l.prototype.compareAbs=function(e){var t=J(e),n=Math.abs(this.value),r=t.value;return t.isSmall?n===(r=Math.abs(r))?0:n>r?1:-1:-1},u.prototype.compareAbs=function(e){var t=this.value,n=J(e).value;return(t=t>=0?t:-t)===(n=n>=0?n:-n)?0:t>n?1:-1},c.prototype.compare=function(e){if(e===1/0)return-1;if(e===-1/0)return 1;var t=J(e),n=this.value,r=t.value;return this.sign!==t.sign?t.sign?1:-1:t.isSmall?this.sign?-1:1:N(n,r)*(this.sign?-1:1)},c.prototype.compareTo=c.prototype.compare,l.prototype.compare=function(e){if(e===1/0)return-1;if(e===-1/0)return 1;var t=J(e),n=this.value,r=t.value;return t.isSmall?n==r?0:n>r?1:-1:n<0!==t.sign?n<0?-1:1:n<0?1:-1},l.prototype.compareTo=l.prototype.compare,u.prototype.compare=function(e){if(e===1/0)return-1;if(e===-1/0)return 1;var t=this.value,n=J(e).value;return t===n?0:t>n?1:-1},u.prototype.compareTo=u.prototype.compare,c.prototype.equals=function(e){return 0===this.compare(e)},u.prototype.eq=u.prototype.equals=l.prototype.eq=l.prototype.equals=c.prototype.eq=c.prototype.equals,c.prototype.notEquals=function(e){return 0!==this.compare(e)},u.prototype.neq=u.prototype.notEquals=l.prototype.neq=l.prototype.notEquals=c.prototype.neq=c.prototype.notEquals,c.prototype.greater=function(e){return this.compare(e)>0},u.prototype.gt=u.prototype.greater=l.prototype.gt=l.prototype.greater=c.prototype.gt=c.prototype.greater,c.prototype.lesser=function(e){return this.compare(e)<0},u.prototype.lt=u.prototype.lesser=l.prototype.lt=l.prototype.lesser=c.prototype.lt=c.prototype.lesser,c.prototype.greaterOrEquals=function(e){return this.compare(e)>=0},u.prototype.geq=u.prototype.greaterOrEquals=l.prototype.geq=l.prototype.greaterOrEquals=c.prototype.geq=c.prototype.greaterOrEquals,c.prototype.lesserOrEquals=function(e){return this.compare(e)<=0},u.prototype.leq=u.prototype.lesserOrEquals=l.prototype.leq=l.prototype.lesserOrEquals=c.prototype.leq=c.prototype.lesserOrEquals,c.prototype.isEven=function(){return 0==(1&this.value[0])},l.prototype.isEven=function(){return 0==(1&this.value)},u.prototype.isEven=function(){return(this.value&BigInt(1))===BigInt(0)},c.prototype.isOdd=function(){return 1==(1&this.value[0])},l.prototype.isOdd=function(){return 1==(1&this.value)},u.prototype.isOdd=function(){return(this.value&BigInt(1))===BigInt(1)},c.prototype.isPositive=function(){return!this.sign},l.prototype.isPositive=function(){return this.value>0},u.prototype.isPositive=l.prototype.isPositive,c.prototype.isNegative=function(){return this.sign},l.prototype.isNegative=function(){return this.value<0},u.prototype.isNegative=l.prototype.isNegative,c.prototype.isUnit=function(){return!1},l.prototype.isUnit=function(){return 1===Math.abs(this.value)},u.prototype.isUnit=function(){return this.abs().value===BigInt(1)},c.prototype.isZero=function(){return!1},l.prototype.isZero=function(){return 0===this.value},u.prototype.isZero=function(){return this.value===BigInt(0)},c.prototype.isDivisibleBy=function(e){var t=J(e);return!t.isZero()&&(!!t.isUnit()||(0===t.compareAbs(2)?this.isEven():this.mod(t).isZero()))},u.prototype.isDivisibleBy=l.prototype.isDivisibleBy=c.prototype.isDivisibleBy,c.prototype.isPrime=function(t){var n=P(this);if(n!==e)return n;var r=this.abs(),s=r.bitLength();if(s<=64)return O(r,[2,3,5,7,11,13,17,19,23,29,31,37]);for(var o=Math.log(2)*s.toJSNumber(),a=Math.ceil(!0===t?2*Math.pow(o,2):o),c=[],l=0;l<a;l++)c.push(i(l+2));return O(r,c)},u.prototype.isPrime=l.prototype.isPrime=c.prototype.isPrime,c.prototype.isProbablePrime=function(t,n){var r=P(this);if(r!==e)return r;for(var s=this.abs(),o=t===e?5:t,a=[],c=0;c<o;c++)a.push(i.randBetween(2,s.minus(2),n));return O(s,a)},u.prototype.isProbablePrime=l.prototype.isProbablePrime=c.prototype.isProbablePrime,c.prototype.modInv=function(e){for(var t,n,r,s=i.zero,o=i.one,a=J(e),c=this.abs();!c.isZero();)t=a.divide(c),n=s,r=a,s=o,a=c,o=n.subtract(t.multiply(o)),c=r.subtract(t.multiply(c));if(!a.isUnit())throw new Error(this.toString()+" and "+e.toString()+" are not co-prime");return-1===s.compare(0)&&(s=s.add(e)),this.isNegative()?s.negate():s},u.prototype.modInv=l.prototype.modInv=c.prototype.modInv,c.prototype.next=function(){var e=this.value;return this.sign?b(e,1,this.sign):new c(v(e,1),this.sign)},l.prototype.next=function(){var e=this.value;return e+1<n?new l(e+1):new c(r,!1)},u.prototype.next=function(){return new u(this.value+BigInt(1))},c.prototype.prev=function(){var e=this.value;return this.sign?new c(v(e,1),!0):b(e,1,this.sign)},l.prototype.prev=function(){var e=this.value;return e-1>-n?new l(e-1):new c(r,!0)},u.prototype.prev=function(){return new u(this.value-BigInt(1))};for(var R=[1];2*R[R.length-1]<=t;)R.push(2*R[R.length-1]);var D=R.length,z=R[D-1];function M(e){return Math.abs(e)<=t}function L(e,t,n){t=J(t);for(var r=e.isNegative(),s=t.isNegative(),o=r?e.not():e,a=s?t.not():t,c=0,l=0,u=null,h=null,d=[];!o.isZero()||!a.isZero();)c=(u=A(o,z))[1].toJSNumber(),r&&(c=z-1-c),l=(h=A(a,z))[1].toJSNumber(),s&&(l=z-1-l),o=u[0],a=h[0],d.push(n(c,l));for(var p=0!==n(r?1:0,s?1:0)?i(-1):i(0),f=d.length-1;f>=0;f-=1)p=p.multiply(z).add(i(d[f]));return p}c.prototype.shiftLeft=function(e){var t=J(e).toJSNumber();if(!M(t))throw new Error(String(t)+" is too large for shifting.");if(t<0)return this.shiftRight(-t);var n=this;if(n.isZero())return n;for(;t>=D;)n=n.multiply(z),t-=D-1;return n.multiply(R[t])},u.prototype.shiftLeft=l.prototype.shiftLeft=c.prototype.shiftLeft,c.prototype.shiftRight=function(e){var t,n=J(e).toJSNumber();if(!M(n))throw new Error(String(n)+" is too large for shifting.");if(n<0)return this.shiftLeft(-n);for(var r=this;n>=D;){if(r.isZero()||r.isNegative()&&r.isUnit())return r;r=(t=A(r,z))[1].isNegative()?t[0].prev():t[0],n-=D-1}return(t=A(r,R[n]))[1].isNegative()?t[0].prev():t[0]},u.prototype.shiftRight=l.prototype.shiftRight=c.prototype.shiftRight,c.prototype.not=function(){return this.negate().prev()},u.prototype.not=l.prototype.not=c.prototype.not,c.prototype.and=function(e){return L(this,e,(function(e,t){return e&t}))},u.prototype.and=l.prototype.and=c.prototype.and,c.prototype.or=function(e){return L(this,e,(function(e,t){return e|t}))},u.prototype.or=l.prototype.or=c.prototype.or,c.prototype.xor=function(e){return L(this,e,(function(e,t){return e^t}))},u.prototype.xor=l.prototype.xor=c.prototype.xor;var U=1<<30;function F(e){var n=e.value,r="number"==typeof n?n|U:"bigint"==typeof n?n|BigInt(U):n[0]+n[1]*t|1073758208;return r&-r}function j(e,t){if(t.compareTo(e)<=0){var n=j(e,t.square(t)),r=n.p,s=n.e,o=r.multiply(t);return o.compareTo(e)<=0?{p:o,e:2*s+1}:{p:r,e:2*s}}return{p:i(1),e:0}}function q(e,t){return e=J(e),t=J(t),e.greater(t)?e:t}function B(e,t){return e=J(e),t=J(t),e.lesser(t)?e:t}function W(e,t){if(e=J(e).abs(),t=J(t).abs(),e.equals(t))return e;if(e.isZero())return t;if(t.isZero())return e;for(var n,r,i=a[1];e.isEven()&&t.isEven();)n=B(F(e),F(t)),e=e.divide(n),t=t.divide(n),i=i.multiply(n);for(;e.isEven();)e=e.divide(F(e));do{for(;t.isEven();)t=t.divide(F(t));e.greater(t)&&(r=t,t=e,e=r),t=t.subtract(e)}while(!t.isZero());return i.isUnit()?e:e.multiply(i)}c.prototype.bitLength=function(){var e=this;return e.compareTo(i(0))<0&&(e=e.negate().subtract(i(1))),0===e.compareTo(i(0))?i(0):i(j(e,i(2)).e).add(i(1))},u.prototype.bitLength=l.prototype.bitLength=c.prototype.bitLength;var V=function(e,t,n,r){n=n||s,e=String(e),r||(e=e.toLowerCase(),n=n.toLowerCase());var i,o=e.length,a=Math.abs(t),c={};for(i=0;i<n.length;i++)c[n[i]]=i;for(i=0;i<o;i++)if("-"!==(h=e[i])&&h in c&&c[h]>=a){if("1"===h&&1===a)continue;throw new Error(h+" is not a valid digit in base "+t+".")}t=J(t);var l=[],u="-"===e[0];for(i=u?1:0;i<e.length;i++){var h;if((h=e[i])in c)l.push(J(c[h]));else{if("<"!==h)throw new Error(h+" is not a valid character");var d=i;do{i++}while(">"!==e[i]&&i<e.length);l.push(J(e.slice(d+1,i)))}}return H(l,t,u)};function H(e,t,n){var r,i=a[0],s=a[1];for(r=e.length-1;r>=0;r--)i=i.add(e[r].times(s)),s=s.times(t);return n?i.negate():i}function K(e,t){if((t=i(t)).isZero()){if(e.isZero())return{value:[0],isNegative:!1};throw new Error("Cannot convert nonzero numbers to base 0.")}if(t.equals(-1)){if(e.isZero())return{value:[0],isNegative:!1};if(e.isNegative())return{value:[].concat.apply([],Array.apply(null,Array(-e.toJSNumber())).map(Array.prototype.valueOf,[1,0])),isNegative:!1};var n=Array.apply(null,Array(e.toJSNumber()-1)).map(Array.prototype.valueOf,[0,1]);return n.unshift([1]),{value:[].concat.apply([],n),isNegative:!1}}var r=!1;if(e.isNegative()&&t.isPositive()&&(r=!0,e=e.abs()),t.isUnit())return e.isZero()?{value:[0],isNegative:!1}:{value:Array.apply(null,Array(e.toJSNumber())).map(Number.prototype.valueOf,1),isNegative:r};for(var s,o=[],a=e;a.isNegative()||a.compareAbs(t)>=0;){s=a.divmod(t),a=s.quotient;var c=s.remainder;c.isNegative()&&(c=t.minus(c).abs(),a=a.next()),o.push(c.toJSNumber())}return o.push(a.toJSNumber()),{value:o.reverse(),isNegative:r}}function $(e,t,n){var r=K(e,t);return(r.isNegative?"-":"")+r.value.map((function(e){return function(e,t){return e<(t=t||s).length?t[e]:"<"+e+">"}(e,n)})).join("")}function G(e){if(h(+e)){var t=+e;if(t===m(t))return o?new u(BigInt(t)):new l(t);throw new Error("Invalid integer: "+e)}var n="-"===e[0];n&&(e=e.slice(1));var r=e.split(/e/i);if(r.length>2)throw new Error("Invalid integer: "+r.join("e"));if(2===r.length){var i=r[1];if("+"===i[0]&&(i=i.slice(1)),(i=+i)!==m(i)||!h(i))throw new Error("Invalid integer: "+i+" is not a valid exponent.");var s=r[0],a=s.indexOf(".");if(a>=0&&(i-=s.length-a-1,s=s.slice(0,a)+s.slice(a+1)),i<0)throw new Error("Cannot include negative exponent part for integers");e=s+=new Array(i+1).join("0")}if(!/^([0-9][0-9]*)$/.test(e))throw new Error("Invalid integer: "+e);if(o)return new u(BigInt(n?"-"+e:e));for(var d=[],p=e.length,_=p-7;p>0;)d.push(+e.slice(_,p)),(_-=7)<0&&(_=0),p-=7;return f(d),new c(d,n)}function J(e){return"number"==typeof e?function(e){if(o)return new u(BigInt(e));if(h(e)){if(e!==m(e))throw new Error(e+" is not an integer.");return new l(e)}return G(e.toString())}(e):"string"==typeof e?G(e):"bigint"==typeof e?new u(e):e}c.prototype.toArray=function(e){return K(this,e)},l.prototype.toArray=function(e){return K(this,e)},u.prototype.toArray=function(e){return K(this,e)},c.prototype.toString=function(t,n){if(t===e&&(t=10),10!==t)return $(this,t,n);for(var r,i=this.value,s=i.length,o=String(i[--s]);--s>=0;)r=String(i[s]),o+="0000000".slice(r.length)+r;return(this.sign?"-":"")+o},l.prototype.toString=function(t,n){return t===e&&(t=10),10!=t?$(this,t,n):String(this.value)},u.prototype.toString=l.prototype.toString,u.prototype.toJSON=c.prototype.toJSON=l.prototype.toJSON=function(){return this.toString()},c.prototype.valueOf=function(){return parseInt(this.toString(),10)},c.prototype.toJSNumber=c.prototype.valueOf,l.prototype.valueOf=function(){return this.value},l.prototype.toJSNumber=l.prototype.valueOf,u.prototype.valueOf=u.prototype.toJSNumber=function(){return parseInt(this.toString(),10)};for(var Z=0;Z<1e3;Z++)a[Z]=J(Z),Z>0&&(a[-Z]=J(-Z));return a.one=a[1],a.zero=a[0],a.minusOne=a[-1],a.max=q,a.min=B,a.gcd=W,a.lcm=function(e,t){return e=J(e).abs(),t=J(t).abs(),e.divide(W(e,t)).multiply(t)},a.isInstance=function(e){return e instanceof c||e instanceof l||e instanceof u},a.randBetween=function(e,n,r){e=J(e),n=J(n);var i=r||Math.random,s=B(e,n),o=q(e,n).subtract(s).add(1);if(o.isSmall)return s.add(Math.floor(i()*o));for(var c=K(o,t).value,l=[],u=!0,h=0;h<c.length;h++){var d=u?c[h]+(h+1<c.length?c[h+1]/t:0):t,p=m(i()*d);l.push(p),p<c[h]&&(u=!1)}return s.add(a.fromArray(l,t,!1))},a.fromArray=function(e,t,n){return H(e.map(J),J(t||10),n)},a}();e.hasOwnProperty("exports")&&(e.exports=i),void 0===(r=function(){return i}.call(t,n,t,e))||(e.exports=r)},5461:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},3915:function(e,t,n){"use strict";var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},r.apply(this,arguments)},i=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))},s=this&&this.__generator||function(e,t){var n,r,i,s,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(i=2&s[0]?r.return:s[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,s[1])).done)return i;switch(r=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,r=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!((i=(i=o.trys).length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){o=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){o.label=s[1];break}if(6===s[0]&&o.label<i[1]){o.label=i[1],i=s;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(s);break}i[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(e){s=[6,e],r=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}},o=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,s=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=s.next()).done;)o.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=s.return)&&n.call(s)}finally{if(i)throw i.error}}return o},a=this&&this.__spreadArray||function(e,t){for(var n=0,r=t.length,i=e.length;n<r;n++,i++)e[i]=t[n];return e},c=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0}),t.ActionBuilder=t.TransactionBuilder=t.Api=void 0;var l=n(8442),u=n(2753),h=function(){function e(e){this.contracts=new Map,this.cachedAbis=new Map,this.transactionExtensions=[{id:1,type:"resource_payer",keys:["payer","max_net_bytes","max_cpu_us","max_memory_bytes"]}],this.rpc=e.rpc,this.authorityProvider=e.authorityProvider||e.rpc,this.abiProvider=e.abiProvider||e.rpc,this.signatureProvider=e.signatureProvider,this.chainId=e.chainId,this.textEncoder=e.textEncoder,this.textDecoder=e.textDecoder,this.abiTypes=u.getTypesFromAbi(u.createAbiTypes()),this.transactionTypes=u.getTypesFromAbi(u.createTransactionTypes())}return e.prototype.rawAbiToJson=function(e){var t=new u.SerialBuffer({textEncoder:this.textEncoder,textDecoder:this.textDecoder,array:e});if(!u.supportedAbiVersion(t.getString()))throw new Error("Unsupported abi version");return t.restartRead(),this.abiTypes.get("abi_def").deserialize(t)},e.prototype.jsonToRawAbi=function(e){var t=new u.SerialBuffer({textEncoder:this.textEncoder,textDecoder:this.textDecoder});if(this.abiTypes.get("abi_def").serialize(t,e),!u.supportedAbiVersion(t.getString()))throw new Error("Unsupported abi version");return t.asUint8Array()},e.prototype.getCachedAbi=function(e,t){return void 0===t&&(t=!1),i(this,void 0,void 0,(function(){var n,r,i,o;return s(this,(function(s){switch(s.label){case 0:if(!t&&this.cachedAbis.get(e))return[2,this.cachedAbis.get(e)];s.label=1;case 1:return s.trys.push([1,3,,4]),[4,this.abiProvider.getRawAbi(e)];case 2:return r=s.sent().abi,i=this.rawAbiToJson(r),n={rawAbi:r,abi:i},[3,4];case 3:throw(o=s.sent()).message="fetching abi for "+e+": "+o.message,o;case 4:if(!n)throw new Error("Missing abi for "+e);return this.cachedAbis.set(e,n),[2,n]}}))}))},e.prototype.getAbi=function(e,t){return void 0===t&&(t=!1),i(this,void 0,void 0,(function(){return s(this,(function(n){switch(n.label){case 0:return[4,this.getCachedAbi(e,t)];case 1:return[2,n.sent().abi]}}))}))},e.prototype.getTransactionAbis=function(e,t){return void 0===t&&(t=!1),i(this,void 0,void 0,(function(){var n,r,c,l,u=this;return s(this,(function(h){return n=(e.context_free_actions||[]).concat(e.actions),r=n.map((function(e){return e.account})),c=new Set(r),l=a([],o(c)).map((function(e){return i(u,void 0,void 0,(function(){var n;return s(this,(function(r){switch(r.label){case 0:return n={accountName:e},[4,this.getCachedAbi(e,t)];case 1:return[2,(n.abi=r.sent().rawAbi,n)]}}))}))})),[2,Promise.all(l)]}))}))},e.prototype.getContract=function(e,t){return void 0===t&&(t=!1),i(this,void 0,void 0,(function(){var n,r,i,o,a,l,h,d,p,f,_;return s(this,(function(s){switch(s.label){case 0:return!t&&this.contracts.get(e)?[2,this.contracts.get(e)]:[4,this.getAbi(e,t)];case 1:n=s.sent(),r=u.getTypesFromAbi(u.createInitialTypes(),n),i=new Map;try{for(o=c(n.actions),a=o.next();!a.done;a=o.next())l=a.value,h=l.name,d=l.type,i.set(h,u.getType(r,d))}catch(e){f={error:e}}finally{try{a&&!a.done&&(_=o.return)&&_.call(o)}finally{if(f)throw f.error}}return p={types:r,actions:i},this.contracts.set(e,p),[2,p]}}))}))},e.prototype.serialize=function(e,t,n){this.transactionTypes.get(t).serialize(e,n)},e.prototype.deserialize=function(e,t){return this.transactionTypes.get(t).deserialize(e)},e.prototype.serializeTransaction=function(e){var t=new u.SerialBuffer({textEncoder:this.textEncoder,textDecoder:this.textDecoder});return this.serialize(t,"transaction",r({max_net_usage_words:0,max_cpu_usage_ms:0,delay_sec:0,context_free_actions:[],actions:[],transaction_extensions:[]},e)),t.asUint8Array()},e.prototype.serializeContextFreeData=function(e){var t,n;if(!e||!e.length)return null;var r=new u.SerialBuffer({textEncoder:this.textEncoder,textDecoder:this.textDecoder});r.pushVaruint32(e.length);try{for(var i=c(e),s=i.next();!s.done;s=i.next()){var o=s.value;r.pushBytes(o)}}catch(e){t={error:e}}finally{try{s&&!s.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}return r.asUint8Array()},e.prototype.deserializeTransaction=function(e){var t=new u.SerialBuffer({textEncoder:this.textEncoder,textDecoder:this.textDecoder});return t.pushArray(e),this.deserialize(t,"transaction")},e.prototype.serializeTransactionExtensions=function(e){var t=[];if(e.resource_payer){var n=new u.SerialBuffer({textEncoder:this.textEncoder,textDecoder:this.textDecoder});u.getTypesFromAbi(u.createTransactionExtensionTypes()).get("resource_payer").serialize(n,e.resource_payer),t=a(a([],o(t)),[[1,u.arrayToHex(n.asUint8Array())]])}return t},e.prototype.deserializeTransactionExtensions=function(e){var t=this,n={};return e.forEach((function(e){var r=t.transactionExtensions.find((function(t){return t.id===e[0]}));if(void 0===r)throw new Error("Transaction Extension could not be determined: "+e);var i=u.getTypesFromAbi(u.createTransactionExtensionTypes()),s=new u.SerialBuffer({textEncoder:t.textEncoder,textDecoder:t.textDecoder});s.pushArray(u.hexToUint8Array(e[1]));var o=i.get(r.type).deserialize(s);1===e[0]&&(o.max_net_bytes=Number(o.max_net_bytes),o.max_cpu_us=Number(o.max_cpu_us),o.max_memory_bytes=Number(o.max_memory_bytes),n.resource_payer=o)})),n},e.prototype.deleteTransactionExtensionObjects=function(e){return delete e.resource_payer,e},e.prototype.serializeActions=function(e){return i(this,void 0,void 0,(function(){var t=this;return s(this,(function(n){switch(n.label){case 0:return[4,Promise.all(e.map((function(e){return i(t,void 0,void 0,(function(){var t,n,r,i,o;return s(this,(function(s){switch(s.label){case 0:return t=e.account,n=e.name,r=e.authorization,i=e.data,[4,this.getContract(t)];case 1:return o=s.sent(),"object"!=typeof i?[2,e]:[2,u.serializeAction(o,t,n,r,i,this.textEncoder,this.textDecoder)]}}))}))})))];case 1:return[2,n.sent()]}}))}))},e.prototype.deserializeActions=function(e){return i(this,void 0,void 0,(function(){var t=this;return s(this,(function(n){switch(n.label){case 0:return[4,Promise.all(e.map((function(e){var n=e.account,r=e.name,o=e.authorization,a=e.data;return i(t,void 0,void 0,(function(){var e;return s(this,(function(t){switch(t.label){case 0:return[4,this.getContract(n)];case 1:return e=t.sent(),[2,u.deserializeAction(e,n,r,o,a,this.textEncoder,this.textDecoder)]}}))}))})))];case 1:return[2,n.sent()]}}))}))},e.prototype.deserializeTransactionWithActions=function(e){return i(this,void 0,void 0,(function(){var t,n,i;return s(this,(function(s){switch(s.label){case 0:return"string"==typeof e&&(e=u.hexToUint8Array(e)),t=this.deserializeTransaction(e),[4,this.deserializeActions(t.context_free_actions)];case 1:return n=s.sent(),[4,this.deserializeActions(t.actions)];case 2:return i=s.sent(),[2,r(r({},t),{context_free_actions:n,actions:i})]}}))}))},e.prototype.deflateSerializedArray=function(e){return l.deflate(e,{level:9})},e.prototype.inflateSerializedArray=function(e){return l.inflate(e)},e.prototype.transact=function(e,t){var n=void 0===t?{}:t,o=n.broadcast,a=void 0===o||o,c=n.sign,l=void 0===c||c,u=n.readOnlyTrx,h=n.returnFailureTraces,d=n.requiredKeys,p=n.compression,f=n.blocksBehind,_=n.useLastIrreversible,m=n.expireSeconds;return i(this,void 0,void 0,(function(){var t,n,i,o,c,g,y,v;return s(this,(function(s){switch(s.label){case 0:if("number"==typeof f&&_)throw new Error("Use either blocksBehind or useLastIrreversible");return this.chainId?[3,2]:[4,this.rpc.get_info()];case 1:t=s.sent(),this.chainId=t.chain_id,s.label=2;case 2:return"number"!=typeof f&&!_||!m?[3,4]:[4,this.generateTapos(t,e,f,_,m)];case 3:e=s.sent(),s.label=4;case 4:if(!this.hasRequiredTaposFields(e))throw new Error("Required configuration or TAPOS fields are not present");return[4,this.getTransactionAbis(e)];case 5:return n=s.sent(),i=[r({},e)],v={},[4,this.serializeTransactionExtensions(e)];case 6:return v.transaction_extensions=s.sent(),[4,this.serializeActions(e.context_free_actions||[])];case 7:return v.context_free_actions=s.sent(),[4,this.serializeActions(e.actions)];case 8:return e=r.apply(void 0,i.concat([(v.actions=s.sent(),v)])),e=this.deleteTransactionExtensionObjects(e),o=this.serializeTransaction(e),c=this.serializeContextFreeData(e.context_free_data),g={serializedTransaction:o,serializedContextFreeData:c,signatures:[]},l?d?[3,11]:[4,this.signatureProvider.getAvailableKeys()]:[3,13];case 9:return y=s.sent(),[4,this.authorityProvider.getRequiredKeys({transaction:e,availableKeys:y})];case 10:d=s.sent(),s.label=11;case 11:return[4,this.signatureProvider.sign({chainId:this.chainId,requiredKeys:d,serializedTransaction:o,serializedContextFreeData:c,abis:n})];case 12:g=s.sent(),s.label=13;case 13:return a?p?[2,this.pushCompressedSignedTransaction(g,u,h)]:[2,this.pushSignedTransaction(g,u,h)]:[2,g]}}))}))},e.prototype.query=function(e,t,n,o){var a=o.sign,c=o.requiredKeys,l=o.authorization,h=void 0===l?[]:l;return i(this,void 0,void 0,(function(){var i,o,l,d,p,f,_,m,g,y,v;return s(this,(function(s){switch(s.label){case 0:return[4,this.rpc.get_info()];case 1:return i=s.sent(),[4,this.tryRefBlockFromGetInfo(i)];case 2:return o=s.sent(),l=new u.SerialBuffer({textEncoder:this.textEncoder,textDecoder:this.textDecoder}),u.serializeQuery(l,n),d=r(r({},u.transactionHeader(o,1800)),{context_free_actions:[],actions:[{account:e,name:"queryit",authorization:h,data:u.arrayToHex(l.asUint8Array())}]}),p=this.serializeTransaction(d),f=[],a?[4,this.getTransactionAbis(d)]:[3,8];case 3:return _=s.sent(),c?[3,6]:[4,this.signatureProvider.getAvailableKeys()];case 4:return m=s.sent(),[4,this.authorityProvider.getRequiredKeys({transaction:d,availableKeys:m})];case 5:c=s.sent(),s.label=6;case 6:return[4,this.signatureProvider.sign({chainId:this.chainId,requiredKeys:c,serializedTransaction:p,serializedContextFreeData:null,abis:_})];case 7:g=s.sent(),f=g.signatures,s.label=8;case 8:return[4,this.rpc.send_transaction({signatures:f,compression:0,serializedTransaction:p})];case 9:return y=s.sent(),v=new u.SerialBuffer({textEncoder:this.textEncoder,textDecoder:this.textDecoder,array:u.hexToUint8Array(y.processed.action_traces[0][1].return_value)}),t?[2,u.deserializeAnyvarShort(v)]:[2,u.deserializeAnyvar(v)]}}))}))},e.prototype.pushSignedTransaction=function(e,t,n){var r=e.signatures,o=e.serializedTransaction,a=e.serializedContextFreeData;return void 0===t&&(t=!1),void 0===n&&(n=!1),i(this,void 0,void 0,(function(){return s(this,(function(e){return t?[2,this.rpc.push_ro_transaction({signatures:r,serializedTransaction:o,serializedContextFreeData:a},n)]:[2,this.rpc.push_transaction({signatures:r,serializedTransaction:o,serializedContextFreeData:a})]}))}))},e.prototype.pushCompressedSignedTransaction=function(e,t,n){var r=e.signatures,o=e.serializedTransaction,a=e.serializedContextFreeData;return void 0===t&&(t=!1),void 0===n&&(n=!1),i(this,void 0,void 0,(function(){var e,i;return s(this,(function(s){return e=this.deflateSerializedArray(o),i=this.deflateSerializedArray(a||new Uint8Array(0)),t?[2,this.rpc.push_ro_transaction({signatures:r,compression:1,serializedTransaction:e,serializedContextFreeData:i},n)]:[2,this.rpc.push_transaction({signatures:r,compression:1,serializedTransaction:e,serializedContextFreeData:i})]}))}))},e.prototype.generateTapos=function(e,t,n,o,a){return i(this,void 0,void 0,(function(){var i,c,l,h;return s(this,(function(s){switch(s.label){case 0:return e?[3,2]:[4,this.rpc.get_info()];case 1:e=s.sent(),s.label=2;case 2:return o?[4,this.tryRefBlockFromGetInfo(e)]:[3,4];case 3:return i=s.sent(),[2,r(r({},u.transactionHeader(i,a)),t)];case 4:return(c=e.head_block_num-n)<=e.last_irreversible_block_num?[4,this.tryGetBlockInfo(c)]:[3,6];case 5:return h=s.sent(),[3,8];case 6:return[4,this.tryGetBlockHeaderState(c)];case 7:h=s.sent(),s.label=8;case 8:return l=h,[2,r(r({},u.transactionHeader(l,a)),t)]}}))}))},e.prototype.hasRequiredTaposFields=function(e){var t=e.expiration,n=e.ref_block_num,r=e.ref_block_prefix;return!(!t||"number"!=typeof n||"number"!=typeof r)},e.prototype.tryGetBlockHeaderState=function(e){return i(this,void 0,void 0,(function(){return s(this,(function(t){switch(t.label){case 0:return t.trys.push([0,2,,4]),[4,this.rpc.get_block_header_state(e)];case 1:case 3:return[2,t.sent()];case 2:return t.sent(),[4,this.tryGetBlockInfo(e)];case 4:return[2]}}))}))},e.prototype.tryGetBlockInfo=function(e){return i(this,void 0,void 0,(function(){return s(this,(function(t){switch(t.label){case 0:return t.trys.push([0,2,,4]),[4,this.rpc.get_block_info(e)];case 1:case 3:return[2,t.sent()];case 2:return t.sent(),[4,this.rpc.get_block(e)];case 4:return[2]}}))}))},e.prototype.tryRefBlockFromGetInfo=function(e){return i(this,void 0,void 0,(function(){var t;return s(this,(function(n){switch(n.label){case 0:return e.hasOwnProperty("last_irreversible_block_id")&&e.hasOwnProperty("last_irreversible_block_num")&&e.hasOwnProperty("last_irreversible_block_time")?[2,{block_num:e.last_irreversible_block_num,id:e.last_irreversible_block_id,timestamp:e.last_irreversible_block_time}]:[3,1];case 1:return[4,this.tryGetBlockInfo(e.last_irreversible_block_num)];case 2:return[2,{block_num:(t=n.sent()).block_num,id:t.id,timestamp:t.timestamp}]}}))}))},e.prototype.with=function(e){return new p(this,e)},e.prototype.buildTransaction=function(e){var t=new d(this);return e?e(t):t},e}();t.Api=h;var d=function(){function e(e){this.actions=[],this.contextFreeGroups=[],this.api=e}return e.prototype.with=function(e){var t=new p(this.api,e);return this.actions.push(t),t},e.prototype.associateContextFree=function(e){return this.contextFreeGroups.push(e),this},e.prototype.send=function(e){return i(this,void 0,void 0,(function(){var t,n,r,o=this;return s(this,(function(a){switch(a.label){case 0:return t=[],n=[],r=this.actions.map((function(e){return e.serializedData})),[4,Promise.all(this.contextFreeGroups.map((function(e){return i(o,void 0,void 0,(function(){var i,o,a,c;return s(this,(function(s){return i=e({cfd:t.length,cfa:n.length}),o=i.action,a=i.contextFreeAction,c=i.contextFreeData,o&&r.push(o),a&&n.push(a),c&&t.push(c),[2]}))}))})))];case 1:return a.sent(),this.contextFreeGroups=[],this.actions=[],[4,this.api.transact({context_free_data:t,context_free_actions:n,actions:r},e)];case 2:return[2,a.sent()]}}))}))},e}();t.TransactionBuilder=d;var p=function(){function e(e,t){this.api=e,this.accountName=t}return e.prototype.as=function(e){void 0===e&&(e=[]);var t;return t=e&&"string"==typeof e?[{actor:e,permission:"active"}]:e,new f(this,this.api,this.accountName,t)},e}();t.ActionBuilder=p;var f=function(e,t,n,r){var i,s,o=this,a=t.cachedAbis.get(n);if(!a)throw new Error("ABI must be cached before using ActionBuilder, run api.getAbi()");var l=u.getTypesFromAbi(u.createInitialTypes(),a.abi),h=new Map;try{for(var d=c(a.abi.actions),p=d.next();!p.done;p=d.next()){var f=p.value,_=f.name,m=f.type;h.set(_,u.getType(l,m))}}catch(e){i={error:e}}finally{try{p&&!p.done&&(s=d.return)&&s.call(d)}finally{if(i)throw i.error}}h.forEach((function(i,s){var a;Object.assign(o,((a={})[s]=function(){for(var o=[],a=0;a<arguments.length;a++)o[a]=arguments[a];var c={};o.forEach((function(e,t){var n=i.fields[t];c[n.name]=e}));var d=u.serializeAction({types:l,actions:h},n,s,r,c,t.textEncoder,t.textDecoder);return e.serializedData=d,d},a))}))}},6208:function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var n,r,i,s,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(i=2&s[0]?r.return:s[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,s[1])).done)return i;switch(r=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,r=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!((i=(i=o.trys).length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){o=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){o.label=s[1];break}if(6===s[0]&&o.label<i[1]){o.label=i[1],i=s;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(s);break}i[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(e){s=[6,e],r=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}},s=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0}),t.JsonRpc=void 0;var o=n(1823),a=n(3937),c=function(e){var t,n,r="";try{for(var i=s(e),o=i.next();!o.done;o=i.next())r+=("00"+o.value.toString(16)).slice(-2)}catch(e){t={error:e}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}return r},l=function(){function e(e,t){void 0===t&&(t={}),this.endpoint=e.replace(/\/$/,""),t.fetch?this.fetchBuiltin=t.fetch:this.fetchBuiltin=n.g.fetch}return e.prototype.fetch=function(e,t){return r(this,void 0,void 0,(function(){var n,r,s;return i(this,(function(i){switch(i.label){case 0:return i.trys.push([0,3,,4]),[4,(0,this.fetchBuiltin)(this.endpoint+e,{body:JSON.stringify(t),method:"POST"})];case 1:return[4,(n=i.sent()).json()];case 2:if((r=i.sent()).processed&&r.processed.except)throw new a.RpcError(r);if(r.result&&r.result.except)throw new a.RpcError(r);return[3,4];case 3:throw(s=i.sent()).isFetchError=!0,s;case 4:if(!n.ok)throw new a.RpcError(r);return[2,r]}}))}))},e.prototype.abi_bin_to_json=function(e,t,n){return r(this,void 0,void 0,(function(){return i(this,(function(r){switch(r.label){case 0:return[4,this.fetch("/v1/chain/abi_bin_to_json",{code:e,action:t,binargs:n})];case 1:return[2,r.sent()]}}))}))},e.prototype.abi_json_to_bin=function(e,t,n){return r(this,void 0,void 0,(function(){return i(this,(function(r){switch(r.label){case 0:return[4,this.fetch("/v1/chain/abi_json_to_bin",{code:e,action:t,args:n})];case 1:return[2,r.sent()]}}))}))},e.prototype.get_abi=function(e){return r(this,void 0,void 0,(function(){return i(this,(function(t){switch(t.label){case 0:return[4,this.fetch("/v1/chain/get_abi",{account_name:e})];case 1:return[2,t.sent()]}}))}))},e.prototype.get_account=function(e){return r(this,void 0,void 0,(function(){return i(this,(function(t){switch(t.label){case 0:return[4,this.fetch("/v1/chain/get_account",{account_name:e})];case 1:return[2,t.sent()]}}))}))},e.prototype.get_accounts_by_authorizers=function(e,t){return r(this,void 0,void 0,(function(){return i(this,(function(n){switch(n.label){case 0:return[4,this.fetch("/v1/chain/get_accounts_by_authorizers",{accounts:e,keys:t})];case 1:return[2,n.sent()]}}))}))},e.prototype.get_activated_protocol_features=function(e){var t=e.limit,n=void 0===t?10:t,s=e.search_by_block_num,o=void 0!==s&&s,a=e.reverse,c=void 0!==a&&a,l=e.lower_bound,u=void 0===l?null:l,h=e.upper_bound,d=void 0===h?null:h;return r(this,void 0,void 0,(function(){return i(this,(function(e){switch(e.label){case 0:return[4,this.fetch("/v1/chain/get_activated_protocol_features",{lower_bound:u,upper_bound:d,limit:n,search_by_block_num:o,reverse:c})];case 1:return[2,e.sent()]}}))}))},e.prototype.get_block_header_state=function(e){return r(this,void 0,void 0,(function(){return i(this,(function(t){switch(t.label){case 0:return[4,this.fetch("/v1/chain/get_block_header_state",{block_num_or_id:e})];case 1:return[2,t.sent()]}}))}))},e.prototype.get_block_info=function(e){return r(this,void 0,void 0,(function(){return i(this,(function(t){switch(t.label){case 0:return[4,this.fetch("/v1/chain/get_block_info",{block_num:e})];case 1:return[2,t.sent()]}}))}))},e.prototype.get_block=function(e){return r(this,void 0,void 0,(function(){return i(this,(function(t){switch(t.label){case 0:return[4,this.fetch("/v1/chain/get_block",{block_num_or_id:e})];case 1:return[2,t.sent()]}}))}))},e.prototype.get_code=function(e){return r(this,void 0,void 0,(function(){return i(this,(function(t){switch(t.label){case 0:return[4,this.fetch("/v1/chain/get_code",{account_name:e,code_as_wasm:!0})];case 1:return[2,t.sent()]}}))}))},e.prototype.get_code_hash=function(e){return r(this,void 0,void 0,(function(){return i(this,(function(t){switch(t.label){case 0:return[4,this.fetch("/v1/chain/get_code_hash",{account_name:e})];case 1:return[2,t.sent()]}}))}))},e.prototype.get_currency_balance=function(e,t,n){return void 0===n&&(n=null),r(this,void 0,void 0,(function(){return i(this,(function(r){switch(r.label){case 0:return[4,this.fetch("/v1/chain/get_currency_balance",{code:e,account:t,symbol:n})];case 1:return[2,r.sent()]}}))}))},e.prototype.get_currency_stats=function(e,t){return r(this,void 0,void 0,(function(){return i(this,(function(n){switch(n.label){case 0:return[4,this.fetch("/v1/chain/get_currency_stats",{code:e,symbol:t})];case 1:return[2,n.sent()]}}))}))},e.prototype.get_info=function(){return r(this,void 0,void 0,(function(){return i(this,(function(e){switch(e.label){case 0:return[4,this.fetch("/v1/chain/get_info",{})];case 1:return[2,e.sent()]}}))}))},e.prototype.get_producer_schedule=function(){return r(this,void 0,void 0,(function(){return i(this,(function(e){switch(e.label){case 0:return[4,this.fetch("/v1/chain/get_producer_schedule",{})];case 1:return[2,e.sent()]}}))}))},e.prototype.get_producers=function(e,t,n){return void 0===e&&(e=!0),void 0===t&&(t=""),void 0===n&&(n=50),r(this,void 0,void 0,(function(){return i(this,(function(r){switch(r.label){case 0:return[4,this.fetch("/v1/chain/get_producers",{json:e,lower_bound:t,limit:n})];case 1:return[2,r.sent()]}}))}))},e.prototype.get_raw_code_and_abi=function(e){return r(this,void 0,void 0,(function(){return i(this,(function(t){switch(t.label){case 0:return[4,this.fetch("/v1/chain/get_raw_code_and_abi",{account_name:e})];case 1:return[2,t.sent()]}}))}))},e.prototype.getRawAbi=function(e){return r(this,void 0,void 0,(function(){var t,n;return i(this,(function(r){switch(r.label){case 0:return[4,this.get_raw_abi(e)];case 1:return t=r.sent(),n=o.base64ToBinary(t.abi),[2,{accountName:t.account_name,abi:n}]}}))}))},e.prototype.get_raw_abi=function(e){return r(this,void 0,void 0,(function(){return i(this,(function(t){switch(t.label){case 0:return[4,this.fetch("/v1/chain/get_raw_abi",{account_name:e})];case 1:return[2,t.sent()]}}))}))},e.prototype.get_scheduled_transactions=function(e,t,n){return void 0===e&&(e=!0),void 0===t&&(t=""),void 0===n&&(n=50),r(this,void 0,void 0,(function(){return i(this,(function(r){switch(r.label){case 0:return[4,this.fetch("/v1/chain/get_scheduled_transactions",{json:e,lower_bound:t,limit:n})];case 1:return[2,r.sent()]}}))}))},e.prototype.get_table_rows=function(e){var t=e.json,n=void 0===t||t,s=e.code,o=e.scope,a=e.table,c=e.lower_bound,l=void 0===c?"":c,u=e.upper_bound,h=void 0===u?"":u,d=e.index_position,p=void 0===d?1:d,f=e.key_type,_=void 0===f?"":f,m=e.limit,g=void 0===m?10:m,y=e.reverse,v=void 0!==y&&y,w=e.show_payer,b=void 0!==w&&w;return r(this,void 0,void 0,(function(){return i(this,(function(e){switch(e.label){case 0:return[4,this.fetch("/v1/chain/get_table_rows",{json:n,code:s,scope:o,table:a,lower_bound:l,upper_bound:h,index_position:p,key_type:_,limit:g,reverse:v,show_payer:b})];case 1:return[2,e.sent()]}}))}))},e.prototype.get_kv_table_rows=function(e){var t=e.json,n=void 0===t||t,s=e.code,o=e.table,a=e.index_name,c=e.encode_type,l=void 0===c?"bytes":c,u=e.index_value,h=e.lower_bound,d=e.upper_bound,p=e.limit,f=void 0===p?10:p,_=e.reverse,m=void 0!==_&&_,g=e.show_payer,y=void 0!==g&&g;return r(this,void 0,void 0,(function(){return i(this,(function(e){switch(e.label){case 0:return[4,this.fetch("/v1/chain/get_kv_table_rows",{json:n,code:s,table:o,index_name:a,encode_type:l,index_value:u,lower_bound:h,upper_bound:d,limit:f,reverse:m,show_payer:y})];case 1:return[2,e.sent()]}}))}))},e.prototype.get_table_by_scope=function(e){var t=e.code,n=e.table,s=e.lower_bound,o=void 0===s?"":s,a=e.upper_bound,c=void 0===a?"":a,l=e.limit,u=void 0===l?10:l;return r(this,void 0,void 0,(function(){return i(this,(function(e){switch(e.label){case 0:return[4,this.fetch("/v1/chain/get_table_by_scope",{code:t,table:n,lower_bound:o,upper_bound:c,limit:u})];case 1:return[2,e.sent()]}}))}))},e.prototype.getRequiredKeys=function(e){return r(this,void 0,void 0,(function(){var t;return i(this,(function(n){switch(n.label){case 0:return t=o.convertLegacyPublicKeys,[4,this.fetch("/v1/chain/get_required_keys",{transaction:e.transaction,available_keys:e.availableKeys})];case 1:return[2,t.apply(void 0,[n.sent().required_keys])]}}))}))},e.prototype.push_transaction=function(e){var t=e.signatures,n=e.compression,s=void 0===n?0:n,o=e.serializedTransaction,a=e.serializedContextFreeData;return r(this,void 0,void 0,(function(){return i(this,(function(e){switch(e.label){case 0:return[4,this.fetch("/v1/chain/push_transaction",{signatures:t,compression:s,packed_context_free_data:c(a||new Uint8Array(0)),packed_trx:c(o)})];case 1:return[2,e.sent()]}}))}))},e.prototype.push_ro_transaction=function(e,t){var n=e.signatures,s=e.compression,o=void 0===s?0:s,a=e.serializedTransaction;return void 0===t&&(t=!1),r(this,void 0,void 0,(function(){return i(this,(function(e){switch(e.label){case 0:return[4,this.fetch("/v1/chain/push_ro_transaction",{transaction:{signatures:n,compression:o,packed_context_free_data:c(new Uint8Array(0)),packed_trx:c(a)},return_failure_traces:t})];case 1:return[2,e.sent()]}}))}))},e.prototype.push_transactions=function(e){return r(this,void 0,void 0,(function(){var t;return i(this,(function(n){switch(n.label){case 0:return t=e.map((function(e){var t=e.signatures,n=e.compression,r=void 0===n?0:n,i=e.serializedTransaction,s=e.serializedContextFreeData;return{signatures:t,compression:r,packed_context_free_data:c(s||new Uint8Array(0)),packed_trx:c(i)}})),[4,this.fetch("/v1/chain/push_transactions",t)];case 1:return[2,n.sent()]}}))}))},e.prototype.send_transaction=function(e){var t=e.signatures,n=e.compression,s=void 0===n?0:n,o=e.serializedTransaction,a=e.serializedContextFreeData;return r(this,void 0,void 0,(function(){return i(this,(function(e){switch(e.label){case 0:return[4,this.fetch("/v1/chain/send_transaction",{signatures:t,compression:s,packed_context_free_data:c(a||new Uint8Array(0)),packed_trx:c(o)})];case 1:return[2,e.sent()]}}))}))},e.prototype.db_size_get=function(){return r(this,void 0,void 0,(function(){return i(this,(function(e){switch(e.label){case 0:return[4,this.fetch("/v1/db_size/get",{})];case 1:return[2,e.sent()]}}))}))},e.prototype.trace_get_block=function(e){return r(this,void 0,void 0,(function(){return i(this,(function(t){switch(t.label){case 0:return[4,this.fetch("/v1/trace_api/get_block",{block_num:e})];case 1:return[2,t.sent()]}}))}))},e.prototype.history_get_actions=function(e,t,n){return void 0===t&&(t=null),void 0===n&&(n=null),r(this,void 0,void 0,(function(){return i(this,(function(r){switch(r.label){case 0:return[4,this.fetch("/v1/history/get_actions",{account_name:e,pos:t,offset:n})];case 1:return[2,r.sent()]}}))}))},e.prototype.history_get_transaction=function(e,t){return void 0===t&&(t=null),r(this,void 0,void 0,(function(){return i(this,(function(n){switch(n.label){case 0:return[4,this.fetch("/v1/history/get_transaction",{id:e,block_num_hint:t})];case 1:return[2,n.sent()]}}))}))},e.prototype.history_get_key_accounts=function(e){return r(this,void 0,void 0,(function(){return i(this,(function(t){switch(t.label){case 0:return[4,this.fetch("/v1/history/get_key_accounts",{public_key:e})];case 1:return[2,t.sent()]}}))}))},e.prototype.history_get_controlled_accounts=function(e){return r(this,void 0,void 0,(function(){return i(this,(function(t){switch(t.label){case 0:return[4,this.fetch("/v1/history/get_controlled_accounts",{controlling_account:e})];case 1:return[2,t.sent()]}}))}))},e}();t.JsonRpc=l},1823:function(e,t,n){"use strict";var r=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,s=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=s.next()).done;)o.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=s.return)&&n.call(s)}finally{if(i)throw i.error}}return o},i=this&&this.__spreadArray||function(e,t){for(var n=0,r=t.length,i=e.length;n<r;n++,i++)e[i]=t[n];return e},s=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0}),t.signatureToString=t.stringToSignature=t.privateKeyToString=t.privateKeyToLegacyString=t.stringToPrivateKey=t.convertLegacyPublicKeys=t.convertLegacyPublicKey=t.publicKeyToString=t.publicKeyToLegacyString=t.stringToPublicKey=t.signatureDataSize=t.privateKeyDataSize=t.publicKeyDataSize=t.KeyType=t.base64ToBinary=t.binaryToBase58=t.base58ToBinary=t.signedBinaryToDecimal=t.binaryToDecimal=t.signedDecimalToBinary=t.decimalToBinary=t.negate=t.isNegative=void 0;var o,a=n(6204),c=n(1963).RIPEMD160.hash,l="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz",u="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",h=function(){for(var e=Array(256).fill(-1),t=0;t<l.length;++t)e[l.charCodeAt(t)]=t;return e}(),d=function(){for(var e=Array(256).fill(-1),t=0;t<u.length;++t)e[u.charCodeAt(t)]=t;return e["=".charCodeAt(0)]=0,e}();t.isNegative=function(e){return 0!=(128&e[e.length-1])},t.negate=function(e){for(var t=1,n=0;n<e.length;++n){var r=(255&~e[n])+t;e[n]=r,t=r>>8}},t.decimalToBinary=function(e,t){for(var n=new Uint8Array(e),r=0;r<t.length;++r){var i=t.charCodeAt(r);if(i<"0".charCodeAt(0)||i>"9".charCodeAt(0))throw new Error("invalid number");for(var s=i-"0".charCodeAt(0),o=0;o<e;++o){var a=10*n[o]+s;n[o]=a,s=a>>8}if(s)throw new Error("number is out of range")}return n},t.signedDecimalToBinary=function(e,n){var r="-"===n[0];r&&(n=n.substr(1));var i=t.decimalToBinary(e,n);if(r){if(t.negate(i),!t.isNegative(i))throw new Error("number is out of range")}else if(t.isNegative(i))throw new Error("number is out of range");return i},t.binaryToDecimal=function(e,t){void 0===t&&(t=1);for(var n=Array(t).fill("0".charCodeAt(0)),s=e.length-1;s>=0;--s){for(var o=e[s],a=0;a<n.length;++a){var c=(n[a]-"0".charCodeAt(0)<<8)+o;n[a]="0".charCodeAt(0)+c%10,o=c/10|0}for(;o;)n.push("0".charCodeAt(0)+o%10),o=o/10|0}return n.reverse(),String.fromCharCode.apply(String,i([],r(n)))},t.signedBinaryToDecimal=function(e,n){if(void 0===n&&(n=1),t.isNegative(e)){var r=e.slice();return t.negate(r),"-"+t.binaryToDecimal(r,n)}return t.binaryToDecimal(e,n)},t.base58ToBinary=function(e,t){if(!e)return function(e){for(var t,n,r=[],i=0;i<e.length;++i){var o=h[e.charCodeAt(i)];if(o<0)throw new Error("invalid base-58 value");for(var a=0;a<r.length;++a){var c=58*r[a]+o;r[a]=255&c,o=c>>8}o&&r.push(o)}try{for(var l=s(e),u=l.next();!u.done&&"1"===u.value;u=l.next())r.push(0)}catch(e){t={error:e}}finally{try{u&&!u.done&&(n=l.return)&&n.call(l)}finally{if(t)throw t.error}}return r.reverse(),new Uint8Array(r)}(t);for(var n=new Uint8Array(e),r=0;r<t.length;++r){var i=h[t.charCodeAt(r)];if(i<0)throw new Error("invalid base-58 value");for(var o=0;o<e;++o){var a=58*n[o]+i;n[o]=a,i=a>>8}if(i)throw new Error("base-58 value is out of range")}return n.reverse(),n},t.binaryToBase58=function(e,t){var n,o,a,c;void 0===t&&(t=1);var u=[];try{for(var d=s(e),p=d.next();!p.done;p=d.next()){for(var f=p.value,_=0;_<u.length;++_){var m=(h[u[_]]<<8)+f;u[_]=l.charCodeAt(m%58),f=m/58|0}for(;f;)u.push(l.charCodeAt(f%58)),f=f/58|0}}catch(e){n={error:e}}finally{try{p&&!p.done&&(o=d.return)&&o.call(d)}finally{if(n)throw n.error}}try{for(var g=s(e),y=g.next();!y.done&&!y.value;y=g.next())u.push("1".charCodeAt(0))}catch(e){a={error:e}}finally{try{y&&!y.done&&(c=g.return)&&c.call(g)}finally{if(a)throw a.error}}return u.reverse(),String.fromCharCode.apply(String,i([],r(u)))},t.base64ToBinary=function(e){var t=e.length;if(1==(3&t)&&"="===e[t-1]&&(t-=1),0!=(3&t))throw new Error("base-64 value is not padded correctly");var n=t>>2,r=3*n;t>0&&"="===e[t-1]&&("="===e[t-2]?r-=2:r-=1);for(var i=new Uint8Array(r),s=0;s<n;++s){var o=d[e.charCodeAt(4*s+0)],a=d[e.charCodeAt(4*s+1)],c=d[e.charCodeAt(4*s+2)],l=d[e.charCodeAt(4*s+3)];i[3*s+0]=o<<2|a>>4,3*s+1<r&&(i[3*s+1]=(15&a)<<4|c>>2),3*s+2<r&&(i[3*s+2]=(3&c)<<6|l)}return i},function(e){e[e.k1=0]="k1",e[e.r1=1]="r1",e[e.wa=2]="wa"}(o=t.KeyType||(t.KeyType={})),t.publicKeyDataSize=33,t.privateKeyDataSize=32,t.signatureDataSize=65;var p=function(e,t){for(var n=new Uint8Array(e.length+t.length),r=0;r<e.length;++r)n[r]=e[r];for(r=0;r<t.length;++r)n[e.length+r]=t.charCodeAt(r);return c(n)},f=function(e,n,r,i){var s=t.base58ToBinary(r?r+4:0,e),o={type:n,data:new Uint8Array(s.buffer,0,s.length-4)},a=new Uint8Array(p(o.data,i));if(a[0]!==s[s.length-4]||a[1]!==s[s.length-3]||a[2]!==s[s.length-2]||a[3]!==s[s.length-1])throw new Error("checksum doesn't match");return o},_=function(e,n,r){for(var i=new Uint8Array(p(e.data,n)),s=new Uint8Array(e.data.length+4),o=0;o<e.data.length;++o)s[o]=e.data[o];for(o=0;o<4;++o)s[o+e.data.length]=i[o];return r+t.binaryToBase58(s)};t.stringToPublicKey=function(e){if("string"!=typeof e)throw new Error("expected string containing public key");if("EOS"===e.substr(0,3)){for(var n=t.base58ToBinary(t.publicKeyDataSize+4,e.substr(3)),r={type:o.k1,data:new Uint8Array(t.publicKeyDataSize)},i=0;i<t.publicKeyDataSize;++i)r.data[i]=n[i];var s=new Uint8Array(c(r.data));if(s[0]!==n[t.publicKeyDataSize]||s[1]!==n[34]||s[2]!==n[35]||s[3]!==n[36])throw new Error("checksum doesn't match");return r}if("PUB_K1_"===e.substr(0,7))return f(e.substr(7),o.k1,t.publicKeyDataSize,"K1");if("PUB_R1_"===e.substr(0,7))return f(e.substr(7),o.r1,t.publicKeyDataSize,"R1");if("PUB_WA_"===e.substr(0,7))return f(e.substr(7),o.wa,0,"WA");throw new Error("unrecognized public key format")},t.publicKeyToLegacyString=function(e){if(e.type===o.k1&&e.data.length===t.publicKeyDataSize)return _(e,"","EOS");throw e.type===o.r1||e.type===o.wa?new Error("Key format not supported in legacy conversion"):new Error("unrecognized public key format")},t.publicKeyToString=function(e){if(e.type===o.k1&&e.data.length===t.publicKeyDataSize)return _(e,"K1","PUB_K1_");if(e.type===o.r1&&e.data.length===t.publicKeyDataSize)return _(e,"R1","PUB_R1_");if(e.type===o.wa)return _(e,"WA","PUB_WA_");throw new Error("unrecognized public key format")},t.convertLegacyPublicKey=function(e){return"EOS"===e.substr(0,3)?t.publicKeyToString(t.stringToPublicKey(e)):e},t.convertLegacyPublicKeys=function(e){return e.map(t.convertLegacyPublicKey)},t.stringToPrivateKey=function(e){if("string"!=typeof e)throw new Error("expected string containing private key");if("PVT_R1_"===e.substr(0,7))return f(e.substr(7),o.r1,t.privateKeyDataSize,"R1");if("PVT_K1_"===e.substr(0,7))return f(e.substr(7),o.k1,t.privateKeyDataSize,"K1");var n=t.base58ToBinary(t.privateKeyDataSize+5,e),r={type:o.k1,data:new Uint8Array(t.privateKeyDataSize)};if(128!==n[0])throw new Error("unrecognized private key type");for(var i=0;i<t.privateKeyDataSize;++i)r.data[i]=n[i+1];return r},t.privateKeyToLegacyString=function(e){if(e.type===o.k1&&e.data.length===t.privateKeyDataSize){var n=[];n.push(128),e.data.forEach((function(e){return n.push(e)}));for(var r=new Uint8Array(a.sha256().update(a.sha256().update(n).digest()).digest()),i=new Uint8Array(t.privateKeyDataSize+5),s=0;s<n.length;s++)i[s]=n[s];for(s=0;s<4;s++)i[s+n.length]=r[s];return t.binaryToBase58(i)}throw e.type===o.r1||e.type===o.wa?new Error("Key format not supported in legacy conversion"):new Error("unrecognized public key format")},t.privateKeyToString=function(e){if(e.type===o.r1)return _(e,"R1","PVT_R1_");if(e.type===o.k1)return _(e,"K1","PVT_K1_");throw new Error("unrecognized private key format")},t.stringToSignature=function(e){if("string"!=typeof e)throw new Error("expected string containing signature");if("SIG_K1_"===e.substr(0,7))return f(e.substr(7),o.k1,t.signatureDataSize,"K1");if("SIG_R1_"===e.substr(0,7))return f(e.substr(7),o.r1,t.signatureDataSize,"R1");if("SIG_WA_"===e.substr(0,7))return f(e.substr(7),o.wa,0,"WA");throw new Error("unrecognized signature format")},t.signatureToString=function(e){if(e.type===o.k1)return _(e,"K1","SIG_K1_");if(e.type===o.r1)return _(e,"R1","SIG_R1_");if(e.type===o.wa)return _(e,"WA","SIG_WA_");throw new Error("unrecognized signature format")}},5576:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},3937:function(e,t){"use strict";var n,r=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},n(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0}),t.RpcError=void 0;var i=function(e){function t(n){var r=this;return n.error&&n.error.details&&n.error.details.length&&n.error.details[0].message?(r=e.call(this,n.error.details[0].message)||this).details=n.error.details:n.processed&&n.processed.except&&n.processed.except.message?(r=e.call(this,n.processed.except.message)||this).details=n.processed.except:n.result&&n.result.except&&n.result.except.message?(r=e.call(this,n.result.except.message)||this).details=n.result.except:r=e.call(this,n.message)||this,Object.setPrototypeOf(r,t.prototype),r.json=n,r}return r(t,e),t}(Error);t.RpcError=i},2753:function(e,t,n){"use strict";var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},r.apply(this,arguments)},i=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,s=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=s.next()).done;)o.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=s.return)&&n.call(s)}finally{if(i)throw i.error}}return o},s=this&&this.__spreadArray||function(e,t){for(var n=0,r=t.length,i=e.length;n<r;n++,i++)e[i]=t[n];return e},o=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0}),t.serializeQuery=t.deserializeAnyArray=t.serializeAnyArray=t.deserializeAnyObject=t.serializeAnyObject=t.deserializeAnyvarShort=t.deserializeAnyvar=t.serializeAnyvar=t.deserializeAction=t.deserializeActionData=t.serializeAction=t.serializeActionData=t.transactionHeader=t.getTypesFromAbi=t.getType=t.createTransactionTypes=t.createTransactionExtensionTypes=t.createAbiTypes=t.createInitialTypes=t.hexToUint8Array=t.arrayToHex=t.symbolToString=t.stringToSymbol=t.blockTimestampToDate=t.dateToBlockTimestamp=t.timePointSecToDate=t.dateToTimePointSec=t.timePointToDate=t.dateToTimePoint=t.supportedAbiVersion=t.SerialBuffer=t.SerializerState=void 0;var a=n(1823),c=function(e){void 0===e&&(e={}),this.skippedBinaryExtension=!1,this.options=e};t.SerializerState=c;var l=function(){function e(e){var t=void 0===e?{}:e,n=t.textEncoder,r=t.textDecoder,i=t.array;this.readPos=0,this.array=i||new Uint8Array(1024),this.length=i?i.length:0,this.textEncoder=n||new TextEncoder,this.textDecoder=r||new TextDecoder("utf-8",{fatal:!0})}return e.prototype.reserve=function(e){if(!(this.length+e<=this.array.length)){for(var t=this.array.length;this.length+e>t;)t=Math.ceil(1.5*t);var n=new Uint8Array(t);n.set(this.array),this.array=n}},e.prototype.haveReadData=function(){return this.readPos<this.length},e.prototype.restartRead=function(){this.readPos=0},e.prototype.asUint8Array=function(){return new Uint8Array(this.array.buffer,this.array.byteOffset,this.length)},e.prototype.pushArray=function(e){this.reserve(e.length),this.array.set(e,this.length),this.length+=e.length},e.prototype.push=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.pushArray(e)},e.prototype.get=function(){if(this.readPos<this.length)return this.array[this.readPos++];throw new Error("Read past end of buffer")},e.prototype.pushUint8ArrayChecked=function(e,t){if(e.length!==t)throw new Error("Binary data has incorrect size");this.pushArray(e)},e.prototype.getUint8Array=function(e){if(this.readPos+e>this.length)throw new Error("Read past end of buffer");var t=new Uint8Array(this.array.buffer,this.array.byteOffset+this.readPos,e);return this.readPos+=e,t},e.prototype.skip=function(e){if(this.readPos+e>this.length)throw new Error("Read past end of buffer");this.readPos+=e},e.prototype.pushUint16=function(e){this.push(e>>0&255,e>>8&255)},e.prototype.getUint16=function(){var e=0;return(e|=this.get()<<0)|this.get()<<8},e.prototype.pushUint32=function(e){this.push(e>>0&255,e>>8&255,e>>16&255,e>>24&255)},e.prototype.getUint32=function(){var e=0;return e|=this.get()<<0,e|=this.get()<<8,e|=this.get()<<16,(e|=this.get()<<24)>>>0},e.prototype.pushNumberAsUint64=function(e){this.pushUint32(e>>>0),this.pushUint32(Math.floor(e/4294967296)>>>0)},e.prototype.getUint64AsNumber=function(){var e=this.getUint32();return 4294967296*(this.getUint32()>>>0)+(e>>>0)},e.prototype.pushVaruint32=function(e){for(;;){if(!(e>>>7)){this.push(e);break}this.push(128|127&e),e>>>=7}},e.prototype.getVaruint32=function(){for(var e=0,t=0;;){var n=this.get();if(e|=(127&n)<<t,t+=7,!(128&n))break}return e>>>0},e.prototype.pushVarint32=function(e){this.pushVaruint32(e<<1^e>>31)},e.prototype.getVarint32=function(){var e=this.getVaruint32();return 1&e?~e>>1|2147483648:e>>>1},e.prototype.pushFloat32=function(e){this.pushArray(new Uint8Array(new Float32Array([e]).buffer))},e.prototype.getFloat32=function(){return new Float32Array(this.getUint8Array(4).slice().buffer)[0]},e.prototype.pushFloat64=function(e){this.pushArray(new Uint8Array(new Float64Array([e]).buffer))},e.prototype.getFloat64=function(){return new Float64Array(this.getUint8Array(8).slice().buffer)[0]},e.prototype.pushName=function(e){if("string"!=typeof e)throw new Error("Expected string containing name");if(!new RegExp(/^[.1-5a-z]{0,12}[.1-5a-j]?$/).test(e))throw new Error("Name should be less than 13 characters, or less than 14 if last character is between 1-5 or a-j, and only contain the following symbols .12345abcdefghijklmnopqrstuvwxyz");for(var t=function(e){return e>="a".charCodeAt(0)&&e<="z".charCodeAt(0)?e-"a".charCodeAt(0)+6:e>="1".charCodeAt(0)&&e<="5".charCodeAt(0)?e-"1".charCodeAt(0)+1:0},n=new Uint8Array(8),r=63,i=0;i<e.length;++i){var s=t(e.charCodeAt(i));r<5&&(s<<=1);for(var o=4;o>=0;--o)r>=0&&(n[Math.floor(r/8)]|=(s>>o&1)<<r%8,--r)}this.pushArray(n)},e.prototype.getName=function(){for(var e=this.getUint8Array(8),t="",n=63;n>=0;){for(var r=0,i=0;i<5;++i)n>=0&&(r=r<<1|e[Math.floor(n/8)]>>n%8&1,--n);t+=r>=6?String.fromCharCode(r+"a".charCodeAt(0)-6):r>=1?String.fromCharCode(r+"1".charCodeAt(0)-1):"."}for(;t.endsWith(".");)t=t.substr(0,t.length-1);return t},e.prototype.pushBytes=function(e){this.pushVaruint32(e.length),this.pushArray(e)},e.prototype.getBytes=function(){return this.getUint8Array(this.getVaruint32())},e.prototype.pushString=function(e){this.pushBytes(this.textEncoder.encode(e))},e.prototype.getString=function(){return this.textDecoder.decode(this.getBytes())},e.prototype.pushSymbolCode=function(e){if("string"!=typeof e)throw new Error("Expected string containing symbol_code");var t=[];for(t.push.apply(t,s([],i(this.textEncoder.encode(e))));t.length<8;)t.push(0);this.pushArray(t.slice(0,8))},e.prototype.getSymbolCode=function(){var e,t=this.getUint8Array(8);for(e=0;e<t.length&&t[e];++e);return this.textDecoder.decode(new Uint8Array(t.buffer,t.byteOffset,e))},e.prototype.pushSymbol=function(e){var t=e.name,n=e.precision;if(!/^[A-Z]{1,7}$/.test(t))throw new Error("Expected symbol to be A-Z and between one and seven characters");var r=[255&n];for(r.push.apply(r,s([],i(this.textEncoder.encode(t))));r.length<8;)r.push(0);this.pushArray(r.slice(0,8))},e.prototype.getSymbol=function(){var e,t=this.get(),n=this.getUint8Array(7);for(e=0;e<n.length&&n[e];++e);return{name:this.textDecoder.decode(new Uint8Array(n.buffer,n.byteOffset,e)),precision:t}},e.prototype.pushAsset=function(e){if("string"!=typeof e)throw new Error("Expected string containing asset");var t=0,n="",r=0;"-"===(e=e.trim())[t]&&(n+="-",++t);for(var i=!1;t<e.length&&e.charCodeAt(t)>="0".charCodeAt(0)&&e.charCodeAt(t)<="9".charCodeAt(0);)i=!0,n+=e[t],++t;if(!i)throw new Error("Asset must begin with a number");if("."===e[t])for(++t;t<e.length&&e.charCodeAt(t)>="0".charCodeAt(0)&&e.charCodeAt(t)<="9".charCodeAt(0);)n+=e[t],++r,++t;var s=e.substr(t).trim();this.pushArray(a.signedDecimalToBinary(8,n)),this.pushSymbol({name:s,precision:r})},e.prototype.getAsset=function(){var e=this.getUint8Array(8),t=this.getSymbol(),n=t.name,r=t.precision,i=a.signedBinaryToDecimal(e,r+1);return r&&(i=i.substr(0,i.length-r)+"."+i.substr(i.length-r)),i+" "+n},e.prototype.pushPublicKey=function(e){var t=a.stringToPublicKey(e);this.push(t.type),this.pushArray(t.data)},e.prototype.getPublicKey=function(){var e,t=this.get();if(t===a.KeyType.wa){var n=this.readPos;this.skip(34),this.skip(this.getVaruint32()),e=new Uint8Array(this.array.buffer,this.array.byteOffset+n,this.readPos-n)}else e=this.getUint8Array(a.publicKeyDataSize);return a.publicKeyToString({type:t,data:e})},e.prototype.pushPrivateKey=function(e){var t=a.stringToPrivateKey(e);this.push(t.type),this.pushArray(t.data)},e.prototype.getPrivateKey=function(){var e=this.get(),t=this.getUint8Array(a.privateKeyDataSize);return a.privateKeyToString({type:e,data:t})},e.prototype.pushSignature=function(e){var t=a.stringToSignature(e);this.push(t.type),this.pushArray(t.data)},e.prototype.getSignature=function(){var e,t=this.get();if(t===a.KeyType.wa){var n=this.readPos;this.skip(65),this.skip(this.getVaruint32()),this.skip(this.getVaruint32()),e=new Uint8Array(this.array.buffer,this.array.byteOffset+n,this.readPos-n)}else e=this.getUint8Array(a.signatureDataSize);return a.signatureToString({type:t,data:e})},e}();t.SerialBuffer=l,t.supportedAbiVersion=function(e){return e.startsWith("eosio::abi/1.")};var u=function(e){var t=Date.parse(e);if(Number.isNaN(t))throw new Error("Invalid time format");return t};function h(e,t){throw new Error("Don't know how to serialize "+this.name)}function d(e){throw new Error("Don't know how to deserialize "+this.name)}function p(e,t,n,r){var i,s;if(void 0===n&&(n=new c),void 0===r&&(r=!0),"object"!=typeof t)throw new Error("expected object containing data: "+JSON.stringify(t));this.base&&this.base.serialize(e,t,n,r);try{for(var a=o(this.fields),l=a.next();!l.done;l=a.next()){var u=l.value;if(u.name in t){if(n.skippedBinaryExtension)throw new Error("unexpected "+this.name+"."+u.name);u.type.serialize(e,t[u.name],n,r&&u===this.fields[this.fields.length-1])}else{if(!r||!u.type.extensionOf)throw new Error("missing "+this.name+"."+u.name+" (type="+u.type.name+")");n.skippedBinaryExtension=!0}}}catch(e){i={error:e}}finally{try{l&&!l.done&&(s=a.return)&&s.call(a)}finally{if(i)throw i.error}}}function f(e,t,n){var r,i,s;void 0===t&&(t=new c),void 0===n&&(n=!0),s=this.base?this.base.deserialize(e,t,n):{};try{for(var a=o(this.fields),l=a.next();!l.done;l=a.next()){var u=l.value;n&&u.type.extensionOf&&!e.haveReadData()?t.skippedBinaryExtension=!0:s[u.name]=u.type.deserialize(e,t,n)}}catch(e){r={error:e}}finally{try{l&&!l.done&&(i=a.return)&&i.call(a)}finally{if(r)throw r.error}}return s}function _(e,t,n,r){if(!Array.isArray(t)||2!==t.length||"string"!=typeof t[0])throw new Error('expected variant: ["type", value]');var i=this.fields.findIndex((function(e){return e.name===t[0]}));if(i<0)throw new Error('type "'+t[0]+'" is not valid for variant');e.pushVaruint32(i),this.fields[i].type.serialize(e,t[1],n,r)}function m(e,t,n){var r=e.getVaruint32();if(r>=this.fields.length)throw new Error("type index "+r+" is not valid for variant");var i=this.fields[r];return[i.name,i.type.deserialize(e,t,n)]}function g(e,t,n,r){var i,s;e.pushVaruint32(t.length);try{for(var a=o(t),c=a.next();!c.done;c=a.next()){var l=c.value;this.arrayOf.serialize(e,l,n,!1)}}catch(e){i={error:e}}finally{try{c&&!c.done&&(s=a.return)&&s.call(a)}finally{if(i)throw i.error}}}function y(e,t,n){for(var r=e.getVaruint32(),i=[],s=0;s<r;++s)i.push(this.arrayOf.deserialize(e,t,!1));return i}function v(e,t,n,r){null==t?e.push(0):(e.push(1),this.optionalOf.serialize(e,t,n,r))}function w(e,t,n){return e.get()?this.optionalOf.deserialize(e,t,n):null}function b(e,t,n,r){this.extensionOf.serialize(e,t,n,r)}function k(e,t,n){return this.extensionOf.deserialize(e,t,n)}function E(e,t,n,r){var s,a,c=Object.entries(t);e.pushVaruint32(c.length);try{for(var l=o(c),u=l.next();!u.done;u=l.next()){var h=i(u.value,2),d=h[0],p=h[1],f=this.fields[0].type,_=this.fields[1].type;f.serialize(e,d,n,r),_.serialize(e,p,n,r)}}catch(e){s={error:e}}finally{try{u&&!u.done&&(a=l.return)&&a.call(l)}finally{if(s)throw s.error}}}function T(e,t,n){for(var r=e.getVaruint32(),i={},s=0;s<r;++s){var o=this.fields[0].type,a=this.fields[1].type;i[o.deserialize(e,t,n)]=a.deserialize(e,t,n)}return i}function S(e,t,n,r){var i=this;e.pushVaruint32(t.length),t.forEach((function(t){i.fields[0].type.serialize(e,t[0],n,r),i.fields[1].type.serialize(e,t[1],n,r)}))}function I(e,t,n){for(var r=[],i=e.getVaruint32(),s=0;s<i;++s)r.push(this.fields[0].type.deserialize(e,t,n)),r.push(this.fields[1].type.deserialize(e,t,n));return r}t.dateToTimePoint=function(e){return Math.round(1e3*u(e+"Z"))},t.timePointToDate=function(e){var t=new Date(e/1e3).toISOString();return t.substr(0,t.length-1)},t.dateToTimePointSec=function(e){return Math.round(u(e+"Z")/1e3)},t.timePointSecToDate=function(e){var t=new Date(1e3*e).toISOString();return t.substr(0,t.length-1)},t.dateToBlockTimestamp=function(e){return Math.round((u(e+"Z")-9466848e5)/500)},t.blockTimestampToDate=function(e){var t=new Date(500*e+9466848e5).toISOString();return t.substr(0,t.length-1)},t.stringToSymbol=function(e){if("string"!=typeof e)throw new Error("Expected string containing symbol");var t=e.match(/^([0-9]+),([A-Z]+)$/);if(!t)throw new Error("Invalid symbol");return{name:t[2],precision:+t[1]}},t.symbolToString=function(e){var t=e.name;return e.precision+","+t},t.arrayToHex=function(e){var t,n,r="";try{for(var i=o(e),s=i.next();!s.done;s=i.next())r+=("00"+s.value.toString(16)).slice(-2)}catch(e){t={error:e}}finally{try{s&&!s.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}return r.toUpperCase()},t.hexToUint8Array=function(e){if("string"!=typeof e)throw new Error("Expected string containing hex digits");if(e.length%2)throw new Error("Odd number of hex digits");for(var t=e.length/2,n=new Uint8Array(t),r=0;r<t;++r){var i=parseInt(e.substr(2*r,2),16);if(Number.isNaN(i))throw new Error("Expected hex string");n[r]=i}return n};var C=function(e){return r({name:"<missing name>",aliasOfName:"",arrayOf:null,optionalOf:null,extensionOf:null,baseName:"",base:null,fields:[],serialize:h,deserialize:d},e)},x=function(e,t){if(Number.isNaN(+e)||Number.isNaN(+t)||"number"!=typeof e&&"string"!=typeof e)throw new Error("Expected number");if(+e!=+t)throw new Error("Number is out of range");return+e};t.createInitialTypes=function(){var e=new Map(Object.entries({bool:C({name:"bool",serialize:function(e,t){if("boolean"!=typeof t&&("number"!=typeof t||1!==t&&0!==t))throw new Error("Expected boolean or number equal to 1 or 0");e.push(t?1:0)},deserialize:function(e){return!!e.get()}}),uint8:C({name:"uint8",serialize:function(e,t){e.push(x(t,255&t))},deserialize:function(e){return e.get()}}),int8:C({name:"int8",serialize:function(e,t){e.push(x(t,t<<24>>24))},deserialize:function(e){return e.get()<<24>>24}}),uint16:C({name:"uint16",serialize:function(e,t){e.pushUint16(x(t,65535&t))},deserialize:function(e){return e.getUint16()}}),int16:C({name:"int16",serialize:function(e,t){e.pushUint16(x(t,t<<16>>16))},deserialize:function(e){return e.getUint16()<<16>>16}}),uint32:C({name:"uint32",serialize:function(e,t){e.pushUint32(x(t,t>>>0))},deserialize:function(e){return e.getUint32()}}),uint64:C({name:"uint64",serialize:function(e,t){e.pushArray(a.decimalToBinary(8,""+t))},deserialize:function(e){return a.binaryToDecimal(e.getUint8Array(8))}}),int64:C({name:"int64",serialize:function(e,t){e.pushArray(a.signedDecimalToBinary(8,""+t))},deserialize:function(e){return a.signedBinaryToDecimal(e.getUint8Array(8))}}),int32:C({name:"int32",serialize:function(e,t){e.pushUint32(x(t,0|t))},deserialize:function(e){return 0|e.getUint32()}}),varuint32:C({name:"varuint32",serialize:function(e,t){e.pushVaruint32(x(t,t>>>0))},deserialize:function(e){return e.getVaruint32()}}),varint32:C({name:"varint32",serialize:function(e,t){e.pushVarint32(x(t,0|t))},deserialize:function(e){return e.getVarint32()}}),uint128:C({name:"uint128",serialize:function(e,t){e.pushArray(a.decimalToBinary(16,""+t))},deserialize:function(e){return a.binaryToDecimal(e.getUint8Array(16))}}),int128:C({name:"int128",serialize:function(e,t){e.pushArray(a.signedDecimalToBinary(16,""+t))},deserialize:function(e){return a.signedBinaryToDecimal(e.getUint8Array(16))}}),float32:C({name:"float32",serialize:function(e,t){e.pushFloat32(t)},deserialize:function(e){return e.getFloat32()}}),float64:C({name:"float64",serialize:function(e,t){e.pushFloat64(t)},deserialize:function(e){return e.getFloat64()}}),float128:C({name:"float128",serialize:function(e,n){e.pushUint8ArrayChecked(t.hexToUint8Array(n),16)},deserialize:function(e){return t.arrayToHex(e.getUint8Array(16))}}),bytes:C({name:"bytes",serialize:function(e,n){n instanceof Uint8Array||Array.isArray(n)?e.pushBytes(n):e.pushBytes(t.hexToUint8Array(n))},deserialize:function(e,n){return n&&n.options.bytesAsUint8Array?e.getBytes():t.arrayToHex(e.getBytes())}}),string:C({name:"string",serialize:function(e,t){e.pushString(t)},deserialize:function(e){return e.getString()}}),name:C({name:"name",serialize:function(e,t){e.pushName(t)},deserialize:function(e){return e.getName()}}),time_point:C({name:"time_point",serialize:function(e,n){e.pushNumberAsUint64(t.dateToTimePoint(n))},deserialize:function(e){return t.timePointToDate(e.getUint64AsNumber())}}),time_point_sec:C({name:"time_point_sec",serialize:function(e,n){e.pushUint32(t.dateToTimePointSec(n))},deserialize:function(e){return t.timePointSecToDate(e.getUint32())}}),block_timestamp_type:C({name:"block_timestamp_type",serialize:function(e,n){e.pushUint32(t.dateToBlockTimestamp(n))},deserialize:function(e){return t.blockTimestampToDate(e.getUint32())}}),symbol_code:C({name:"symbol_code",serialize:function(e,t){e.pushSymbolCode(t)},deserialize:function(e){return e.getSymbolCode()}}),symbol:C({name:"symbol",serialize:function(e,n){e.pushSymbol(t.stringToSymbol(n))},deserialize:function(e){return t.symbolToString(e.getSymbol())}}),asset:C({name:"asset",serialize:function(e,t){e.pushAsset(t)},deserialize:function(e){return e.getAsset()}}),checksum160:C({name:"checksum160",serialize:function(e,n){e.pushUint8ArrayChecked(t.hexToUint8Array(n),20)},deserialize:function(e){return t.arrayToHex(e.getUint8Array(20))}}),checksum256:C({name:"checksum256",serialize:function(e,n){e.pushUint8ArrayChecked(t.hexToUint8Array(n),32)},deserialize:function(e){return t.arrayToHex(e.getUint8Array(32))}}),checksum512:C({name:"checksum512",serialize:function(e,n){e.pushUint8ArrayChecked(t.hexToUint8Array(n),64)},deserialize:function(e){return t.arrayToHex(e.getUint8Array(64))}}),public_key:C({name:"public_key",serialize:function(e,t){e.pushPublicKey(t)},deserialize:function(e){return e.getPublicKey()}}),private_key:C({name:"private_key",serialize:function(e,t){e.pushPrivateKey(t)},deserialize:function(e){return e.getPrivateKey()}}),signature:C({name:"signature",serialize:function(e,t){e.pushSignature(t)},deserialize:function(e){return e.getSignature()}})}));return e.set("extended_asset",C({name:"extended_asset",baseName:"",fields:[{name:"quantity",typeName:"asset",type:e.get("asset")},{name:"contract",typeName:"name",type:e.get("name")}],serialize:p,deserialize:f})),e},t.createAbiTypes=function(){var e=t.createInitialTypes();return e.set("extensions_entry",C({name:"extensions_entry",baseName:"",fields:[{name:"tag",typeName:"uint16",type:null},{name:"value",typeName:"bytes",type:null}],serialize:p,deserialize:f})),e.set("type_def",C({name:"type_def",baseName:"",fields:[{name:"new_type_name",typeName:"string",type:null},{name:"type",typeName:"string",type:null}],serialize:p,deserialize:f})),e.set("field_def",C({name:"field_def",baseName:"",fields:[{name:"name",typeName:"string",type:null},{name:"type",typeName:"string",type:null}],serialize:p,deserialize:f})),e.set("struct_def",C({name:"struct_def",baseName:"",fields:[{name:"name",typeName:"string",type:null},{name:"base",typeName:"string",type:null},{name:"fields",typeName:"field_def[]",type:null}],serialize:p,deserialize:f})),e.set("action_def",C({name:"action_def",baseName:"",fields:[{name:"name",typeName:"name",type:null},{name:"type",typeName:"string",type:null},{name:"ricardian_contract",typeName:"string",type:null}],serialize:p,deserialize:f})),e.set("table_def",C({name:"table_def",baseName:"",fields:[{name:"name",typeName:"name",type:null},{name:"index_type",typeName:"string",type:null},{name:"key_names",typeName:"string[]",type:null},{name:"key_types",typeName:"string[]",type:null},{name:"type",typeName:"string",type:null}],serialize:p,deserialize:f})),e.set("clause_pair",C({name:"clause_pair",baseName:"",fields:[{name:"id",typeName:"string",type:null},{name:"body",typeName:"string",type:null}],serialize:p,deserialize:f})),e.set("error_message",C({name:"error_message",baseName:"",fields:[{name:"error_code",typeName:"uint64",type:null},{name:"error_msg",typeName:"string",type:null}],serialize:p,deserialize:f})),e.set("variant_def",C({name:"variant_def",baseName:"",fields:[{name:"name",typeName:"string",type:null},{name:"types",typeName:"string[]",type:null}],serialize:p,deserialize:f})),e.set("action_result",C({name:"action_result",baseName:"",fields:[{name:"name",typeName:"name",type:null},{name:"result_type",typeName:"string",type:null}],serialize:p,deserialize:f})),e.set("primary_key_index_def",C({name:"primary_key_index_def",baseName:"",fields:[{name:"name",typeName:"name",type:null},{name:"type",typeName:"string",type:null}],serialize:p,deserialize:f})),e.set("secondary_index_def",C({name:"secondary_index_def",baseName:"",fields:[{name:"type",typeName:"string",type:null}],serialize:p,deserialize:f})),e.set("secondary_indices",C({name:"secondary_indices",baseName:"",fields:[{name:"name",typeName:"name",type:null},{name:"secondary_index_def",typeName:"secondary_index_def",type:null}],serialize:E,deserialize:T})),e.set("kv_table_entry_def",C({name:"kv_table_entry_def",baseName:"",fields:[{name:"type",typeName:"string",type:null},{name:"primary_index",typeName:"primary_key_index_def",type:null},{name:"secondary_indices",typeName:"secondary_indices",type:null}],serialize:p,deserialize:f})),e.set("kv_table",C({name:"kv_table",baseName:"",fields:[{name:"name",typeName:"name",type:null},{name:"kv_table_entry_def",typeName:"kv_table_entry_def",type:null}],serialize:E,deserialize:T})),e.set("abi_def",C({name:"abi_def",baseName:"",fields:[{name:"version",typeName:"string",type:null},{name:"types",typeName:"type_def[]",type:null},{name:"structs",typeName:"struct_def[]",type:null},{name:"actions",typeName:"action_def[]",type:null},{name:"tables",typeName:"table_def[]",type:null},{name:"ricardian_clauses",typeName:"clause_pair[]",type:null},{name:"error_messages",typeName:"error_message[]",type:null},{name:"abi_extensions",typeName:"extensions_entry[]",type:null},{name:"variants",typeName:"variant_def[]$",type:null},{name:"action_results",typeName:"action_result[]$",type:null},{name:"kv_tables",typeName:"kv_table$",type:null}],serialize:p,deserialize:f})),e},t.createTransactionExtensionTypes=function(){var e=t.createInitialTypes();return e.set("resource_payer",C({name:"resource_payer",baseName:"",fields:[{name:"payer",typeName:"name",type:null},{name:"max_net_bytes",typeName:"uint64",type:null},{name:"max_cpu_us",typeName:"uint64",type:null},{name:"max_memory_bytes",typeName:"uint64",type:null}],serialize:p,deserialize:f})),e},t.createTransactionTypes=function(){var e=t.createInitialTypes();return e.set("permission_level",C({name:"permission_level",baseName:"",fields:[{name:"actor",typeName:"name",type:null},{name:"permission",typeName:"name",type:null}],serialize:p,deserialize:f})),e.set("action",C({name:"action",baseName:"",fields:[{name:"account",typeName:"name",type:null},{name:"name",typeName:"name",type:null},{name:"authorization",typeName:"permission_level[]",type:null},{name:"data",typeName:"bytes",type:null}],serialize:p,deserialize:f})),e.set("extension",C({name:"extension",baseName:"",fields:[{name:"type",typeName:"uint16",type:null},{name:"data",typeName:"bytes",type:null}],serialize:S,deserialize:I})),e.set("transaction_header",C({name:"transaction_header",baseName:"",fields:[{name:"expiration",typeName:"time_point_sec",type:null},{name:"ref_block_num",typeName:"uint16",type:null},{name:"ref_block_prefix",typeName:"uint32",type:null},{name:"max_net_usage_words",typeName:"varuint32",type:null},{name:"max_cpu_usage_ms",typeName:"uint8",type:null},{name:"delay_sec",typeName:"varuint32",type:null}],serialize:p,deserialize:f})),e.set("transaction",C({name:"transaction",baseName:"transaction_header",fields:[{name:"context_free_actions",typeName:"action[]",type:null},{name:"actions",typeName:"action[]",type:null},{name:"transaction_extensions",typeName:"extension",type:null}],serialize:p,deserialize:f})),e},t.getType=function(e,n){var r=e.get(n);if(r&&r.aliasOfName)return t.getType(e,r.aliasOfName);if(r)return r;if(n.endsWith("[]"))return C({name:n,arrayOf:t.getType(e,n.substr(0,n.length-2)),serialize:g,deserialize:y});if(n.endsWith("?"))return C({name:n,optionalOf:t.getType(e,n.substr(0,n.length-1)),serialize:v,deserialize:w});if(n.endsWith("$"))return C({name:n,extensionOf:t.getType(e,n.substr(0,n.length-1)),serialize:b,deserialize:k});throw new Error("Unknown type: "+n)},t.getTypesFromAbi=function(e,n){var r,s,a,c,l,u,h,d,g,y,v=new Map(e);if(n&&n.types)try{for(var w=o(n.types),b=w.next();!b.done;b=w.next()){var k=b.value,E=k.new_type_name,T=k.type;v.set(E,C({name:E,aliasOfName:T}))}}catch(e){r={error:e}}finally{try{b&&!b.done&&(s=w.return)&&s.call(w)}finally{if(r)throw r.error}}if(n&&n.structs)try{for(var S=o(n.structs),I=S.next();!I.done;I=S.next()){var x=I.value,A=x.name,N=x.base,P=x.fields;v.set(A,C({name:A,baseName:N,fields:P.map((function(e){return{name:e.name,typeName:e.type,type:null}})),serialize:p,deserialize:f}))}}catch(e){a={error:e}}finally{try{I&&!I.done&&(c=S.return)&&c.call(S)}finally{if(a)throw a.error}}if(n&&n.variants)try{for(var O=o(n.variants),R=O.next();!R.done;R=O.next()){var D=R.value,z=D.name,M=D.types;v.set(z,C({name:z,fields:M.map((function(e){return{name:e,typeName:e,type:null}})),serialize:_,deserialize:m}))}}catch(e){l={error:e}}finally{try{R&&!R.done&&(u=O.return)&&u.call(O)}finally{if(l)throw l.error}}try{for(var L=o(v),U=L.next();!U.done;U=L.next()){var F=i(U.value,2);F[0],(T=F[1]).baseName&&(T.base=t.getType(v,T.baseName));try{for(var j=(g=void 0,o(T.fields)),q=j.next();!q.done;q=j.next()){var B=q.value;B.type=t.getType(v,B.typeName)}}catch(e){g={error:e}}finally{try{q&&!q.done&&(y=j.return)&&y.call(j)}finally{if(g)throw g.error}}}}catch(e){h={error:e}}finally{try{U&&!U.done&&(d=L.return)&&d.call(L)}finally{if(h)throw h.error}}return v},t.transactionHeader=function(e,n){var r,i=e.header?e.header.timestamp:e.timestamp,s=parseInt((r=e.id.substr(16,8)).substr(6,2)+r.substr(4,2)+r.substr(2,2)+r.substr(0,2),16);return{expiration:t.timePointSecToDate(t.dateToTimePointSec(i)+n),ref_block_num:65535&e.block_num,ref_block_prefix:s}},t.serializeActionData=function(e,n,r,i,s,o){var a=e.actions.get(r);if(!a)throw new Error("Unknown action "+r+" in contract "+n);var c=new l({textEncoder:s,textDecoder:o});return a.serialize(c,i),t.arrayToHex(c.asUint8Array())},t.serializeAction=function(e,n,r,i,s,o,a){return{account:n,name:r,authorization:i,data:t.serializeActionData(e,n,r,s,o,a)}},t.deserializeActionData=function(e,n,r,i,s,o){var a=e.actions.get(r);if("string"==typeof i&&(i=t.hexToUint8Array(i)),!a)throw new Error("Unknown action "+r+" in contract "+n);var c=new l({textDecoder:o,textEncoder:s});return c.pushArray(i),a.deserialize(c)},t.deserializeAction=function(e,n,r,i,s,o,a){return{account:n,name:r,authorization:i,data:t.deserializeActionData(e,n,r,s,o,a)}},t.serializeAnyvar=function(e,t){var n,r,s,o,a,c,l,u,h;null===t?(u=(n=i([P.null_t,t],2))[0],h=n[1]):"string"==typeof t?(u=(r=i([P.string,t],2))[0],h=r[1]):"number"==typeof t?(u=(s=i([P.int32,t],2))[0],h=s[1]):t instanceof Uint8Array?(u=(o=i([P.bytes,t],2))[0],h=o[1]):Array.isArray(t)?(u=(a=i([P.any_array,t],2))[0],h=a[1]):2===Object.keys(t).length&&t.hasOwnProperty("type")&&t.hasOwnProperty("value")?(u=(c=i([P[t.type],t.value],2))[0],h=c[1]):(u=(l=i([P.any_object,t],2))[0],h=l[1]),e.pushVaruint32(u.index),u.type.serialize(e,h)},t.deserializeAnyvar=function(e,t){var n=e.getVaruint32();if(n>=O.length)throw new Error("Tried to deserialize unknown anyvar type");var r=O[n],i=r.type.deserialize(e,t);return t&&t.options.useShortForm||r.useShortForm?i:{type:r.type.name,value:i}},t.deserializeAnyvarShort=function(e){return t.deserializeAnyvar(e,new c({useShortForm:!0}))},t.serializeAnyObject=function(e,n){var r,s,a=Object.entries(n);e.pushVaruint32(a.length);try{for(var c=o(a),l=c.next();!l.done;l=c.next()){var u=i(l.value,2),h=u[0],d=u[1];e.pushString(h),t.serializeAnyvar(e,d)}}catch(e){r={error:e}}finally{try{l&&!l.done&&(s=c.return)&&s.call(c)}finally{if(r)throw r.error}}},t.deserializeAnyObject=function(e,n){for(var r=e.getVaruint32(),i={},s=0;s<r;++s){var o=e.getString();if(o in i){for(var a=1;o+"_"+a in i;)++a;o=o+"_"+a}i[o]=t.deserializeAnyvar(e,n)}return i},t.serializeAnyArray=function(e,n){var r,i;e.pushVaruint32(n.length);try{for(var s=o(n),a=s.next();!a.done;a=s.next()){var c=a.value;t.serializeAnyvar(e,c)}}catch(e){r={error:e}}finally{try{a&&!a.done&&(i=s.return)&&i.call(s)}finally{if(r)throw r.error}}},t.deserializeAnyArray=function(e,n){for(var r=e.getVaruint32(),i=[],s=0;s<r;++s)i.push(t.deserializeAnyvar(e,n));return i};var A,N=((A=t.createInitialTypes()).set("null_t",C({name:"null_t",serialize:function(e,t){},deserialize:function(e,t){}})),A.set("any_object",C({name:"any_object",serialize:t.serializeAnyObject,deserialize:t.deserializeAnyObject})),A.set("any_array",C({name:"any_array",serialize:t.serializeAnyArray,deserialize:t.deserializeAnyArray})),A),P={null_t:{index:0,useShortForm:!0,type:N.get("null_t")},int64:{index:1,useShortForm:!1,type:N.get("int64")},uint64:{index:2,useShortForm:!1,type:N.get("uint64")},int32:{index:3,useShortForm:!0,type:N.get("int32")},uint32:{index:4,useShortForm:!1,type:N.get("uint32")},int16:{index:5,useShortForm:!1,type:N.get("int16")},uint16:{index:6,useShortForm:!1,type:N.get("uint16")},int8:{index:7,useShortForm:!1,type:N.get("int8")},uint8:{index:8,useShortForm:!1,type:N.get("uint8")},time_point:{index:9,useShortForm:!1,type:N.get("time_point")},checksum256:{index:10,useShortForm:!1,type:N.get("checksum256")},float64:{index:11,useShortForm:!1,type:N.get("float64")},string:{index:12,useShortForm:!0,type:N.get("string")},any_object:{index:13,useShortForm:!0,type:N.get("any_object")},any_array:{index:14,useShortForm:!0,type:N.get("any_array")},bytes:{index:15,useShortForm:!1,type:N.get("bytes")},symbol:{index:16,useShortForm:!1,type:N.get("symbol")},symbol_code:{index:17,useShortForm:!1,type:N.get("symbol_code")},asset:{index:18,useShortForm:!1,type:N.get("asset")}},O=[P.null_t,P.int64,P.uint64,P.int32,P.uint32,P.int16,P.uint16,P.int8,P.uint8,P.time_point,P.checksum256,P.float64,P.string,P.any_object,P.any_array,P.bytes,P.symbol,P.symbol_code,P.asset];t.serializeQuery=function(e,n){var r,s,a,c,l,u,h,d;if("string"==typeof n?u=n:Array.isArray(n)&&2===n.length?(u=(r=i(n,2))[0],d=r[1]):Array.isArray(n)&&3===n.length?(u=(s=i(n,3))[0],h=s[1],d=s[2]):(u=(a=i([n.method,n.arg,n.filter],3))[0],h=a[1],d=a[2]),e.pushString(u),void 0===h?e.push(0):(e.push(1),t.serializeAnyvar(e,h)),void 0===d)e.push(0);else{e.pushVaruint32(d.length);try{for(var p=o(d),f=p.next();!f.done;f=p.next()){var _=f.value;t.serializeQuery(e,_)}}catch(e){c={error:e}}finally{try{f&&!f.done&&(l=p.return)&&l.call(p)}finally{if(c)throw c.error}}}}},7678:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Serialize=t.RpcError=t.RpcInterfaces=t.Numeric=t.JsonRpc=t.ApiInterfaces=t.Api=void 0;var r=n(3915);Object.defineProperty(t,"Api",{enumerable:!0,get:function(){return r.Api}});var i=n(5461);t.ApiInterfaces=i;var s=n(6208);Object.defineProperty(t,"JsonRpc",{enumerable:!0,get:function(){return s.JsonRpc}});var o=n(1823);t.Numeric=o;var a=n(5576);t.RpcInterfaces=a;var c=n(3937);Object.defineProperty(t,"RpcError",{enumerable:!0,get:function(){return c.RpcError}});var l=n(2753);t.Serialize=l},1963:e=>{"use strict";var t=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),n=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return t(e,null,[{key:"get_n_pad_bytes",value:function(e){return 64-(e+8&63)}},{key:"pad",value:function(t){var n,r,i=t.byteLength,s=e.get_n_pad_bytes(i),o=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],r=!0,i=!1,s=void 0;try{for(var o,a=e[Symbol.iterator]();!(r=(o=a.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){i=!0,s=e}finally{try{!r&&a.return&&a.return()}finally{if(i)throw s}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}((n=i,r=536870912,[Math.floor(n/r),n%r]).map((function(e,t){return t?8*e:e})),2),a=o[0],c=o[1],l=new Uint8Array(i+s+8);l.set(new Uint8Array(t),0);var u=new DataView(l.buffer);return u.setUint8(i,128),u.setUint32(i+s,c,!0),u.setUint32(i+s+4,a,!0),l.buffer}},{key:"f",value:function(e,t,n,r){return 0<=e&&e<=15?t^n^r:16<=e&&e<=31?t&n|~t&r:32<=e&&e<=47?(t|~n)^r:48<=e&&e<=63?t&r|n&~r:64<=e&&e<=79?t^(n|~r):void 0}},{key:"K",value:function(e){return 0<=e&&e<=15?0:16<=e&&e<=31?1518500249:32<=e&&e<=47?1859775393:48<=e&&e<=63?2400959708:64<=e&&e<=79?2840853838:void 0}},{key:"KP",value:function(e){return 0<=e&&e<=15?1352829926:16<=e&&e<=31?1548603684:32<=e&&e<=47?1836072691:48<=e&&e<=63?2053994217:64<=e&&e<=79?0:void 0}},{key:"add_modulo32",value:function(){return 0|Array.from(arguments).reduce((function(e,t){return e+t}),0)}},{key:"rol32",value:function(e,t){return e<<t|e>>>32-t}},{key:"hash",value:function(t){for(var n=e.pad(t),r=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13],i=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11],s=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6],o=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11],a=n.byteLength/64,c=new Array(a).fill(void 0).map((function(e,t){return function(e){return new DataView(n,64*t,64).getUint32(4*e,!0)}})),l=[1732584193,4023233417,2562383102,271733878,3285377520],u=0;u<a;++u){for(var h=l[0],d=l[1],p=l[2],f=l[3],_=l[4],m=h,g=d,y=p,v=f,w=_,b=0;b<80;++b){var k=e.add_modulo32(e.rol32(e.add_modulo32(h,e.f(b,d,p,f),c[u](r[b]),e.K(b)),s[b]),_);h=_,_=f,f=e.rol32(p,10),p=d,d=k,k=e.add_modulo32(e.rol32(e.add_modulo32(m,e.f(79-b,g,y,v),c[u](i[b]),e.KP(b)),o[b]),w),m=w,w=v,v=e.rol32(y,10),y=g,g=k}var E=e.add_modulo32(l[1],p,v);l[1]=e.add_modulo32(l[2],f,w),l[2]=e.add_modulo32(l[3],_,m),l[3]=e.add_modulo32(l[4],h,g),l[4]=e.add_modulo32(l[0],d,y),l[0]=E}var T=new ArrayBuffer(20),S=new DataView(T);return l.forEach((function(e,t){return S.setUint32(4*t,e,!0)})),T}}]),e}();e.exports={RIPEMD160:n}},6204:(e,t,n)=>{var r=t;r.utils=n(6414),r.common=n(2238),r.sha=n(4538),r.ripemd=n(2185),r.hmac=n(6316),r.sha1=r.sha.sha1,r.sha256=r.sha.sha256,r.sha224=r.sha.sha224,r.sha384=r.sha.sha384,r.sha512=r.sha.sha512,r.ripemd160=r.ripemd.ripemd160},2238:(e,t,n)=>{"use strict";var r=n(6414),i=n(6794);function s(){this.pending=null,this.pendingTotal=0,this.blockSize=this.constructor.blockSize,this.outSize=this.constructor.outSize,this.hmacStrength=this.constructor.hmacStrength,this.padLength=this.constructor.padLength/8,this.endian="big",this._delta8=this.blockSize/8,this._delta32=this.blockSize/32}t.BlockHash=s,s.prototype.update=function(e,t){if(e=r.toArray(e,t),this.pending?this.pending=this.pending.concat(e):this.pending=e,this.pendingTotal+=e.length,this.pending.length>=this._delta8){var n=(e=this.pending).length%this._delta8;this.pending=e.slice(e.length-n,e.length),0===this.pending.length&&(this.pending=null),e=r.join32(e,0,e.length-n,this.endian);for(var i=0;i<e.length;i+=this._delta32)this._update(e,i,i+this._delta32)}return this},s.prototype.digest=function(e){return this.update(this._pad()),i(null===this.pending),this._digest(e)},s.prototype._pad=function(){var e=this.pendingTotal,t=this._delta8,n=t-(e+this.padLength)%t,r=new Array(n+this.padLength);r[0]=128;for(var i=1;i<n;i++)r[i]=0;if(e<<=3,"big"===this.endian){for(var s=8;s<this.padLength;s++)r[i++]=0;r[i++]=0,r[i++]=0,r[i++]=0,r[i++]=0,r[i++]=e>>>24&255,r[i++]=e>>>16&255,r[i++]=e>>>8&255,r[i++]=255&e}else for(r[i++]=255&e,r[i++]=e>>>8&255,r[i++]=e>>>16&255,r[i++]=e>>>24&255,r[i++]=0,r[i++]=0,r[i++]=0,r[i++]=0,s=8;s<this.padLength;s++)r[i++]=0;return r}},6316:(e,t,n)=>{"use strict";var r=n(6414),i=n(6794);function s(e,t,n){if(!(this instanceof s))return new s(e,t,n);this.Hash=e,this.blockSize=e.blockSize/8,this.outSize=e.outSize/8,this.inner=null,this.outer=null,this._init(r.toArray(t,n))}e.exports=s,s.prototype._init=function(e){e.length>this.blockSize&&(e=(new this.Hash).update(e).digest()),i(e.length<=this.blockSize);for(var t=e.length;t<this.blockSize;t++)e.push(0);for(t=0;t<e.length;t++)e[t]^=54;for(this.inner=(new this.Hash).update(e),t=0;t<e.length;t++)e[t]^=106;this.outer=(new this.Hash).update(e)},s.prototype.update=function(e,t){return this.inner.update(e,t),this},s.prototype.digest=function(e){return this.outer.update(this.inner.digest()),this.outer.digest(e)}},2185:(e,t,n)=>{"use strict";var r=n(6414),i=n(2238),s=r.rotl32,o=r.sum32,a=r.sum32_3,c=r.sum32_4,l=i.BlockHash;function u(){if(!(this instanceof u))return new u;l.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.endian="little"}function h(e,t,n,r){return e<=15?t^n^r:e<=31?t&n|~t&r:e<=47?(t|~n)^r:e<=63?t&r|n&~r:t^(n|~r)}function d(e){return e<=15?0:e<=31?1518500249:e<=47?1859775393:e<=63?2400959708:2840853838}function p(e){return e<=15?1352829926:e<=31?1548603684:e<=47?1836072691:e<=63?2053994217:0}r.inherits(u,l),t.ripemd160=u,u.blockSize=512,u.outSize=160,u.hmacStrength=192,u.padLength=64,u.prototype._update=function(e,t){for(var n=this.h[0],r=this.h[1],i=this.h[2],l=this.h[3],u=this.h[4],y=n,v=r,w=i,b=l,k=u,E=0;E<80;E++){var T=o(s(c(n,h(E,r,i,l),e[f[E]+t],d(E)),m[E]),u);n=u,u=l,l=s(i,10),i=r,r=T,T=o(s(c(y,h(79-E,v,w,b),e[_[E]+t],p(E)),g[E]),k),y=k,k=b,b=s(w,10),w=v,v=T}T=a(this.h[1],i,b),this.h[1]=a(this.h[2],l,k),this.h[2]=a(this.h[3],u,y),this.h[3]=a(this.h[4],n,v),this.h[4]=a(this.h[0],r,w),this.h[0]=T},u.prototype._digest=function(e){return"hex"===e?r.toHex32(this.h,"little"):r.split32(this.h,"little")};var f=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13],_=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11],m=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6],g=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]},4538:(e,t,n)=>{"use strict";t.sha1=n(6854),t.sha224=n(9104),t.sha256=n(7284),t.sha384=n(8909),t.sha512=n(1260)},6854:(e,t,n)=>{"use strict";var r=n(6414),i=n(2238),s=n(2181),o=r.rotl32,a=r.sum32,c=r.sum32_5,l=s.ft_1,u=i.BlockHash,h=[1518500249,1859775393,2400959708,3395469782];function d(){if(!(this instanceof d))return new d;u.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.W=new Array(80)}r.inherits(d,u),e.exports=d,d.blockSize=512,d.outSize=160,d.hmacStrength=80,d.padLength=64,d.prototype._update=function(e,t){for(var n=this.W,r=0;r<16;r++)n[r]=e[t+r];for(;r<n.length;r++)n[r]=o(n[r-3]^n[r-8]^n[r-14]^n[r-16],1);var i=this.h[0],s=this.h[1],u=this.h[2],d=this.h[3],p=this.h[4];for(r=0;r<n.length;r++){var f=~~(r/20),_=c(o(i,5),l(f,s,u,d),p,n[r],h[f]);p=d,d=u,u=o(s,30),s=i,i=_}this.h[0]=a(this.h[0],i),this.h[1]=a(this.h[1],s),this.h[2]=a(this.h[2],u),this.h[3]=a(this.h[3],d),this.h[4]=a(this.h[4],p)},d.prototype._digest=function(e){return"hex"===e?r.toHex32(this.h,"big"):r.split32(this.h,"big")}},9104:(e,t,n)=>{"use strict";var r=n(6414),i=n(7284);function s(){if(!(this instanceof s))return new s;i.call(this),this.h=[3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428]}r.inherits(s,i),e.exports=s,s.blockSize=512,s.outSize=224,s.hmacStrength=192,s.padLength=64,s.prototype._digest=function(e){return"hex"===e?r.toHex32(this.h.slice(0,7),"big"):r.split32(this.h.slice(0,7),"big")}},7284:(e,t,n)=>{"use strict";var r=n(6414),i=n(2238),s=n(2181),o=n(6794),a=r.sum32,c=r.sum32_4,l=r.sum32_5,u=s.ch32,h=s.maj32,d=s.s0_256,p=s.s1_256,f=s.g0_256,_=s.g1_256,m=i.BlockHash,g=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];function y(){if(!(this instanceof y))return new y;m.call(this),this.h=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],this.k=g,this.W=new Array(64)}r.inherits(y,m),e.exports=y,y.blockSize=512,y.outSize=256,y.hmacStrength=192,y.padLength=64,y.prototype._update=function(e,t){for(var n=this.W,r=0;r<16;r++)n[r]=e[t+r];for(;r<n.length;r++)n[r]=c(_(n[r-2]),n[r-7],f(n[r-15]),n[r-16]);var i=this.h[0],s=this.h[1],m=this.h[2],g=this.h[3],y=this.h[4],v=this.h[5],w=this.h[6],b=this.h[7];for(o(this.k.length===n.length),r=0;r<n.length;r++){var k=l(b,p(y),u(y,v,w),this.k[r],n[r]),E=a(d(i),h(i,s,m));b=w,w=v,v=y,y=a(g,k),g=m,m=s,s=i,i=a(k,E)}this.h[0]=a(this.h[0],i),this.h[1]=a(this.h[1],s),this.h[2]=a(this.h[2],m),this.h[3]=a(this.h[3],g),this.h[4]=a(this.h[4],y),this.h[5]=a(this.h[5],v),this.h[6]=a(this.h[6],w),this.h[7]=a(this.h[7],b)},y.prototype._digest=function(e){return"hex"===e?r.toHex32(this.h,"big"):r.split32(this.h,"big")}},8909:(e,t,n)=>{"use strict";var r=n(6414),i=n(1260);function s(){if(!(this instanceof s))return new s;i.call(this),this.h=[3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428]}r.inherits(s,i),e.exports=s,s.blockSize=1024,s.outSize=384,s.hmacStrength=192,s.padLength=128,s.prototype._digest=function(e){return"hex"===e?r.toHex32(this.h.slice(0,12),"big"):r.split32(this.h.slice(0,12),"big")}},1260:(e,t,n)=>{"use strict";var r=n(6414),i=n(2238),s=n(6794),o=r.rotr64_hi,a=r.rotr64_lo,c=r.shr64_hi,l=r.shr64_lo,u=r.sum64,h=r.sum64_hi,d=r.sum64_lo,p=r.sum64_4_hi,f=r.sum64_4_lo,_=r.sum64_5_hi,m=r.sum64_5_lo,g=i.BlockHash,y=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591];function v(){if(!(this instanceof v))return new v;g.call(this),this.h=[1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209],this.k=y,this.W=new Array(160)}function w(e,t,n,r,i){var s=e&n^~e&i;return s<0&&(s+=4294967296),s}function b(e,t,n,r,i,s){var o=t&r^~t&s;return o<0&&(o+=4294967296),o}function k(e,t,n,r,i){var s=e&n^e&i^n&i;return s<0&&(s+=4294967296),s}function E(e,t,n,r,i,s){var o=t&r^t&s^r&s;return o<0&&(o+=4294967296),o}function T(e,t){var n=o(e,t,28)^o(t,e,2)^o(t,e,7);return n<0&&(n+=4294967296),n}function S(e,t){var n=a(e,t,28)^a(t,e,2)^a(t,e,7);return n<0&&(n+=4294967296),n}function I(e,t){var n=a(e,t,14)^a(e,t,18)^a(t,e,9);return n<0&&(n+=4294967296),n}function C(e,t){var n=o(e,t,1)^o(e,t,8)^c(e,t,7);return n<0&&(n+=4294967296),n}function x(e,t){var n=a(e,t,1)^a(e,t,8)^l(e,t,7);return n<0&&(n+=4294967296),n}function A(e,t){var n=a(e,t,19)^a(t,e,29)^l(e,t,6);return n<0&&(n+=4294967296),n}r.inherits(v,g),e.exports=v,v.blockSize=1024,v.outSize=512,v.hmacStrength=192,v.padLength=128,v.prototype._prepareBlock=function(e,t){for(var n=this.W,r=0;r<32;r++)n[r]=e[t+r];for(;r<n.length;r+=2){var i=(m=n[r-4],g=n[r-3],y=void 0,(y=o(m,g,19)^o(g,m,29)^c(m,g,6))<0&&(y+=4294967296),y),s=A(n[r-4],n[r-3]),a=n[r-14],l=n[r-13],u=C(n[r-30],n[r-29]),h=x(n[r-30],n[r-29]),d=n[r-32],_=n[r-31];n[r]=p(i,s,a,l,u,h,d,_),n[r+1]=f(i,s,a,l,u,h,d,_)}var m,g,y},v.prototype._update=function(e,t){this._prepareBlock(e,t);var n,r,i,a=this.W,c=this.h[0],l=this.h[1],p=this.h[2],f=this.h[3],g=this.h[4],y=this.h[5],v=this.h[6],C=this.h[7],x=this.h[8],A=this.h[9],N=this.h[10],P=this.h[11],O=this.h[12],R=this.h[13],D=this.h[14],z=this.h[15];s(this.k.length===a.length);for(var M=0;M<a.length;M+=2){var L=D,U=z,F=(i=void 0,(i=o(n=x,r=A,14)^o(n,r,18)^o(r,n,9))<0&&(i+=4294967296),i),j=I(x,A),q=w(x,0,N,0,O),B=b(0,A,0,P,0,R),W=this.k[M],V=this.k[M+1],H=a[M],K=a[M+1],$=_(L,U,F,j,q,B,W,V,H,K),G=m(L,U,F,j,q,B,W,V,H,K);L=T(c,l),U=S(c,l),F=k(c,0,p,0,g),j=E(0,l,0,f,0,y);var J=h(L,U,F,j),Z=d(L,U,F,j);D=O,z=R,O=N,R=P,N=x,P=A,x=h(v,C,$,G),A=d(C,C,$,G),v=g,C=y,g=p,y=f,p=c,f=l,c=h($,G,J,Z),l=d($,G,J,Z)}u(this.h,0,c,l),u(this.h,2,p,f),u(this.h,4,g,y),u(this.h,6,v,C),u(this.h,8,x,A),u(this.h,10,N,P),u(this.h,12,O,R),u(this.h,14,D,z)},v.prototype._digest=function(e){return"hex"===e?r.toHex32(this.h,"big"):r.split32(this.h,"big")}},2181:(e,t,n)=>{"use strict";var r=n(6414).rotr32;function i(e,t,n){return e&t^~e&n}function s(e,t,n){return e&t^e&n^t&n}function o(e,t,n){return e^t^n}t.ft_1=function(e,t,n,r){return 0===e?i(t,n,r):1===e||3===e?o(t,n,r):2===e?s(t,n,r):void 0},t.ch32=i,t.maj32=s,t.p32=o,t.s0_256=function(e){return r(e,2)^r(e,13)^r(e,22)},t.s1_256=function(e){return r(e,6)^r(e,11)^r(e,25)},t.g0_256=function(e){return r(e,7)^r(e,18)^e>>>3},t.g1_256=function(e){return r(e,17)^r(e,19)^e>>>10}},6414:(e,t,n)=>{"use strict";var r=n(6794),i=n(5153);function s(e,t){return 55296==(64512&e.charCodeAt(t))&&!(t<0||t+1>=e.length)&&56320==(64512&e.charCodeAt(t+1))}function o(e){return(e>>>24|e>>>8&65280|e<<8&16711680|(255&e)<<24)>>>0}function a(e){return 1===e.length?"0"+e:e}function c(e){return 7===e.length?"0"+e:6===e.length?"00"+e:5===e.length?"000"+e:4===e.length?"0000"+e:3===e.length?"00000"+e:2===e.length?"000000"+e:1===e.length?"0000000"+e:e}t.inherits=i,t.toArray=function(e,t){if(Array.isArray(e))return e.slice();if(!e)return[];var n=[];if("string"==typeof e)if(t){if("hex"===t)for((e=e.replace(/[^a-z0-9]+/gi,"")).length%2!=0&&(e="0"+e),i=0;i<e.length;i+=2)n.push(parseInt(e[i]+e[i+1],16))}else for(var r=0,i=0;i<e.length;i++){var o=e.charCodeAt(i);o<128?n[r++]=o:o<2048?(n[r++]=o>>6|192,n[r++]=63&o|128):s(e,i)?(o=65536+((1023&o)<<10)+(1023&e.charCodeAt(++i)),n[r++]=o>>18|240,n[r++]=o>>12&63|128,n[r++]=o>>6&63|128,n[r++]=63&o|128):(n[r++]=o>>12|224,n[r++]=o>>6&63|128,n[r++]=63&o|128)}else for(i=0;i<e.length;i++)n[i]=0|e[i];return n},t.toHex=function(e){for(var t="",n=0;n<e.length;n++)t+=a(e[n].toString(16));return t},t.htonl=o,t.toHex32=function(e,t){for(var n="",r=0;r<e.length;r++){var i=e[r];"little"===t&&(i=o(i)),n+=c(i.toString(16))}return n},t.zero2=a,t.zero8=c,t.join32=function(e,t,n,i){var s=n-t;r(s%4==0);for(var o=new Array(s/4),a=0,c=t;a<o.length;a++,c+=4){var l;l="big"===i?e[c]<<24|e[c+1]<<16|e[c+2]<<8|e[c+3]:e[c+3]<<24|e[c+2]<<16|e[c+1]<<8|e[c],o[a]=l>>>0}return o},t.split32=function(e,t){for(var n=new Array(4*e.length),r=0,i=0;r<e.length;r++,i+=4){var s=e[r];"big"===t?(n[i]=s>>>24,n[i+1]=s>>>16&255,n[i+2]=s>>>8&255,n[i+3]=255&s):(n[i+3]=s>>>24,n[i+2]=s>>>16&255,n[i+1]=s>>>8&255,n[i]=255&s)}return n},t.rotr32=function(e,t){return e>>>t|e<<32-t},t.rotl32=function(e,t){return e<<t|e>>>32-t},t.sum32=function(e,t){return e+t>>>0},t.sum32_3=function(e,t,n){return e+t+n>>>0},t.sum32_4=function(e,t,n,r){return e+t+n+r>>>0},t.sum32_5=function(e,t,n,r,i){return e+t+n+r+i>>>0},t.sum64=function(e,t,n,r){var i=e[t],s=r+e[t+1]>>>0,o=(s<r?1:0)+n+i;e[t]=o>>>0,e[t+1]=s},t.sum64_hi=function(e,t,n,r){return(t+r>>>0<t?1:0)+e+n>>>0},t.sum64_lo=function(e,t,n,r){return t+r>>>0},t.sum64_4_hi=function(e,t,n,r,i,s,o,a){var c=0,l=t;return c+=(l=l+r>>>0)<t?1:0,c+=(l=l+s>>>0)<s?1:0,e+n+i+o+(c+=(l=l+a>>>0)<a?1:0)>>>0},t.sum64_4_lo=function(e,t,n,r,i,s,o,a){return t+r+s+a>>>0},t.sum64_5_hi=function(e,t,n,r,i,s,o,a,c,l){var u=0,h=t;return u+=(h=h+r>>>0)<t?1:0,u+=(h=h+s>>>0)<s?1:0,u+=(h=h+a>>>0)<a?1:0,e+n+i+o+c+(u+=(h=h+l>>>0)<l?1:0)>>>0},t.sum64_5_lo=function(e,t,n,r,i,s,o,a,c,l){return t+r+s+a+l>>>0},t.rotr64_hi=function(e,t,n){return(t<<32-n|e>>>n)>>>0},t.rotr64_lo=function(e,t,n){return(e<<32-n|t>>>n)>>>0},t.shr64_hi=function(e,t,n){return e>>>n},t.shr64_lo=function(e,t,n){return(e<<32-n|t>>>n)>>>0}},5153:e=>{"function"==typeof Object.create?e.exports=function(e,t){t&&(e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:e.exports=function(e,t){if(t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}}},6794:e=>{function t(e,t){if(!e)throw new Error(t||"Assertion failed")}e.exports=t,t.equal=function(e,t,n){if(e!=t)throw new Error(n||"Assertion failed: "+e+" != "+t)}},8442:(e,t,n)=>{"use strict";const{Deflate:r,deflate:i,deflateRaw:s,gzip:o}=n(8064),{Inflate:a,inflate:c,inflateRaw:l,ungzip:u}=n(6986),h=n(8681);e.exports.Deflate=r,e.exports.deflate=i,e.exports.deflateRaw=s,e.exports.gzip=o,e.exports.Inflate=a,e.exports.inflate=c,e.exports.inflateRaw=l,e.exports.ungzip=u,e.exports.constants=h},8064:(e,t,n)=>{"use strict";const r=n(9246),i=n(3251),s=n(7816),o=n(2587),a=n(4213),c=Object.prototype.toString,{Z_NO_FLUSH:l,Z_SYNC_FLUSH:u,Z_FULL_FLUSH:h,Z_FINISH:d,Z_OK:p,Z_STREAM_END:f,Z_DEFAULT_COMPRESSION:_,Z_DEFAULT_STRATEGY:m,Z_DEFLATED:g}=n(8681);function y(e){this.options=i.assign({level:_,method:g,chunkSize:16384,windowBits:15,memLevel:8,strategy:m},e||{});let t=this.options;t.raw&&t.windowBits>0?t.windowBits=-t.windowBits:t.gzip&&t.windowBits>0&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new a,this.strm.avail_out=0;let n=r.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(n!==p)throw new Error(o[n]);if(t.header&&r.deflateSetHeader(this.strm,t.header),t.dictionary){let e;if(e="string"==typeof t.dictionary?s.string2buf(t.dictionary):"[object ArrayBuffer]"===c.call(t.dictionary)?new Uint8Array(t.dictionary):t.dictionary,n=r.deflateSetDictionary(this.strm,e),n!==p)throw new Error(o[n]);this._dict_set=!0}}function v(e,t){const n=new y(t);if(n.push(e,!0),n.err)throw n.msg||o[n.err];return n.result}y.prototype.push=function(e,t){const n=this.strm,i=this.options.chunkSize;let o,a;if(this.ended)return!1;for(a=t===~~t?t:!0===t?d:l,"string"==typeof e?n.input=s.string2buf(e):"[object ArrayBuffer]"===c.call(e)?n.input=new Uint8Array(e):n.input=e,n.next_in=0,n.avail_in=n.input.length;;)if(0===n.avail_out&&(n.output=new Uint8Array(i),n.next_out=0,n.avail_out=i),(a===u||a===h)&&n.avail_out<=6)this.onData(n.output.subarray(0,n.next_out)),n.avail_out=0;else{if(o=r.deflate(n,a),o===f)return n.next_out>0&&this.onData(n.output.subarray(0,n.next_out)),o=r.deflateEnd(this.strm),this.onEnd(o),this.ended=!0,o===p;if(0!==n.avail_out){if(a>0&&n.next_out>0)this.onData(n.output.subarray(0,n.next_out)),n.avail_out=0;else if(0===n.avail_in)break}else this.onData(n.output)}return!0},y.prototype.onData=function(e){this.chunks.push(e)},y.prototype.onEnd=function(e){e===p&&(this.result=i.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},e.exports.Deflate=y,e.exports.deflate=v,e.exports.deflateRaw=function(e,t){return(t=t||{}).raw=!0,v(e,t)},e.exports.gzip=function(e,t){return(t=t||{}).gzip=!0,v(e,t)},e.exports.constants=n(8681)},6986:(e,t,n)=>{"use strict";const r=n(7387),i=n(3251),s=n(7816),o=n(2587),a=n(4213),c=n(2442),l=Object.prototype.toString,{Z_NO_FLUSH:u,Z_FINISH:h,Z_OK:d,Z_STREAM_END:p,Z_NEED_DICT:f,Z_STREAM_ERROR:_,Z_DATA_ERROR:m,Z_MEM_ERROR:g}=n(8681);function y(e){this.options=i.assign({chunkSize:65536,windowBits:15,to:""},e||{});const t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits&&(t.windowBits=-15)),!(t.windowBits>=0&&t.windowBits<16)||e&&e.windowBits||(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&0==(15&t.windowBits)&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new a,this.strm.avail_out=0;let n=r.inflateInit2(this.strm,t.windowBits);if(n!==d)throw new Error(o[n]);if(this.header=new c,r.inflateGetHeader(this.strm,this.header),t.dictionary&&("string"==typeof t.dictionary?t.dictionary=s.string2buf(t.dictionary):"[object ArrayBuffer]"===l.call(t.dictionary)&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(n=r.inflateSetDictionary(this.strm,t.dictionary),n!==d)))throw new Error(o[n])}function v(e,t){const n=new y(t);if(n.push(e),n.err)throw n.msg||o[n.err];return n.result}y.prototype.push=function(e,t){const n=this.strm,i=this.options.chunkSize,o=this.options.dictionary;let a,c,y;if(this.ended)return!1;for(c=t===~~t?t:!0===t?h:u,"[object ArrayBuffer]"===l.call(e)?n.input=new Uint8Array(e):n.input=e,n.next_in=0,n.avail_in=n.input.length;;){for(0===n.avail_out&&(n.output=new Uint8Array(i),n.next_out=0,n.avail_out=i),a=r.inflate(n,c),a===f&&o&&(a=r.inflateSetDictionary(n,o),a===d?a=r.inflate(n,c):a===m&&(a=f));n.avail_in>0&&a===p&&n.state.wrap>0&&0!==e[n.next_in];)r.inflateReset(n),a=r.inflate(n,c);switch(a){case _:case m:case f:case g:return this.onEnd(a),this.ended=!0,!1}if(y=n.avail_out,n.next_out&&(0===n.avail_out||a===p))if("string"===this.options.to){let e=s.utf8border(n.output,n.next_out),t=n.next_out-e,r=s.buf2string(n.output,e);n.next_out=t,n.avail_out=i-t,t&&n.output.set(n.output.subarray(e,e+t),0),this.onData(r)}else this.onData(n.output.length===n.next_out?n.output:n.output.subarray(0,n.next_out));if(a!==d||0!==y){if(a===p)return a=r.inflateEnd(this.strm),this.onEnd(a),this.ended=!0,!0;if(0===n.avail_in)break}}return!0},y.prototype.onData=function(e){this.chunks.push(e)},y.prototype.onEnd=function(e){e===d&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=i.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},e.exports.Inflate=y,e.exports.inflate=v,e.exports.inflateRaw=function(e,t){return(t=t||{}).raw=!0,v(e,t)},e.exports.ungzip=v,e.exports.constants=n(8681)},3251:e=>{"use strict";const t=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);e.exports.assign=function(e){const n=Array.prototype.slice.call(arguments,1);for(;n.length;){const r=n.shift();if(r){if("object"!=typeof r)throw new TypeError(r+"must be non-object");for(const n in r)t(r,n)&&(e[n]=r[n])}}return e},e.exports.flattenChunks=e=>{let t=0;for(let n=0,r=e.length;n<r;n++)t+=e[n].length;const n=new Uint8Array(t);for(let t=0,r=0,i=e.length;t<i;t++){let i=e[t];n.set(i,r),r+=i.length}return n}},7816:e=>{"use strict";let t=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(e){t=!1}const n=new Uint8Array(256);for(let e=0;e<256;e++)n[e]=e>=252?6:e>=248?5:e>=240?4:e>=224?3:e>=192?2:1;n[254]=n[254]=1,e.exports.string2buf=e=>{let t,n,r,i,s,o=e.length,a=0;for(i=0;i<o;i++)n=e.charCodeAt(i),55296==(64512&n)&&i+1<o&&(r=e.charCodeAt(i+1),56320==(64512&r)&&(n=65536+(n-55296<<10)+(r-56320),i++)),a+=n<128?1:n<2048?2:n<65536?3:4;for(t=new Uint8Array(a),s=0,i=0;s<a;i++)n=e.charCodeAt(i),55296==(64512&n)&&i+1<o&&(r=e.charCodeAt(i+1),56320==(64512&r)&&(n=65536+(n-55296<<10)+(r-56320),i++)),n<128?t[s++]=n:n<2048?(t[s++]=192|n>>>6,t[s++]=128|63&n):n<65536?(t[s++]=224|n>>>12,t[s++]=128|n>>>6&63,t[s++]=128|63&n):(t[s++]=240|n>>>18,t[s++]=128|n>>>12&63,t[s++]=128|n>>>6&63,t[s++]=128|63&n);return t},e.exports.buf2string=(e,r)=>{let i,s;const o=r||e.length,a=new Array(2*o);for(s=0,i=0;i<o;){let t=e[i++];if(t<128){a[s++]=t;continue}let r=n[t];if(r>4)a[s++]=65533,i+=r-1;else{for(t&=2===r?31:3===r?15:7;r>1&&i<o;)t=t<<6|63&e[i++],r--;r>1?a[s++]=65533:t<65536?a[s++]=t:(t-=65536,a[s++]=55296|t>>10&1023,a[s++]=56320|1023&t)}}return((e,n)=>{if(n<65534&&e.subarray&&t)return String.fromCharCode.apply(null,e.length===n?e:e.subarray(0,n));let r="";for(let t=0;t<n;t++)r+=String.fromCharCode(e[t]);return r})(a,s)},e.exports.utf8border=(e,t)=>{(t=t||e.length)>e.length&&(t=e.length);let r=t-1;for(;r>=0&&128==(192&e[r]);)r--;return r<0||0===r?t:r+n[e[r]]>t?r:t}},5775:e=>{"use strict";e.exports=(e,t,n,r)=>{let i=65535&e|0,s=e>>>16&65535|0,o=0;for(;0!==n;){o=n>2e3?2e3:n,n-=o;do{i=i+t[r++]|0,s=s+i|0}while(--o);i%=65521,s%=65521}return i|s<<16|0}},8681:e=>{"use strict";e.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},2576:e=>{"use strict";const t=new Uint32Array((()=>{let e,t=[];for(var n=0;n<256;n++){e=n;for(var r=0;r<8;r++)e=1&e?3988292384^e>>>1:e>>>1;t[n]=e}return t})());e.exports=(e,n,r,i)=>{const s=t,o=i+r;e^=-1;for(let t=i;t<o;t++)e=e>>>8^s[255&(e^n[t])];return-1^e}},9246:(e,t,n)=>{"use strict";const{_tr_init:r,_tr_stored_block:i,_tr_flush_block:s,_tr_tally:o,_tr_align:a}=n(1443),c=n(5775),l=n(2576),u=n(2587),{Z_NO_FLUSH:h,Z_PARTIAL_FLUSH:d,Z_FULL_FLUSH:p,Z_FINISH:f,Z_BLOCK:_,Z_OK:m,Z_STREAM_END:g,Z_STREAM_ERROR:y,Z_DATA_ERROR:v,Z_BUF_ERROR:w,Z_DEFAULT_COMPRESSION:b,Z_FILTERED:k,Z_HUFFMAN_ONLY:E,Z_RLE:T,Z_FIXED:S,Z_DEFAULT_STRATEGY:I,Z_UNKNOWN:C,Z_DEFLATED:x}=n(8681),A=258,N=262,P=103,O=113,R=666,D=(e,t)=>(e.msg=u[t],t),z=e=>(e<<1)-(e>4?9:0),M=e=>{let t=e.length;for(;--t>=0;)e[t]=0};let L=(e,t,n)=>(t<<e.hash_shift^n)&e.hash_mask;const U=e=>{const t=e.state;let n=t.pending;n>e.avail_out&&(n=e.avail_out),0!==n&&(e.output.set(t.pending_buf.subarray(t.pending_out,t.pending_out+n),e.next_out),e.next_out+=n,t.pending_out+=n,e.total_out+=n,e.avail_out-=n,t.pending-=n,0===t.pending&&(t.pending_out=0))},F=(e,t)=>{s(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,U(e.strm)},j=(e,t)=>{e.pending_buf[e.pending++]=t},q=(e,t)=>{e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=255&t},B=(e,t,n,r)=>{let i=e.avail_in;return i>r&&(i=r),0===i?0:(e.avail_in-=i,t.set(e.input.subarray(e.next_in,e.next_in+i),n),1===e.state.wrap?e.adler=c(e.adler,t,i,n):2===e.state.wrap&&(e.adler=l(e.adler,t,i,n)),e.next_in+=i,e.total_in+=i,i)},W=(e,t)=>{let n,r,i=e.max_chain_length,s=e.strstart,o=e.prev_length,a=e.nice_match;const c=e.strstart>e.w_size-N?e.strstart-(e.w_size-N):0,l=e.window,u=e.w_mask,h=e.prev,d=e.strstart+A;let p=l[s+o-1],f=l[s+o];e.prev_length>=e.good_match&&(i>>=2),a>e.lookahead&&(a=e.lookahead);do{if(n=t,l[n+o]===f&&l[n+o-1]===p&&l[n]===l[s]&&l[++n]===l[s+1]){s+=2,n++;do{}while(l[++s]===l[++n]&&l[++s]===l[++n]&&l[++s]===l[++n]&&l[++s]===l[++n]&&l[++s]===l[++n]&&l[++s]===l[++n]&&l[++s]===l[++n]&&l[++s]===l[++n]&&s<d);if(r=A-(d-s),s=d-A,r>o){if(e.match_start=t,o=r,r>=a)break;p=l[s+o-1],f=l[s+o]}}}while((t=h[t&u])>c&&0!=--i);return o<=e.lookahead?o:e.lookahead},V=e=>{const t=e.w_size;let n,r,i,s,o;do{if(s=e.window_size-e.lookahead-e.strstart,e.strstart>=t+(t-N)){e.window.set(e.window.subarray(t,t+t),0),e.match_start-=t,e.strstart-=t,e.block_start-=t,r=e.hash_size,n=r;do{i=e.head[--n],e.head[n]=i>=t?i-t:0}while(--r);r=t,n=r;do{i=e.prev[--n],e.prev[n]=i>=t?i-t:0}while(--r);s+=t}if(0===e.strm.avail_in)break;if(r=B(e.strm,e.window,e.strstart+e.lookahead,s),e.lookahead+=r,e.lookahead+e.insert>=3)for(o=e.strstart-e.insert,e.ins_h=e.window[o],e.ins_h=L(e,e.ins_h,e.window[o+1]);e.insert&&(e.ins_h=L(e,e.ins_h,e.window[o+3-1]),e.prev[o&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=o,o++,e.insert--,!(e.lookahead+e.insert<3)););}while(e.lookahead<N&&0!==e.strm.avail_in)},H=(e,t)=>{let n,r;for(;;){if(e.lookahead<N){if(V(e),e.lookahead<N&&t===h)return 1;if(0===e.lookahead)break}if(n=0,e.lookahead>=3&&(e.ins_h=L(e,e.ins_h,e.window[e.strstart+3-1]),n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!==n&&e.strstart-n<=e.w_size-N&&(e.match_length=W(e,n)),e.match_length>=3)if(r=o(e,e.strstart-e.match_start,e.match_length-3),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=3){e.match_length--;do{e.strstart++,e.ins_h=L(e,e.ins_h,e.window[e.strstart+3-1]),n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart}while(0!=--e.match_length);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=L(e,e.ins_h,e.window[e.strstart+1]);else r=o(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(r&&(F(e,!1),0===e.strm.avail_out))return 1}return e.insert=e.strstart<2?e.strstart:2,t===f?(F(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(F(e,!1),0===e.strm.avail_out)?1:2},K=(e,t)=>{let n,r,i;for(;;){if(e.lookahead<N){if(V(e),e.lookahead<N&&t===h)return 1;if(0===e.lookahead)break}if(n=0,e.lookahead>=3&&(e.ins_h=L(e,e.ins_h,e.window[e.strstart+3-1]),n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=2,0!==n&&e.prev_length<e.max_lazy_match&&e.strstart-n<=e.w_size-N&&(e.match_length=W(e,n),e.match_length<=5&&(e.strategy===k||3===e.match_length&&e.strstart-e.match_start>4096)&&(e.match_length=2)),e.prev_length>=3&&e.match_length<=e.prev_length){i=e.strstart+e.lookahead-3,r=o(e,e.strstart-1-e.prev_match,e.prev_length-3),e.lookahead-=e.prev_length-1,e.prev_length-=2;do{++e.strstart<=i&&(e.ins_h=L(e,e.ins_h,e.window[e.strstart+3-1]),n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart)}while(0!=--e.prev_length);if(e.match_available=0,e.match_length=2,e.strstart++,r&&(F(e,!1),0===e.strm.avail_out))return 1}else if(e.match_available){if(r=o(e,0,e.window[e.strstart-1]),r&&F(e,!1),e.strstart++,e.lookahead--,0===e.strm.avail_out)return 1}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(r=o(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<2?e.strstart:2,t===f?(F(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(F(e,!1),0===e.strm.avail_out)?1:2};function $(e,t,n,r,i){this.good_length=e,this.max_lazy=t,this.nice_length=n,this.max_chain=r,this.func=i}const G=[new $(0,0,0,0,((e,t)=>{let n=65535;for(n>e.pending_buf_size-5&&(n=e.pending_buf_size-5);;){if(e.lookahead<=1){if(V(e),0===e.lookahead&&t===h)return 1;if(0===e.lookahead)break}e.strstart+=e.lookahead,e.lookahead=0;const r=e.block_start+n;if((0===e.strstart||e.strstart>=r)&&(e.lookahead=e.strstart-r,e.strstart=r,F(e,!1),0===e.strm.avail_out))return 1;if(e.strstart-e.block_start>=e.w_size-N&&(F(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,t===f?(F(e,!0),0===e.strm.avail_out?3:4):(e.strstart>e.block_start&&(F(e,!1),e.strm.avail_out),1)})),new $(4,4,8,4,H),new $(4,5,16,8,H),new $(4,6,32,32,H),new $(4,4,16,16,K),new $(8,16,32,32,K),new $(8,16,128,128,K),new $(8,32,128,256,K),new $(32,128,258,1024,K),new $(32,258,258,4096,K)];function J(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=x,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(1146),this.dyn_dtree=new Uint16Array(122),this.bl_tree=new Uint16Array(78),M(this.dyn_ltree),M(this.dyn_dtree),M(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(16),this.heap=new Uint16Array(573),M(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(573),M(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const Z=e=>{if(!e||!e.state)return D(e,y);e.total_in=e.total_out=0,e.data_type=C;const t=e.state;return t.pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=t.wrap?42:O,e.adler=2===t.wrap?0:1,t.last_flush=h,r(t),m},Y=e=>{const t=Z(e);var n;return t===m&&((n=e.state).window_size=2*n.w_size,M(n.head),n.max_lazy_match=G[n.level].max_lazy,n.good_match=G[n.level].good_length,n.nice_match=G[n.level].nice_length,n.max_chain_length=G[n.level].max_chain,n.strstart=0,n.block_start=0,n.lookahead=0,n.insert=0,n.match_length=n.prev_length=2,n.match_available=0,n.ins_h=0),t},Q=(e,t,n,r,i,s)=>{if(!e)return y;let o=1;if(t===b&&(t=6),r<0?(o=0,r=-r):r>15&&(o=2,r-=16),i<1||i>9||n!==x||r<8||r>15||t<0||t>9||s<0||s>S)return D(e,y);8===r&&(r=9);const a=new J;return e.state=a,a.strm=e,a.wrap=o,a.gzhead=null,a.w_bits=r,a.w_size=1<<a.w_bits,a.w_mask=a.w_size-1,a.hash_bits=i+7,a.hash_size=1<<a.hash_bits,a.hash_mask=a.hash_size-1,a.hash_shift=~~((a.hash_bits+3-1)/3),a.window=new Uint8Array(2*a.w_size),a.head=new Uint16Array(a.hash_size),a.prev=new Uint16Array(a.w_size),a.lit_bufsize=1<<i+6,a.pending_buf_size=4*a.lit_bufsize,a.pending_buf=new Uint8Array(a.pending_buf_size),a.d_buf=1*a.lit_bufsize,a.l_buf=3*a.lit_bufsize,a.level=t,a.strategy=s,a.method=n,Y(e)};e.exports.deflateInit=(e,t)=>Q(e,t,x,15,8,I),e.exports.deflateInit2=Q,e.exports.deflateReset=Y,e.exports.deflateResetKeep=Z,e.exports.deflateSetHeader=(e,t)=>e&&e.state?2!==e.state.wrap?y:(e.state.gzhead=t,m):y,e.exports.deflate=(e,t)=>{let n,r;if(!e||!e.state||t>_||t<0)return e?D(e,y):y;const s=e.state;if(!e.output||!e.input&&0!==e.avail_in||s.status===R&&t!==f)return D(e,0===e.avail_out?w:y);s.strm=e;const c=s.last_flush;if(s.last_flush=t,42===s.status)if(2===s.wrap)e.adler=0,j(s,31),j(s,139),j(s,8),s.gzhead?(j(s,(s.gzhead.text?1:0)+(s.gzhead.hcrc?2:0)+(s.gzhead.extra?4:0)+(s.gzhead.name?8:0)+(s.gzhead.comment?16:0)),j(s,255&s.gzhead.time),j(s,s.gzhead.time>>8&255),j(s,s.gzhead.time>>16&255),j(s,s.gzhead.time>>24&255),j(s,9===s.level?2:s.strategy>=E||s.level<2?4:0),j(s,255&s.gzhead.os),s.gzhead.extra&&s.gzhead.extra.length&&(j(s,255&s.gzhead.extra.length),j(s,s.gzhead.extra.length>>8&255)),s.gzhead.hcrc&&(e.adler=l(e.adler,s.pending_buf,s.pending,0)),s.gzindex=0,s.status=69):(j(s,0),j(s,0),j(s,0),j(s,0),j(s,0),j(s,9===s.level?2:s.strategy>=E||s.level<2?4:0),j(s,3),s.status=O);else{let t=x+(s.w_bits-8<<4)<<8,n=-1;n=s.strategy>=E||s.level<2?0:s.level<6?1:6===s.level?2:3,t|=n<<6,0!==s.strstart&&(t|=32),t+=31-t%31,s.status=O,q(s,t),0!==s.strstart&&(q(s,e.adler>>>16),q(s,65535&e.adler)),e.adler=1}if(69===s.status)if(s.gzhead.extra){for(n=s.pending;s.gzindex<(65535&s.gzhead.extra.length)&&(s.pending!==s.pending_buf_size||(s.gzhead.hcrc&&s.pending>n&&(e.adler=l(e.adler,s.pending_buf,s.pending-n,n)),U(e),n=s.pending,s.pending!==s.pending_buf_size));)j(s,255&s.gzhead.extra[s.gzindex]),s.gzindex++;s.gzhead.hcrc&&s.pending>n&&(e.adler=l(e.adler,s.pending_buf,s.pending-n,n)),s.gzindex===s.gzhead.extra.length&&(s.gzindex=0,s.status=73)}else s.status=73;if(73===s.status)if(s.gzhead.name){n=s.pending;do{if(s.pending===s.pending_buf_size&&(s.gzhead.hcrc&&s.pending>n&&(e.adler=l(e.adler,s.pending_buf,s.pending-n,n)),U(e),n=s.pending,s.pending===s.pending_buf_size)){r=1;break}r=s.gzindex<s.gzhead.name.length?255&s.gzhead.name.charCodeAt(s.gzindex++):0,j(s,r)}while(0!==r);s.gzhead.hcrc&&s.pending>n&&(e.adler=l(e.adler,s.pending_buf,s.pending-n,n)),0===r&&(s.gzindex=0,s.status=91)}else s.status=91;if(91===s.status)if(s.gzhead.comment){n=s.pending;do{if(s.pending===s.pending_buf_size&&(s.gzhead.hcrc&&s.pending>n&&(e.adler=l(e.adler,s.pending_buf,s.pending-n,n)),U(e),n=s.pending,s.pending===s.pending_buf_size)){r=1;break}r=s.gzindex<s.gzhead.comment.length?255&s.gzhead.comment.charCodeAt(s.gzindex++):0,j(s,r)}while(0!==r);s.gzhead.hcrc&&s.pending>n&&(e.adler=l(e.adler,s.pending_buf,s.pending-n,n)),0===r&&(s.status=P)}else s.status=P;if(s.status===P&&(s.gzhead.hcrc?(s.pending+2>s.pending_buf_size&&U(e),s.pending+2<=s.pending_buf_size&&(j(s,255&e.adler),j(s,e.adler>>8&255),e.adler=0,s.status=O)):s.status=O),0!==s.pending){if(U(e),0===e.avail_out)return s.last_flush=-1,m}else if(0===e.avail_in&&z(t)<=z(c)&&t!==f)return D(e,w);if(s.status===R&&0!==e.avail_in)return D(e,w);if(0!==e.avail_in||0!==s.lookahead||t!==h&&s.status!==R){let n=s.strategy===E?((e,t)=>{let n;for(;;){if(0===e.lookahead&&(V(e),0===e.lookahead)){if(t===h)return 1;break}if(e.match_length=0,n=o(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,n&&(F(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,t===f?(F(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(F(e,!1),0===e.strm.avail_out)?1:2})(s,t):s.strategy===T?((e,t)=>{let n,r,i,s;const a=e.window;for(;;){if(e.lookahead<=A){if(V(e),e.lookahead<=A&&t===h)return 1;if(0===e.lookahead)break}if(e.match_length=0,e.lookahead>=3&&e.strstart>0&&(i=e.strstart-1,r=a[i],r===a[++i]&&r===a[++i]&&r===a[++i])){s=e.strstart+A;do{}while(r===a[++i]&&r===a[++i]&&r===a[++i]&&r===a[++i]&&r===a[++i]&&r===a[++i]&&r===a[++i]&&r===a[++i]&&i<s);e.match_length=A-(s-i),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=3?(n=o(e,1,e.match_length-3),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(n=o(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),n&&(F(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,t===f?(F(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(F(e,!1),0===e.strm.avail_out)?1:2})(s,t):G[s.level].func(s,t);if(3!==n&&4!==n||(s.status=R),1===n||3===n)return 0===e.avail_out&&(s.last_flush=-1),m;if(2===n&&(t===d?a(s):t!==_&&(i(s,0,0,!1),t===p&&(M(s.head),0===s.lookahead&&(s.strstart=0,s.block_start=0,s.insert=0))),U(e),0===e.avail_out))return s.last_flush=-1,m}return t!==f?m:s.wrap<=0?g:(2===s.wrap?(j(s,255&e.adler),j(s,e.adler>>8&255),j(s,e.adler>>16&255),j(s,e.adler>>24&255),j(s,255&e.total_in),j(s,e.total_in>>8&255),j(s,e.total_in>>16&255),j(s,e.total_in>>24&255)):(q(s,e.adler>>>16),q(s,65535&e.adler)),U(e),s.wrap>0&&(s.wrap=-s.wrap),0!==s.pending?m:g)},e.exports.deflateEnd=e=>{if(!e||!e.state)return y;const t=e.state.status;return 42!==t&&69!==t&&73!==t&&91!==t&&t!==P&&t!==O&&t!==R?D(e,y):(e.state=null,t===O?D(e,v):m)},e.exports.deflateSetDictionary=(e,t)=>{let n=t.length;if(!e||!e.state)return y;const r=e.state,i=r.wrap;if(2===i||1===i&&42!==r.status||r.lookahead)return y;if(1===i&&(e.adler=c(e.adler,t,n,0)),r.wrap=0,n>=r.w_size){0===i&&(M(r.head),r.strstart=0,r.block_start=0,r.insert=0);let e=new Uint8Array(r.w_size);e.set(t.subarray(n-r.w_size,n),0),t=e,n=r.w_size}const s=e.avail_in,o=e.next_in,a=e.input;for(e.avail_in=n,e.next_in=0,e.input=t,V(r);r.lookahead>=3;){let e=r.strstart,t=r.lookahead-2;do{r.ins_h=L(r,r.ins_h,r.window[e+3-1]),r.prev[e&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=e,e++}while(--t);r.strstart=e,r.lookahead=2,V(r)}return r.strstart+=r.lookahead,r.block_start=r.strstart,r.insert=r.lookahead,r.lookahead=0,r.match_length=r.prev_length=2,r.match_available=0,e.next_in=o,e.input=a,e.avail_in=s,r.wrap=i,m},e.exports.deflateInfo="pako deflate (from Nodeca project)"},2442:e=>{"use strict";e.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},400:e=>{"use strict";e.exports=function(e,t){let n,r,i,s,o,a,c,l,u,h,d,p,f,_,m,g,y,v,w,b,k,E,T,S;const I=e.state;n=e.next_in,T=e.input,r=n+(e.avail_in-5),i=e.next_out,S=e.output,s=i-(t-e.avail_out),o=i+(e.avail_out-257),a=I.dmax,c=I.wsize,l=I.whave,u=I.wnext,h=I.window,d=I.hold,p=I.bits,f=I.lencode,_=I.distcode,m=(1<<I.lenbits)-1,g=(1<<I.distbits)-1;e:do{p<15&&(d+=T[n++]<<p,p+=8,d+=T[n++]<<p,p+=8),y=f[d&m];t:for(;;){if(v=y>>>24,d>>>=v,p-=v,v=y>>>16&255,0===v)S[i++]=65535&y;else{if(!(16&v)){if(0==(64&v)){y=f[(65535&y)+(d&(1<<v)-1)];continue t}if(32&v){I.mode=12;break e}e.msg="invalid literal/length code",I.mode=30;break e}w=65535&y,v&=15,v&&(p<v&&(d+=T[n++]<<p,p+=8),w+=d&(1<<v)-1,d>>>=v,p-=v),p<15&&(d+=T[n++]<<p,p+=8,d+=T[n++]<<p,p+=8),y=_[d&g];n:for(;;){if(v=y>>>24,d>>>=v,p-=v,v=y>>>16&255,!(16&v)){if(0==(64&v)){y=_[(65535&y)+(d&(1<<v)-1)];continue n}e.msg="invalid distance code",I.mode=30;break e}if(b=65535&y,v&=15,p<v&&(d+=T[n++]<<p,p+=8,p<v&&(d+=T[n++]<<p,p+=8)),b+=d&(1<<v)-1,b>a){e.msg="invalid distance too far back",I.mode=30;break e}if(d>>>=v,p-=v,v=i-s,b>v){if(v=b-v,v>l&&I.sane){e.msg="invalid distance too far back",I.mode=30;break e}if(k=0,E=h,0===u){if(k+=c-v,v<w){w-=v;do{S[i++]=h[k++]}while(--v);k=i-b,E=S}}else if(u<v){if(k+=c+u-v,v-=u,v<w){w-=v;do{S[i++]=h[k++]}while(--v);if(k=0,u<w){v=u,w-=v;do{S[i++]=h[k++]}while(--v);k=i-b,E=S}}}else if(k+=u-v,v<w){w-=v;do{S[i++]=h[k++]}while(--v);k=i-b,E=S}for(;w>2;)S[i++]=E[k++],S[i++]=E[k++],S[i++]=E[k++],w-=3;w&&(S[i++]=E[k++],w>1&&(S[i++]=E[k++]))}else{k=i-b;do{S[i++]=S[k++],S[i++]=S[k++],S[i++]=S[k++],w-=3}while(w>2);w&&(S[i++]=S[k++],w>1&&(S[i++]=S[k++]))}break}}break}}while(n<r&&i<o);w=p>>3,n-=w,p-=w<<3,d&=(1<<p)-1,e.next_in=n,e.next_out=i,e.avail_in=n<r?r-n+5:5-(n-r),e.avail_out=i<o?o-i+257:257-(i-o),I.hold=d,I.bits=p}},7387:(e,t,n)=>{"use strict";const r=n(5775),i=n(2576),s=n(400),o=n(1017),{Z_FINISH:a,Z_BLOCK:c,Z_TREES:l,Z_OK:u,Z_STREAM_END:h,Z_NEED_DICT:d,Z_STREAM_ERROR:p,Z_DATA_ERROR:f,Z_MEM_ERROR:_,Z_BUF_ERROR:m,Z_DEFLATED:g}=n(8681),y=12,v=30,w=e=>(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24);function b(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const k=e=>{if(!e||!e.state)return p;const t=e.state;return e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=1,t.last=0,t.havedict=0,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new Int32Array(852),t.distcode=t.distdyn=new Int32Array(592),t.sane=1,t.back=-1,u},E=e=>{if(!e||!e.state)return p;const t=e.state;return t.wsize=0,t.whave=0,t.wnext=0,k(e)},T=(e,t)=>{let n;if(!e||!e.state)return p;const r=e.state;return t<0?(n=0,t=-t):(n=1+(t>>4),t<48&&(t&=15)),t&&(t<8||t>15)?p:(null!==r.window&&r.wbits!==t&&(r.window=null),r.wrap=n,r.wbits=t,E(e))},S=(e,t)=>{if(!e)return p;const n=new b;e.state=n,n.window=null;const r=T(e,t);return r!==u&&(e.state=null),r};let I,C,x=!0;const A=e=>{if(x){I=new Int32Array(512),C=new Int32Array(32);let t=0;for(;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(o(1,e.lens,0,288,I,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;o(2,e.lens,0,32,C,0,e.work,{bits:5}),x=!1}e.lencode=I,e.lenbits=9,e.distcode=C,e.distbits=5},N=(e,t,n,r)=>{let i;const s=e.state;return null===s.window&&(s.wsize=1<<s.wbits,s.wnext=0,s.whave=0,s.window=new Uint8Array(s.wsize)),r>=s.wsize?(s.window.set(t.subarray(n-s.wsize,n),0),s.wnext=0,s.whave=s.wsize):(i=s.wsize-s.wnext,i>r&&(i=r),s.window.set(t.subarray(n-r,n-r+i),s.wnext),(r-=i)?(s.window.set(t.subarray(n-r,n),0),s.wnext=r,s.whave=s.wsize):(s.wnext+=i,s.wnext===s.wsize&&(s.wnext=0),s.whave<s.wsize&&(s.whave+=i))),0};e.exports.inflateReset=E,e.exports.inflateReset2=T,e.exports.inflateResetKeep=k,e.exports.inflateInit=e=>S(e,15),e.exports.inflateInit2=S,e.exports.inflate=(e,t)=>{let n,b,k,E,T,S,I,C,x,P,O,R,D,z,M,L,U,F,j,q,B,W,V=0;const H=new Uint8Array(4);let K,$;const G=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(!e||!e.state||!e.output||!e.input&&0!==e.avail_in)return p;n=e.state,n.mode===y&&(n.mode=13),T=e.next_out,k=e.output,I=e.avail_out,E=e.next_in,b=e.input,S=e.avail_in,C=n.hold,x=n.bits,P=S,O=I,W=u;e:for(;;)switch(n.mode){case 1:if(0===n.wrap){n.mode=13;break}for(;x<16;){if(0===S)break e;S--,C+=b[E++]<<x,x+=8}if(2&n.wrap&&35615===C){n.check=0,H[0]=255&C,H[1]=C>>>8&255,n.check=i(n.check,H,2,0),C=0,x=0,n.mode=2;break}if(n.flags=0,n.head&&(n.head.done=!1),!(1&n.wrap)||(((255&C)<<8)+(C>>8))%31){e.msg="incorrect header check",n.mode=v;break}if((15&C)!==g){e.msg="unknown compression method",n.mode=v;break}if(C>>>=4,x-=4,B=8+(15&C),0===n.wbits)n.wbits=B;else if(B>n.wbits){e.msg="invalid window size",n.mode=v;break}n.dmax=1<<n.wbits,e.adler=n.check=1,n.mode=512&C?10:y,C=0,x=0;break;case 2:for(;x<16;){if(0===S)break e;S--,C+=b[E++]<<x,x+=8}if(n.flags=C,(255&n.flags)!==g){e.msg="unknown compression method",n.mode=v;break}if(57344&n.flags){e.msg="unknown header flags set",n.mode=v;break}n.head&&(n.head.text=C>>8&1),512&n.flags&&(H[0]=255&C,H[1]=C>>>8&255,n.check=i(n.check,H,2,0)),C=0,x=0,n.mode=3;case 3:for(;x<32;){if(0===S)break e;S--,C+=b[E++]<<x,x+=8}n.head&&(n.head.time=C),512&n.flags&&(H[0]=255&C,H[1]=C>>>8&255,H[2]=C>>>16&255,H[3]=C>>>24&255,n.check=i(n.check,H,4,0)),C=0,x=0,n.mode=4;case 4:for(;x<16;){if(0===S)break e;S--,C+=b[E++]<<x,x+=8}n.head&&(n.head.xflags=255&C,n.head.os=C>>8),512&n.flags&&(H[0]=255&C,H[1]=C>>>8&255,n.check=i(n.check,H,2,0)),C=0,x=0,n.mode=5;case 5:if(1024&n.flags){for(;x<16;){if(0===S)break e;S--,C+=b[E++]<<x,x+=8}n.length=C,n.head&&(n.head.extra_len=C),512&n.flags&&(H[0]=255&C,H[1]=C>>>8&255,n.check=i(n.check,H,2,0)),C=0,x=0}else n.head&&(n.head.extra=null);n.mode=6;case 6:if(1024&n.flags&&(R=n.length,R>S&&(R=S),R&&(n.head&&(B=n.head.extra_len-n.length,n.head.extra||(n.head.extra=new Uint8Array(n.head.extra_len)),n.head.extra.set(b.subarray(E,E+R),B)),512&n.flags&&(n.check=i(n.check,b,R,E)),S-=R,E+=R,n.length-=R),n.length))break e;n.length=0,n.mode=7;case 7:if(2048&n.flags){if(0===S)break e;R=0;do{B=b[E+R++],n.head&&B&&n.length<65536&&(n.head.name+=String.fromCharCode(B))}while(B&&R<S);if(512&n.flags&&(n.check=i(n.check,b,R,E)),S-=R,E+=R,B)break e}else n.head&&(n.head.name=null);n.length=0,n.mode=8;case 8:if(4096&n.flags){if(0===S)break e;R=0;do{B=b[E+R++],n.head&&B&&n.length<65536&&(n.head.comment+=String.fromCharCode(B))}while(B&&R<S);if(512&n.flags&&(n.check=i(n.check,b,R,E)),S-=R,E+=R,B)break e}else n.head&&(n.head.comment=null);n.mode=9;case 9:if(512&n.flags){for(;x<16;){if(0===S)break e;S--,C+=b[E++]<<x,x+=8}if(C!==(65535&n.check)){e.msg="header crc mismatch",n.mode=v;break}C=0,x=0}n.head&&(n.head.hcrc=n.flags>>9&1,n.head.done=!0),e.adler=n.check=0,n.mode=y;break;case 10:for(;x<32;){if(0===S)break e;S--,C+=b[E++]<<x,x+=8}e.adler=n.check=w(C),C=0,x=0,n.mode=11;case 11:if(0===n.havedict)return e.next_out=T,e.avail_out=I,e.next_in=E,e.avail_in=S,n.hold=C,n.bits=x,d;e.adler=n.check=1,n.mode=y;case y:if(t===c||t===l)break e;case 13:if(n.last){C>>>=7&x,x-=7&x,n.mode=27;break}for(;x<3;){if(0===S)break e;S--,C+=b[E++]<<x,x+=8}switch(n.last=1&C,C>>>=1,x-=1,3&C){case 0:n.mode=14;break;case 1:if(A(n),n.mode=20,t===l){C>>>=2,x-=2;break e}break;case 2:n.mode=17;break;case 3:e.msg="invalid block type",n.mode=v}C>>>=2,x-=2;break;case 14:for(C>>>=7&x,x-=7&x;x<32;){if(0===S)break e;S--,C+=b[E++]<<x,x+=8}if((65535&C)!=(C>>>16^65535)){e.msg="invalid stored block lengths",n.mode=v;break}if(n.length=65535&C,C=0,x=0,n.mode=15,t===l)break e;case 15:n.mode=16;case 16:if(R=n.length,R){if(R>S&&(R=S),R>I&&(R=I),0===R)break e;k.set(b.subarray(E,E+R),T),S-=R,E+=R,I-=R,T+=R,n.length-=R;break}n.mode=y;break;case 17:for(;x<14;){if(0===S)break e;S--,C+=b[E++]<<x,x+=8}if(n.nlen=257+(31&C),C>>>=5,x-=5,n.ndist=1+(31&C),C>>>=5,x-=5,n.ncode=4+(15&C),C>>>=4,x-=4,n.nlen>286||n.ndist>30){e.msg="too many length or distance symbols",n.mode=v;break}n.have=0,n.mode=18;case 18:for(;n.have<n.ncode;){for(;x<3;){if(0===S)break e;S--,C+=b[E++]<<x,x+=8}n.lens[G[n.have++]]=7&C,C>>>=3,x-=3}for(;n.have<19;)n.lens[G[n.have++]]=0;if(n.lencode=n.lendyn,n.lenbits=7,K={bits:n.lenbits},W=o(0,n.lens,0,19,n.lencode,0,n.work,K),n.lenbits=K.bits,W){e.msg="invalid code lengths set",n.mode=v;break}n.have=0,n.mode=19;case 19:for(;n.have<n.nlen+n.ndist;){for(;V=n.lencode[C&(1<<n.lenbits)-1],M=V>>>24,L=V>>>16&255,U=65535&V,!(M<=x);){if(0===S)break e;S--,C+=b[E++]<<x,x+=8}if(U<16)C>>>=M,x-=M,n.lens[n.have++]=U;else{if(16===U){for($=M+2;x<$;){if(0===S)break e;S--,C+=b[E++]<<x,x+=8}if(C>>>=M,x-=M,0===n.have){e.msg="invalid bit length repeat",n.mode=v;break}B=n.lens[n.have-1],R=3+(3&C),C>>>=2,x-=2}else if(17===U){for($=M+3;x<$;){if(0===S)break e;S--,C+=b[E++]<<x,x+=8}C>>>=M,x-=M,B=0,R=3+(7&C),C>>>=3,x-=3}else{for($=M+7;x<$;){if(0===S)break e;S--,C+=b[E++]<<x,x+=8}C>>>=M,x-=M,B=0,R=11+(127&C),C>>>=7,x-=7}if(n.have+R>n.nlen+n.ndist){e.msg="invalid bit length repeat",n.mode=v;break}for(;R--;)n.lens[n.have++]=B}}if(n.mode===v)break;if(0===n.lens[256]){e.msg="invalid code -- missing end-of-block",n.mode=v;break}if(n.lenbits=9,K={bits:n.lenbits},W=o(1,n.lens,0,n.nlen,n.lencode,0,n.work,K),n.lenbits=K.bits,W){e.msg="invalid literal/lengths set",n.mode=v;break}if(n.distbits=6,n.distcode=n.distdyn,K={bits:n.distbits},W=o(2,n.lens,n.nlen,n.ndist,n.distcode,0,n.work,K),n.distbits=K.bits,W){e.msg="invalid distances set",n.mode=v;break}if(n.mode=20,t===l)break e;case 20:n.mode=21;case 21:if(S>=6&&I>=258){e.next_out=T,e.avail_out=I,e.next_in=E,e.avail_in=S,n.hold=C,n.bits=x,s(e,O),T=e.next_out,k=e.output,I=e.avail_out,E=e.next_in,b=e.input,S=e.avail_in,C=n.hold,x=n.bits,n.mode===y&&(n.back=-1);break}for(n.back=0;V=n.lencode[C&(1<<n.lenbits)-1],M=V>>>24,L=V>>>16&255,U=65535&V,!(M<=x);){if(0===S)break e;S--,C+=b[E++]<<x,x+=8}if(L&&0==(240&L)){for(F=M,j=L,q=U;V=n.lencode[q+((C&(1<<F+j)-1)>>F)],M=V>>>24,L=V>>>16&255,U=65535&V,!(F+M<=x);){if(0===S)break e;S--,C+=b[E++]<<x,x+=8}C>>>=F,x-=F,n.back+=F}if(C>>>=M,x-=M,n.back+=M,n.length=U,0===L){n.mode=26;break}if(32&L){n.back=-1,n.mode=y;break}if(64&L){e.msg="invalid literal/length code",n.mode=v;break}n.extra=15&L,n.mode=22;case 22:if(n.extra){for($=n.extra;x<$;){if(0===S)break e;S--,C+=b[E++]<<x,x+=8}n.length+=C&(1<<n.extra)-1,C>>>=n.extra,x-=n.extra,n.back+=n.extra}n.was=n.length,n.mode=23;case 23:for(;V=n.distcode[C&(1<<n.distbits)-1],M=V>>>24,L=V>>>16&255,U=65535&V,!(M<=x);){if(0===S)break e;S--,C+=b[E++]<<x,x+=8}if(0==(240&L)){for(F=M,j=L,q=U;V=n.distcode[q+((C&(1<<F+j)-1)>>F)],M=V>>>24,L=V>>>16&255,U=65535&V,!(F+M<=x);){if(0===S)break e;S--,C+=b[E++]<<x,x+=8}C>>>=F,x-=F,n.back+=F}if(C>>>=M,x-=M,n.back+=M,64&L){e.msg="invalid distance code",n.mode=v;break}n.offset=U,n.extra=15&L,n.mode=24;case 24:if(n.extra){for($=n.extra;x<$;){if(0===S)break e;S--,C+=b[E++]<<x,x+=8}n.offset+=C&(1<<n.extra)-1,C>>>=n.extra,x-=n.extra,n.back+=n.extra}if(n.offset>n.dmax){e.msg="invalid distance too far back",n.mode=v;break}n.mode=25;case 25:if(0===I)break e;if(R=O-I,n.offset>R){if(R=n.offset-R,R>n.whave&&n.sane){e.msg="invalid distance too far back",n.mode=v;break}R>n.wnext?(R-=n.wnext,D=n.wsize-R):D=n.wnext-R,R>n.length&&(R=n.length),z=n.window}else z=k,D=T-n.offset,R=n.length;R>I&&(R=I),I-=R,n.length-=R;do{k[T++]=z[D++]}while(--R);0===n.length&&(n.mode=21);break;case 26:if(0===I)break e;k[T++]=n.length,I--,n.mode=21;break;case 27:if(n.wrap){for(;x<32;){if(0===S)break e;S--,C|=b[E++]<<x,x+=8}if(O-=I,e.total_out+=O,n.total+=O,O&&(e.adler=n.check=n.flags?i(n.check,k,O,T-O):r(n.check,k,O,T-O)),O=I,(n.flags?C:w(C))!==n.check){e.msg="incorrect data check",n.mode=v;break}C=0,x=0}n.mode=28;case 28:if(n.wrap&&n.flags){for(;x<32;){if(0===S)break e;S--,C+=b[E++]<<x,x+=8}if(C!==(4294967295&n.total)){e.msg="incorrect length check",n.mode=v;break}C=0,x=0}n.mode=29;case 29:W=h;break e;case v:W=f;break e;case 31:return _;default:return p}return e.next_out=T,e.avail_out=I,e.next_in=E,e.avail_in=S,n.hold=C,n.bits=x,(n.wsize||O!==e.avail_out&&n.mode<v&&(n.mode<27||t!==a))&&N(e,e.output,e.next_out,O-e.avail_out)?(n.mode=31,_):(P-=e.avail_in,O-=e.avail_out,e.total_in+=P,e.total_out+=O,n.total+=O,n.wrap&&O&&(e.adler=n.check=n.flags?i(n.check,k,O,e.next_out-O):r(n.check,k,O,e.next_out-O)),e.data_type=n.bits+(n.last?64:0)+(n.mode===y?128:0)+(20===n.mode||15===n.mode?256:0),(0===P&&0===O||t===a)&&W===u&&(W=m),W)},e.exports.inflateEnd=e=>{if(!e||!e.state)return p;let t=e.state;return t.window&&(t.window=null),e.state=null,u},e.exports.inflateGetHeader=(e,t)=>{if(!e||!e.state)return p;const n=e.state;return 0==(2&n.wrap)?p:(n.head=t,t.done=!1,u)},e.exports.inflateSetDictionary=(e,t)=>{const n=t.length;let i,s,o;return e&&e.state?(i=e.state,0!==i.wrap&&11!==i.mode?p:11===i.mode&&(s=1,s=r(s,t,n,0),s!==i.check)?f:(o=N(e,t,n,n),o?(i.mode=31,_):(i.havedict=1,u))):p},e.exports.inflateInfo="pako inflate (from Nodeca project)"},1017:e=>{"use strict";const t=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),n=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),r=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),i=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]);e.exports=(e,s,o,a,c,l,u,h)=>{const d=h.bits;let p,f,_,m,g,y,v=0,w=0,b=0,k=0,E=0,T=0,S=0,I=0,C=0,x=0,A=null,N=0;const P=new Uint16Array(16),O=new Uint16Array(16);let R,D,z,M=null,L=0;for(v=0;v<=15;v++)P[v]=0;for(w=0;w<a;w++)P[s[o+w]]++;for(E=d,k=15;k>=1&&0===P[k];k--);if(E>k&&(E=k),0===k)return c[l++]=20971520,c[l++]=20971520,h.bits=1,0;for(b=1;b<k&&0===P[b];b++);for(E<b&&(E=b),I=1,v=1;v<=15;v++)if(I<<=1,I-=P[v],I<0)return-1;if(I>0&&(0===e||1!==k))return-1;for(O[1]=0,v=1;v<15;v++)O[v+1]=O[v]+P[v];for(w=0;w<a;w++)0!==s[o+w]&&(u[O[s[o+w]]++]=w);if(0===e?(A=M=u,y=19):1===e?(A=t,N-=257,M=n,L-=257,y=256):(A=r,M=i,y=-1),x=0,w=0,v=b,g=l,T=E,S=0,_=-1,C=1<<E,m=C-1,1===e&&C>852||2===e&&C>592)return 1;for(;;){R=v-S,u[w]<y?(D=0,z=u[w]):u[w]>y?(D=M[L+u[w]],z=A[N+u[w]]):(D=96,z=0),p=1<<v-S,f=1<<T,b=f;do{f-=p,c[g+(x>>S)+f]=R<<24|D<<16|z|0}while(0!==f);for(p=1<<v-1;x&p;)p>>=1;if(0!==p?(x&=p-1,x+=p):x=0,w++,0==--P[v]){if(v===k)break;v=s[o+u[w]]}if(v>E&&(x&m)!==_){for(0===S&&(S=E),g+=b,T=v-S,I=1<<T;T+S<k&&(I-=P[T+S],!(I<=0));)T++,I<<=1;if(C+=1<<T,1===e&&C>852||2===e&&C>592)return 1;_=x&m,c[_]=E<<24|T<<16|g-l|0}}return 0!==x&&(c[g+x]=v-S<<24|64<<16|0),h.bits=E,0}},2587:e=>{"use strict";e.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},1443:e=>{"use strict";function t(e){let t=e.length;for(;--t>=0;)e[t]=0}const n=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),r=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),i=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),s=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),o=new Array(576);t(o);const a=new Array(60);t(a);const c=new Array(512);t(c);const l=new Array(256);t(l);const u=new Array(29);t(u);const h=new Array(30);function d(e,t,n,r,i){this.static_tree=e,this.extra_bits=t,this.extra_base=n,this.elems=r,this.max_length=i,this.has_stree=e&&e.length}let p,f,_;function m(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}t(h);const g=e=>e<256?c[e]:c[256+(e>>>7)],y=(e,t)=>{e.pending_buf[e.pending++]=255&t,e.pending_buf[e.pending++]=t>>>8&255},v=(e,t,n)=>{e.bi_valid>16-n?(e.bi_buf|=t<<e.bi_valid&65535,y(e,e.bi_buf),e.bi_buf=t>>16-e.bi_valid,e.bi_valid+=n-16):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=n)},w=(e,t,n)=>{v(e,n[2*t],n[2*t+1])},b=(e,t)=>{let n=0;do{n|=1&e,e>>>=1,n<<=1}while(--t>0);return n>>>1},k=(e,t,n)=>{const r=new Array(16);let i,s,o=0;for(i=1;i<=15;i++)r[i]=o=o+n[i-1]<<1;for(s=0;s<=t;s++){let t=e[2*s+1];0!==t&&(e[2*s]=b(r[t]++,t))}},E=e=>{let t;for(t=0;t<286;t++)e.dyn_ltree[2*t]=0;for(t=0;t<30;t++)e.dyn_dtree[2*t]=0;for(t=0;t<19;t++)e.bl_tree[2*t]=0;e.dyn_ltree[512]=1,e.opt_len=e.static_len=0,e.last_lit=e.matches=0},T=e=>{e.bi_valid>8?y(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0},S=(e,t,n,r)=>{const i=2*t,s=2*n;return e[i]<e[s]||e[i]===e[s]&&r[t]<=r[n]},I=(e,t,n)=>{const r=e.heap[n];let i=n<<1;for(;i<=e.heap_len&&(i<e.heap_len&&S(t,e.heap[i+1],e.heap[i],e.depth)&&i++,!S(t,r,e.heap[i],e.depth));)e.heap[n]=e.heap[i],n=i,i<<=1;e.heap[n]=r},C=(e,t,i)=>{let s,o,a,c,d=0;if(0!==e.last_lit)do{s=e.pending_buf[e.d_buf+2*d]<<8|e.pending_buf[e.d_buf+2*d+1],o=e.pending_buf[e.l_buf+d],d++,0===s?w(e,o,t):(a=l[o],w(e,a+256+1,t),c=n[a],0!==c&&(o-=u[a],v(e,o,c)),s--,a=g(s),w(e,a,i),c=r[a],0!==c&&(s-=h[a],v(e,s,c)))}while(d<e.last_lit);w(e,256,t)},x=(e,t)=>{const n=t.dyn_tree,r=t.stat_desc.static_tree,i=t.stat_desc.has_stree,s=t.stat_desc.elems;let o,a,c,l=-1;for(e.heap_len=0,e.heap_max=573,o=0;o<s;o++)0!==n[2*o]?(e.heap[++e.heap_len]=l=o,e.depth[o]=0):n[2*o+1]=0;for(;e.heap_len<2;)c=e.heap[++e.heap_len]=l<2?++l:0,n[2*c]=1,e.depth[c]=0,e.opt_len--,i&&(e.static_len-=r[2*c+1]);for(t.max_code=l,o=e.heap_len>>1;o>=1;o--)I(e,n,o);c=s;do{o=e.heap[1],e.heap[1]=e.heap[e.heap_len--],I(e,n,1),a=e.heap[1],e.heap[--e.heap_max]=o,e.heap[--e.heap_max]=a,n[2*c]=n[2*o]+n[2*a],e.depth[c]=(e.depth[o]>=e.depth[a]?e.depth[o]:e.depth[a])+1,n[2*o+1]=n[2*a+1]=c,e.heap[1]=c++,I(e,n,1)}while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],((e,t)=>{const n=t.dyn_tree,r=t.max_code,i=t.stat_desc.static_tree,s=t.stat_desc.has_stree,o=t.stat_desc.extra_bits,a=t.stat_desc.extra_base,c=t.stat_desc.max_length;let l,u,h,d,p,f,_=0;for(d=0;d<=15;d++)e.bl_count[d]=0;for(n[2*e.heap[e.heap_max]+1]=0,l=e.heap_max+1;l<573;l++)u=e.heap[l],d=n[2*n[2*u+1]+1]+1,d>c&&(d=c,_++),n[2*u+1]=d,u>r||(e.bl_count[d]++,p=0,u>=a&&(p=o[u-a]),f=n[2*u],e.opt_len+=f*(d+p),s&&(e.static_len+=f*(i[2*u+1]+p)));if(0!==_){do{for(d=c-1;0===e.bl_count[d];)d--;e.bl_count[d]--,e.bl_count[d+1]+=2,e.bl_count[c]--,_-=2}while(_>0);for(d=c;0!==d;d--)for(u=e.bl_count[d];0!==u;)h=e.heap[--l],h>r||(n[2*h+1]!==d&&(e.opt_len+=(d-n[2*h+1])*n[2*h],n[2*h+1]=d),u--)}})(e,t),k(n,l,e.bl_count)},A=(e,t,n)=>{let r,i,s=-1,o=t[1],a=0,c=7,l=4;for(0===o&&(c=138,l=3),t[2*(n+1)+1]=65535,r=0;r<=n;r++)i=o,o=t[2*(r+1)+1],++a<c&&i===o||(a<l?e.bl_tree[2*i]+=a:0!==i?(i!==s&&e.bl_tree[2*i]++,e.bl_tree[32]++):a<=10?e.bl_tree[34]++:e.bl_tree[36]++,a=0,s=i,0===o?(c=138,l=3):i===o?(c=6,l=3):(c=7,l=4))},N=(e,t,n)=>{let r,i,s=-1,o=t[1],a=0,c=7,l=4;for(0===o&&(c=138,l=3),r=0;r<=n;r++)if(i=o,o=t[2*(r+1)+1],!(++a<c&&i===o)){if(a<l)do{w(e,i,e.bl_tree)}while(0!=--a);else 0!==i?(i!==s&&(w(e,i,e.bl_tree),a--),w(e,16,e.bl_tree),v(e,a-3,2)):a<=10?(w(e,17,e.bl_tree),v(e,a-3,3)):(w(e,18,e.bl_tree),v(e,a-11,7));a=0,s=i,0===o?(c=138,l=3):i===o?(c=6,l=3):(c=7,l=4)}};let P=!1;const O=(e,t,n,r)=>{v(e,0+(r?1:0),3),((e,t,n,r)=>{T(e),y(e,n),y(e,~n),e.pending_buf.set(e.window.subarray(t,t+n),e.pending),e.pending+=n})(e,t,n)};e.exports._tr_init=e=>{P||((()=>{let e,t,s,m,g;const y=new Array(16);for(s=0,m=0;m<28;m++)for(u[m]=s,e=0;e<1<<n[m];e++)l[s++]=m;for(l[s-1]=m,g=0,m=0;m<16;m++)for(h[m]=g,e=0;e<1<<r[m];e++)c[g++]=m;for(g>>=7;m<30;m++)for(h[m]=g<<7,e=0;e<1<<r[m]-7;e++)c[256+g++]=m;for(t=0;t<=15;t++)y[t]=0;for(e=0;e<=143;)o[2*e+1]=8,e++,y[8]++;for(;e<=255;)o[2*e+1]=9,e++,y[9]++;for(;e<=279;)o[2*e+1]=7,e++,y[7]++;for(;e<=287;)o[2*e+1]=8,e++,y[8]++;for(k(o,287,y),e=0;e<30;e++)a[2*e+1]=5,a[2*e]=b(e,5);p=new d(o,n,257,286,15),f=new d(a,r,0,30,15),_=new d(new Array(0),i,0,19,7)})(),P=!0),e.l_desc=new m(e.dyn_ltree,p),e.d_desc=new m(e.dyn_dtree,f),e.bl_desc=new m(e.bl_tree,_),e.bi_buf=0,e.bi_valid=0,E(e)},e.exports._tr_stored_block=O,e.exports._tr_flush_block=(e,t,n,r)=>{let i,c,l=0;e.level>0?(2===e.strm.data_type&&(e.strm.data_type=(e=>{let t,n=4093624447;for(t=0;t<=31;t++,n>>>=1)if(1&n&&0!==e.dyn_ltree[2*t])return 0;if(0!==e.dyn_ltree[18]||0!==e.dyn_ltree[20]||0!==e.dyn_ltree[26])return 1;for(t=32;t<256;t++)if(0!==e.dyn_ltree[2*t])return 1;return 0})(e)),x(e,e.l_desc),x(e,e.d_desc),l=(e=>{let t;for(A(e,e.dyn_ltree,e.l_desc.max_code),A(e,e.dyn_dtree,e.d_desc.max_code),x(e,e.bl_desc),t=18;t>=3&&0===e.bl_tree[2*s[t]+1];t--);return e.opt_len+=3*(t+1)+5+5+4,t})(e),i=e.opt_len+3+7>>>3,c=e.static_len+3+7>>>3,c<=i&&(i=c)):i=c=n+5,n+4<=i&&-1!==t?O(e,t,n,r):4===e.strategy||c===i?(v(e,2+(r?1:0),3),C(e,o,a)):(v(e,4+(r?1:0),3),((e,t,n,r)=>{let i;for(v(e,t-257,5),v(e,n-1,5),v(e,r-4,4),i=0;i<r;i++)v(e,e.bl_tree[2*s[i]+1],3);N(e,e.dyn_ltree,t-1),N(e,e.dyn_dtree,n-1)})(e,e.l_desc.max_code+1,e.d_desc.max_code+1,l+1),C(e,e.dyn_ltree,e.dyn_dtree)),E(e),r&&T(e)},e.exports._tr_tally=(e,t,n)=>(e.pending_buf[e.d_buf+2*e.last_lit]=t>>>8&255,e.pending_buf[e.d_buf+2*e.last_lit+1]=255&t,e.pending_buf[e.l_buf+e.last_lit]=255&n,e.last_lit++,0===t?e.dyn_ltree[2*n]++:(e.matches++,t--,e.dyn_ltree[2*(l[n]+256+1)]++,e.dyn_dtree[2*g(t)]++),e.last_lit===e.lit_bufsize-1),e.exports._tr_align=e=>{v(e,2,3),w(e,256,o),(e=>{16===e.bi_valid?(y(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=255&e.bi_buf,e.bi_buf>>=8,e.bi_valid-=8)})(e)}},4213:e=>{"use strict";e.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},9105:function(e){e.exports=function(){"use strict";function e(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function t(t){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?e(Object(r),!0).forEach((function(e){s(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):e(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function i(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e){return{all:e=e||new Map,on:function(t,n){var r=e.get(t);r?r.push(n):e.set(t,[n])},off:function(t,n){var r=e.get(t);r&&(n?r.splice(r.indexOf(n)>>>0,1):e.set(t,[]))},emit:function(t,n){var r=e.get(t);r&&r.slice().map((function(e){e(n)})),(r=e.get("*"))&&r.slice().map((function(e){e(t,n)}))}}}var a="expiry",c=function(e){if(e)throw new Error("Cannot use disposed instance.")},l={expiryCheckInterval:100},u=function(){function e(){var r=this,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};n(this,e),s(this,"expire",(function(){c(r.disposed);for(var e=Date.now(),t=e;t>=r.lastExpiredTime;t-=1){var n=r.queue[t];n&&(delete r.queue[t],n.forEach((function(e){var t=e.key;return(0,e.onExpire)(t)})))}r.lastExpiredTime=e})),this.config=t(t({},l),i),this.queue={},this.disposed=!1,this.lastExpiredTime=Date.now()-1;var o=this.config.expiryCheckInterval;this.timer=setInterval(this.expire,o)}return i(e,[{key:"add",value:function(e,t,n){return c(this.disposed),this.queue[e]||(this.queue[e]=[]),this.queue[e].push({key:t,onExpire:n}),!0}},{key:"remove",value:function(e,t){c(this.disposed);var n=this.queue[e];if(n){var r=n.filter((function(e){return e.key!==t}));return r.length?this.queue[e]=r:delete this.queue[e],!0}return!1}},{key:"dispose",value:function(){return c(this.disposed),clearInterval(this.timer),this.timer=null,this.queue={},this.disposed=!0,!0}}]),e}(),h={defaultCacheExpiryIn:6e4,expiryCheckInterval:100};return function(){function e(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:u;n(this,e),this.config=t(t({},h),r);var s=o(),a=[s.on,s.off,s.emit];this.on=a[0],this.off=a[1],this.emit=a[2],this.cacheStore={},this.disposed=!1;var c=this.config.expiryCheckInterval;this.cacheExpirer=new i({expiryCheckInterval:c})}return i(e,[{key:"put",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.config.defaultCacheExpiryIn;c(this.disposed),this.cacheStore[t]&&this.remove(t);var i=Date.now(),s=r?i+r:null,o={value:n,addedAt:i,expiryAt:s};if(this.cacheStore[t]=o,s){var l=function(){e.remove(t),e.emit(a,{key:t,data:e.cacheStore[t]})};this.cacheExpirer.add(s,t,l)}return this.emit("add",{key:t,data:o}),o}},{key:"get",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";c(this.disposed);var t=this.cacheStore[e];return t?(this.emit("get",{key:e,data:t}),t):null}},{key:"remove",value:function(e){c(this.disposed);var t=this.cacheStore[e];if(t){delete this.cacheStore[e];var n=t.expiryAt;return this.cacheExpirer.remove(n,e),this.emit("remove",{key:e,data:t}),!0}return!1}},{key:"dispose",value:function(){var e=this;return c(this.disposed),Object.keys(this.cacheStore).forEach((function(t){return e.remove(t)})),this.emit("clear",{}),this.cacheExpirer.dispose(),this.disposed=!0,!0}}]),e}()}()},7588:e=>{var t=function(e){"use strict";var t,n=Object.prototype,r=n.hasOwnProperty,i="function"==typeof Symbol?Symbol:{},s=i.iterator||"@@iterator",o=i.asyncIterator||"@@asyncIterator",a=i.toStringTag||"@@toStringTag";function c(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(e){c=function(e,t,n){return e[t]=n}}function l(e,t,n,r){var i=t&&t.prototype instanceof m?t:m,s=Object.create(i.prototype),o=new x(r||[]);return s._invoke=function(e,t,n){var r=h;return function(i,s){if(r===p)throw new Error("Generator is already running");if(r===f){if("throw"===i)throw s;return N()}for(n.method=i,n.arg=s;;){var o=n.delegate;if(o){var a=S(o,n);if(a){if(a===_)continue;return a}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(r===h)throw r=f,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r=p;var c=u(e,t,n);if("normal"===c.type){if(r=n.done?f:d,c.arg===_)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(r=f,n.method="throw",n.arg=c.arg)}}}(e,n,o),s}function u(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=l;var h="suspendedStart",d="suspendedYield",p="executing",f="completed",_={};function m(){}function g(){}function y(){}var v={};c(v,s,(function(){return this}));var w=Object.getPrototypeOf,b=w&&w(w(A([])));b&&b!==n&&r.call(b,s)&&(v=b);var k=y.prototype=m.prototype=Object.create(v);function E(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function T(e,t){function n(i,s,o,a){var c=u(e[i],e,s);if("throw"!==c.type){var l=c.arg,h=l.value;return h&&"object"==typeof h&&r.call(h,"__await")?t.resolve(h.__await).then((function(e){n("next",e,o,a)}),(function(e){n("throw",e,o,a)})):t.resolve(h).then((function(e){l.value=e,o(l)}),(function(e){return n("throw",e,o,a)}))}a(c.arg)}var i;this._invoke=function(e,r){function s(){return new t((function(t,i){n(e,r,t,i)}))}return i=i?i.then(s,s):s()}}function S(e,n){var r=e.iterator[n.method];if(r===t){if(n.delegate=null,"throw"===n.method){if(e.iterator.return&&(n.method="return",n.arg=t,S(e,n),"throw"===n.method))return _;n.method="throw",n.arg=new TypeError("The iterator does not provide a 'throw' method")}return _}var i=u(r,e.iterator,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,_;var s=i.arg;return s?s.done?(n[e.resultName]=s.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,_):s:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,_)}function I(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function C(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function x(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(I,this),this.reset(!0)}function A(e){if(e){var n=e[s];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,o=function n(){for(;++i<e.length;)if(r.call(e,i))return n.value=e[i],n.done=!1,n;return n.value=t,n.done=!0,n};return o.next=o}}return{next:N}}function N(){return{value:t,done:!0}}return g.prototype=y,c(k,"constructor",y),c(y,"constructor",g),g.displayName=c(y,a,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===g||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,y):(e.__proto__=y,c(e,a,"GeneratorFunction")),e.prototype=Object.create(k),e},e.awrap=function(e){return{__await:e}},E(T.prototype),c(T.prototype,o,(function(){return this})),e.AsyncIterator=T,e.async=function(t,n,r,i,s){void 0===s&&(s=Promise);var o=new T(l(t,n,r,i),s);return e.isGeneratorFunction(n)?o:o.next().then((function(e){return e.done?e.value:o.next()}))},E(k),c(k,a,"Generator"),c(k,s,(function(){return this})),c(k,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function n(){for(;t.length;){var r=t.pop();if(r in e)return n.value=r,n.done=!1,n}return n.done=!0,n}},e.values=A,x.prototype={constructor:x,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(C),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function i(r,i){return a.type="throw",a.arg=e,n.next=r,i&&(n.method="next",n.arg=t),!!i}for(var s=this.tryEntries.length-1;s>=0;--s){var o=this.tryEntries[s],a=o.completion;if("root"===o.tryLoc)return i("end");if(o.tryLoc<=this.prev){var c=r.call(o,"catchLoc"),l=r.call(o,"finallyLoc");if(c&&l){if(this.prev<o.catchLoc)return i(o.catchLoc,!0);if(this.prev<o.finallyLoc)return i(o.finallyLoc)}else if(c){if(this.prev<o.catchLoc)return i(o.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return i(o.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var s=i;break}}s&&("break"===e||"continue"===e)&&s.tryLoc<=t&&t<=s.finallyLoc&&(s=null);var o=s?s.completion:{};return o.type=e,o.arg=t,s?(this.method="next",this.next=s.finallyLoc,_):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),_},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),C(n),_}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;C(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:A(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),_}},e}(e.exports);try{regeneratorRuntime=t}catch(e){"object"==typeof globalThis?globalThis.regeneratorRuntime=t:Function("r","regeneratorRuntime = r")(t)}},1303:(e,t,n)=>{"use strict";var r=n(6356),i=(n(7588),n(4683));const s=function(e,t){if(!e)throw o(t)},o=function(e){return new Error("Firebase Database (${JSCORE_VERSION}) INTERNAL ASSERT FAILED: "+e)},a=function(e){const t=[];let n=0;for(let r=0;r<e.length;r++){let i=e.charCodeAt(r);i<128?t[n++]=i:i<2048?(t[n++]=i>>6|192,t[n++]=63&i|128):55296==(64512&i)&&r+1<e.length&&56320==(64512&e.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&e.charCodeAt(++r)),t[n++]=i>>18|240,t[n++]=i>>12&63|128,t[n++]=i>>6&63|128,t[n++]=63&i|128):(t[n++]=i>>12|224,t[n++]=i>>6&63|128,t[n++]=63&i|128)}return t},c={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let t=0;t<e.length;t+=3){const i=e[t],s=t+1<e.length,o=s?e[t+1]:0,a=t+2<e.length,c=a?e[t+2]:0,l=i>>2,u=(3&i)<<4|o>>4;let h=(15&o)<<2|c>>6,d=63&c;a||(d=64,s||(h=64)),r.push(n[l],n[u],n[h],n[d])}return r.join("")},encodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(a(e),t)},decodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):function(e){const t=[];let n=0,r=0;for(;n<e.length;){const i=e[n++];if(i<128)t[r++]=String.fromCharCode(i);else if(i>191&&i<224){const s=e[n++];t[r++]=String.fromCharCode((31&i)<<6|63&s)}else if(i>239&&i<365){const s=((7&i)<<18|(63&e[n++])<<12|(63&e[n++])<<6|63&e[n++])-65536;t[r++]=String.fromCharCode(55296+(s>>10)),t[r++]=String.fromCharCode(56320+(1023&s))}else{const s=e[n++],o=e[n++];t[r++]=String.fromCharCode((15&i)<<12|(63&s)<<6|63&o)}}return t.join("")}(this.decodeStringToByteArray(e,t))},decodeStringToByteArray(e,t){this.init_();const n=t?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let t=0;t<e.length;){const i=n[e.charAt(t++)],s=t<e.length?n[e.charAt(t)]:0;++t;const o=t<e.length?n[e.charAt(t)]:64;++t;const a=t<e.length?n[e.charAt(t)]:64;if(++t,null==i||null==s||null==o||null==a)throw Error();const c=i<<2|s>>4;if(r.push(c),64!==o){const e=s<<4&240|o>>2;if(r.push(e),64!==a){const e=o<<6&192|a;r.push(e)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}},l=function(e){try{return c.decodeString(e,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function u(e){return h(void 0,e)}function h(e,t){if(!(t instanceof Object))return t;switch(t.constructor){case Date:return new Date(t.getTime());case Object:void 0===e&&(e={});break;case Array:e=[];break;default:return t}for(const n in t)t.hasOwnProperty(n)&&"__proto__"!==n&&(e[n]=h(e[n],t[n]));return e}class d{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}wrapCallback(e){return(t,n)=>{t?this.reject(t):this.resolve(n),"function"==typeof e&&(this.promise.catch((()=>{})),1===e.length?e(t):e(t,n))}}}function p(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function f(){return"undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(p())}function _(){const e="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof e&&void 0!==e.id}function m(){return"object"==typeof navigator&&"ReactNative"===navigator.product}class g extends Error{constructor(e,t,n){super(t),this.code=e,this.customData=n,this.name="FirebaseError",Object.setPrototypeOf(this,g.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,y.prototype.create)}}class y{constructor(e,t,n){this.service=e,this.serviceName=t,this.errors=n}create(e,...t){const n=t[0]||{},r=`${this.service}/${e}`,i=this.errors[e],s=i?function(e,t){return e.replace(v,((e,n)=>{const r=t[n];return null!=r?String(r):`<${n}?>`}))}(i,n):"Error",o=`${this.serviceName}: ${s} (${r}).`;return new g(r,o,n)}}const v=/\{\$([^}]+)}/g;function w(e){return JSON.parse(e)}function b(e){return JSON.stringify(e)}const k=function(e){let t={},n={},r={},i="";try{const s=e.split(".");t=w(l(s[0])||""),n=w(l(s[1])||""),i=s[2],r=n.d||{},delete n.d}catch(e){}return{header:t,claims:n,data:r,signature:i}};function E(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function T(e,t){return Object.prototype.hasOwnProperty.call(e,t)?e[t]:void 0}function S(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}function I(e,t,n){const r={};for(const i in e)Object.prototype.hasOwnProperty.call(e,i)&&(r[i]=t.call(n,e[i],i,e));return r}function C(e,t){if(e===t)return!0;const n=Object.keys(e),r=Object.keys(t);for(const i of n){if(!r.includes(i))return!1;const n=e[i],s=t[i];if(x(n)&&x(s)){if(!C(n,s))return!1}else if(n!==s)return!1}for(const e of r)if(!n.includes(e))return!1;return!0}function x(e){return null!==e&&"object"==typeof e}function A(e){const t=[];for(const[n,r]of Object.entries(e))Array.isArray(r)?r.forEach((e=>{t.push(encodeURIComponent(n)+"="+encodeURIComponent(e))})):t.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return t.length?"&"+t.join("&"):""}function N(e){const t={};return e.replace(/^\?/,"").split("&").forEach((e=>{if(e){const[n,r]=e.split("=");t[decodeURIComponent(n)]=decodeURIComponent(r)}})),t}function P(e){const t=e.indexOf("?");if(!t)return"";const n=e.indexOf("#",t);return e.substring(t,n>0?n:void 0)}class O{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=64,this.pad_[0]=128;for(let e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(e,t){t||(t=0);const n=this.W_;if("string"==typeof e)for(let r=0;r<16;r++)n[r]=e.charCodeAt(t)<<24|e.charCodeAt(t+1)<<16|e.charCodeAt(t+2)<<8|e.charCodeAt(t+3),t+=4;else for(let r=0;r<16;r++)n[r]=e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3],t+=4;for(let e=16;e<80;e++){const t=n[e-3]^n[e-8]^n[e-14]^n[e-16];n[e]=4294967295&(t<<1|t>>>31)}let r,i,s=this.chain_[0],o=this.chain_[1],a=this.chain_[2],c=this.chain_[3],l=this.chain_[4];for(let e=0;e<80;e++){e<40?e<20?(r=c^o&(a^c),i=1518500249):(r=o^a^c,i=1859775393):e<60?(r=o&a|c&(o|a),i=2400959708):(r=o^a^c,i=3395469782);const t=(s<<5|s>>>27)+r+l+i+n[e]&4294967295;l=c,c=a,a=4294967295&(o<<30|o>>>2),o=s,s=t}this.chain_[0]=this.chain_[0]+s&4294967295,this.chain_[1]=this.chain_[1]+o&4294967295,this.chain_[2]=this.chain_[2]+a&4294967295,this.chain_[3]=this.chain_[3]+c&4294967295,this.chain_[4]=this.chain_[4]+l&4294967295}update(e,t){if(null==e)return;void 0===t&&(t=e.length);const n=t-this.blockSize;let r=0;const i=this.buf_;let s=this.inbuf_;for(;r<t;){if(0===s)for(;r<=n;)this.compress_(e,r),r+=this.blockSize;if("string"==typeof e){for(;r<t;)if(i[s]=e.charCodeAt(r),++s,++r,s===this.blockSize){this.compress_(i),s=0;break}}else for(;r<t;)if(i[s]=e[r],++s,++r,s===this.blockSize){this.compress_(i),s=0;break}}this.inbuf_=s,this.total_+=t}digest(){const e=[];let t=8*this.total_;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let e=this.blockSize-1;e>=56;e--)this.buf_[e]=255&t,t/=256;this.compress_(this.buf_);let n=0;for(let t=0;t<5;t++)for(let r=24;r>=0;r-=8)e[n]=this.chain_[t]>>r&255,++n;return e}}class R{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then((()=>{e(this)})).catch((e=>{this.error(e)}))}next(e){this.forEachObserver((t=>{t.next(e)}))}error(e){this.forEachObserver((t=>{t.error(e)})),this.close(e)}complete(){this.forEachObserver((e=>{e.complete()})),this.close()}subscribe(e,t,n){let r;if(void 0===e&&void 0===t&&void 0===n)throw new Error("Missing Observer.");r=function(e,t){if("object"!=typeof e||null===e)return!1;for(const t of["next","error","complete"])if(t in e&&"function"==typeof e[t])return!0;return!1}(e)?e:{next:e,error:t,complete:n},void 0===r.next&&(r.next=D),void 0===r.error&&(r.error=D),void 0===r.complete&&(r.complete=D);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then((()=>{try{this.finalError?r.error(this.finalError):r.complete()}catch(e){}})),this.observers.push(r),i}unsubscribeOne(e){void 0!==this.observers&&void 0!==this.observers[e]&&(delete this.observers[e],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then((()=>{if(void 0!==this.observers&&void 0!==this.observers[e])try{t(this.observers[e])}catch(e){"undefined"!=typeof console&&console.error&&console.error(e)}}))}close(e){this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then((()=>{this.observers=void 0,this.onNoObservers=void 0})))}}function D(){}function z(e,t){return`${e} failed: ${t} argument `}const M=function(e){let t=0;for(let n=0;n<e.length;n++){const r=e.charCodeAt(n);r<128?t++:r<2048?t+=2:r>=55296&&r<=56319?(t+=4,n++):t+=3}return t};function L(e,t=1e3,n=2){const r=t*Math.pow(n,e),i=Math.round(.5*r*(Math.random()-.5)*2);return Math.min(144e5,r+i)}function U(e){return e&&e._delegate?e._delegate:e}class F{constructor(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const j="[DEFAULT]";class q{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const e=new d;if(this.instancesDeferred.set(t,e),this.isInitialized(t)||this.shouldAutoInitialize())try{const n=this.getOrInitializeService({instanceIdentifier:t});n&&e.resolve(n)}catch(e){}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const n=this.normalizeInstanceIdentifier(null==e?void 0:e.identifier),r=null!==(t=null==e?void 0:e.optional)&&void 0!==t&&t;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(r)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(e){if(r)return null;throw e}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,this.shouldAutoInitialize()){if(function(e){return"EAGER"===e.instantiationMode}(e))try{this.getOrInitializeService({instanceIdentifier:j})}catch(e){}for(const[e,t]of this.instancesDeferred.entries()){const n=this.normalizeInstanceIdentifier(e);try{const e=this.getOrInitializeService({instanceIdentifier:n});t.resolve(e)}catch(e){}}}}clearInstance(e="[DEFAULT]"){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter((e=>"INTERNAL"in e)).map((e=>e.INTERNAL.delete())),...e.filter((e=>"_delete"in e)).map((e=>e._delete()))])}isComponentSet(){return null!=this.component}isInitialized(e="[DEFAULT]"){return this.instances.has(e)}getOptions(e="[DEFAULT]"){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const r=this.getOrInitializeService({instanceIdentifier:n,options:t});for(const[e,t]of this.instancesDeferred.entries())n===this.normalizeInstanceIdentifier(e)&&t.resolve(r);return r}onInit(e,t){var n;const r=this.normalizeInstanceIdentifier(t),i=null!==(n=this.onInitCallbacks.get(r))&&void 0!==n?n:new Set;i.add(e),this.onInitCallbacks.set(r,i);const s=this.instances.get(r);return s&&e(s,r),()=>{i.delete(e)}}invokeOnInitCallbacks(e,t){const n=this.onInitCallbacks.get(t);if(n)for(const r of n)try{r(e,t)}catch(e){}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:(r=e,r===j?void 0:r),options:t}),this.instances.set(e,n),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch(e){}var r;return n||null}normalizeInstanceIdentifier(e="[DEFAULT]"){return this.component?this.component.multipleInstances?e:j:e}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class B{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new q(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}const W=[];var V;!function(e){e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT"}(V||(V={}));const H={debug:V.DEBUG,verbose:V.VERBOSE,info:V.INFO,warn:V.WARN,error:V.ERROR,silent:V.SILENT},K=V.INFO,$={[V.DEBUG]:"log",[V.VERBOSE]:"log",[V.INFO]:"info",[V.WARN]:"warn",[V.ERROR]:"error"},G=(e,t,...n)=>{if(t<e.logLevel)return;const r=(new Date).toISOString(),i=$[t];if(!i)throw new Error(`Attempted to log a message with an invalid logType (value: ${t})`);console[i](`[${r}]  ${e.name}:`,...n)};class J{constructor(e){this.name=e,this._logLevel=K,this._logHandler=G,this._userLogHandler=null,W.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in V))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel="string"==typeof e?H[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if("function"!=typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,V.DEBUG,...e),this._logHandler(this,V.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,V.VERBOSE,...e),this._logHandler(this,V.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,V.INFO,...e),this._logHandler(this,V.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,V.WARN,...e),this._logHandler(this,V.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,V.ERROR,...e),this._logHandler(this,V.ERROR,...e)}}class Z{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map((e=>{if(function(e){const t=e.getComponent();return"VERSION"===(null==t?void 0:t.type)}(e)){const t=e.getImmediate();return`${t.library}/${t.version}`}return null})).filter((e=>e)).join(" ")}}const Y="@firebase/app",Q="0.7.10",X=new J("@firebase/app"),ee={[Y]:"fire-core","@firebase/app-compat":"fire-core-compat","@firebase/analytics":"fire-analytics","@firebase/analytics-compat":"fire-analytics-compat","@firebase/app-check":"fire-app-check","@firebase/app-check-compat":"fire-app-check-compat","@firebase/auth":"fire-auth","@firebase/auth-compat":"fire-auth-compat","@firebase/database":"fire-rtdb","@firebase/database-compat":"fire-rtdb-compat","@firebase/functions":"fire-fn","@firebase/functions-compat":"fire-fn-compat","@firebase/installations":"fire-iid","@firebase/installations-compat":"fire-iid-compat","@firebase/messaging":"fire-fcm","@firebase/messaging-compat":"fire-fcm-compat","@firebase/performance":"fire-perf","@firebase/performance-compat":"fire-perf-compat","@firebase/remote-config":"fire-rc","@firebase/remote-config-compat":"fire-rc-compat","@firebase/storage":"fire-gcs","@firebase/storage-compat":"fire-gcs-compat","@firebase/firestore":"fire-fst","@firebase/firestore-compat":"fire-fst-compat","fire-js":"fire-js",firebase:"fire-js-all"},te=new Map,ne=new Map;function re(e,t){try{e.container.addComponent(t)}catch(n){X.debug(`Component ${t.name} failed to register with FirebaseApp ${e.name}`,n)}}function ie(e){const t=e.name;if(ne.has(t))return X.debug(`There were multiple attempts to register component ${t}.`),!1;ne.set(t,e);for(const t of te.values())re(t,e);return!0}function se(e,t){return e.container.getProvider(t)}const oe=new y("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function."});class ae{constructor(e,t,n){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new F("app",(()=>this),"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw oe.create("app-deleted",{appName:this._name})}}const ce="9.6.0";function le(e="[DEFAULT]"){const t=te.get(e);if(!t)throw oe.create("no-app",{appName:e});return t}function ue(e,t,n){var r;let i=null!==(r=ee[e])&&void 0!==r?r:e;n&&(i+=`-${n}`);const s=i.match(/\s|\//),o=t.match(/\s|\//);if(s||o){const e=[`Unable to register library "${i}" with version "${t}":`];return s&&e.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&o&&e.push("and"),o&&e.push(`version name "${t}" contains illegal characters (whitespace or "/")`),void X.warn(e.join(" "))}ie(new F(`${i}-version`,(()=>({library:i,version:t})),"VERSION"))}function he(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}ie(new F("platform-logger",(e=>new Z(e)),"PRIVATE")),ue(Y,Q,""),ue(Y,Q,"esm2017"),ue("fire-js",""),ue("firebase","9.6.0","app"),Object.create,Object.create;const de=function(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}},pe=new y("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),fe=new J("@firebase/auth");function _e(e,...t){fe.logLevel<=V.ERROR&&fe.error(`Auth (9.6.0): ${e}`,...t)}function me(e,...t){throw ye(e,...t)}function ge(e,...t){return ye(e,...t)}function ye(e,...t){if("string"!=typeof e){const n=t[0],r=[...t.slice(1)];return r[0]&&(r[0].appName=e.name),e._errorFactory.create(n,...r)}return pe.create(e,...t)}function ve(e,t,...n){if(!e)throw ye(t,...n)}function we(e){const t="INTERNAL ASSERTION FAILED: "+e;throw _e(t),new Error(t)}function be(e,t){e||we(t)}const ke=new Map;function Ee(e){be(e instanceof Function,"Expected a class definition");let t=ke.get(e);return t?(be(t instanceof e,"Instance stored in cache mismatched with class"),t):(t=new e,ke.set(e,t),t)}function Te(){var e;return"undefined"!=typeof self&&(null===(e=self.location)||void 0===e?void 0:e.href)||""}function Se(){var e;return"undefined"!=typeof self&&(null===(e=self.location)||void 0===e?void 0:e.protocol)||null}class Ie{constructor(e,t){this.shortDelay=e,this.longDelay=t,be(t>e,"Short delay should be less than long delay!"),this.isMobile=f()||m()}get(){return"undefined"!=typeof navigator&&navigator&&"onLine"in navigator&&"boolean"==typeof navigator.onLine&&("http:"===Se()||"https:"===Se()||_()||"connection"in navigator)&&!navigator.onLine?Math.min(5e3,this.shortDelay):this.isMobile?this.longDelay:this.shortDelay}}function Ce(e,t){be(e.emulator,"Emulator should always be set here");const{url:n}=e.emulator;return t?`${n}${t.startsWith("/")?t.slice(1):t}`:n}class xe{static initialize(e,t,n){this.fetchImpl=e,t&&(this.headersImpl=t),n&&(this.responseImpl=n)}static fetch(){return this.fetchImpl?this.fetchImpl:"undefined"!=typeof self&&"fetch"in self?self.fetch:void we("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:"undefined"!=typeof self&&"Headers"in self?self.Headers:void we("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:"undefined"!=typeof self&&"Response"in self?self.Response:void we("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const Ae={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"internal-error",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error"},Ne=new Ie(3e4,6e4);function Pe(e,t){return e.tenantId&&!t.tenantId?Object.assign(Object.assign({},t),{tenantId:e.tenantId}):t}async function Oe(e,t,n,r,i={}){return Re(e,i,(()=>{let i={},s={};r&&("GET"===t?s=r:i={body:JSON.stringify(r)});const o=A(Object.assign({key:e.config.apiKey},s)).slice(1),a=new(xe.headers());return a.set("Content-Type","application/json"),a.set("X-Client-Version",e._getSdkClientVersion()),e.languageCode&&a.set("X-Firebase-Locale",e.languageCode),xe.fetch()(ze(e,e.config.apiHost,n,o),Object.assign({method:t,headers:a,referrerPolicy:"no-referrer"},i))}))}async function Re(e,t,n){e._canInitEmulator=!1;const r=Object.assign(Object.assign({},Ae),t);try{const t=new Me(e),i=await Promise.race([n(),t.promise]);t.clearNetworkTimeout();const s=await i.json();if("needConfirmation"in s)throw Le(e,"account-exists-with-different-credential",s);if(i.ok&&!("errorMessage"in s))return s;{const t=i.ok?s.errorMessage:s.error.message,[n,o]=t.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===n)throw Le(e,"credential-already-in-use",s);if("EMAIL_EXISTS"===n)throw Le(e,"email-already-in-use",s);const a=r[n]||n.toLowerCase().replace(/[_\s]+/g,"-");if(o)throw function(e,t,n){const r=Object.assign(Object.assign({},de()),{[t]:n});return new y("auth","Firebase",r).create(t,{appName:e.name})}(e,a,o);me(e,a)}}catch(t){if(t instanceof g)throw t;me(e,"network-request-failed")}}async function De(e,t,n,r,i={}){const s=await Oe(e,t,n,r,i);return"mfaPendingCredential"in s&&me(e,"multi-factor-auth-required",{_serverResponse:s}),s}function ze(e,t,n,r){const i=`${t}${n}?${r}`;return e.config.emulator?Ce(e.config,i):`${e.config.apiScheme}://${i}`}class Me{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise(((e,t)=>{this.timer=setTimeout((()=>t(ge(this.auth,"timeout"))),Ne.get())}))}clearNetworkTimeout(){clearTimeout(this.timer)}}function Le(e,t,n){const r={appName:e.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const i=ge(e,t,r);return i.customData._tokenResponse=n,i}function Ue(e){if(e)try{const t=new Date(Number(e));if(!isNaN(t.getTime()))return t.toUTCString()}catch(e){}}function Fe(e){return 1e3*Number(e)}function je(e){const[t,n,r]=e.split(".");if(void 0===t||void 0===n||void 0===r)return _e("JWT malformed, contained fewer than 3 sections"),null;try{const e=l(n);return e?JSON.parse(e):(_e("Failed to decode base64 JWT payload"),null)}catch(e){return _e("Caught error parsing JWT payload as JSON",e),null}}async function qe(e,t,n=!1){if(n)return t;try{return await t}catch(t){throw t instanceof g&&function({code:e}){return"auth/user-disabled"===e||"auth/user-token-expired"===e}(t)&&e.auth.currentUser===e&&await e.auth.signOut(),t}}class Be{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const e=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),e}{this.errorBackoff=3e4;const e=(null!==(t=this.user.stsTokenManager.expirationTime)&&void 0!==t?t:0)-Date.now()-3e5;return Math.max(0,e)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout((async()=>{await this.iteration()}),t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){return void("auth/network-request-failed"===e.code&&this.schedule(!0))}this.schedule()}}class We{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Ue(this.lastLoginAt),this.creationTime=Ue(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function Ve(e){var t;const n=e.auth,r=await e.getIdToken(),i=await qe(e,async function(e,t){return Oe(e,"POST","/v1/accounts:lookup",t)}(n,{idToken:r}));ve(null==i?void 0:i.users.length,n,"internal-error");const s=i.users[0];e._notifyReloadListener(s);const o=(null===(t=s.providerUserInfo)||void 0===t?void 0:t.length)?s.providerUserInfo.map((e=>{var{providerId:t}=e,n=he(e,["providerId"]);return{providerId:t,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}})):[],a=(c=e.providerData,l=o,[...c.filter((e=>!l.some((t=>t.providerId===e.providerId)))),...l]);var c,l;const u=e.isAnonymous,h=!(e.email&&s.passwordHash||(null==a?void 0:a.length)),d=!!u&&h,p={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:a,metadata:new We(s.createdAt,s.lastLoginAt),isAnonymous:d};Object.assign(e,p)}class He{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){ve(e.idToken,"internal-error"),ve(void 0!==e.idToken,"internal-error"),ve(void 0!==e.refreshToken,"internal-error");const t="expiresIn"in e&&void 0!==e.expiresIn?Number(e.expiresIn):function(e){const t=je(e);return ve(t,"internal-error"),ve(void 0!==t.exp,"internal-error"),ve(void 0!==t.iat,"internal-error"),Number(t.exp)-Number(t.iat)}(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}async getToken(e,t=!1){return ve(!this.accessToken||this.refreshToken,e,"user-token-expired"),t||!this.accessToken||this.isExpired?this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null:this.accessToken}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:n,refreshToken:r,expiresIn:i}=await async function(e,t){const n=await Re(e,{},(()=>{const n=A({grant_type:"refresh_token",refresh_token:t}).slice(1),{tokenApiHost:r,apiKey:i}=e.config,s=ze(e,r,"/v1/token",`key=${i}`);return xe.fetch()(s,{method:"POST",headers:{"X-Client-Version":e._getSdkClientVersion(),"Content-Type":"application/x-www-form-urlencoded"},body:n})}));return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}(e,t);this.updateTokensAndExpiration(n,r,Number(i))}updateTokensAndExpiration(e,t,n){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+1e3*n}static fromJSON(e,t){const{refreshToken:n,accessToken:r,expirationTime:i}=t,s=new He;return n&&(ve("string"==typeof n,"internal-error",{appName:e}),s.refreshToken=n),r&&(ve("string"==typeof r,"internal-error",{appName:e}),s.accessToken=r),i&&(ve("number"==typeof i,"internal-error",{appName:e}),s.expirationTime=i),s}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new He,this.toJSON())}_performRefresh(){return we("not implemented")}}function Ke(e,t){ve("string"==typeof e||void 0===e,"internal-error",{appName:t})}class $e{constructor(e){var{uid:t,auth:n,stsTokenManager:r}=e,i=he(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.emailVerified=!1,this.isAnonymous=!1,this.tenantId=null,this.providerData=[],this.proactiveRefresh=new Be(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=n,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.metadata=new We(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const t=await qe(this,this.stsTokenManager.getToken(this.auth,e));return ve(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return async function(e,t=!1){const n=U(e),r=await n.getIdToken(t),i=je(r);ve(i&&i.exp&&i.auth_time&&i.iat,n.auth,"internal-error");const s="object"==typeof i.firebase?i.firebase:void 0,o=null==s?void 0:s.sign_in_provider;return{claims:i,token:r,authTime:Ue(Fe(i.auth_time)),issuedAtTime:Ue(Fe(i.iat)),expirationTime:Ue(Fe(i.exp)),signInProvider:o||null,signInSecondFactor:(null==s?void 0:s.sign_in_second_factor)||null}}(this,e)}reload(){return async function(e){const t=U(e);await Ve(t),await t.auth._persistUserIfCurrent(t),t.auth._notifyListenersIfCurrent(t)}(this)}_assign(e){this!==e&&(ve(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map((e=>Object.assign({},e))),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){return new $e(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}))}_onReload(e){ve(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),t&&await Ve(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){const e=await this.getIdToken();return await qe(this,async function(e,t){return Oe(e,"POST","/v1/accounts:delete",t)}(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map((e=>Object.assign({},e))),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var n,r,i,s,o,a,c,l;const u=null!==(n=t.displayName)&&void 0!==n?n:void 0,h=null!==(r=t.email)&&void 0!==r?r:void 0,d=null!==(i=t.phoneNumber)&&void 0!==i?i:void 0,p=null!==(s=t.photoURL)&&void 0!==s?s:void 0,f=null!==(o=t.tenantId)&&void 0!==o?o:void 0,_=null!==(a=t._redirectEventId)&&void 0!==a?a:void 0,m=null!==(c=t.createdAt)&&void 0!==c?c:void 0,g=null!==(l=t.lastLoginAt)&&void 0!==l?l:void 0,{uid:y,emailVerified:v,isAnonymous:w,providerData:b,stsTokenManager:k}=t;ve(y&&k,e,"internal-error");const E=He.fromJSON(this.name,k);ve("string"==typeof y,e,"internal-error"),Ke(u,e.name),Ke(h,e.name),ve("boolean"==typeof v,e,"internal-error"),ve("boolean"==typeof w,e,"internal-error"),Ke(d,e.name),Ke(p,e.name),Ke(f,e.name),Ke(_,e.name),Ke(m,e.name),Ke(g,e.name);const T=new $e({uid:y,auth:e,email:h,emailVerified:v,displayName:u,isAnonymous:w,photoURL:p,phoneNumber:d,tenantId:f,stsTokenManager:E,createdAt:m,lastLoginAt:g});return b&&Array.isArray(b)&&(T.providerData=b.map((e=>Object.assign({},e)))),_&&(T._redirectEventId=_),T}static async _fromIdTokenResponse(e,t,n=!1){const r=new He;r.updateFromServerResponse(t);const i=new $e({uid:t.localId,auth:e,stsTokenManager:r,isAnonymous:n});return await Ve(i),i}}class Ge{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return void 0===t?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}Ge.type="NONE";const Je=Ge;function Ze(e,t,n){return`firebase:${e}:${t}:${n}`}class Ye{constructor(e,t,n){this.persistence=e,this.auth=t,this.userKey=n;const{config:r,name:i}=this.auth;this.fullUserKey=Ze(this.userKey,r.apiKey,i),this.fullPersistenceKey=Ze("persistence",r.apiKey,i),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?$e._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();return await this.removeCurrentUser(),this.persistence=e,t?this.setCurrentUser(t):void 0}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,n="authUser"){if(!t.length)return new Ye(Ee(Je),e,n);const r=(await Promise.all(t.map((async e=>{if(await e._isAvailable())return e})))).filter((e=>e));let i=r[0]||Ee(Je);const s=Ze(n,e.config.apiKey,e.name);let o=null;for(const n of t)try{const t=await n._get(s);if(t){const r=$e._fromJSON(e,t);n!==i&&(o=r),i=n;break}}catch(e){}const a=r.filter((e=>e._shouldAllowMigration));return i._shouldAllowMigration&&a.length?(i=a[0],o&&await i._set(s,o.toJSON()),await Promise.all(t.map((async e=>{if(e!==i)try{await e._remove(s)}catch(e){}}))),new Ye(i,e,n)):new Ye(i,e,n)}}function Qe(e){const t=e.toLowerCase();if(t.includes("opera/")||t.includes("opr/")||t.includes("opios/"))return"Opera";if(nt(t))return"IEMobile";if(t.includes("msie")||t.includes("trident/"))return"IE";if(t.includes("edge/"))return"Edge";if(Xe(t))return"Firefox";if(t.includes("silk/"))return"Silk";if(it(t))return"Blackberry";if(st(t))return"Webos";if(et(t))return"Safari";if((t.includes("chrome/")||tt(t))&&!t.includes("edge/"))return"Chrome";if(rt(t))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=e.match(t);if(2===(null==n?void 0:n.length))return n[1]}return"Other"}function Xe(e=p()){return/firefox\//i.test(e)}function et(e=p()){const t=e.toLowerCase();return t.includes("safari/")&&!t.includes("chrome/")&&!t.includes("crios/")&&!t.includes("android")}function tt(e=p()){return/crios\//i.test(e)}function nt(e=p()){return/iemobile/i.test(e)}function rt(e=p()){return/android/i.test(e)}function it(e=p()){return/blackberry/i.test(e)}function st(e=p()){return/webos/i.test(e)}function ot(e=p()){return/iphone|ipad|ipod/i.test(e)}function at(e=p()){return ot(e)||rt(e)||st(e)||it(e)||/windows phone/i.test(e)||nt(e)}function ct(e,t=[]){let n;switch(e){case"Browser":n=Qe(p());break;case"Worker":n=`${Qe(p())}-${e}`;break;default:n=e}return`${n}/JsCore/9.6.0/${t.length?t.join(","):"FirebaseCore-web"}`}class lt{constructor(e,t){this.app=e,this.config=t,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new ht(this),this.idTokenSubscription=new ht(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=pe,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=t.sdkClientVersion}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Ee(t)),this._initializationPromise=this.queue((async()=>{var n,r;this._deleted||(this.persistenceManager=await Ye.create(this,e),this._deleted||((null===(n=this._popupRedirectResolver)||void 0===n?void 0:n._shouldInitProactively)&&await this._popupRedirectResolver._initialize(this),await this.initializeCurrentUser(t),this.lastNotifiedUid=(null===(r=this.currentUser)||void 0===r?void 0:r.uid)||null,this._deleted||(this._isInitialized=!0)))})),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();return this.currentUser||e?this.currentUser&&e&&this.currentUser.uid===e.uid?(this._currentUser._assign(e),void await this.currentUser.getIdToken()):void await this._updateCurrentUser(e):void 0}async initializeCurrentUser(e){var t;let n=await this.assertedPersistence.getCurrentUser();if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const r=null===(t=this.redirectUser)||void 0===t?void 0:t._redirectEventId,i=null==n?void 0:n._redirectEventId,s=await this.tryRedirectSignIn(e);r&&r!==i||!(null==s?void 0:s.user)||(n=s.user)}return n?n._redirectEventId?(ve(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===n._redirectEventId?this.directlySetCurrentUser(n):this.reloadAndSetCurrentUserOrClear(n)):this.reloadAndSetCurrentUserOrClear(n):this.directlySetCurrentUser(null)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch(e){await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await Ve(e)}catch(e){if("auth/network-request-failed"!==e.code)return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=function(){if("undefined"==typeof navigator)return null;const e=navigator;return e.languages&&e.languages[0]||e.language||null}()}async _delete(){this._deleted=!0}async updateCurrentUser(e){const t=e?U(e):null;return t&&ve(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e){if(!this._deleted)return e&&ve(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),this.queue((async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()}))}async signOut(){return(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null)}setPersistence(e){return this.queue((async()=>{await this.assertedPersistence.setPersistence(Ee(e))}))}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new y("auth","Firebase",e())}onAuthStateChanged(e,t,n){return this.registerStateListener(this.authStateSubscription,e,t,n)}onIdTokenChanged(e,t,n){return this.registerStateListener(this.idTokenSubscription,e,t,n)}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(e=this._currentUser)||void 0===e?void 0:e.toJSON()}}async _setRedirectUser(e,t){const n=await this.getOrInitRedirectPersistenceManager(t);return null===e?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&Ee(e)||this._popupRedirectResolver;ve(t,this,"argument-error"),this.redirectPersistenceManager=await Ye.create(this,[Ee(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,n;return this._isInitialized&&await this.queue((async()=>{})),(null===(t=this._currentUser)||void 0===t?void 0:t._redirectEventId)===e?this._currentUser:(null===(n=this.redirectUser)||void 0===n?void 0:n._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue((async()=>this.directlySetCurrentUser(e)))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=null!==(t=null===(e=this.currentUser)||void 0===e?void 0:e.uid)&&void 0!==t?t:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,n,r){if(this._deleted)return()=>{};const i="function"==typeof t?t:t.next.bind(t),s=this._isInitialized?Promise.resolve():this._initializationPromise;return ve(s,this,"internal-error"),s.then((()=>i(this.currentUser))),"function"==typeof t?e.addObserver(t,n,r):e.addObserver(t)}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&(this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh()),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return ve(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){e&&!this.frameworks.includes(e)&&(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=ct(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}_getSdkClientVersion(){return this.clientVersion}}function ut(e){return U(e)}class ht{constructor(e){this.auth=e,this.observer=null,this.addObserver=function(e,t){const n=new R(e,void 0);return n.subscribe.bind(n)}((e=>this.observer=e))}get next(){return ve(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}class dt{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return we("not implemented")}_getIdTokenResponse(e){return we("not implemented")}_linkToIdToken(e,t){return we("not implemented")}_getReauthenticationResolver(e){return we("not implemented")}}class pt extends dt{constructor(e,t,n,r=null){super("password",n),this._email=e,this._password=t,this._tenantId=r}static _fromEmailAndPassword(e,t){return new pt(e,t,"password")}static _fromEmailAndCode(e,t,n=null){return new pt(e,t,"emailLink",n)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t="string"==typeof e?JSON.parse(e):e;if((null==t?void 0:t.email)&&(null==t?void 0:t.password)){if("password"===t.signInMethod)return this._fromEmailAndPassword(t.email,t.password);if("emailLink"===t.signInMethod)return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":return async function(e,t){return De(e,"POST","/v1/accounts:signInWithPassword",Pe(e,t))}(e,{returnSecureToken:!0,email:this._email,password:this._password});case"emailLink":return async function(e,t){return De(e,"POST","/v1/accounts:signInWithEmailLink",Pe(e,t))}(e,{email:this._email,oobCode:this._password});default:me(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":return async function(e,t){return Oe(e,"POST","/v1/accounts:update",t)}(e,{idToken:t,returnSecureToken:!0,email:this._email,password:this._password});case"emailLink":return async function(e,t){return De(e,"POST","/v1/accounts:signInWithEmailLink",Pe(e,t))}(e,{idToken:t,email:this._email,oobCode:this._password});default:me(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function ft(e,t){return De(e,"POST","/v1/accounts:signInWithIdp",Pe(e,t))}class _t extends dt{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new _t(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):me("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t="string"==typeof e?JSON.parse(e):e,{providerId:n,signInMethod:r}=t,i=he(t,["providerId","signInMethod"]);if(!n||!r)return null;const s=new _t(n,r);return s.idToken=i.idToken||void 0,s.accessToken=i.accessToken||void 0,s.secret=i.secret,s.nonce=i.nonce,s.pendingToken=i.pendingToken||null,s}_getIdTokenResponse(e){return ft(e,this.buildRequest())}_linkToIdToken(e,t){const n=this.buildRequest();return n.idToken=t,ft(e,n)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,ft(e,t)}buildRequest(){const e={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=A(t)}return e}}const mt={USER_NOT_FOUND:"user-not-found"};class gt extends dt{constructor(e){super("phone","phone"),this.params=e}static _fromVerification(e,t){return new gt({verificationId:e,verificationCode:t})}static _fromTokenResponse(e,t){return new gt({phoneNumber:e,temporaryProof:t})}_getIdTokenResponse(e){return async function(e,t){return De(e,"POST","/v1/accounts:signInWithPhoneNumber",Pe(e,t))}(e,this._makeVerificationRequest())}_linkToIdToken(e,t){return async function(e,t){const n=await De(e,"POST","/v1/accounts:signInWithPhoneNumber",Pe(e,t));if(n.temporaryProof)throw Le(e,"account-exists-with-different-credential",n);return n}(e,Object.assign({idToken:t},this._makeVerificationRequest()))}_getReauthenticationResolver(e){return async function(e,t){return De(e,"POST","/v1/accounts:signInWithPhoneNumber",Pe(e,Object.assign(Object.assign({},t),{operation:"REAUTH"})),mt)}(e,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:e,phoneNumber:t,verificationId:n,verificationCode:r}=this.params;return e&&t?{temporaryProof:e,phoneNumber:t}:{sessionInfo:n,code:r}}toJSON(){const e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}static fromJSON(e){"string"==typeof e&&(e=JSON.parse(e));const{verificationId:t,verificationCode:n,phoneNumber:r,temporaryProof:i}=e;return n||t||r||i?new gt({verificationId:t,verificationCode:n,phoneNumber:r,temporaryProof:i}):null}}class yt{constructor(e){var t,n,r,i,s,o;const a=N(P(e)),c=null!==(t=a.apiKey)&&void 0!==t?t:null,l=null!==(n=a.oobCode)&&void 0!==n?n:null,u=function(e){switch(e){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(r=a.mode)&&void 0!==r?r:null);ve(c&&l&&u,"argument-error"),this.apiKey=c,this.operation=u,this.code=l,this.continueUrl=null!==(i=a.continueUrl)&&void 0!==i?i:null,this.languageCode=null!==(s=a.languageCode)&&void 0!==s?s:null,this.tenantId=null!==(o=a.tenantId)&&void 0!==o?o:null}static parseLink(e){const t=function(e){const t=N(P(e)).link,n=t?N(P(t)).deep_link_id:null,r=N(P(e)).deep_link_id;return(r?N(P(r)).link:null)||r||n||t||e}(e);try{return new yt(t)}catch(e){return null}}}class vt{constructor(){this.providerId=vt.PROVIDER_ID}static credential(e,t){return pt._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const n=yt.parseLink(t);return ve(n,"argument-error"),pt._fromEmailAndCode(e,n.code,n.tenantId)}}vt.PROVIDER_ID="password",vt.EMAIL_PASSWORD_SIGN_IN_METHOD="password",vt.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class wt{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class bt extends wt{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class kt extends bt{constructor(){super("facebook.com")}static credential(e){return _t._fromParams({providerId:kt.PROVIDER_ID,signInMethod:kt.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return kt.credentialFromTaggedObject(e)}static credentialFromError(e){return kt.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e))return null;if(!e.oauthAccessToken)return null;try{return kt.credential(e.oauthAccessToken)}catch(e){return null}}}kt.FACEBOOK_SIGN_IN_METHOD="facebook.com",kt.PROVIDER_ID="facebook.com";class Et extends bt{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return _t._fromParams({providerId:Et.PROVIDER_ID,signInMethod:Et.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Et.credentialFromTaggedObject(e)}static credentialFromError(e){return Et.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:n}=e;if(!t&&!n)return null;try{return Et.credential(t,n)}catch(e){return null}}}Et.GOOGLE_SIGN_IN_METHOD="google.com",Et.PROVIDER_ID="google.com";class Tt extends bt{constructor(){super("github.com")}static credential(e){return _t._fromParams({providerId:Tt.PROVIDER_ID,signInMethod:Tt.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Tt.credentialFromTaggedObject(e)}static credentialFromError(e){return Tt.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e))return null;if(!e.oauthAccessToken)return null;try{return Tt.credential(e.oauthAccessToken)}catch(e){return null}}}Tt.GITHUB_SIGN_IN_METHOD="github.com",Tt.PROVIDER_ID="github.com";class St extends bt{constructor(){super("twitter.com")}static credential(e,t){return _t._fromParams({providerId:St.PROVIDER_ID,signInMethod:St.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return St.credentialFromTaggedObject(e)}static credentialFromError(e){return St.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:n}=e;if(!t||!n)return null;try{return St.credential(t,n)}catch(e){return null}}}St.TWITTER_SIGN_IN_METHOD="twitter.com",St.PROVIDER_ID="twitter.com";class It{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,n,r=!1){const i=await $e._fromIdTokenResponse(e,n,r),s=Ct(n);return new It({user:i,providerId:s,_tokenResponse:n,operationType:t})}static async _forOperation(e,t,n){await e._updateTokensIfNecessary(n,!0);const r=Ct(n);return new It({user:e,providerId:r,_tokenResponse:n,operationType:t})}}function Ct(e){return e.providerId?e.providerId:"phoneNumber"in e?"phone":null}class xt extends g{constructor(e,t,n,r){var i;super(t.code,t.message),this.operationType=n,this.user=r,Object.setPrototypeOf(this,xt.prototype),this.customData={appName:e.name,tenantId:null!==(i=e.tenantId)&&void 0!==i?i:void 0,_serverResponse:t.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,t,n,r){return new xt(e,t,n,r)}}function At(e,t,n,r){return("reauthenticate"===t?n._getReauthenticationResolver(e):n._getIdTokenResponse(e)).catch((n=>{if("auth/multi-factor-auth-required"===n.code)throw xt._fromErrorAndOperation(e,n,t,r);throw n}))}new WeakMap;const Nt="__sak";class Pt{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Nt,"1"),this.storage.removeItem(Nt),Promise.resolve(!0)):Promise.resolve(!1)}catch(e){return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}class Ot extends Pt{constructor(){super((()=>window.localStorage),"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=function(){const e=p();return et(e)||ot(e)}()&&function(){try{return!(!window||window===window.top)}catch(e){return!1}}(),this.fallbackToPolling=at(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const n=this.storage.getItem(t),r=this.localCache[t];n!==r&&e(t,r,n)}}onStorageEvent(e,t=!1){if(!e.key)return void this.forAllChangedKeys(((e,t,n)=>{this.notifyListeners(e,n)}));const n=e.key;if(t?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){const r=this.storage.getItem(n);if(e.newValue!==r)null!==e.newValue?this.storage.setItem(n,e.newValue):this.storage.removeItem(n);else if(this.localCache[n]===e.newValue&&!t)return}const r=()=>{const e=this.storage.getItem(n);(t||this.localCache[n]!==e)&&this.notifyListeners(n,e)},i=this.storage.getItem(n);!function(){const e=p();return e.indexOf("MSIE ")>=0||e.indexOf("Trident/")>=0}()||10!==document.documentMode||i===e.newValue||e.newValue===e.oldValue?r():setTimeout(r,10)}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const e of Array.from(n))e(t?JSON.parse(t):t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval((()=>{this.forAllChangedKeys(((e,t,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:n}),!0)}))}),1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}Ot.type="LOCAL";const Rt=Ot;class Dt extends Pt{constructor(){super((()=>window.sessionStorage),"SESSION")}_addListener(e,t){}_removeListener(e,t){}}Dt.type="SESSION";const zt=Dt;class Mt{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find((t=>t.isListeningto(e)));if(t)return t;const n=new Mt(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:n,eventType:r,data:i}=t.data,s=this.handlersMap[r];if(!(null==s?void 0:s.size))return;t.ports[0].postMessage({status:"ack",eventId:n,eventType:r});const o=Array.from(s).map((async e=>e(t.origin,i))),a=await function(e){return Promise.all(e.map((async e=>{try{return{fulfilled:!0,value:await e}}catch(e){return{fulfilled:!1,reason:e}}})))}(o);t.ports[0].postMessage({status:"done",eventId:n,eventType:r,response:a})}_subscribe(e,t){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),t&&0!==this.handlersMap[e].size||delete this.handlersMap[e],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}function Lt(e="",t=10){let n="";for(let e=0;e<t;e++)n+=Math.floor(10*Math.random());return e+n}Mt.receivers=[];class Ut{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,n=50){const r="undefined"!=typeof MessageChannel?new MessageChannel:null;if(!r)throw new Error("connection_unavailable");let i,s;return new Promise(((o,a)=>{const c=Lt("",20);r.port1.start();const l=setTimeout((()=>{a(new Error("unsupported_event"))}),n);s={messageChannel:r,onMessage(e){const t=e;if(t.data.eventId===c)switch(t.data.status){case"ack":clearTimeout(l),i=setTimeout((()=>{a(new Error("timeout"))}),3e3);break;case"done":clearTimeout(i),o(t.data.response);break;default:clearTimeout(l),clearTimeout(i),a(new Error("invalid_response"))}}},this.handlers.add(s),r.port1.addEventListener("message",s.onMessage),this.target.postMessage({eventType:e,eventId:c,data:t},[r.port2])})).finally((()=>{s&&this.removeMessageHandler(s)}))}}function Ft(){return window}function jt(){return void 0!==Ft().WorkerGlobalScope&&"function"==typeof Ft().importScripts}const qt="firebaseLocalStorageDb",Bt="firebaseLocalStorage",Wt="fbase_key";class Vt{constructor(e){this.request=e}toPromise(){return new Promise(((e,t)=>{this.request.addEventListener("success",(()=>{e(this.request.result)})),this.request.addEventListener("error",(()=>{t(this.request.error)}))}))}}function Ht(e,t){return e.transaction([Bt],t?"readwrite":"readonly").objectStore(Bt)}function Kt(){const e=indexedDB.open(qt,1);return new Promise(((t,n)=>{e.addEventListener("error",(()=>{n(e.error)})),e.addEventListener("upgradeneeded",(()=>{const t=e.result;try{t.createObjectStore(Bt,{keyPath:Wt})}catch(e){n(e)}})),e.addEventListener("success",(async()=>{const n=e.result;n.objectStoreNames.contains(Bt)?t(n):(n.close(),await function(){const e=indexedDB.deleteDatabase(qt);return new Vt(e).toPromise()}(),t(await Kt()))}))}))}async function $t(e,t,n){const r=Ht(e,!0).put({[Wt]:t,value:n});return new Vt(r).toPromise()}function Gt(e,t){const n=Ht(e,!0).delete(t);return new Vt(n).toPromise()}class Jt{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then((()=>{}),(()=>{}))}async _openDb(){return this.db||(this.db=await Kt()),this.db}async _withRetries(e){let t=0;for(;;)try{const t=await this._openDb();return await e(t)}catch(e){if(t++>3)throw e;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return jt()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Mt._getInstance(jt()?self:null),this.receiver._subscribe("keyChanged",(async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)}))),this.receiver._subscribe("ping",(async(e,t)=>["keyChanged"]))}async initializeSender(){var e,t;if(this.activeServiceWorker=await async function(){if(!(null===navigator||void 0===navigator?void 0:navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch(e){return null}}(),!this.activeServiceWorker)return;this.sender=new Ut(this.activeServiceWorker);const n=await this.sender._send("ping",{},800);n&&(null===(e=n[0])||void 0===e?void 0:e.fulfilled)&&(null===(t=n[0])||void 0===t?void 0:t.value.includes("keyChanged"))&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){var t;if(this.sender&&this.activeServiceWorker&&((null===(t=null===navigator||void 0===navigator?void 0:navigator.serviceWorker)||void 0===t?void 0:t.controller)||null)===this.activeServiceWorker)try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch(t){}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Kt();return await $t(e,Nt,"1"),await Gt(e,Nt),!0}catch(e){}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite((async()=>(await this._withRetries((n=>$t(n,e,t))),this.localCache[e]=t,this.notifyServiceWorker(e))))}async _get(e){const t=await this._withRetries((t=>async function(e,t){const n=Ht(e,!1).get(t),r=await new Vt(n).toPromise();return void 0===r?null:r.value}(t,e)));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite((async()=>(await this._withRetries((t=>Gt(t,e))),delete this.localCache[e],this.notifyServiceWorker(e))))}async _poll(){const e=await this._withRetries((e=>{const t=Ht(e,!1).getAll();return new Vt(t).toPromise()}));if(!e)return[];if(0!==this.pendingWrites)return[];const t=[],n=new Set;for(const{fbase_key:r,value:i}of e)n.add(r),JSON.stringify(this.localCache[r])!==JSON.stringify(i)&&(this.notifyListeners(r,i),t.push(r));for(const e of Object.keys(this.localCache))this.localCache[e]&&!n.has(e)&&(this.notifyListeners(e,null),t.push(e));return t}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const e of Array.from(n))e(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval((async()=>this._poll()),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&this.stopPolling()}}Jt.type="LOCAL";const Zt=Jt;function Yt(e){return`__${e}${Math.floor(1e6*Math.random())}`}Yt("rcb"),new Ie(3e4,6e4);class Qt{constructor(e){this.providerId=Qt.PROVIDER_ID,this.auth=ut(e)}verifyPhoneNumber(e,t){return async function(e,t,n){var r;const i=await n.verify();try{let s;if(ve("string"==typeof i,e,"argument-error"),ve("recaptcha"===n.type,e,"argument-error"),s="string"==typeof t?{phoneNumber:t}:t,"session"in s){const t=s.session;if("phoneNumber"in s){ve("enroll"===t.type,e,"internal-error");const n=await function(e,t){return Oe(e,"POST","/v2/accounts/mfaEnrollment:start",Pe(e,t))}(e,{idToken:t.credential,phoneEnrollmentInfo:{phoneNumber:s.phoneNumber,recaptchaToken:i}});return n.phoneSessionInfo.sessionInfo}{ve("signin"===t.type,e,"internal-error");const n=(null===(r=s.multiFactorHint)||void 0===r?void 0:r.uid)||s.multiFactorUid;ve(n,e,"missing-multi-factor-info");const o=await function(e,t){return Oe(e,"POST","/v2/accounts/mfaSignIn:start",Pe(e,t))}(e,{mfaPendingCredential:t.credential,mfaEnrollmentId:n,phoneSignInInfo:{recaptchaToken:i}});return o.phoneResponseInfo.sessionInfo}}{const{sessionInfo:t}=await async function(e,t){return Oe(e,"POST","/v1/accounts:sendVerificationCode",Pe(e,t))}(e,{phoneNumber:s.phoneNumber,recaptchaToken:i});return t}}finally{n._reset()}}(this.auth,e,U(t))}static credential(e,t){return gt._fromVerification(e,t)}static credentialFromResult(e){const t=e;return Qt.credentialFromTaggedObject(t)}static credentialFromError(e){return Qt.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{phoneNumber:t,temporaryProof:n}=e;return t&&n?gt._fromTokenResponse(t,n):null}}Qt.PROVIDER_ID="phone",Qt.PHONE_SIGN_IN_METHOD="phone";class Xt extends dt{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return ft(e,this._buildIdpRequest())}_linkToIdToken(e,t){return ft(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return ft(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function en(e){return async function(e,t,n=!1){const r="signIn",i=await At(e,r,t),s=await It._fromIdTokenResponse(e,r,i);return n||await e._updateCurrentUser(s.user),s}(e.auth,new Xt(e),e.bypassAuthState)}function tn(e){const{auth:t,user:n}=e;return ve(n,t,"internal-error"),async function(e,t,n=!1){const{auth:r}=e,i="reauthenticate";try{const s=await qe(e,At(r,i,t,e),n);ve(s.idToken,r,"internal-error");const o=je(s.idToken);ve(o,r,"internal-error");const{sub:a}=o;return ve(e.uid===a,r,"user-mismatch"),It._forOperation(e,i,s)}catch(e){throw"auth/user-not-found"===(null==e?void 0:e.code)&&me(r,"user-mismatch"),e}}(n,new Xt(e),e.bypassAuthState)}async function nn(e){const{auth:t,user:n}=e;return ve(n,t,"internal-error"),async function(e,t,n=!1){const r=await qe(e,t._linkToIdToken(e.auth,await e.getIdToken()),n);return It._forOperation(e,"link",r)}(n,new Xt(e),e.bypassAuthState)}class rn{constructor(e,t,n,r,i=!1){this.auth=e,this.resolver=n,this.user=r,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise((async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(e){this.reject(e)}}))}async onAuthEvent(e){const{urlResponse:t,sessionId:n,postBody:r,tenantId:i,error:s,type:o}=e;if(s)return void this.reject(s);const a={auth:this.auth,requestUri:t,sessionId:n,tenantId:i||void 0,postBody:r||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(o)(a))}catch(e){this.reject(e)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return en;case"linkViaPopup":case"linkViaRedirect":return nn;case"reauthViaPopup":case"reauthViaRedirect":return tn;default:me(this.auth,"internal-error")}}resolve(e){be(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){be(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const sn=new Ie(2e3,1e4);class on extends rn{constructor(e,t,n,r,i){super(e,t,r,i),this.provider=n,this.authWindow=null,this.pollId=null,on.currentPopupAction&&on.currentPopupAction.cancel(),on.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return ve(e,this.auth,"internal-error"),e}async onExecution(){be(1===this.filter.length,"Popup operations only handle one event");const e=Lt();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch((e=>{this.reject(e)})),this.resolver._isIframeWebStorageSupported(this.auth,(e=>{e||this.reject(ge(this.auth,"web-storage-unsupported"))})),this.pollUserCancellation()}get eventId(){var e;return(null===(e=this.authWindow)||void 0===e?void 0:e.associatedEvent)||null}cancel(){this.reject(ge(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,on.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,n;(null===(n=null===(t=this.authWindow)||void 0===t?void 0:t.window)||void 0===n?void 0:n.closed)?this.pollId=window.setTimeout((()=>{this.pollId=null,this.reject(ge(this.auth,"popup-closed-by-user"))}),2e3):this.pollId=window.setTimeout(e,sn.get())};e()}}on.currentPopupAction=null;const an=new Map;class cn extends rn{constructor(e,t,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,n),this.eventId=null}async execute(){let e=an.get(this.auth._key());if(!e){try{const t=await async function(e,t){const n=function(e){return Ze("pendingRedirect",e.config.apiKey,e.name)}(t),r=function(e){return Ee(e._redirectPersistence)}(e);if(!await r._isAvailable())return!1;const i="true"===await r._get(n);return await r._remove(n),i}(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(t)}catch(t){e=()=>Promise.reject(t)}an.set(this.auth._key(),e)}return this.bypassAuthState||an.set(this.auth._key(),(()=>Promise.resolve(null))),e()}async onAuthEvent(e){if("signInViaRedirect"===e.type)return super.onAuthEvent(e);if("unknown"!==e.type){if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}else this.resolve(null)}async onExecution(){}cleanUp(){}}async function ln(e,t,n=!1){const r=ut(e),i=function(e,t){return t?Ee(t):(ve(e._popupRedirectResolver,e,"argument-error"),e._popupRedirectResolver)}(r,t),s=new cn(r,i,n),o=await s.execute();return o&&!n&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,t)),o}class un{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach((n=>{this.isEventForConsumer(e,n)&&(t=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))})),this.hasHandledPotentialRedirect||!function(e){switch(e.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return dn(e);default:return!1}}(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var n;if(e.error&&!dn(e)){const r=(null===(n=e.error.code)||void 0===n?void 0:n.split("auth/")[1])||"internal-error";t.onError(ge(this.auth,r))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const n=null===t.eventId||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(hn(e))}saveEventToCache(e){this.cachedEventUids.add(hn(e)),this.lastProcessedEventTime=Date.now()}}function hn(e){return[e.type,e.eventId,e.sessionId,e.tenantId].filter((e=>e)).join("-")}function dn({type:e,error:t}){return"unknown"===e&&"auth/no-auth-event"===(null==t?void 0:t.code)}const pn=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,fn=/^https?/;function _n(e){const t=Te(),{protocol:n,hostname:r}=new URL(t);if(e.startsWith("chrome-extension://")){const i=new URL(e);return""===i.hostname&&""===r?"chrome-extension:"===n&&e.replace("chrome-extension://","")===t.replace("chrome-extension://",""):"chrome-extension:"===n&&i.hostname===r}if(!fn.test(n))return!1;if(pn.test(e))return r===e;const i=e.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}const mn=new Ie(3e4,6e4);function gn(){const e=Ft().___jsl;if(null==e?void 0:e.H)for(const t of Object.keys(e.H))if(e.H[t].r=e.H[t].r||[],e.H[t].L=e.H[t].L||[],e.H[t].r=[...e.H[t].L],e.CP)for(let t=0;t<e.CP.length;t++)e.CP[t]=null}let yn=null;function vn(e){return yn=yn||function(e){return new Promise(((t,n)=>{var r,i,s,o;function a(){gn(),gapi.load("gapi.iframes",{callback:()=>{t(gapi.iframes.getContext())},ontimeout:()=>{gn(),n(ge(e,"network-request-failed"))},timeout:mn.get()})}if(null===(i=null===(r=Ft().gapi)||void 0===r?void 0:r.iframes)||void 0===i?void 0:i.Iframe)t(gapi.iframes.getContext());else{if(!(null===(s=Ft().gapi)||void 0===s?void 0:s.load)){const t=Yt("iframefcb");return Ft()[t]=()=>{gapi.load?a():n(ge(e,"network-request-failed"))},o=`https://apis.google.com/js/api.js?onload=${t}`,new Promise(((e,t)=>{const n=document.createElement("script");var r,i;n.setAttribute("src",o),n.onload=e,n.onerror=e=>{const n=ge("internal-error");n.customData=e,t(n)},n.type="text/javascript",n.charset="UTF-8",(null!==(i=null===(r=document.getElementsByTagName("head"))||void 0===r?void 0:r[0])&&void 0!==i?i:document).appendChild(n)}))}a()}})).catch((e=>{throw yn=null,e}))}(e),yn}const wn=new Ie(5e3,15e3),bn={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},kn=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function En(e){const t=e.config;ve(t.authDomain,e,"auth-domain-config-required");const n=t.emulator?Ce(t,"emulator/auth/iframe"):`https://${e.config.authDomain}/__/auth/iframe`,r={apiKey:t.apiKey,appName:e.name,v:ce},i=kn.get(e.config.apiHost);i&&(r.eid=i);const s=e._getFrameworks();return s.length&&(r.fw=s.join(",")),`${n}?${A(r).slice(1)}`}const Tn={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};class Sn{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch(e){}}}function In(e,t,n,r,i,s){ve(e.config.authDomain,e,"auth-domain-config-required"),ve(e.config.apiKey,e,"invalid-api-key");const o={apiKey:e.config.apiKey,appName:e.name,authType:n,redirectUrl:r,v:ce,eventId:i};if(t instanceof wt){t.setDefaultLanguage(e.languageCode),o.providerId=t.providerId||"",S(t.getCustomParameters())||(o.customParameters=JSON.stringify(t.getCustomParameters()));for(const[e,t]of Object.entries(s||{}))o[e]=t}if(t instanceof bt){const e=t.getScopes().filter((e=>""!==e));e.length>0&&(o.scopes=e.join(","))}e.tenantId&&(o.tid=e.tenantId);const a=o;for(const e of Object.keys(a))void 0===a[e]&&delete a[e];return`${function({config:e}){return e.emulator?Ce(e,"emulator/auth/handler"):`https://${e.authDomain}/__/auth/handler`}(e)}?${A(a).slice(1)}`}const Cn="webStorageSupport",xn=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=zt,this._completeRedirectFn=ln}async _openPopup(e,t,n,r){var i;return be(null===(i=this.eventManagers[e._key()])||void 0===i?void 0:i.manager,"_initialize() not called before _openPopup()"),function(e,t,n,r=500,i=600){const s=Math.max((window.screen.availHeight-i)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let a="";const c=Object.assign(Object.assign({},Tn),{width:r.toString(),height:i.toString(),top:s,left:o}),l=p().toLowerCase();n&&(a=tt(l)?"_blank":n),Xe(l)&&(t=t||"http://localhost",c.scrollbars="yes");const u=Object.entries(c).reduce(((e,[t,n])=>`${e}${t}=${n},`),"");if(function(e=p()){var t;return ot(e)&&!!(null===(t=window.navigator)||void 0===t?void 0:t.standalone)}(l)&&"_self"!==a)return function(e,t){const n=document.createElement("a");n.href=e,n.target=t;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}(t||"",a),new Sn(null);const h=window.open(t||"",a,u);ve(h,e,"popup-blocked");try{h.focus()}catch(e){}return new Sn(h)}(e,In(e,t,n,Te(),r),Lt())}async _openRedirect(e,t,n,r){var i;return await this._originValidation(e),i=In(e,t,n,Te(),r),Ft().location.href=i,new Promise((()=>{}))}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:e,promise:n}=this.eventManagers[t];return e?Promise.resolve(e):(be(n,"If manager is not set, promise should be"),n)}const n=this.initAndGetManager(e);return this.eventManagers[t]={promise:n},n}async initAndGetManager(e){const t=await async function(e){const t=await vn(e),n=Ft().gapi;return ve(n,e,"internal-error"),t.open({where:document.body,url:En(e),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:bn,dontclear:!0},(t=>new Promise((async(n,r)=>{await t.restyle({setHideOnLeave:!1});const i=ge(e,"network-request-failed"),s=Ft().setTimeout((()=>{r(i)}),wn.get());function o(){Ft().clearTimeout(s),n(t)}t.ping(o).then(o,(()=>{r(i)}))}))))}(e),n=new un(e);return t.register("authEvent",(t=>(ve(null==t?void 0:t.authEvent,e,"invalid-auth-event"),{status:n.onEvent(t.authEvent)?"ACK":"ERROR"})),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=t,n}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Cn,{type:Cn},(n=>{var r;const i=null===(r=null==n?void 0:n[0])||void 0===r?void 0:r.webStorageSupport;void 0!==i&&t(!!i),me(e,"internal-error")}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=async function(e){if(e.config.emulator)return;const{authorizedDomains:t}=await async function(e,t={}){return Oe(e,"GET","/v1/projects",t)}(e);for(const e of t)try{if(_n(e))return}catch(e){}me(e,"unauthorized-domain")}(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return at()||et()||ot()}};var An,Nn="@firebase/auth",Pn="0.19.3";class On{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),(null===(e=this.auth.currentUser)||void 0===e?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged((t=>{var n;e((null===(n=t)||void 0===n?void 0:n.stsTokenManager.accessToken)||null)}));this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){ve(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}An="Browser",ie(new F("auth",((e,{options:t})=>{const n=e.getProvider("app").getImmediate(),{apiKey:r,authDomain:i}=n.options;return(e=>{ve(r&&!r.includes(":"),"invalid-api-key",{appName:e.name}),ve(!(null==i?void 0:i.includes(":")),"argument-error",{appName:e.name});const n={apiKey:r,authDomain:i,clientPlatform:An,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:ct(An)},s=new lt(e,n);return function(e,t){const n=(null==t?void 0:t.persistence)||[],r=(Array.isArray(n)?n:[n]).map(Ee);(null==t?void 0:t.errorMap)&&e._updateErrorMap(t.errorMap),e._initializeWithPersistence(r,null==t?void 0:t.popupRedirectResolver)}(s,t),s})(n)}),"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback(((e,t,n)=>{e.getProvider("auth-internal").initialize()}))),ie(new F("auth-internal",(e=>{return t=ut(e.getProvider("auth").getImmediate()),new On(t);var t}),"PRIVATE").setInstantiationMode("EXPLICIT")),ue(Nn,Pn,void 0),ue(Nn,Pn,"esm2017");var Rn=n(1733);const Dn="@firebase/installations",zn="0.5.4",Mn="w:0.5.4",Ln=new y("installations","Installations",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."});function Un(e){return e instanceof g&&e.code.includes("request-failed")}function Fn({projectId:e}){return`https://firebaseinstallations.googleapis.com/v1/projects/${e}/installations`}function jn(e){return{token:e.token,requestStatus:2,expiresIn:(t=e.expiresIn,Number(t.replace("s","000"))),creationTime:Date.now()};var t}async function qn(e,t){const n=(await t.json()).error;return Ln.create("request-failed",{requestName:e,serverCode:n.code,serverMessage:n.message,serverStatus:n.status})}function Bn({apiKey:e}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":e})}async function Wn(e){const t=await e();return t.status>=500&&t.status<600?e():t}function Vn(e){return new Promise((t=>{setTimeout(t,e)}))}const Hn=/^[cdef][\w-]{21}$/;function Kn(){try{const e=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(e),e[0]=112+e[0]%16;const t=function(e){return(t=e,btoa(String.fromCharCode(...t)).replace(/\+/g,"-").replace(/\//g,"_")).substr(0,22);var t}(e);return Hn.test(t)?t:""}catch(e){return""}}function $n(e){return`${e.appName}!${e.appId}`}const Gn=new Map;function Jn(e,t){const n=$n(e);Zn(n,t),function(e,t){const n=(!Yn&&"BroadcastChannel"in self&&(Yn=new BroadcastChannel("[Firebase] FID Change"),Yn.onmessage=e=>{Zn(e.data.key,e.data.fid)}),Yn);n&&n.postMessage({key:e,fid:t}),0===Gn.size&&Yn&&(Yn.close(),Yn=null)}(n,t)}function Zn(e,t){const n=Gn.get(e);if(n)for(const e of n)e(t)}let Yn=null;const Qn="firebase-installations-store";let Xn=null;function er(){return Xn||(Xn=(0,Rn.openDb)("firebase-installations-database",1,(e=>{0===e.oldVersion&&e.createObjectStore(Qn)}))),Xn}async function tr(e,t){const n=$n(e),r=(await er()).transaction(Qn,"readwrite"),i=r.objectStore(Qn),s=await i.get(n);return await i.put(t,n),await r.complete,s&&s.fid===t.fid||Jn(e,t.fid),t}async function nr(e){const t=$n(e),n=(await er()).transaction(Qn,"readwrite");await n.objectStore(Qn).delete(t),await n.complete}async function rr(e,t){const n=$n(e),r=(await er()).transaction(Qn,"readwrite"),i=r.objectStore(Qn),s=await i.get(n),o=t(s);return void 0===o?await i.delete(n):await i.put(o,n),await r.complete,!o||s&&s.fid===o.fid||Jn(e,o.fid),o}async function ir(e){let t;const n=await rr(e,(n=>{const r=function(e){return ar(e||{fid:Kn(),registrationStatus:0})}(n),i=function(e,t){if(0===t.registrationStatus){if(!navigator.onLine)return{installationEntry:t,registrationPromise:Promise.reject(Ln.create("app-offline"))};const n={fid:t.fid,registrationStatus:1,registrationTime:Date.now()},r=async function(e,t){try{const n=await async function(e,{fid:t}){const n=Fn(e),r=Bn(e),i={fid:t,authVersion:"FIS_v2",appId:e.appId,sdkVersion:Mn},s={method:"POST",headers:r,body:JSON.stringify(i)},o=await Wn((()=>fetch(n,s)));if(o.ok){const e=await o.json();return{fid:e.fid||t,registrationStatus:2,refreshToken:e.refreshToken,authToken:jn(e.authToken)}}throw await qn("Create Installation",o)}(e,t);return tr(e,n)}catch(n){throw Un(n)&&409===n.customData.serverCode?await nr(e):await tr(e,{fid:t.fid,registrationStatus:0}),n}}(e,n);return{installationEntry:n,registrationPromise:r}}return 1===t.registrationStatus?{installationEntry:t,registrationPromise:sr(e)}:{installationEntry:t}}(e,r);return t=i.registrationPromise,i.installationEntry}));return""===n.fid?{installationEntry:await t}:{installationEntry:n,registrationPromise:t}}async function sr(e){let t=await or(e);for(;1===t.registrationStatus;)await Vn(100),t=await or(e);if(0===t.registrationStatus){const{installationEntry:t,registrationPromise:n}=await ir(e);return n||t}return t}function or(e){return rr(e,(e=>{if(!e)throw Ln.create("installation-not-found");return ar(e)}))}function ar(e){return 1===(t=e).registrationStatus&&t.registrationTime+1e4<Date.now()?{fid:e.fid,registrationStatus:0}:e;var t}async function cr({appConfig:e,platformLoggerProvider:t},n){const r=function(e,{fid:t}){return`${Fn(e)}/${t}/authTokens:generate`}(e,n),i=function(e,{refreshToken:t}){const n=Bn(e);return n.append("Authorization",function(e){return`FIS_v2 ${e}`}(t)),n}(e,n),s=t.getImmediate({optional:!0});s&&i.append("x-firebase-client",s.getPlatformInfoString());const o={installation:{sdkVersion:Mn}},a={method:"POST",headers:i,body:JSON.stringify(o)},c=await Wn((()=>fetch(r,a)));if(c.ok)return jn(await c.json());throw await qn("Generate Auth Token",c)}async function lr(e,t=!1){let n;const r=await rr(e.appConfig,(r=>{if(!hr(r))throw Ln.create("not-registered");const i=r.authToken;if(!t&&(2===(s=i).requestStatus&&!function(e){const t=Date.now();return t<e.creationTime||e.creationTime+e.expiresIn<t+36e5}(s)))return r;var s;if(1===i.requestStatus)return n=async function(e,t){let n=await ur(e.appConfig);for(;1===n.authToken.requestStatus;)await Vn(100),n=await ur(e.appConfig);const r=n.authToken;return 0===r.requestStatus?lr(e,t):r}(e,t),r;{if(!navigator.onLine)throw Ln.create("app-offline");const t=function(e){const t={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},e),{authToken:t})}(r);return n=async function(e,t){try{const n=await cr(e,t),r=Object.assign(Object.assign({},t),{authToken:n});return await tr(e.appConfig,r),n}catch(n){if(!Un(n)||401!==n.customData.serverCode&&404!==n.customData.serverCode){const n=Object.assign(Object.assign({},t),{authToken:{requestStatus:0}});await tr(e.appConfig,n)}else await nr(e.appConfig);throw n}}(e,t),t}}));return n?await n:r.authToken}function ur(e){return rr(e,(e=>{if(!hr(e))throw Ln.create("not-registered");return 1===(t=e.authToken).requestStatus&&t.requestTime+1e4<Date.now()?Object.assign(Object.assign({},e),{authToken:{requestStatus:0}}):e;var t}))}function hr(e){return void 0!==e&&2===e.registrationStatus}function dr(e){return Ln.create("missing-app-config-values",{valueName:e})}const pr="installations";ie(new F(pr,(e=>{const t=e.getProvider("app").getImmediate(),n=function(e){if(!e||!e.options)throw dr("App Configuration");if(!e.name)throw dr("App Name");const t=["projectId","apiKey","appId"];for(const n of t)if(!e.options[n])throw dr(n);return{appName:e.name,projectId:e.options.projectId,apiKey:e.options.apiKey,appId:e.options.appId}}(t);return{app:t,appConfig:n,platformLoggerProvider:se(t,"platform-logger"),_delete:()=>Promise.resolve()}}),"PUBLIC")),ie(new F("installations-internal",(e=>{const t=se(e.getProvider("app").getImmediate(),pr).getImmediate();return{getId:()=>async function(e){const t=e,{installationEntry:n,registrationPromise:r}=await ir(t.appConfig);return r?r.catch(console.error):lr(t).catch(console.error),n.fid}(t),getToken:e=>async function(e,t=!1){const n=e;return await async function(e){const{registrationPromise:t}=await ir(e);t&&await t}(n.appConfig),(await lr(n,t)).token}(t,e)}}),"PRIVATE")),ue(Dn,zn),ue(Dn,zn,"esm2017");const fr="analytics",_r="https://www.googletagmanager.com/gtag/js",mr=new J("@firebase/analytics");function gr(e){return Promise.all(e.map((e=>e.catch((e=>e)))))}const yr=new y("analytics","Analytics",{"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-intialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.'}),vr=new class{constructor(e={},t=1e3){this.throttleMetadata=e,this.intervalMillis=t}getThrottleMetadata(e){return this.throttleMetadata[e]}setThrottleMetadata(e,t){this.throttleMetadata[e]=t}deleteThrottleMetadata(e){delete this.throttleMetadata[e]}};function wr(e){return new Headers({Accept:"application/json","x-goog-api-key":e})}async function br(e,t=vr,n){const{appId:r,apiKey:i,measurementId:s}=e.options;if(!r)throw yr.create("no-app-id");if(!i){if(s)return{measurementId:s,appId:r};throw yr.create("no-api-key")}const o=t.getThrottleMetadata(r)||{backoffCount:0,throttleEndTimeMillis:Date.now()},a=new Er;return setTimeout((async()=>{a.abort()}),void 0!==n?n:6e4),kr({appId:r,apiKey:i,measurementId:s},o,a,t)}async function kr(e,{throttleEndTimeMillis:t,backoffCount:n},r,i=vr){const{appId:s,measurementId:o}=e;try{await function(e,t){return new Promise(((n,r)=>{const i=Math.max(t-Date.now(),0),s=setTimeout(n,i);e.addEventListener((()=>{clearTimeout(s),r(yr.create("fetch-throttle",{throttleEndTimeMillis:t}))}))}))}(r,t)}catch(e){if(o)return mr.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${o} provided in the "measurementId" field in the local Firebase config. [${e.message}]`),{appId:s,measurementId:o};throw e}try{const t=await async function(e){var t;const{appId:n,apiKey:r}=e,i={method:"GET",headers:wr(r)},s="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig".replace("{app-id}",n),o=await fetch(s,i);if(200!==o.status&&304!==o.status){let e="";try{const n=await o.json();(null===(t=n.error)||void 0===t?void 0:t.message)&&(e=n.error.message)}catch(e){}throw yr.create("config-fetch-failed",{httpStatus:o.status,responseMessage:e})}return o.json()}(e);return i.deleteThrottleMetadata(s),t}catch(t){if(!function(e){if(!(e instanceof g&&e.customData))return!1;const t=Number(e.customData.httpStatus);return 429===t||500===t||503===t||504===t}(t)){if(i.deleteThrottleMetadata(s),o)return mr.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${o} provided in the "measurementId" field in the local Firebase config. [${t.message}]`),{appId:s,measurementId:o};throw t}const a=503===Number(t.customData.httpStatus)?L(n,i.intervalMillis,30):L(n,i.intervalMillis),c={throttleEndTimeMillis:Date.now()+a,backoffCount:n+1};return i.setThrottleMetadata(s,c),mr.debug(`Calling attemptFetch again in ${a} millis`),kr(e,c,r,i)}}class Er{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach((e=>e()))}}async function Tr(e,t,n,r,i,s,o){var a;const c=br(e);c.then((t=>{n[t.measurementId]=t.appId,e.options.measurementId&&t.measurementId!==e.options.measurementId&&mr.warn(`The measurement ID in the local Firebase config (${e.options.measurementId}) does not match the measurement ID fetched from the server (${t.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)})).catch((e=>mr.error(e))),t.push(c);const l=async function(){if("object"!=typeof indexedDB)return mr.warn(yr.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;try{await new Promise(((e,t)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(r),e(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{var e;t((null===(e=i.error)||void 0===e?void 0:e.message)||"")}}catch(e){t(e)}}))}catch(e){return mr.warn(yr.create("indexeddb-unavailable",{errorInfo:e}).message),!1}return!0}().then((e=>e?r.getId():void 0)),[u,h]=await Promise.all([c,l]);(function(){const e=window.document.getElementsByTagName("script");for(const t of Object.values(e))if(t.src&&t.src.includes(_r))return t;return null})()||function(e,t){const n=document.createElement("script");n.src=`${_r}?l=${e}&id=${t}`,n.async=!0,document.head.appendChild(n)}(s,u.measurementId),i("js",new Date);const d=null!==(a=null==o?void 0:o.config)&&void 0!==a?a:{};return d.origin="firebase",d.update=!0,null!=h&&(d.firebase_id=h),i("config",u.measurementId,d),u.measurementId}class Sr{constructor(e){this.app=e}_delete(){return delete Ir[this.app.options.appId],Promise.resolve()}}let Ir={},Cr=[];const xr={};let Ar,Nr,Pr="dataLayer",Or=!1;function Rr(e,t,n){!function(){const e=[];if(_()&&e.push("This is a browser extension environment."),"undefined"!=typeof navigator&&navigator.cookieEnabled||e.push("Cookies are not available."),e.length>0){const t=e.map(((e,t)=>`(${t+1}) ${e}`)).join(" "),n=yr.create("invalid-analytics-context",{errorInfo:t});mr.warn(n.message)}}();const r=e.options.appId;if(!r)throw yr.create("no-app-id");if(!e.options.apiKey){if(!e.options.measurementId)throw yr.create("no-api-key");mr.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${e.options.measurementId} provided in the "measurementId" field in the local Firebase config.`)}if(null!=Ir[r])throw yr.create("already-exists",{id:r});if(!Or){!function(e){let t=[];Array.isArray(window.dataLayer)?t=window.dataLayer:window.dataLayer=t}();const{wrappedGtag:e,gtagCore:t}=function(e,t,n,r,i){let s=function(...e){window.dataLayer.push(arguments)};return window.gtag&&"function"==typeof window.gtag&&(s=window.gtag),window.gtag=function(e,t,n,r){return async function(i,s,o){try{"event"===i?await async function(e,t,n,r,i){try{let s=[];if(i&&i.send_to){let e=i.send_to;Array.isArray(e)||(e=[e]);const r=await gr(n);for(const n of e){const e=r.find((e=>e.measurementId===n)),i=e&&t[e.appId];if(!i){s=[];break}s.push(i)}}0===s.length&&(s=Object.values(t)),await Promise.all(s),e("event",r,i||{})}catch(e){mr.error(e)}}(e,t,n,s,o):"config"===i?await async function(e,t,n,r,i,s){const o=r[i];try{if(o)await t[o];else{const e=(await gr(n)).find((e=>e.measurementId===i));e&&await t[e.appId]}}catch(e){mr.error(e)}e("config",i,s)}(e,t,n,r,s,o):e("set",s)}catch(e){mr.error(e)}}}(s,e,t,n),{gtagCore:s,wrappedGtag:window.gtag}}(Ir,Cr,xr);Nr=e,Ar=t,Or=!0}return Ir[r]=Tr(e,Cr,xr,t,Ar,Pr,n),new Sr(e)}const Dr="@firebase/analytics",zr="0.7.4";ie(new F(fr,((e,{options:t})=>Rr(e.getProvider("app").getImmediate(),e.getProvider("installations-internal").getImmediate(),t)),"PUBLIC")),ie(new F("analytics-internal",(function(e){try{const t=e.getProvider(fr).getImmediate();return{logEvent:(e,n,r)=>function(e,t,n,r){e=U(e),async function(e,t,n,r,i){if(i&&i.global)e("event",n,r);else{const i=await t;e("event",n,Object.assign(Object.assign({},r),{send_to:i}))}}(Nr,Ir[e.app.options.appId],t,n,r).catch((e=>mr.error(e)))}(t,e,n,r)}}catch(e){throw yr.create("interop-component-reg-failed",{reason:e})}}),"PRIVATE")),ue(Dr,zr),ue(Dr,zr,"esm2017");const Mr="@firebase/database",Lr="0.12.4";let Ur="";class Fr{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,t){null==t?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),b(t))}get(e){const t=this.domStorage_.getItem(this.prefixedName_(e));return null==t?null:w(t)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}}class jr{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,t){null==t?delete this.cache_[e]:this.cache_[e]=t}get(e){return E(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}}const qr=function(e){try{if("undefined"!=typeof window&&void 0!==window[e]){const t=window[e];return t.setItem("firebase:sentinel","cache"),t.removeItem("firebase:sentinel"),new Fr(t)}}catch(e){}return new jr},Br=qr("localStorage"),Wr=qr("sessionStorage"),Vr=new J("@firebase/database"),Hr=function(){let e=1;return function(){return e++}}(),Kr=function(e){const t=function(e){const t=[];let n=0;for(let r=0;r<e.length;r++){let i=e.charCodeAt(r);if(i>=55296&&i<=56319){const t=i-55296;r++,s(r<e.length,"Surrogate pair missing trail surrogate."),i=65536+(t<<10)+(e.charCodeAt(r)-56320)}i<128?t[n++]=i:i<2048?(t[n++]=i>>6|192,t[n++]=63&i|128):i<65536?(t[n++]=i>>12|224,t[n++]=i>>6&63|128,t[n++]=63&i|128):(t[n++]=i>>18|240,t[n++]=i>>12&63|128,t[n++]=i>>6&63|128,t[n++]=63&i|128)}return t}(e),n=new O;n.update(t);const r=n.digest();return c.encodeByteArray(r)},$r=function(...e){let t="";for(let n=0;n<e.length;n++){const r=e[n];Array.isArray(r)||r&&"object"==typeof r&&"number"==typeof r.length?t+=$r.apply(null,r):t+="object"==typeof r?b(r):r,t+=" "}return t};let Gr=null,Jr=!0;const Zr=function(...e){if(!0===Jr&&(Jr=!1,null===Gr&&!0===Wr.get("logging_enabled")&&(t=!0,s(!n||!0===t||!1===t,"Can't turn on custom loggers persistently."),!0===t?(Vr.logLevel=V.VERBOSE,Gr=Vr.log.bind(Vr),n&&Wr.set("logging_enabled",!0)):"function"==typeof t?Gr=t:(Gr=null,Wr.remove("logging_enabled")))),Gr){const t=$r.apply(null,e);Gr(t)}var t,n},Yr=function(e){return function(...t){Zr(e,...t)}},Qr=function(...e){const t="FIREBASE INTERNAL ERROR: "+$r(...e);Vr.error(t)},Xr=function(...e){const t=`FIREBASE FATAL ERROR: ${$r(...e)}`;throw Vr.error(t),new Error(t)},ei=function(...e){const t="FIREBASE WARNING: "+$r(...e);Vr.warn(t)},ti=function(e){return"number"==typeof e&&(e!=e||e===Number.POSITIVE_INFINITY||e===Number.NEGATIVE_INFINITY)},ni="[MIN_NAME]",ri="[MAX_NAME]",ii=function(e,t){if(e===t)return 0;if(e===ni||t===ri)return-1;if(t===ni||e===ri)return 1;{const n=di(e),r=di(t);return null!==n?null!==r?n-r==0?e.length-t.length:n-r:-1:null!==r?1:e<t?-1:1}},si=function(e,t){return e===t?0:e<t?-1:1},oi=function(e,t){if(t&&e in t)return t[e];throw new Error("Missing required key ("+e+") in object: "+b(t))},ai=function(e){if("object"!=typeof e||null===e)return b(e);const t=[];for(const n in e)t.push(n);t.sort();let n="{";for(let r=0;r<t.length;r++)0!==r&&(n+=","),n+=b(t[r]),n+=":",n+=ai(e[t[r]]);return n+="}",n},ci=function(e,t){const n=e.length;if(n<=t)return[e];const r=[];for(let i=0;i<n;i+=t)i+t>n?r.push(e.substring(i,n)):r.push(e.substring(i,i+t));return r};function li(e,t){for(const n in e)e.hasOwnProperty(n)&&t(n,e[n])}const ui=function(e){s(!ti(e),"Invalid JSON number");let t,n,r,i,o;0===e?(n=0,r=0,t=1/e==-1/0?1:0):(t=e<0,(e=Math.abs(e))>=Math.pow(2,-1022)?(i=Math.min(Math.floor(Math.log(e)/Math.LN2),1023),n=i+1023,r=Math.round(e*Math.pow(2,52-i)-Math.pow(2,52))):(n=0,r=Math.round(e/Math.pow(2,-1074))));const a=[];for(o=52;o;o-=1)a.push(r%2?1:0),r=Math.floor(r/2);for(o=11;o;o-=1)a.push(n%2?1:0),n=Math.floor(n/2);a.push(t?1:0),a.reverse();const c=a.join("");let l="";for(o=0;o<64;o+=8){let e=parseInt(c.substr(o,8),2).toString(16);1===e.length&&(e="0"+e),l+=e}return l.toLowerCase()},hi=new RegExp("^-?(0*)\\d{1,10}$"),di=function(e){if(hi.test(e)){const t=Number(e);if(t>=-2147483648&&t<=2147483647)return t}return null},pi=function(e){try{e()}catch(e){setTimeout((()=>{const t=e.stack||"";throw ei("Exception was thrown by user callback.",t),e}),Math.floor(0))}},fi=function(e,t){const n=setTimeout(e,t);return"object"==typeof n&&n.unref&&n.unref(),n};class _i{constructor(e,t){this.appName_=e,this.appCheckProvider=t,this.appCheck=null==t?void 0:t.getImmediate({optional:!0}),this.appCheck||null==t||t.get().then((e=>this.appCheck=e))}getToken(e){return this.appCheck?this.appCheck.getToken(e):new Promise(((t,n)=>{setTimeout((()=>{this.appCheck?this.getToken(e).then(t,n):t(null)}),0)}))}addTokenChangeListener(e){var t;null===(t=this.appCheckProvider)||void 0===t||t.get().then((t=>t.addTokenListener(e)))}notifyForInvalidToken(){ei(`Provided AppCheck credentials for the app named "${this.appName_}" are invalid. This usually indicates your app was not initialized correctly.`)}}class mi{constructor(e,t,n){this.appName_=e,this.firebaseOptions_=t,this.authProvider_=n,this.auth_=null,this.auth_=n.getImmediate({optional:!0}),this.auth_||n.onInit((e=>this.auth_=e))}getToken(e){return this.auth_?this.auth_.getToken(e).catch((e=>e&&"auth/token-not-initialized"===e.code?(Zr("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(e))):new Promise(((t,n)=>{setTimeout((()=>{this.auth_?this.getToken(e).then(t,n):t(null)}),0)}))}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then((t=>t.addAuthTokenListener(e)))}removeTokenChangeListener(e){this.authProvider_.get().then((t=>t.removeAuthTokenListener(e)))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',ei(e)}}class gi{constructor(e){this.accessToken=e}getToken(e){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(e){e(this.accessToken)}removeTokenChangeListener(e){}notifyForInvalidToken(){}}gi.OWNER="owner";const yi=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,vi="websocket",wi="long_polling";class bi{constructor(e,t,n,r,i=!1,s="",o=!1){this.secure=t,this.namespace=n,this.webSocketOnly=r,this.nodeAdmin=i,this.persistenceKey=s,this.includeNamespaceInQueryParams=o,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=Br.get("host:"+e)||this._host}isCacheableHost(){return"s-"===this.internalHost.substr(0,2)}isCustomHost(){return"firebaseio.com"!==this._domain&&"firebaseio-demo.com"!==this._domain}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&Br.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){const e=this.secure?"https://":"http://",t=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${t}`}}function ki(e,t,n){let r;if(s("string"==typeof t,"typeof type must == string"),s("object"==typeof n,"typeof params must == object"),t===vi)r=(e.secure?"wss://":"ws://")+e.internalHost+"/.ws?";else{if(t!==wi)throw new Error("Unknown connection type: "+t);r=(e.secure?"https://":"http://")+e.internalHost+"/.lp?"}(function(e){return e.host!==e.internalHost||e.isCustomHost()||e.includeNamespaceInQueryParams})(e)&&(n.ns=e.namespace);const i=[];return li(n,((e,t)=>{i.push(e+"="+t)})),r+i.join("&")}class Ei{constructor(){this.counters_={}}incrementCounter(e,t=1){E(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=t}get(){return u(this.counters_)}}const Ti={},Si={};function Ii(e){const t=e.toString();return Ti[t]||(Ti[t]=new Ei),Ti[t]}class Ci{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,t){this.closeAfterResponse=e,this.onClose=t,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,t){for(this.pendingResponses[e]=t;this.pendingResponses[this.currentResponseNum];){const e=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let t=0;t<e.length;++t)e[t]&&pi((()=>{this.onMessage_(e[t])}));if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}class xi{constructor(e,t,n,r,i,s,o){this.connId=e,this.repoInfo=t,this.applicationId=n,this.appCheckToken=r,this.authToken=i,this.transportSessionId=s,this.lastSessionId=o,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=Yr(e),this.stats_=Ii(t),this.urlFn=e=>(this.appCheckToken&&(e.ac=this.appCheckToken),ki(t,wi,e))}open(e,t){this.curSegmentNum=0,this.onDisconnect_=t,this.myPacketOrderer=new Ci(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout((()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null}),Math.floor(3e4)),function(e){if("complete"===document.readyState)e();else{let t=!1;const n=function(){document.body?t||(t=!0,e()):setTimeout(n,Math.floor(10))};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",(()=>{"complete"===document.readyState&&n()})),window.attachEvent("onload",n))}}((()=>{if(this.isClosed_)return;this.scriptTagHolder=new Ai(((...e)=>{const[t,n,r,i,s]=e;if(this.incrementIncomingBytes_(e),this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,"start"===t)this.id=n,this.password=r;else{if("close"!==t)throw new Error("Unrecognized command received: "+t);n?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(n,(()=>{this.onClosed_()}))):this.onClosed_()}}),((...e)=>{const[t,n]=e;this.incrementIncomingBytes_(e),this.myPacketOrderer.handleResponse(t,n)}),(()=>{this.onClosed_()}),this.urlFn);const e={start:"t"};e.ser=Math.floor(1e8*Math.random()),this.scriptTagHolder.uniqueCallbackIdentifier&&(e.cb=this.scriptTagHolder.uniqueCallbackIdentifier),e.v="5",this.transportSessionId&&(e.s=this.transportSessionId),this.lastSessionId&&(e.ls=this.lastSessionId),this.applicationId&&(e.p=this.applicationId),this.appCheckToken&&(e.ac=this.appCheckToken),"undefined"!=typeof location&&location.hostname&&yi.test(location.hostname)&&(e.r="f");const t=this.urlFn(e);this.log_("Connecting via long-poll to "+t),this.scriptTagHolder.addTag(t,(()=>{}))}))}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){xi.forceAllow_=!0}static forceDisallow(){xi.forceDisallow_=!0}static isAvailable(){return!(!xi.forceAllow_&&(xi.forceDisallow_||"undefined"==typeof document||null==document.createElement||"object"==typeof window&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href)||"object"==typeof Windows&&"object"==typeof Windows.UI))}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){const t=b(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);const n=function(e){const t=a(e);return c.encodeByteArray(t,!0)}(t),r=ci(n,1840);for(let e=0;e<r.length;e++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,r.length,r[e]),this.curSegmentNum++}addDisconnectPingFrame(e,t){this.myDisconnFrame=document.createElement("iframe");const n={dframe:"t"};n.id=e,n.pw=t,this.myDisconnFrame.src=this.urlFn(n),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){const t=b(e).length;this.bytesReceived+=t,this.stats_.incrementCounter("bytes_received",t)}}class Ai{constructor(e,t,n,r){this.onDisconnect=n,this.urlFn=r,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(1e8*Math.random()),this.sendNewPolls=!0;{this.uniqueCallbackIdentifier=Hr(),window["pLPCommand"+this.uniqueCallbackIdentifier]=e,window["pRTLPCB"+this.uniqueCallbackIdentifier]=t,this.myIFrame=Ai.createIFrame_();let n="";this.myIFrame.src&&"javascript:"===this.myIFrame.src.substr(0,"javascript:".length)&&(n='<script>document.domain="'+document.domain+'";<\/script>');const r="<html><body>"+n+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(r),this.myIFrame.doc.close()}catch(e){Zr("frame writing exception"),e.stack&&Zr(e.stack),Zr(e)}}}static createIFrame_(){const e=document.createElement("iframe");if(e.style.display="none",!document.body)throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";document.body.appendChild(e);try{e.contentWindow.document||Zr("No IE domain setting required")}catch(t){const n=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+n+"';document.close();})())"}return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.innerHTML="",setTimeout((()=>{null!==this.myIFrame&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)}),Math.floor(0)));const e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,t){for(this.myID=e,this.myPW=t,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const e={};e.id=this.myID,e.pw=this.myPW,e.ser=this.currentSerial;let t=this.urlFn(e),n="",r=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+30+n.length<=1870;){const e=this.pendingSegs.shift();n=n+"&seg"+r+"="+e.seg+"&ts"+r+"="+e.ts+"&d"+r+"="+e.d,r++}return t+=n,this.addLongPollTag_(t,this.currentSerial),!0}return!1}enqueueSegment(e,t,n){this.pendingSegs.push({seg:e,ts:t,d:n}),this.alive&&this.newRequest_()}addLongPollTag_(e,t){this.outstandingRequests.add(t);const n=()=>{this.outstandingRequests.delete(t),this.newRequest_()},r=setTimeout(n,Math.floor(25e3));this.addTag(e,(()=>{clearTimeout(r),n()}))}addTag(e,t){setTimeout((()=>{try{if(!this.sendNewPolls)return;const n=this.myIFrame.doc.createElement("script");n.type="text/javascript",n.async=!0,n.src=e,n.onload=n.onreadystatechange=function(){const e=n.readyState;e&&"loaded"!==e&&"complete"!==e||(n.onload=n.onreadystatechange=null,n.parentNode&&n.parentNode.removeChild(n),t())},n.onerror=()=>{Zr("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(n)}catch(e){}}),Math.floor(1))}}let Ni=null;"undefined"!=typeof MozWebSocket?Ni=MozWebSocket:"undefined"!=typeof WebSocket&&(Ni=WebSocket);class Pi{constructor(e,t,n,r,i,s,o){this.connId=e,this.applicationId=n,this.appCheckToken=r,this.authToken=i,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=Yr(this.connId),this.stats_=Ii(t),this.connURL=Pi.connectionURL_(t,s,o,r),this.nodeAdmin=t.nodeAdmin}static connectionURL_(e,t,n,r){const i={v:"5"};return"undefined"!=typeof location&&location.hostname&&yi.test(location.hostname)&&(i.r="f"),t&&(i.s=t),n&&(i.ls=n),r&&(i.ac=r),ki(e,vi,i)}open(e,t){this.onDisconnect=t,this.onMessage=e,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,Br.set("previous_websocket_failure",!0);try{{const e={headers:{"X-Firebase-GMPID":this.applicationId||"","X-Firebase-AppCheck":this.appCheckToken||""}};this.mySock=new Ni(this.connURL,[],e)}}catch(e){this.log_("Error instantiating WebSocket.");const t=e.message||e.data;return t&&this.log_(t),void this.onClosed_()}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=e=>{this.handleIncomingFrame(e)},this.mySock.onerror=e=>{this.log_("WebSocket error.  Closing connection.");const t=e.message||e.data;t&&this.log_(t),this.onClosed_()}}start(){}static forceDisallow(){Pi.forceDisallow_=!0}static isAvailable(){let e=!1;if("undefined"!=typeof navigator&&navigator.userAgent){const t=/Android ([0-9]{0,}\.[0-9]{0,})/,n=navigator.userAgent.match(t);n&&n.length>1&&parseFloat(n[1])<4.4&&(e=!0)}return!e&&null!==Ni&&!Pi.forceDisallow_}static previouslyFailed(){return Br.isInMemoryStorage||!0===Br.get("previous_websocket_failure")}markConnectionHealthy(){Br.remove("previous_websocket_failure")}appendFrame_(e){if(this.frames.push(e),this.frames.length===this.totalFrames){const e=this.frames.join("");this.frames=null;const t=w(e);this.onMessage(t)}}handleNewFrameCount_(e){this.totalFrames=e,this.frames=[]}extractFrameCount_(e){if(s(null===this.frames,"We already have a frame buffer"),e.length<=6){const t=Number(e);if(!isNaN(t))return this.handleNewFrameCount_(t),null}return this.handleNewFrameCount_(1),e}handleIncomingFrame(e){if(null===this.mySock)return;const t=e.data;if(this.bytesReceived+=t.length,this.stats_.incrementCounter("bytes_received",t.length),this.resetKeepAlive(),null!==this.frames)this.appendFrame_(t);else{const e=this.extractFrameCount_(t);null!==e&&this.appendFrame_(e)}}send(e){this.resetKeepAlive();const t=b(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);const n=ci(t,16384);n.length>1&&this.sendString_(String(n.length));for(let e=0;e<n.length;e++)this.sendString_(n[e])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval((()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()}),Math.floor(45e3))}sendString_(e){try{this.mySock.send(e)}catch(e){this.log_("Exception thrown from WebSocket.send():",e.message||e.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}Pi.responsesRequiredToBeHealthy=2,Pi.healthyTimeout=3e4;class Oi{constructor(e){this.initTransports_(e)}static get ALL_TRANSPORTS(){return[xi,Pi]}initTransports_(e){const t=Pi&&Pi.isAvailable();let n=t&&!Pi.previouslyFailed();if(e.webSocketOnly&&(t||ei("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),n=!0),n)this.transports_=[Pi];else{const e=this.transports_=[];for(const t of Oi.ALL_TRANSPORTS)t&&t.isAvailable()&&e.push(t)}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}class Ri{constructor(e,t,n,r,i,s,o,a,c,l){this.id=e,this.repoInfo_=t,this.applicationId_=n,this.appCheckToken_=r,this.authToken_=i,this.onMessage_=s,this.onReady_=o,this.onDisconnect_=a,this.onKill_=c,this.lastSessionId=l,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=Yr("c:"+this.id+":"),this.transportManager_=new Oi(t),this.log_("Connection created"),this.start_()}start_(){const e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.conn_),n=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout((()=>{this.conn_&&this.conn_.open(t,n)}),Math.floor(0));const r=e.healthyTimeout||0;r>0&&(this.healthyTimeout_=fi((()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>102400?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>10240?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))}),Math.floor(r)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return t=>{e===this.conn_?this.onConnectionLost_(t):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return t=>{2!==this.state_&&(e===this.rx_?this.onPrimaryMessageReceived_(t):e===this.secondaryConn_?this.onSecondaryMessageReceived_(t):this.log_("message on old connection"))}}sendRequest(e){const t={t:"d",d:e};this.sendData_(t)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if("t"in e){const t=e.t;"a"===t?this.upgradeIfSecondaryHealthy_():"r"===t?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),this.tx_!==this.secondaryConn_&&this.rx_!==this.secondaryConn_||this.close()):"o"===t&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){const t=oi("t",e),n=oi("d",e);if("c"===t)this.onSecondaryControl_(n);else{if("d"!==t)throw new Error("Unknown protocol layer: "+t);this.pendingDataMessages.push(n)}}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:"p",d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:"a",d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:"n",d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){const t=oi("t",e),n=oi("d",e);"c"===t?this.onControl_(n):"d"===t&&this.onDataMessage_(n)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){const t=oi("t",e);if("d"in e){const n=e.d;if("h"===t)this.onHandshake_(n);else if("n"===t){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let e=0;e<this.pendingDataMessages.length;++e)this.onDataMessage_(this.pendingDataMessages[e]);this.pendingDataMessages=[],this.tryCleanupConnection()}else"s"===t?this.onConnectionShutdown_(n):"r"===t?this.onReset_(n):"e"===t?Qr("Server Error: "+n):"o"===t?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):Qr("Unknown control packet command: "+t)}}onHandshake_(e){const t=e.ts,n=e.v,r=e.h;this.sessionId=e.s,this.repoInfo_.host=r,0===this.state_&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,t),"5"!==n&&ei("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.secondaryConn_),n=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(t,n),fi((()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())}),Math.floor(6e4))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,1===this.state_?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,t){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(t,this.sessionId),this.onReady_=null),0===this.primaryResponsesRequired_?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):fi((()=>{this.sendPingOnPrimaryIfNecessary_()}),Math.floor(5e3))}sendPingOnPrimaryIfNecessary_(){this.isHealthy_||1!==this.state_||(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:"p",d:{}}}))}onSecondaryConnectionLost_(){const e=this.secondaryConn_;this.secondaryConn_=null,this.tx_!==e&&this.rx_!==e||this.close()}onConnectionLost_(e){this.conn_=null,e||0!==this.state_?1===this.state_&&this.log_("Realtime connection lost."):(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(Br.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(1!==this.state_)throw"Connection is not connected";this.tx_.send(e)}close(){2!==this.state_&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}class Di{put(e,t,n,r){}merge(e,t,n,r){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,t,n){}onDisconnectMerge(e,t,n){}onDisconnectCancel(e,t){}reportStats(e){}}class zi{constructor(e){this.allowedEvents_=e,this.listeners_={},s(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...t){if(Array.isArray(this.listeners_[e])){const n=[...this.listeners_[e]];for(let e=0;e<n.length;e++)n[e].callback.apply(n[e].context,t)}}on(e,t,n){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:t,context:n});const r=this.getInitialEvent(e);r&&t.apply(n,r)}off(e,t,n){this.validateEventType_(e);const r=this.listeners_[e]||[];for(let e=0;e<r.length;e++)if(r[e].callback===t&&(!n||n===r[e].context))return void r.splice(e,1)}validateEventType_(e){s(this.allowedEvents_.find((t=>t===e)),"Unknown event: "+e)}}class Mi extends zi{constructor(){super(["online"]),this.online_=!0,"undefined"==typeof window||void 0===window.addEventListener||f()||(window.addEventListener("online",(()=>{this.online_||(this.online_=!0,this.trigger("online",!0))}),!1),window.addEventListener("offline",(()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))}),!1))}static getInstance(){return new Mi}getInitialEvent(e){return s("online"===e,"Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}}class Li{constructor(e,t){if(void 0===t){this.pieces_=e.split("/");let t=0;for(let e=0;e<this.pieces_.length;e++)this.pieces_[e].length>0&&(this.pieces_[t]=this.pieces_[e],t++);this.pieces_.length=t,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=t}toString(){let e="";for(let t=this.pieceNum_;t<this.pieces_.length;t++)""!==this.pieces_[t]&&(e+="/"+this.pieces_[t]);return e||"/"}}function Ui(){return new Li("")}function Fi(e){return e.pieceNum_>=e.pieces_.length?null:e.pieces_[e.pieceNum_]}function ji(e){return e.pieces_.length-e.pieceNum_}function qi(e){let t=e.pieceNum_;return t<e.pieces_.length&&t++,new Li(e.pieces_,t)}function Bi(e){return e.pieceNum_<e.pieces_.length?e.pieces_[e.pieces_.length-1]:null}function Wi(e,t=0){return e.pieces_.slice(e.pieceNum_+t)}function Vi(e){if(e.pieceNum_>=e.pieces_.length)return null;const t=[];for(let n=e.pieceNum_;n<e.pieces_.length-1;n++)t.push(e.pieces_[n]);return new Li(t,0)}function Hi(e,t){const n=[];for(let t=e.pieceNum_;t<e.pieces_.length;t++)n.push(e.pieces_[t]);if(t instanceof Li)for(let e=t.pieceNum_;e<t.pieces_.length;e++)n.push(t.pieces_[e]);else{const e=t.split("/");for(let t=0;t<e.length;t++)e[t].length>0&&n.push(e[t])}return new Li(n,0)}function Ki(e){return e.pieceNum_>=e.pieces_.length}function $i(e,t){const n=Fi(e),r=Fi(t);if(null===n)return t;if(n===r)return $i(qi(e),qi(t));throw new Error("INTERNAL ERROR: innerPath ("+t+") is not within outerPath ("+e+")")}function Gi(e,t){const n=Wi(e,0),r=Wi(t,0);for(let e=0;e<n.length&&e<r.length;e++){const t=ii(n[e],r[e]);if(0!==t)return t}return n.length===r.length?0:n.length<r.length?-1:1}function Ji(e,t){if(ji(e)!==ji(t))return!1;for(let n=e.pieceNum_,r=t.pieceNum_;n<=e.pieces_.length;n++,r++)if(e.pieces_[n]!==t.pieces_[r])return!1;return!0}function Zi(e,t){let n=e.pieceNum_,r=t.pieceNum_;if(ji(e)>ji(t))return!1;for(;n<e.pieces_.length;){if(e.pieces_[n]!==t.pieces_[r])return!1;++n,++r}return!0}class Yi{constructor(e,t){this.errorPrefix_=t,this.parts_=Wi(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let e=0;e<this.parts_.length;e++)this.byteLength_+=M(this.parts_[e]);Qi(this)}}function Qi(e){if(e.byteLength_>768)throw new Error(e.errorPrefix_+"has a key path longer than 768 bytes ("+e.byteLength_+").");if(e.parts_.length>32)throw new Error(e.errorPrefix_+"path specified exceeds the maximum depth that can be written (32) or object contains a cycle "+Xi(e))}function Xi(e){return 0===e.parts_.length?"":"in property '"+e.parts_.join(".")+"'"}class es extends zi{constructor(){let e,t;super(["visible"]),"undefined"!=typeof document&&void 0!==document.addEventListener&&(void 0!==document.hidden?(t="visibilitychange",e="hidden"):void 0!==document.mozHidden?(t="mozvisibilitychange",e="mozHidden"):void 0!==document.msHidden?(t="msvisibilitychange",e="msHidden"):void 0!==document.webkitHidden&&(t="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,t&&document.addEventListener(t,(()=>{const t=!document[e];t!==this.visible_&&(this.visible_=t,this.trigger("visible",t))}),!1)}static getInstance(){return new es}getInitialEvent(e){return s("visible"===e,"Unknown event type: "+e),[this.visible_]}}const ts=1e3;class ns extends Di{constructor(e,t,n,r,i,s,o,a){if(super(),this.repoInfo_=e,this.applicationId_=t,this.onDataUpdate_=n,this.onConnectStatus_=r,this.onServerInfoUpdate_=i,this.authTokenProvider_=s,this.appCheckTokenProvider_=o,this.authOverride_=a,this.id=ns.nextPersistentConnectionId_++,this.log_=Yr("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=ts,this.maxReconnectDelay_=3e5,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,a)throw new Error("Auth override specified in options, but not supported on non Node.js platforms");es.getInstance().on("visible",this.onVisible_,this),-1===e.host.indexOf("fblocal")&&Mi.getInstance().on("online",this.onOnline_,this)}sendRequest(e,t,n){const r=++this.requestNumber_,i={r,a:e,b:t};this.log_(b(i)),s(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(i),n&&(this.requestCBHash_[r]=n)}get(e){this.initConnection_();const t=new d,n={p:e._path.toString(),q:e._queryObject},r={action:"g",request:n,onComplete:e=>{const r=e.d;"ok"===e.s?(this.onDataUpdate_(n.p,r,!1,null),t.resolve(r)):t.reject(r)}};this.outstandingGets_.push(r),this.outstandingGetCount_++;const i=this.outstandingGets_.length-1;return this.connected_||setTimeout((()=>{const e=this.outstandingGets_[i];void 0!==e&&r===e&&(delete this.outstandingGets_[i],this.outstandingGetCount_--,0===this.outstandingGetCount_&&(this.outstandingGets_=[]),this.log_("get "+i+" timed out on connection"),t.reject(new Error("Client is offline.")))}),3e3),this.connected_&&this.sendGet_(i),t.promise}listen(e,t,n,r){this.initConnection_();const i=e._queryIdentifier,o=e._path.toString();this.log_("Listen called for "+o+" "+i),this.listens.has(o)||this.listens.set(o,new Map),s(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"listen() called for non-default but complete query"),s(!this.listens.get(o).has(i),"listen() called twice for same path/queryId.");const a={onComplete:r,hashFn:t,query:e,tag:n};this.listens.get(o).set(i,a),this.connected_&&this.sendListen_(a)}sendGet_(e){const t=this.outstandingGets_[e];this.sendRequest("g",t.request,(n=>{delete this.outstandingGets_[e],this.outstandingGetCount_--,0===this.outstandingGetCount_&&(this.outstandingGets_=[]),t.onComplete&&t.onComplete(n)}))}sendListen_(e){const t=e.query,n=t._path.toString(),r=t._queryIdentifier;this.log_("Listen on "+n+" for "+r);const i={p:n};e.tag&&(i.q=t._queryObject,i.t=e.tag),i.h=e.hashFn(),this.sendRequest("q",i,(i=>{const s=i.d,o=i.s;ns.warnOnListenWarnings_(s,t),(this.listens.get(n)&&this.listens.get(n).get(r))===e&&(this.log_("listen response",i),"ok"!==o&&this.removeListen_(n,r),e.onComplete&&e.onComplete(o,s))}))}static warnOnListenWarnings_(e,t){if(e&&"object"==typeof e&&E(e,"w")){const n=T(e,"w");if(Array.isArray(n)&&~n.indexOf("no_index")){const e='".indexOn": "'+t._queryParams.getIndex().toString()+'"',n=t._path.toString();ei(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${e} at ${n} to your security rules for better performance.`)}}}refreshAuthToken(e){this.authToken_=e,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},(()=>{})),this.reduceReconnectDelayIfAdminCredential_(e)}reduceReconnectDelayIfAdminCredential_(e){(e&&40===e.length||function(e){const t=k(e).claims;return"object"==typeof t&&!0===t.admin}(e))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=3e4)}refreshAppCheckToken(e){this.appCheckToken_=e,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},(()=>{}))}tryAuth(){if(this.connected_&&this.authToken_){const e=this.authToken_,t=function(e){const t=k(e).claims;return!!t&&"object"==typeof t&&t.hasOwnProperty("iat")}(e)?"auth":"gauth",n={cred:e};null===this.authOverride_?n.noauth=!0:"object"==typeof this.authOverride_&&(n.authvar=this.authOverride_),this.sendRequest(t,n,(t=>{const n=t.s,r=t.d||"error";this.authToken_===e&&("ok"===n?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(n,r))}))}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},(e=>{const t=e.s,n=e.d||"error";"ok"===t?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(t,n)}))}unlisten(e,t){const n=e._path.toString(),r=e._queryIdentifier;this.log_("Unlisten called for "+n+" "+r),s(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(n,r)&&this.connected_&&this.sendUnlisten_(n,r,e._queryObject,t)}sendUnlisten_(e,t,n,r){this.log_("Unlisten on "+e+" for "+t);const i={p:e};r&&(i.q=n,i.t=r),this.sendRequest("n",i)}onDisconnectPut(e,t,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",e,t,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"o",data:t,onComplete:n})}onDisconnectMerge(e,t,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",e,t,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"om",data:t,onComplete:n})}onDisconnectCancel(e,t){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",e,null,t):this.onDisconnectRequestQueue_.push({pathString:e,action:"oc",data:null,onComplete:t})}sendOnDisconnect_(e,t,n,r){const i={p:t,d:n};this.log_("onDisconnect "+e,i),this.sendRequest(e,i,(e=>{r&&setTimeout((()=>{r(e.s,e.d)}),Math.floor(0))}))}put(e,t,n,r){this.putInternal("p",e,t,n,r)}merge(e,t,n,r){this.putInternal("m",e,t,n,r)}putInternal(e,t,n,r,i){this.initConnection_();const s={p:t,d:n};void 0!==i&&(s.h=i),this.outstandingPuts_.push({action:e,request:s,onComplete:r}),this.outstandingPutCount_++;const o=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(o):this.log_("Buffering put: "+t)}sendPut_(e){const t=this.outstandingPuts_[e].action,n=this.outstandingPuts_[e].request,r=this.outstandingPuts_[e].onComplete;this.outstandingPuts_[e].queued=this.connected_,this.sendRequest(t,n,(n=>{this.log_(t+" response",n),delete this.outstandingPuts_[e],this.outstandingPutCount_--,0===this.outstandingPutCount_&&(this.outstandingPuts_=[]),r&&r(n.s,n.d)}))}reportStats(e){if(this.connected_){const t={c:e};this.log_("reportStats",t),this.sendRequest("s",t,(e=>{if("ok"!==e.s){const t=e.d;this.log_("reportStats","Error sending stats: "+t)}}))}}onDataMessage_(e){if("r"in e){this.log_("from server: "+b(e));const t=e.r,n=this.requestCBHash_[t];n&&(delete this.requestCBHash_[t],n(e.b))}else{if("error"in e)throw"A server-side error has occurred: "+e.error;"a"in e&&this.onDataPush_(e.a,e.b)}}onDataPush_(e,t){this.log_("handleServerMessage",e,t),"d"===e?this.onDataUpdate_(t.p,t.d,!1,t.t):"m"===e?this.onDataUpdate_(t.p,t.d,!0,t.t):"c"===e?this.onListenRevoked_(t.p,t.q):"ac"===e?this.onAuthRevoked_(t.s,t.d):"apc"===e?this.onAppCheckRevoked_(t.s,t.d):"sd"===e?this.onSecurityDebugPacket_(t):Qr("Unrecognized action received from server: "+b(e)+"\nAre you using the latest client?")}onReady_(e,t){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=(new Date).getTime(),this.handleTimestamp_(e),this.lastSessionId=t,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(e){s(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout((()=>{this.establishConnectionTimer_=null,this.establishConnection_()}),Math.floor(e))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(e){e&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=ts,this.realtime_||this.scheduleConnect_(0)),this.visible_=e}onOnline_(e){e?(this.log_("Browser went online."),this.reconnectDelay_=ts,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&((new Date).getTime()-this.lastConnectionEstablishedTime_>3e4&&(this.reconnectDelay_=ts),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=(new Date).getTime());const e=(new Date).getTime()-this.lastConnectionAttemptTime_;let t=Math.max(0,this.reconnectDelay_-e);t=Math.random()*t,this.log_("Trying to reconnect in "+t+"ms"),this.scheduleConnect_(t),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,1.3*this.reconnectDelay_)}this.onConnectStatus_(!1)}async establishConnection_(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=(new Date).getTime(),this.lastConnectionEstablishedTime_=null;const e=this.onDataMessage_.bind(this),t=this.onReady_.bind(this),n=this.onRealtimeDisconnect_.bind(this),r=this.id+":"+ns.nextConnectionId_++,i=this.lastSessionId;let o=!1,a=null;const c=function(){a?a.close():(o=!0,n())},l=function(e){s(a,"sendRequest call when we're not connected not allowed."),a.sendRequest(e)};this.realtime_={close:c,sendRequest:l};const u=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{const[s,c]=await Promise.all([this.authTokenProvider_.getToken(u),this.appCheckTokenProvider_.getToken(u)]);o?Zr("getToken() completed but was canceled"):(Zr("getToken() completed. Creating connection."),this.authToken_=s&&s.accessToken,this.appCheckToken_=c&&c.token,a=new Ri(r,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,e,t,n,(e=>{ei(e+" ("+this.repoInfo_.toString()+")"),this.interrupt("server_kill")}),i))}catch(e){this.log_("Failed to get token: "+e),o||(this.repoInfo_.nodeAdmin&&ei(e),c())}}}interrupt(e){Zr("Interrupting connection for reason: "+e),this.interruptReasons_[e]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(e){Zr("Resuming connection for reason: "+e),delete this.interruptReasons_[e],S(this.interruptReasons_)&&(this.reconnectDelay_=ts,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(e){const t=e-(new Date).getTime();this.onServerInfoUpdate_({serverTimeOffset:t})}cancelSentTransactions_(){for(let e=0;e<this.outstandingPuts_.length;e++){const t=this.outstandingPuts_[e];t&&"h"in t.request&&t.queued&&(t.onComplete&&t.onComplete("disconnect"),delete this.outstandingPuts_[e],this.outstandingPutCount_--)}0===this.outstandingPutCount_&&(this.outstandingPuts_=[])}onListenRevoked_(e,t){let n;n=t?t.map((e=>ai(e))).join("$"):"default";const r=this.removeListen_(e,n);r&&r.onComplete&&r.onComplete("permission_denied")}removeListen_(e,t){const n=new Li(e).toString();let r;if(this.listens.has(n)){const e=this.listens.get(n);r=e.get(t),e.delete(t),0===e.size&&this.listens.delete(n)}else r=void 0;return r}onAuthRevoked_(e,t){Zr("Auth token revoked: "+e+"/"+t),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),"invalid_token"!==e&&"permission_denied"!==e||(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=3&&(this.reconnectDelay_=3e4,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(e,t){Zr("App check token revoked: "+e+"/"+t),this.appCheckToken_=null,this.forceTokenRefresh_=!0,"invalid_token"!==e&&"permission_denied"!==e||(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=3&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(e){this.securityDebugCallback_?this.securityDebugCallback_(e):"msg"in e&&console.log("FIREBASE: "+e.msg.replace("\n","\nFIREBASE: "))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const e of this.listens.values())for(const t of e.values())this.sendListen_(t);for(let e=0;e<this.outstandingPuts_.length;e++)this.outstandingPuts_[e]&&this.sendPut_(e);for(;this.onDisconnectRequestQueue_.length;){const e=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(e.action,e.pathString,e.data,e.onComplete)}for(let e=0;e<this.outstandingGets_.length;e++)this.outstandingGets_[e]&&this.sendGet_(e)}sendConnectStats_(){const e={};let t="js";e["sdk."+t+"."+Ur.replace(/\./g,"-")]=1,f()?e["framework.cordova"]=1:m()&&(e["framework.reactnative"]=1),this.reportStats(e)}shouldReconnect_(){const e=Mi.getInstance().currentlyOnline();return S(this.interruptReasons_)&&e}}ns.nextPersistentConnectionId_=0,ns.nextConnectionId_=0;class rs{constructor(e,t){this.name=e,this.node=t}static Wrap(e,t){return new rs(e,t)}}class is{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,t){const n=new rs(ni,e),r=new rs(ni,t);return 0!==this.compare(n,r)}minPost(){return rs.MIN}}let ss;class os extends is{static get __EMPTY_NODE(){return ss}static set __EMPTY_NODE(e){ss=e}compare(e,t){return ii(e.name,t.name)}isDefinedOn(e){throw o("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,t){return!1}minPost(){return rs.MIN}maxPost(){return new rs(ri,ss)}makePost(e,t){return s("string"==typeof e,"KeyIndex indexValue must always be a string."),new rs(e,ss)}toString(){return".key"}}const as=new os;class cs{constructor(e,t,n,r,i=null){this.isReverse_=r,this.resultGenerator_=i,this.nodeStack_=[];let s=1;for(;!e.isEmpty();)if(e=e,s=t?n(e.key,t):1,r&&(s*=-1),s<0)e=this.isReverse_?e.left:e.right;else{if(0===s){this.nodeStack_.push(e);break}this.nodeStack_.push(e),e=this.isReverse_?e.right:e.left}}getNext(){if(0===this.nodeStack_.length)return null;let e,t=this.nodeStack_.pop();if(e=this.resultGenerator_?this.resultGenerator_(t.key,t.value):{key:t.key,value:t.value},this.isReverse_)for(t=t.left;!t.isEmpty();)this.nodeStack_.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack_.push(t),t=t.left;return e}hasNext(){return this.nodeStack_.length>0}peek(){if(0===this.nodeStack_.length)return null;const e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}}class ls{constructor(e,t,n,r,i){this.key=e,this.value=t,this.color=null!=n?n:ls.RED,this.left=null!=r?r:us.EMPTY_NODE,this.right=null!=i?i:us.EMPTY_NODE}copy(e,t,n,r,i){return new ls(null!=e?e:this.key,null!=t?t:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||!!e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let r=this;const i=n(e,r.key);return r=i<0?r.copy(null,null,null,r.left.insert(e,t,n),null):0===i?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,n)),r.fixUp_()}removeMin_(){if(this.left.isEmpty())return us.EMPTY_NODE;let e=this;return e.left.isRed_()||e.left.left.isRed_()||(e=e.moveRedLeft_()),e=e.copy(null,null,null,e.left.removeMin_(),null),e.fixUp_()}remove(e,t){let n,r;if(n=this,t(e,n.key)<0)n.left.isEmpty()||n.left.isRed_()||n.left.left.isRed_()||(n=n.moveRedLeft_()),n=n.copy(null,null,null,n.left.remove(e,t),null);else{if(n.left.isRed_()&&(n=n.rotateRight_()),n.right.isEmpty()||n.right.isRed_()||n.right.left.isRed_()||(n=n.moveRedRight_()),0===t(e,n.key)){if(n.right.isEmpty())return us.EMPTY_NODE;r=n.right.min_(),n=n.copy(r.key,r.value,null,null,n.right.removeMin_())}n=n.copy(null,null,null,null,n.right.remove(e,t))}return n.fixUp_()}isRed_(){return this.color}fixUp_(){let e=this;return e.right.isRed_()&&!e.left.isRed_()&&(e=e.rotateLeft_()),e.left.isRed_()&&e.left.left.isRed_()&&(e=e.rotateRight_()),e.left.isRed_()&&e.right.isRed_()&&(e=e.colorFlip_()),e}moveRedLeft_(){let e=this.colorFlip_();return e.right.left.isRed_()&&(e=e.copy(null,null,null,null,e.right.rotateRight_()),e=e.rotateLeft_(),e=e.colorFlip_()),e}moveRedRight_(){let e=this.colorFlip_();return e.left.left.isRed_()&&(e=e.rotateRight_(),e=e.colorFlip_()),e}rotateLeft_(){const e=this.copy(null,null,ls.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight_(){const e=this.copy(null,null,ls.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip_(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth_(){const e=this.check_();return Math.pow(2,e)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const e=this.left.check_();if(e!==this.right.check_())throw new Error("Black depths differ");return e+(this.isRed_()?0:1)}}ls.RED=!0,ls.BLACK=!1;class us{constructor(e,t=us.EMPTY_NODE){this.comparator_=e,this.root_=t}insert(e,t){return new us(this.comparator_,this.root_.insert(e,t,this.comparator_).copy(null,null,ls.BLACK,null,null))}remove(e){return new us(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,ls.BLACK,null,null))}get(e){let t,n=this.root_;for(;!n.isEmpty();){if(t=this.comparator_(e,n.key),0===t)return n.value;t<0?n=n.left:t>0&&(n=n.right)}return null}getPredecessorKey(e){let t,n=this.root_,r=null;for(;!n.isEmpty();){if(t=this.comparator_(e,n.key),0===t){if(n.left.isEmpty())return r?r.key:null;for(n=n.left;!n.right.isEmpty();)n=n.right;return n.key}t<0?n=n.left:t>0&&(r=n,n=n.right)}throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new cs(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,t){return new cs(this.root_,e,this.comparator_,!1,t)}getReverseIteratorFrom(e,t){return new cs(this.root_,e,this.comparator_,!0,t)}getReverseIterator(e){return new cs(this.root_,null,this.comparator_,!0,e)}}function hs(e,t){return ii(e.name,t.name)}function ds(e,t){return ii(e,t)}let ps;us.EMPTY_NODE=new class{copy(e,t,n,r,i){return this}insert(e,t,n){return new ls(e,t,null)}remove(e,t){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}};const fs=function(e){return"number"==typeof e?"number:"+ui(e):"string:"+e},_s=function(e){if(e.isLeafNode()){const t=e.val();s("string"==typeof t||"number"==typeof t||"object"==typeof t&&E(t,".sv"),"Priority must be a string or number.")}else s(e===ps||e.isEmpty(),"priority of unexpected type.");s(e===ps||e.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};let ms,gs,ys;class vs{constructor(e,t=vs.__childrenNodeConstructor.EMPTY_NODE){this.value_=e,this.priorityNode_=t,this.lazyHash_=null,s(void 0!==this.value_&&null!==this.value_,"LeafNode shouldn't be created with null/undefined value."),_s(this.priorityNode_)}static set __childrenNodeConstructor(e){ms=e}static get __childrenNodeConstructor(){return ms}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(e){return new vs(this.value_,e)}getImmediateChild(e){return".priority"===e?this.priorityNode_:vs.__childrenNodeConstructor.EMPTY_NODE}getChild(e){return Ki(e)?this:".priority"===Fi(e)?this.priorityNode_:vs.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(e,t){return null}updateImmediateChild(e,t){return".priority"===e?this.updatePriority(t):t.isEmpty()&&".priority"!==e?this:vs.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(e,t).updatePriority(this.priorityNode_)}updateChild(e,t){const n=Fi(e);return null===n?t:t.isEmpty()&&".priority"!==n?this:(s(".priority"!==n||1===ji(e),".priority must be the last token in a path"),this.updateImmediateChild(n,vs.__childrenNodeConstructor.EMPTY_NODE.updateChild(qi(e),t)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(e,t){return!1}val(e){return e&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(null===this.lazyHash_){let e="";this.priorityNode_.isEmpty()||(e+="priority:"+fs(this.priorityNode_.val())+":");const t=typeof this.value_;e+=t+":",e+="number"===t?ui(this.value_):this.value_,this.lazyHash_=Kr(e)}return this.lazyHash_}getValue(){return this.value_}compareTo(e){return e===vs.__childrenNodeConstructor.EMPTY_NODE?1:e instanceof vs.__childrenNodeConstructor?-1:(s(e.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(e))}compareToLeafNode_(e){const t=typeof e.value_,n=typeof this.value_,r=vs.VALUE_TYPE_ORDER.indexOf(t),i=vs.VALUE_TYPE_ORDER.indexOf(n);return s(r>=0,"Unknown leaf type: "+t),s(i>=0,"Unknown leaf type: "+n),r===i?"object"===n?0:this.value_<e.value_?-1:this.value_===e.value_?0:1:i-r}withIndex(){return this}isIndexed(){return!0}equals(e){if(e===this)return!0;if(e.isLeafNode()){const t=e;return this.value_===t.value_&&this.priorityNode_.equals(t.priorityNode_)}return!1}}vs.VALUE_TYPE_ORDER=["object","boolean","number","string"];const ws=new class extends is{compare(e,t){const n=e.node.getPriority(),r=t.node.getPriority(),i=n.compareTo(r);return 0===i?ii(e.name,t.name):i}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,t){return!e.getPriority().equals(t.getPriority())}minPost(){return rs.MIN}maxPost(){return new rs(ri,new vs("[PRIORITY-POST]",ys))}makePost(e,t){const n=gs(e);return new rs(t,new vs("[PRIORITY-POST]",n))}toString(){return".priority"}},bs=Math.log(2);class ks{constructor(e){var t;this.count=(t=e+1,parseInt(Math.log(t)/bs,10)),this.current_=this.count-1;const n=(r=this.count,parseInt(Array(r+1).join("1"),2));var r;this.bits_=e+1&n}nextBitIsOne(){const e=!(this.bits_&1<<this.current_);return this.current_--,e}}const Es=function(e,t,n,r){e.sort(t);const i=function(t,r){const s=r-t;let o,a;if(0===s)return null;if(1===s)return o=e[t],a=n?n(o):o,new ls(a,o.node,ls.BLACK,null,null);{const c=parseInt(s/2,10)+t,l=i(t,c),u=i(c+1,r);return o=e[c],a=n?n(o):o,new ls(a,o.node,ls.BLACK,l,u)}},s=function(t){let r=null,s=null,o=e.length;const a=function(t,r){const s=o-t,a=o;o-=t;const l=i(s+1,a),u=e[s],h=n?n(u):u;c(new ls(h,u.node,r,null,l))},c=function(e){r?(r.left=e,r=e):(s=e,r=e)};for(let e=0;e<t.count;++e){const n=t.nextBitIsOne(),r=Math.pow(2,t.count-(e+1));n?a(r,ls.BLACK):(a(r,ls.BLACK),a(r,ls.RED))}return s}(new ks(e.length));return new us(r||t,s)};let Ts;const Ss={};class Is{constructor(e,t){this.indexes_=e,this.indexSet_=t}static get Default(){return s(Ss&&ws,"ChildrenNode.ts has not been loaded"),Ts=Ts||new Is({".priority":Ss},{".priority":ws}),Ts}get(e){const t=T(this.indexes_,e);if(!t)throw new Error("No index defined for "+e);return t instanceof us?t:null}hasIndex(e){return E(this.indexSet_,e.toString())}addIndex(e,t){s(e!==as,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const n=[];let r=!1;const i=t.getIterator(rs.Wrap);let o,a=i.getNext();for(;a;)r=r||e.isDefinedOn(a.node),n.push(a),a=i.getNext();o=r?Es(n,e.getCompare()):Ss;const c=e.toString(),l=Object.assign({},this.indexSet_);l[c]=e;const u=Object.assign({},this.indexes_);return u[c]=o,new Is(u,l)}addToIndexes(e,t){const n=I(this.indexes_,((n,r)=>{const i=T(this.indexSet_,r);if(s(i,"Missing index implementation for "+r),n===Ss){if(i.isDefinedOn(e.node)){const n=[],r=t.getIterator(rs.Wrap);let s=r.getNext();for(;s;)s.name!==e.name&&n.push(s),s=r.getNext();return n.push(e),Es(n,i.getCompare())}return Ss}{const r=t.get(e.name);let i=n;return r&&(i=i.remove(new rs(e.name,r))),i.insert(e,e.node)}}));return new Is(n,this.indexSet_)}removeFromIndexes(e,t){const n=I(this.indexes_,(n=>{if(n===Ss)return n;{const r=t.get(e.name);return r?n.remove(new rs(e.name,r)):n}}));return new Is(n,this.indexSet_)}}let Cs;class xs{constructor(e,t,n){this.children_=e,this.priorityNode_=t,this.indexMap_=n,this.lazyHash_=null,this.priorityNode_&&_s(this.priorityNode_),this.children_.isEmpty()&&s(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}static get EMPTY_NODE(){return Cs||(Cs=new xs(new us(ds),null,Is.Default))}isLeafNode(){return!1}getPriority(){return this.priorityNode_||Cs}updatePriority(e){return this.children_.isEmpty()?this:new xs(this.children_,e,this.indexMap_)}getImmediateChild(e){if(".priority"===e)return this.getPriority();{const t=this.children_.get(e);return null===t?Cs:t}}getChild(e){const t=Fi(e);return null===t?this:this.getImmediateChild(t).getChild(qi(e))}hasChild(e){return null!==this.children_.get(e)}updateImmediateChild(e,t){if(s(t,"We should always be passing snapshot nodes"),".priority"===e)return this.updatePriority(t);{const n=new rs(e,t);let r,i;t.isEmpty()?(r=this.children_.remove(e),i=this.indexMap_.removeFromIndexes(n,this.children_)):(r=this.children_.insert(e,t),i=this.indexMap_.addToIndexes(n,this.children_));const s=r.isEmpty()?Cs:this.priorityNode_;return new xs(r,s,i)}}updateChild(e,t){const n=Fi(e);if(null===n)return t;{s(".priority"!==Fi(e)||1===ji(e),".priority must be the last token in a path");const r=this.getImmediateChild(n).updateChild(qi(e),t);return this.updateImmediateChild(n,r)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(e){if(this.isEmpty())return null;const t={};let n=0,r=0,i=!0;if(this.forEachChild(ws,((s,o)=>{t[s]=o.val(e),n++,i&&xs.INTEGER_REGEXP_.test(s)?r=Math.max(r,Number(s)):i=!1})),!e&&i&&r<2*n){const e=[];for(const n in t)e[n]=t[n];return e}return e&&!this.getPriority().isEmpty()&&(t[".priority"]=this.getPriority().val()),t}hash(){if(null===this.lazyHash_){let e="";this.getPriority().isEmpty()||(e+="priority:"+fs(this.getPriority().val())+":"),this.forEachChild(ws,((t,n)=>{const r=n.hash();""!==r&&(e+=":"+t+":"+r)})),this.lazyHash_=""===e?"":Kr(e)}return this.lazyHash_}getPredecessorChildName(e,t,n){const r=this.resolveIndex_(n);if(r){const n=r.getPredecessorKey(new rs(e,t));return n?n.name:null}return this.children_.getPredecessorKey(e)}getFirstChildName(e){const t=this.resolveIndex_(e);if(t){const e=t.minKey();return e&&e.name}return this.children_.minKey()}getFirstChild(e){const t=this.getFirstChildName(e);return t?new rs(t,this.children_.get(t)):null}getLastChildName(e){const t=this.resolveIndex_(e);if(t){const e=t.maxKey();return e&&e.name}return this.children_.maxKey()}getLastChild(e){const t=this.getLastChildName(e);return t?new rs(t,this.children_.get(t)):null}forEachChild(e,t){const n=this.resolveIndex_(e);return n?n.inorderTraversal((e=>t(e.name,e.node))):this.children_.inorderTraversal(t)}getIterator(e){return this.getIteratorFrom(e.minPost(),e)}getIteratorFrom(e,t){const n=this.resolveIndex_(t);if(n)return n.getIteratorFrom(e,(e=>e));{const n=this.children_.getIteratorFrom(e.name,rs.Wrap);let r=n.peek();for(;null!=r&&t.compare(r,e)<0;)n.getNext(),r=n.peek();return n}}getReverseIterator(e){return this.getReverseIteratorFrom(e.maxPost(),e)}getReverseIteratorFrom(e,t){const n=this.resolveIndex_(t);if(n)return n.getReverseIteratorFrom(e,(e=>e));{const n=this.children_.getReverseIteratorFrom(e.name,rs.Wrap);let r=n.peek();for(;null!=r&&t.compare(r,e)>0;)n.getNext(),r=n.peek();return n}}compareTo(e){return this.isEmpty()?e.isEmpty()?0:-1:e.isLeafNode()||e.isEmpty()?1:e===As?-1:0}withIndex(e){if(e===as||this.indexMap_.hasIndex(e))return this;{const t=this.indexMap_.addIndex(e,this.children_);return new xs(this.children_,this.priorityNode_,t)}}isIndexed(e){return e===as||this.indexMap_.hasIndex(e)}equals(e){if(e===this)return!0;if(e.isLeafNode())return!1;{const t=e;if(this.getPriority().equals(t.getPriority())){if(this.children_.count()===t.children_.count()){const e=this.getIterator(ws),n=t.getIterator(ws);let r=e.getNext(),i=n.getNext();for(;r&&i;){if(r.name!==i.name||!r.node.equals(i.node))return!1;r=e.getNext(),i=n.getNext()}return null===r&&null===i}return!1}return!1}}resolveIndex_(e){return e===as?null:this.indexMap_.get(e.toString())}}xs.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/;const As=new class extends xs{constructor(){super(new us(ds),xs.EMPTY_NODE,Is.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return xs.EMPTY_NODE}isEmpty(){return!1}};function Ns(e,t=null){if(null===e)return xs.EMPTY_NODE;if("object"==typeof e&&".priority"in e&&(t=e[".priority"]),s(null===t||"string"==typeof t||"number"==typeof t||"object"==typeof t&&".sv"in t,"Invalid priority type found: "+typeof t),"object"==typeof e&&".value"in e&&null!==e[".value"]&&(e=e[".value"]),"object"!=typeof e||".sv"in e)return new vs(e,Ns(t));if(e instanceof Array){let n=xs.EMPTY_NODE;return li(e,((t,r)=>{if(E(e,t)&&"."!==t.substring(0,1)){const e=Ns(r);!e.isLeafNode()&&e.isEmpty()||(n=n.updateImmediateChild(t,e))}})),n.updatePriority(Ns(t))}{const n=[];let r=!1;if(li(e,((e,t)=>{if("."!==e.substring(0,1)){const i=Ns(t);i.isEmpty()||(r=r||!i.getPriority().isEmpty(),n.push(new rs(e,i)))}})),0===n.length)return xs.EMPTY_NODE;const i=Es(n,hs,(e=>e.name),ds);if(r){const e=Es(n,ws.getCompare());return new xs(i,Ns(t),new Is({".priority":e},{".priority":ws}))}return new xs(i,Ns(t),Is.Default)}}Object.defineProperties(rs,{MIN:{value:new rs(ni,xs.EMPTY_NODE)},MAX:{value:new rs(ri,As)}}),os.__EMPTY_NODE=xs.EMPTY_NODE,vs.__childrenNodeConstructor=xs,ps=As,ys=As,function(e){gs=e}(Ns);class Ps extends is{constructor(e){super(),this.indexPath_=e,s(!Ki(e)&&".priority"!==Fi(e),"Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,t){const n=this.extractChild(e.node),r=this.extractChild(t.node),i=n.compareTo(r);return 0===i?ii(e.name,t.name):i}makePost(e,t){const n=Ns(e),r=xs.EMPTY_NODE.updateChild(this.indexPath_,n);return new rs(t,r)}maxPost(){const e=xs.EMPTY_NODE.updateChild(this.indexPath_,As);return new rs(ri,e)}toString(){return Wi(this.indexPath_,0).join("/")}}const Os=new class extends is{compare(e,t){const n=e.node.compareTo(t.node);return 0===n?ii(e.name,t.name):n}isDefinedOn(e){return!0}indexedValueChanged(e,t){return!e.equals(t)}minPost(){return rs.MIN}maxPost(){return rs.MAX}makePost(e,t){const n=Ns(e);return new rs(t,n)}toString(){return".value"}};function Rs(e){return{type:"value",snapshotNode:e}}function Ds(e,t){return{type:"child_added",snapshotNode:t,childName:e}}function zs(e,t){return{type:"child_removed",snapshotNode:t,childName:e}}function Ms(e,t,n){return{type:"child_changed",snapshotNode:t,childName:e,oldSnap:n}}class Ls{constructor(e){this.index_=e}updateChild(e,t,n,r,i,o){s(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");const a=e.getImmediateChild(t);return a.getChild(r).equals(n.getChild(r))&&a.isEmpty()===n.isEmpty()?e:(null!=o&&(n.isEmpty()?e.hasChild(t)?o.trackChildChange(zs(t,a)):s(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):a.isEmpty()?o.trackChildChange(Ds(t,n)):o.trackChildChange(Ms(t,n,a))),e.isLeafNode()&&n.isEmpty()?e:e.updateImmediateChild(t,n).withIndex(this.index_))}updateFullNode(e,t,n){return null!=n&&(e.isLeafNode()||e.forEachChild(ws,((e,r)=>{t.hasChild(e)||n.trackChildChange(zs(e,r))})),t.isLeafNode()||t.forEachChild(ws,((t,r)=>{if(e.hasChild(t)){const i=e.getImmediateChild(t);i.equals(r)||n.trackChildChange(Ms(t,r,i))}else n.trackChildChange(Ds(t,r))}))),t.withIndex(this.index_)}updatePriority(e,t){return e.isEmpty()?xs.EMPTY_NODE:e.updatePriority(t)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}}class Us{constructor(e){this.indexedFilter_=new Ls(e.getIndex()),this.index_=e.getIndex(),this.startPost_=Us.getStartPost_(e),this.endPost_=Us.getEndPost_(e)}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){return this.index_.compare(this.getStartPost(),e)<=0&&this.index_.compare(e,this.getEndPost())<=0}updateChild(e,t,n,r,i,s){return this.matches(new rs(t,n))||(n=xs.EMPTY_NODE),this.indexedFilter_.updateChild(e,t,n,r,i,s)}updateFullNode(e,t,n){t.isLeafNode()&&(t=xs.EMPTY_NODE);let r=t.withIndex(this.index_);r=r.updatePriority(xs.EMPTY_NODE);const i=this;return t.forEachChild(ws,((e,t)=>{i.matches(new rs(e,t))||(r=r.updateImmediateChild(e,xs.EMPTY_NODE))})),this.indexedFilter_.updateFullNode(e,r,n)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){const t=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),t)}return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){const t=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),t)}return e.getIndex().maxPost()}}class Fs{constructor(e){this.rangedFilter_=new Us(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft()}updateChild(e,t,n,r,i,s){return this.rangedFilter_.matches(new rs(t,n))||(n=xs.EMPTY_NODE),e.getImmediateChild(t).equals(n)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,t,n,r,i,s):this.fullLimitUpdateChild_(e,t,n,i,s)}updateFullNode(e,t,n){let r;if(t.isLeafNode()||t.isEmpty())r=xs.EMPTY_NODE.withIndex(this.index_);else if(2*this.limit_<t.numChildren()&&t.isIndexed(this.index_)){let e;r=xs.EMPTY_NODE.withIndex(this.index_),e=this.reverse_?t.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):t.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let n=0;for(;e.hasNext()&&n<this.limit_;){const t=e.getNext();let i;if(i=this.reverse_?this.index_.compare(this.rangedFilter_.getStartPost(),t)<=0:this.index_.compare(t,this.rangedFilter_.getEndPost())<=0,!i)break;r=r.updateImmediateChild(t.name,t.node),n++}}else{let e,n,i,s;if(r=t.withIndex(this.index_),r=r.updatePriority(xs.EMPTY_NODE),this.reverse_){s=r.getReverseIterator(this.index_),e=this.rangedFilter_.getEndPost(),n=this.rangedFilter_.getStartPost();const t=this.index_.getCompare();i=(e,n)=>t(n,e)}else s=r.getIterator(this.index_),e=this.rangedFilter_.getStartPost(),n=this.rangedFilter_.getEndPost(),i=this.index_.getCompare();let o=0,a=!1;for(;s.hasNext();){const t=s.getNext();!a&&i(e,t)<=0&&(a=!0),a&&o<this.limit_&&i(t,n)<=0?o++:r=r.updateImmediateChild(t.name,xs.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,r,n)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,t,n,r,i){let o;if(this.reverse_){const e=this.index_.getCompare();o=(t,n)=>e(n,t)}else o=this.index_.getCompare();const a=e;s(a.numChildren()===this.limit_,"");const c=new rs(t,n),l=this.reverse_?a.getFirstChild(this.index_):a.getLastChild(this.index_),u=this.rangedFilter_.matches(c);if(a.hasChild(t)){const e=a.getImmediateChild(t);let s=r.getChildAfterChild(this.index_,l,this.reverse_);for(;null!=s&&(s.name===t||a.hasChild(s.name));)s=r.getChildAfterChild(this.index_,s,this.reverse_);const h=null==s?1:o(s,c);if(u&&!n.isEmpty()&&h>=0)return null!=i&&i.trackChildChange(Ms(t,n,e)),a.updateImmediateChild(t,n);{null!=i&&i.trackChildChange(zs(t,e));const n=a.updateImmediateChild(t,xs.EMPTY_NODE);return null!=s&&this.rangedFilter_.matches(s)?(null!=i&&i.trackChildChange(Ds(s.name,s.node)),n.updateImmediateChild(s.name,s.node)):n}}return n.isEmpty()?e:u&&o(l,c)>=0?(null!=i&&(i.trackChildChange(zs(l.name,l.node)),i.trackChildChange(Ds(t,n))),a.updateImmediateChild(t,n).updateImmediateChild(l.name,xs.EMPTY_NODE)):e}}class js{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=ws}hasStart(){return this.startSet_}hasStartAfter(){return this.startAfterSet_}hasEndBefore(){return this.endBeforeSet_}isViewFromLeft(){return""===this.viewFrom_?this.startSet_:"l"===this.viewFrom_}getIndexStartValue(){return s(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return s(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:ni}hasEnd(){return this.endSet_}getIndexEndValue(){return s(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return s(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:ri}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&""!==this.viewFrom_}getLimit(){return s(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===ws}copy(){const e=new js;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}}function qs(e){const t={};if(e.isDefault())return t;let n;return e.index_===ws?n="$priority":e.index_===Os?n="$value":e.index_===as?n="$key":(s(e.index_ instanceof Ps,"Unrecognized index type!"),n=e.index_.toString()),t.orderBy=b(n),e.startSet_&&(t.startAt=b(e.indexStartValue_),e.startNameSet_&&(t.startAt+=","+b(e.indexStartName_))),e.endSet_&&(t.endAt=b(e.indexEndValue_),e.endNameSet_&&(t.endAt+=","+b(e.indexEndName_))),e.limitSet_&&(e.isViewFromLeft()?t.limitToFirst=e.limit_:t.limitToLast=e.limit_),t}function Bs(e){const t={};if(e.startSet_&&(t.sp=e.indexStartValue_,e.startNameSet_&&(t.sn=e.indexStartName_)),e.endSet_&&(t.ep=e.indexEndValue_,e.endNameSet_&&(t.en=e.indexEndName_)),e.limitSet_){t.l=e.limit_;let n=e.viewFrom_;""===n&&(n=e.isViewFromLeft()?"l":"r"),t.vf=n}return e.index_!==ws&&(t.i=e.index_.toString()),t}class Ws extends Di{constructor(e,t,n,r){super(),this.repoInfo_=e,this.onDataUpdate_=t,this.authTokenProvider_=n,this.appCheckTokenProvider_=r,this.log_=Yr("p:rest:"),this.listens_={}}reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,t){return void 0!==t?"tag$"+t:(s(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}listen(e,t,n,r){const i=e._path.toString();this.log_("Listen called for "+i+" "+e._queryIdentifier);const s=Ws.getListenId_(e,n),o={};this.listens_[s]=o;const a=qs(e._queryParams);this.restRequest_(i+".json",a,((e,t)=>{let a=t;if(404===e&&(a=null,e=null),null===e&&this.onDataUpdate_(i,a,!1,n),T(this.listens_,s)===o){let t;t=e?401===e?"permission_denied":"rest_error:"+e:"ok",r(t,null)}}))}unlisten(e,t){const n=Ws.getListenId_(e,t);delete this.listens_[n]}get(e){const t=qs(e._queryParams),n=e._path.toString(),r=new d;return this.restRequest_(n+".json",t,((e,t)=>{let i=t;404===e&&(i=null,e=null),null===e?(this.onDataUpdate_(n,i,!1,null),r.resolve(i)):r.reject(new Error(i))})),r.promise}refreshAuthToken(e){}restRequest_(e,t={},n){return t.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then((([r,i])=>{r&&r.accessToken&&(t.auth=r.accessToken),i&&i.token&&(t.ac=i.token);const s=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+A(t);this.log_("Sending REST request for "+s);const o=new XMLHttpRequest;o.onreadystatechange=()=>{if(n&&4===o.readyState){this.log_("REST Response for "+s+" received. status:",o.status,"response:",o.responseText);let e=null;if(o.status>=200&&o.status<300){try{e=w(o.responseText)}catch(e){ei("Failed to parse JSON response for "+s+": "+o.responseText)}n(null,e)}else 401!==o.status&&404!==o.status&&ei("Got unsuccessful REST response for "+s+" Status: "+o.status),n(o.status);n=null}},o.open("GET",s,!0),o.send()}))}}class Vs{constructor(){this.rootNode_=xs.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,t){this.rootNode_=this.rootNode_.updateChild(e,t)}}function Hs(){return{value:null,children:new Map}}function Ks(e,t,n){if(Ki(t))e.value=n,e.children.clear();else if(null!==e.value)e.value=e.value.updateChild(t,n);else{const r=Fi(t);e.children.has(r)||e.children.set(r,Hs()),Ks(e.children.get(r),t=qi(t),n)}}function $s(e,t,n){null!==e.value?n(t,e.value):function(e,t){e.children.forEach(((e,n)=>{t(n,e)}))}(e,((e,r)=>{$s(r,new Li(t.toString()+"/"+e),n)}))}class Gs{constructor(e){this.collection_=e,this.last_=null}get(){const e=this.collection_.get(),t=Object.assign({},e);return this.last_&&li(this.last_,((e,n)=>{t[e]=t[e]-n})),this.last_=e,t}}class Js{constructor(e,t){this.server_=t,this.statsToReport_={},this.statsListener_=new Gs(e);const n=1e4+2e4*Math.random();fi(this.reportStats_.bind(this),Math.floor(n))}reportStats_(){const e=this.statsListener_.get(),t={};let n=!1;li(e,((e,r)=>{r>0&&E(this.statsToReport_,e)&&(t[e]=r,n=!0)})),n&&this.server_.reportStats(t),fi(this.reportStats_.bind(this),Math.floor(2*Math.random()*3e5))}}var Zs,Ys;function Qs(e){return{fromUser:!1,fromServer:!0,queryId:e,tagged:!0}}(Ys=Zs||(Zs={}))[Ys.OVERWRITE=0]="OVERWRITE",Ys[Ys.MERGE=1]="MERGE",Ys[Ys.ACK_USER_WRITE=2]="ACK_USER_WRITE",Ys[Ys.LISTEN_COMPLETE=3]="LISTEN_COMPLETE";class Xs{constructor(e,t,n){this.path=e,this.affectedTree=t,this.revert=n,this.type=Zs.ACK_USER_WRITE,this.source={fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}operationForChild(e){if(Ki(this.path)){if(null!=this.affectedTree.value)return s(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const t=this.affectedTree.subtree(new Li(e));return new Xs(Ui(),t,this.revert)}}return s(Fi(this.path)===e,"operationForChild called for unrelated child."),new Xs(qi(this.path),this.affectedTree,this.revert)}}class eo{constructor(e,t){this.source=e,this.path=t,this.type=Zs.LISTEN_COMPLETE}operationForChild(e){return Ki(this.path)?new eo(this.source,Ui()):new eo(this.source,qi(this.path))}}class to{constructor(e,t,n){this.source=e,this.path=t,this.snap=n,this.type=Zs.OVERWRITE}operationForChild(e){return Ki(this.path)?new to(this.source,Ui(),this.snap.getImmediateChild(e)):new to(this.source,qi(this.path),this.snap)}}class no{constructor(e,t,n){this.source=e,this.path=t,this.children=n,this.type=Zs.MERGE}operationForChild(e){if(Ki(this.path)){const t=this.children.subtree(new Li(e));return t.isEmpty()?null:t.value?new to(this.source,Ui(),t.value):new no(this.source,Ui(),t)}return s(Fi(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new no(this.source,qi(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}class ro{constructor(e,t,n){this.node_=e,this.fullyInitialized_=t,this.filtered_=n}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(Ki(e))return this.isFullyInitialized()&&!this.filtered_;const t=Fi(e);return this.isCompleteForChild(t)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}}class io{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}}function so(e,t,n,r,i,s){const a=r.filter((e=>e.type===n));a.sort(((t,n)=>function(e,t,n){if(null==t.childName||null==n.childName)throw o("Should only compare child_ events.");const r=new rs(t.childName,t.snapshotNode),i=new rs(n.childName,n.snapshotNode);return e.index_.compare(r,i)}(e,t,n))),a.forEach((n=>{const r=function(e,t,n){return"value"===t.type||"child_removed"===t.type||(t.prevName=n.getPredecessorChildName(t.childName,t.snapshotNode,e.index_)),t}(e,n,s);i.forEach((i=>{i.respondsTo(n.type)&&t.push(i.createEvent(r,e.query_))}))}))}function oo(e,t){return{eventCache:e,serverCache:t}}function ao(e,t,n,r){return oo(new ro(t,n,r),e.serverCache)}function co(e,t,n,r){return oo(e.eventCache,new ro(t,n,r))}function lo(e){return e.eventCache.isFullyInitialized()?e.eventCache.getNode():null}function uo(e){return e.serverCache.isFullyInitialized()?e.serverCache.getNode():null}let ho;class po{constructor(e,t=(()=>(ho||(ho=new us(si)),ho))()){this.value=e,this.children=t}static fromObject(e){let t=new po(null);return li(e,((e,n)=>{t=t.set(new Li(e),n)})),t}isEmpty(){return null===this.value&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,t){if(null!=this.value&&t(this.value))return{path:Ui(),value:this.value};if(Ki(e))return null;{const n=Fi(e),r=this.children.get(n);if(null!==r){const i=r.findRootMostMatchingPathAndValue(qi(e),t);return null!=i?{path:Hi(new Li(n),i.path),value:i.value}:null}return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,(()=>!0))}subtree(e){if(Ki(e))return this;{const t=Fi(e),n=this.children.get(t);return null!==n?n.subtree(qi(e)):new po(null)}}set(e,t){if(Ki(e))return new po(t,this.children);{const n=Fi(e),r=(this.children.get(n)||new po(null)).set(qi(e),t),i=this.children.insert(n,r);return new po(this.value,i)}}remove(e){if(Ki(e))return this.children.isEmpty()?new po(null):new po(null,this.children);{const t=Fi(e),n=this.children.get(t);if(n){const r=n.remove(qi(e));let i;return i=r.isEmpty()?this.children.remove(t):this.children.insert(t,r),null===this.value&&i.isEmpty()?new po(null):new po(this.value,i)}return this}}get(e){if(Ki(e))return this.value;{const t=Fi(e),n=this.children.get(t);return n?n.get(qi(e)):null}}setTree(e,t){if(Ki(e))return t;{const n=Fi(e),r=(this.children.get(n)||new po(null)).setTree(qi(e),t);let i;return i=r.isEmpty()?this.children.remove(n):this.children.insert(n,r),new po(this.value,i)}}fold(e){return this.fold_(Ui(),e)}fold_(e,t){const n={};return this.children.inorderTraversal(((r,i)=>{n[r]=i.fold_(Hi(e,r),t)})),t(e,this.value,n)}findOnPath(e,t){return this.findOnPath_(e,Ui(),t)}findOnPath_(e,t,n){const r=!!this.value&&n(t,this.value);if(r)return r;if(Ki(e))return null;{const r=Fi(e),i=this.children.get(r);return i?i.findOnPath_(qi(e),Hi(t,r),n):null}}foreachOnPath(e,t){return this.foreachOnPath_(e,Ui(),t)}foreachOnPath_(e,t,n){if(Ki(e))return this;{this.value&&n(t,this.value);const r=Fi(e),i=this.children.get(r);return i?i.foreachOnPath_(qi(e),Hi(t,r),n):new po(null)}}foreach(e){this.foreach_(Ui(),e)}foreach_(e,t){this.children.inorderTraversal(((n,r)=>{r.foreach_(Hi(e,n),t)})),this.value&&t(e,this.value)}foreachChild(e){this.children.inorderTraversal(((t,n)=>{n.value&&e(t,n.value)}))}}class fo{constructor(e){this.writeTree_=e}static empty(){return new fo(new po(null))}}function _o(e,t,n){if(Ki(t))return new fo(new po(n));{const r=e.writeTree_.findRootMostValueAndPath(t);if(null!=r){const i=r.path;let s=r.value;const o=$i(i,t);return s=s.updateChild(o,n),new fo(e.writeTree_.set(i,s))}{const r=new po(n),i=e.writeTree_.setTree(t,r);return new fo(i)}}}function mo(e,t,n){let r=e;return li(n,((e,n)=>{r=_o(r,Hi(t,e),n)})),r}function go(e,t){if(Ki(t))return fo.empty();{const n=e.writeTree_.setTree(t,new po(null));return new fo(n)}}function yo(e,t){return null!=vo(e,t)}function vo(e,t){const n=e.writeTree_.findRootMostValueAndPath(t);return null!=n?e.writeTree_.get(n.path).getChild($i(n.path,t)):null}function wo(e){const t=[],n=e.writeTree_.value;return null!=n?n.isLeafNode()||n.forEachChild(ws,((e,n)=>{t.push(new rs(e,n))})):e.writeTree_.children.inorderTraversal(((e,n)=>{null!=n.value&&t.push(new rs(e,n.value))})),t}function bo(e,t){if(Ki(t))return e;{const n=vo(e,t);return new fo(null!=n?new po(n):e.writeTree_.subtree(t))}}function ko(e){return e.writeTree_.isEmpty()}function Eo(e,t){return To(Ui(),e.writeTree_,t)}function To(e,t,n){if(null!=t.value)return n.updateChild(e,t.value);{let r=null;return t.children.inorderTraversal(((t,i)=>{".priority"===t?(s(null!==i.value,"Priority writes must always be leaf nodes"),r=i.value):n=To(Hi(e,t),i,n)})),n.getChild(e).isEmpty()||null===r||(n=n.updateChild(Hi(e,".priority"),r)),n}}function So(e,t){return Mo(t,e)}function Io(e,t){if(e.snap)return Zi(e.path,t);for(const n in e.children)if(e.children.hasOwnProperty(n)&&Zi(Hi(e.path,n),t))return!0;return!1}function Co(e){return e.visible}function xo(e,t,n){let r=fo.empty();for(let i=0;i<e.length;++i){const s=e[i];if(t(s)){const e=s.path;let t;if(s.snap)Zi(n,e)?(t=$i(n,e),r=_o(r,t,s.snap)):Zi(e,n)&&(t=$i(e,n),r=_o(r,Ui(),s.snap.getChild(t)));else{if(!s.children)throw o("WriteRecord should have .snap or .children");if(Zi(n,e))t=$i(n,e),r=mo(r,t,s.children);else if(Zi(e,n))if(t=$i(e,n),Ki(t))r=mo(r,Ui(),s.children);else{const e=T(s.children,Fi(t));if(e){const n=e.getChild(qi(t));r=_o(r,Ui(),n)}}}}}return r}function Ao(e,t,n,r,i){if(r||i){const s=bo(e.visibleWrites,t);if(!i&&ko(s))return n;if(i||null!=n||yo(s,Ui())){const s=function(e){return(e.visible||i)&&(!r||!~r.indexOf(e.writeId))&&(Zi(e.path,t)||Zi(t,e.path))};return Eo(xo(e.allWrites,s,t),n||xs.EMPTY_NODE)}return null}{const r=vo(e.visibleWrites,t);if(null!=r)return r;{const r=bo(e.visibleWrites,t);return ko(r)?n:null!=n||yo(r,Ui())?Eo(r,n||xs.EMPTY_NODE):null}}}function No(e,t,n,r){return Ao(e.writeTree,e.treePath,t,n,r)}function Po(e,t){return function(e,t,n){let r=xs.EMPTY_NODE;const i=vo(e.visibleWrites,t);if(i)return i.isLeafNode()||i.forEachChild(ws,((e,t)=>{r=r.updateImmediateChild(e,t)})),r;if(n){const i=bo(e.visibleWrites,t);return n.forEachChild(ws,((e,t)=>{const n=Eo(bo(i,new Li(e)),t);r=r.updateImmediateChild(e,n)})),wo(i).forEach((e=>{r=r.updateImmediateChild(e.name,e.node)})),r}return wo(bo(e.visibleWrites,t)).forEach((e=>{r=r.updateImmediateChild(e.name,e.node)})),r}(e.writeTree,e.treePath,t)}function Oo(e,t,n,r){return function(e,t,n,r,i){s(r||i,"Either existingEventSnap or existingServerSnap must exist");const o=Hi(t,n);if(yo(e.visibleWrites,o))return null;{const t=bo(e.visibleWrites,o);return ko(t)?i.getChild(n):Eo(t,i.getChild(n))}}(e.writeTree,e.treePath,t,n,r)}function Ro(e,t){return function(e,t){return vo(e.visibleWrites,t)}(e.writeTree,Hi(e.treePath,t))}function Do(e,t,n){return function(e,t,n,r){const i=Hi(t,n),s=vo(e.visibleWrites,i);return null!=s?s:r.isCompleteForChild(n)?Eo(bo(e.visibleWrites,i),r.getNode().getImmediateChild(n)):null}(e.writeTree,e.treePath,t,n)}function zo(e,t){return Mo(Hi(e.treePath,t),e.writeTree)}function Mo(e,t){return{treePath:e,writeTree:t}}class Lo{constructor(){this.changeMap=new Map}trackChildChange(e){const t=e.type,n=e.childName;s("child_added"===t||"child_changed"===t||"child_removed"===t,"Only child changes supported for tracking"),s(".priority"!==n,"Only non-priority child changes can be tracked.");const r=this.changeMap.get(n);if(r){const i=r.type;if("child_added"===t&&"child_removed"===i)this.changeMap.set(n,Ms(n,e.snapshotNode,r.snapshotNode));else if("child_removed"===t&&"child_added"===i)this.changeMap.delete(n);else if("child_removed"===t&&"child_changed"===i)this.changeMap.set(n,zs(n,r.oldSnap));else if("child_changed"===t&&"child_added"===i)this.changeMap.set(n,Ds(n,e.snapshotNode));else{if("child_changed"!==t||"child_changed"!==i)throw o("Illegal combination of changes: "+e+" occurred after "+r);this.changeMap.set(n,Ms(n,e.snapshotNode,r.oldSnap))}}else this.changeMap.set(n,e)}getChanges(){return Array.from(this.changeMap.values())}}const Uo=new class{getCompleteChild(e){return null}getChildAfterChild(e,t,n){return null}};class Fo{constructor(e,t,n=null){this.writes_=e,this.viewCache_=t,this.optCompleteServerCache_=n}getCompleteChild(e){const t=this.viewCache_.eventCache;if(t.isCompleteForChild(e))return t.getNode().getImmediateChild(e);{const t=null!=this.optCompleteServerCache_?new ro(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return Do(this.writes_,e,t)}}getChildAfterChild(e,t,n){const r=null!=this.optCompleteServerCache_?this.optCompleteServerCache_:uo(this.viewCache_),i=function(e,t,n,r,i,s){return function(e,t,n,r,i,s,o){let a;const c=bo(e.visibleWrites,t),l=vo(c,Ui());if(null!=l)a=l;else{if(null==n)return[];a=Eo(c,n)}if(a=a.withIndex(o),a.isEmpty()||a.isLeafNode())return[];{const e=[],t=o.getCompare(),n=s?a.getReverseIteratorFrom(r,o):a.getIteratorFrom(r,o);let c=n.getNext();for(;c&&e.length<i;)0!==t(c,r)&&e.push(c),c=n.getNext();return e}}(e.writeTree,e.treePath,t,n,r,i,s)}(this.writes_,r,t,1,n,e);return 0===i.length?null:i[0]}}function jo(e,t,n,r,i,o){const a=t.eventCache;if(null!=Ro(r,n))return t;{let c,l;if(Ki(n))if(s(t.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),t.serverCache.isFiltered()){const n=uo(t),i=Po(r,n instanceof xs?n:xs.EMPTY_NODE);c=e.filter.updateFullNode(t.eventCache.getNode(),i,o)}else{const n=No(r,uo(t));c=e.filter.updateFullNode(t.eventCache.getNode(),n,o)}else{const u=Fi(n);if(".priority"===u){s(1===ji(n),"Can't have a priority with additional path components");const i=a.getNode();l=t.serverCache.getNode();const o=Oo(r,n,i,l);c=null!=o?e.filter.updatePriority(i,o):a.getNode()}else{const s=qi(n);let h;if(a.isCompleteForChild(u)){l=t.serverCache.getNode();const e=Oo(r,n,a.getNode(),l);h=null!=e?a.getNode().getImmediateChild(u).updateChild(s,e):a.getNode().getImmediateChild(u)}else h=Do(r,u,t.serverCache);c=null!=h?e.filter.updateChild(a.getNode(),u,h,s,i,o):a.getNode()}}return ao(t,c,a.isFullyInitialized()||Ki(n),e.filter.filtersNodes())}}function qo(e,t,n,r,i,s,o,a){const c=t.serverCache;let l;const u=o?e.filter:e.filter.getIndexedFilter();if(Ki(n))l=u.updateFullNode(c.getNode(),r,null);else if(u.filtersNodes()&&!c.isFiltered()){const e=c.getNode().updateChild(n,r);l=u.updateFullNode(c.getNode(),e,null)}else{const e=Fi(n);if(!c.isCompleteForPath(n)&&ji(n)>1)return t;const i=qi(n),s=c.getNode().getImmediateChild(e).updateChild(i,r);l=".priority"===e?u.updatePriority(c.getNode(),s):u.updateChild(c.getNode(),e,s,i,Uo,null)}const h=co(t,l,c.isFullyInitialized()||Ki(n),u.filtersNodes());return jo(e,h,n,i,new Fo(i,h,s),a)}function Bo(e,t,n,r,i,s,o){const a=t.eventCache;let c,l;const u=new Fo(i,t,s);if(Ki(n))l=e.filter.updateFullNode(t.eventCache.getNode(),r,o),c=ao(t,l,!0,e.filter.filtersNodes());else{const i=Fi(n);if(".priority"===i)l=e.filter.updatePriority(t.eventCache.getNode(),r),c=ao(t,l,a.isFullyInitialized(),a.isFiltered());else{const s=qi(n),l=a.getNode().getImmediateChild(i);let h;if(Ki(s))h=r;else{const e=u.getCompleteChild(i);h=null!=e?".priority"===Bi(s)&&e.getChild(Vi(s)).isEmpty()?e:e.updateChild(s,r):xs.EMPTY_NODE}c=l.equals(h)?t:ao(t,e.filter.updateChild(a.getNode(),i,h,s,u,o),a.isFullyInitialized(),e.filter.filtersNodes())}}return c}function Wo(e,t){return e.eventCache.isCompleteForChild(t)}function Vo(e,t,n){return n.foreach(((e,n)=>{t=t.updateChild(e,n)})),t}function Ho(e,t,n,r,i,s,o,a){if(t.serverCache.getNode().isEmpty()&&!t.serverCache.isFullyInitialized())return t;let c,l=t;c=Ki(n)?r:new po(null).setTree(n,r);const u=t.serverCache.getNode();return c.children.inorderTraversal(((n,r)=>{if(u.hasChild(n)){const c=Vo(0,t.serverCache.getNode().getImmediateChild(n),r);l=qo(e,l,new Li(n),c,i,s,o,a)}})),c.children.inorderTraversal(((n,r)=>{const c=!t.serverCache.isCompleteForChild(n)&&void 0===r.value;if(!u.hasChild(n)&&!c){const c=Vo(0,t.serverCache.getNode().getImmediateChild(n),r);l=qo(e,l,new Li(n),c,i,s,o,a)}})),l}class Ko{constructor(e,t){this.query_=e,this.eventRegistrations_=[];const n=this.query_._queryParams,r=new Ls(n.getIndex()),i=(s=n).loadsAllData()?new Ls(s.getIndex()):s.hasLimit()?new Fs(s):new Us(s);var s;this.processor_=function(e){return{filter:e}}(i);const o=t.serverCache,a=t.eventCache,c=r.updateFullNode(xs.EMPTY_NODE,o.getNode(),null),l=i.updateFullNode(xs.EMPTY_NODE,a.getNode(),null),u=new ro(c,o.isFullyInitialized(),r.filtersNodes()),h=new ro(l,a.isFullyInitialized(),i.filtersNodes());this.viewCache_=oo(h,u),this.eventGenerator_=new io(this.query_)}get query(){return this.query_}}function $o(e,t){const n=uo(e.viewCache_);return n&&(e.query._queryParams.loadsAllData()||!Ki(t)&&!n.getImmediateChild(Fi(t)).isEmpty())?n.getChild(t):null}function Go(e){return 0===e.eventRegistrations_.length}function Jo(e,t,n){const r=[];if(n){s(null==t,"A cancel should cancel all event registrations.");const i=e.query._path;e.eventRegistrations_.forEach((e=>{const t=e.createCancelEvent(n,i);t&&r.push(t)}))}if(t){let n=[];for(let r=0;r<e.eventRegistrations_.length;++r){const i=e.eventRegistrations_[r];if(i.matches(t)){if(t.hasAnyCallback()){n=n.concat(e.eventRegistrations_.slice(r+1));break}}else n.push(i)}e.eventRegistrations_=n}else e.eventRegistrations_=[];return r}function Zo(e,t,n,r){t.type===Zs.MERGE&&null!==t.source.queryId&&(s(uo(e.viewCache_),"We should always have a full cache before handling merges"),s(lo(e.viewCache_),"Missing event cache, even though we have a server cache"));const i=e.viewCache_,a=function(e,t,n,r,i){const a=new Lo;let c,l;if(n.type===Zs.OVERWRITE){const o=n;o.source.fromUser?c=Bo(e,t,o.path,o.snap,r,i,a):(s(o.source.fromServer,"Unknown source."),l=o.source.tagged||t.serverCache.isFiltered()&&!Ki(o.path),c=qo(e,t,o.path,o.snap,r,i,l,a))}else if(n.type===Zs.MERGE){const o=n;o.source.fromUser?c=function(e,t,n,r,i,s,o){let a=t;return r.foreach(((r,c)=>{const l=Hi(n,r);Wo(t,Fi(l))&&(a=Bo(e,a,l,c,i,s,o))})),r.foreach(((r,c)=>{const l=Hi(n,r);Wo(t,Fi(l))||(a=Bo(e,a,l,c,i,s,o))})),a}(e,t,o.path,o.children,r,i,a):(s(o.source.fromServer,"Unknown source."),l=o.source.tagged||t.serverCache.isFiltered(),c=Ho(e,t,o.path,o.children,r,i,l,a))}else if(n.type===Zs.ACK_USER_WRITE){const o=n;c=o.revert?function(e,t,n,r,i,o){let a;if(null!=Ro(r,n))return t;{const c=new Fo(r,t,i),l=t.eventCache.getNode();let u;if(Ki(n)||".priority"===Fi(n)){let n;if(t.serverCache.isFullyInitialized())n=No(r,uo(t));else{const e=t.serverCache.getNode();s(e instanceof xs,"serverChildren would be complete if leaf node"),n=Po(r,e)}n=n,u=e.filter.updateFullNode(l,n,o)}else{const i=Fi(n);let s=Do(r,i,t.serverCache);null==s&&t.serverCache.isCompleteForChild(i)&&(s=l.getImmediateChild(i)),u=null!=s?e.filter.updateChild(l,i,s,qi(n),c,o):t.eventCache.getNode().hasChild(i)?e.filter.updateChild(l,i,xs.EMPTY_NODE,qi(n),c,o):l,u.isEmpty()&&t.serverCache.isFullyInitialized()&&(a=No(r,uo(t)),a.isLeafNode()&&(u=e.filter.updateFullNode(u,a,o)))}return a=t.serverCache.isFullyInitialized()||null!=Ro(r,Ui()),ao(t,u,a,e.filter.filtersNodes())}}(e,t,o.path,r,i,a):function(e,t,n,r,i,s,o){if(null!=Ro(i,n))return t;const a=t.serverCache.isFiltered(),c=t.serverCache;if(null!=r.value){if(Ki(n)&&c.isFullyInitialized()||c.isCompleteForPath(n))return qo(e,t,n,c.getNode().getChild(n),i,s,a,o);if(Ki(n)){let r=new po(null);return c.getNode().forEachChild(as,((e,t)=>{r=r.set(new Li(e),t)})),Ho(e,t,n,r,i,s,a,o)}return t}{let l=new po(null);return r.foreach(((e,t)=>{const r=Hi(n,e);c.isCompleteForPath(r)&&(l=l.set(e,c.getNode().getChild(r)))})),Ho(e,t,n,l,i,s,a,o)}}(e,t,o.path,o.affectedTree,r,i,a)}else{if(n.type!==Zs.LISTEN_COMPLETE)throw o("Unknown operation type: "+n.type);c=function(e,t,n,r,i){const s=t.serverCache;return jo(e,co(t,s.getNode(),s.isFullyInitialized()||Ki(n),s.isFiltered()),n,r,Uo,i)}(e,t,n.path,r,a)}const u=a.getChanges();return function(e,t,n){const r=t.eventCache;if(r.isFullyInitialized()){const i=r.getNode().isLeafNode()||r.getNode().isEmpty(),s=lo(e);(n.length>0||!e.eventCache.isFullyInitialized()||i&&!r.getNode().equals(s)||!r.getNode().getPriority().equals(s.getPriority()))&&n.push(Rs(lo(t)))}}(t,c,u),{viewCache:c,changes:u}}(e.processor_,i,t,n,r);var c,l;return c=e.processor_,l=a.viewCache,s(l.eventCache.getNode().isIndexed(c.filter.getIndex()),"Event snap not indexed"),s(l.serverCache.getNode().isIndexed(c.filter.getIndex()),"Server snap not indexed"),s(a.viewCache.serverCache.isFullyInitialized()||!i.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),e.viewCache_=a.viewCache,Yo(e,a.changes,a.viewCache.eventCache.getNode(),null)}function Yo(e,t,n,r){const i=r?[r]:e.eventRegistrations_;return function(e,t,n,r){const i=[],s=[];return t.forEach((t=>{var n;"child_changed"===t.type&&e.index_.indexedValueChanged(t.oldSnap,t.snapshotNode)&&s.push((n=t.childName,{type:"child_moved",snapshotNode:t.snapshotNode,childName:n}))})),so(e,i,"child_removed",t,r,n),so(e,i,"child_added",t,r,n),so(e,i,"child_moved",s,r,n),so(e,i,"child_changed",t,r,n),so(e,i,"value",t,r,n),i}(e.eventGenerator_,t,n,i)}let Qo,Xo;class ea{constructor(){this.views=new Map}}function ta(e,t,n,r){const i=t.source.queryId;if(null!==i){const o=e.views.get(i);return s(null!=o,"SyncTree gave us an op for an invalid query."),Zo(o,t,n,r)}{let i=[];for(const s of e.views.values())i=i.concat(Zo(s,t,n,r));return i}}function na(e,t,n,r,i,s){const o=function(e,t,n,r,i){const s=t._queryIdentifier,o=e.views.get(s);if(!o){let e=No(n,i?r:null),s=!1;e?s=!0:r instanceof xs?(e=Po(n,r),s=!1):(e=xs.EMPTY_NODE,s=!1);const o=oo(new ro(e,s,!1),new ro(r,i,!1));return new Ko(t,o)}return o}(e,t,r,i,s);return e.views.has(t._queryIdentifier)||e.views.set(t._queryIdentifier,o),function(e,t){e.eventRegistrations_.push(t)}(o,n),function(e,t){const n=e.viewCache_.eventCache,r=[];return n.getNode().isLeafNode()||n.getNode().forEachChild(ws,((e,t)=>{r.push(Ds(e,t))})),n.isFullyInitialized()&&r.push(Rs(n.getNode())),Yo(e,r,n.getNode(),t)}(o,n)}function ra(e){const t=[];for(const n of e.views.values())n.query._queryParams.loadsAllData()||t.push(n);return t}function ia(e,t){let n=null;for(const r of e.views.values())n=n||$o(r,t);return n}function sa(e,t){if(t._queryParams.loadsAllData())return ca(e);{const n=t._queryIdentifier;return e.views.get(n)}}function oa(e,t){return null!=sa(e,t)}function aa(e){return null!=ca(e)}function ca(e){for(const t of e.views.values())if(t.query._queryParams.loadsAllData())return t;return null}let la=1;class ua{constructor(e){this.listenProvider_=e,this.syncPointTree_=new po(null),this.pendingWriteTree_={visibleWrites:fo.empty(),allWrites:[],lastWriteId:-1},this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function ha(e,t,n,r,i){return function(e,t,n,r,i){s(r>e.lastWriteId,"Stacking an older write on top of newer ones"),void 0===i&&(i=!0),e.allWrites.push({path:t,snap:n,writeId:r,visible:i}),i&&(e.visibleWrites=_o(e.visibleWrites,t,n)),e.lastWriteId=r}(e.pendingWriteTree_,t,n,r,i),i?ga(e,new to({fromUser:!0,fromServer:!1,queryId:null,tagged:!1},t,n)):[]}function da(e,t,n=!1){const r=function(e,t){for(let n=0;n<e.allWrites.length;n++){const r=e.allWrites[n];if(r.writeId===t)return r}return null}(e.pendingWriteTree_,t);if(function(e,t){const n=e.allWrites.findIndex((e=>e.writeId===t));s(n>=0,"removeWrite called with nonexistent writeId.");const r=e.allWrites[n];e.allWrites.splice(n,1);let i=r.visible,o=!1,a=e.allWrites.length-1;for(;i&&a>=0;){const t=e.allWrites[a];t.visible&&(a>=n&&Io(t,r.path)?i=!1:Zi(r.path,t.path)&&(o=!0)),a--}return!!i&&(o?(function(e){e.visibleWrites=xo(e.allWrites,Co,Ui()),e.allWrites.length>0?e.lastWriteId=e.allWrites[e.allWrites.length-1].writeId:e.lastWriteId=-1}(e),!0):(r.snap?e.visibleWrites=go(e.visibleWrites,r.path):li(r.children,(t=>{e.visibleWrites=go(e.visibleWrites,Hi(r.path,t))})),!0))}(e.pendingWriteTree_,t)){let t=new po(null);return null!=r.snap?t=t.set(Ui(),!0):li(r.children,(e=>{t=t.set(new Li(e),!0)})),ga(e,new Xs(r.path,t,n))}return[]}function pa(e,t,n){return ga(e,new to({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},t,n))}function fa(e,t,n,r){const i=t._path,o=e.syncPointTree_.get(i);let a=[];if(o&&("default"===t._queryIdentifier||oa(o,t))){const c=function(e,t,n,r){const i=t._queryIdentifier,o=[];let a=[];const c=aa(e);if("default"===i)for(const[t,i]of e.views.entries())a=a.concat(Jo(i,n,r)),Go(i)&&(e.views.delete(t),i.query._queryParams.loadsAllData()||o.push(i.query));else{const t=e.views.get(i);t&&(a=a.concat(Jo(t,n,r)),Go(t)&&(e.views.delete(i),t.query._queryParams.loadsAllData()||o.push(t.query)))}return c&&!aa(e)&&o.push(new(s(Qo,"Reference.ts has not been loaded"),Qo)(t._repo,t._path)),{removed:o,events:a}}(o,t,n,r);0===o.views.size&&(e.syncPointTree_=e.syncPointTree_.remove(i));const l=c.removed;a=c.events;const u=-1!==l.findIndex((e=>e._queryParams.loadsAllData())),h=e.syncPointTree_.findOnPath(i,((e,t)=>aa(t)));if(u&&!h){const t=e.syncPointTree_.subtree(i);if(!t.isEmpty()){const n=function(e){return e.fold(((e,t,n)=>{if(t&&aa(t))return[ca(t)];{let e=[];return t&&(e=ra(t)),li(n,((t,n)=>{e=e.concat(n)})),e}}))}(t);for(let t=0;t<n.length;++t){const r=n[t],i=r.query,s=wa(e,r);e.listenProvider_.startListening(Ia(i),ba(e,i),s.hashFn,s.onComplete)}}}if(!h&&l.length>0&&!r)if(u){const n=null;e.listenProvider_.stopListening(Ia(t),n)}else l.forEach((t=>{const n=e.queryToTagMap.get(ka(t));e.listenProvider_.stopListening(Ia(t),n)}));!function(e,t){for(let n=0;n<t.length;++n){const r=t[n];if(!r._queryParams.loadsAllData()){const t=ka(r),n=e.queryToTagMap.get(t);e.queryToTagMap.delete(t),e.tagToQueryMap.delete(n)}}}(e,l)}return a}function _a(e,t,n){const r=t._path;let i=null,o=!1;e.syncPointTree_.foreachOnPath(r,((e,t)=>{const n=$i(e,r);i=i||ia(t,n),o=o||aa(t)}));let a,c=e.syncPointTree_.get(r);c?(o=o||aa(c),i=i||ia(c,Ui())):(c=new ea,e.syncPointTree_=e.syncPointTree_.set(r,c)),null!=i?a=!0:(a=!1,i=xs.EMPTY_NODE,e.syncPointTree_.subtree(r).foreachChild(((e,t)=>{const n=ia(t,Ui());n&&(i=i.updateImmediateChild(e,n))})));const l=oa(c,t);if(!l&&!t._queryParams.loadsAllData()){const n=ka(t);s(!e.queryToTagMap.has(n),"View does not exist, but we have a tag");const r=la++;e.queryToTagMap.set(n,r),e.tagToQueryMap.set(r,n)}let u=na(c,t,n,So(e.pendingWriteTree_,r),i,a);if(!l&&!o){const n=sa(c,t);u=u.concat(function(e,t,n){const r=t._path,i=ba(e,t),o=wa(e,n),a=e.listenProvider_.startListening(Ia(t),i,o.hashFn,o.onComplete),c=e.syncPointTree_.subtree(r);if(i)s(!aa(c.value),"If we're adding a query, it shouldn't be shadowed");else{const t=c.fold(((e,t,n)=>{if(!Ki(e)&&t&&aa(t))return[ca(t).query];{let e=[];return t&&(e=e.concat(ra(t).map((e=>e.query)))),li(n,((t,n)=>{e=e.concat(n)})),e}}));for(let n=0;n<t.length;++n){const r=t[n];e.listenProvider_.stopListening(Ia(r),ba(e,r))}}return a}(e,t,n))}return u}function ma(e,t,n){const r=e.pendingWriteTree_,i=e.syncPointTree_.findOnPath(t,((e,n)=>{const r=ia(n,$i(e,t));if(r)return r}));return Ao(r,t,i,n,!0)}function ga(e,t){return ya(t,e.syncPointTree_,null,So(e.pendingWriteTree_,Ui()))}function ya(e,t,n,r){if(Ki(e.path))return va(e,t,n,r);{const i=t.get(Ui());null==n&&null!=i&&(n=ia(i,Ui()));let s=[];const o=Fi(e.path),a=e.operationForChild(o),c=t.children.get(o);if(c&&a){const e=n?n.getImmediateChild(o):null,t=zo(r,o);s=s.concat(ya(a,c,e,t))}return i&&(s=s.concat(ta(i,e,r,n))),s}}function va(e,t,n,r){const i=t.get(Ui());null==n&&null!=i&&(n=ia(i,Ui()));let s=[];return t.children.inorderTraversal(((t,i)=>{const o=n?n.getImmediateChild(t):null,a=zo(r,t),c=e.operationForChild(t);c&&(s=s.concat(va(c,i,o,a)))})),i&&(s=s.concat(ta(i,e,r,n))),s}function wa(e,t){const n=t.query,r=ba(e,n);return{hashFn:()=>{const e=function(e){return e.viewCache_.serverCache.getNode()}(t)||xs.EMPTY_NODE;return e.hash()},onComplete:t=>{if("ok"===t)return r?function(e,t,n){const r=Ea(e,n);if(r){const n=Ta(r),i=n.path,s=n.queryId,o=$i(i,t);return Sa(e,i,new eo(Qs(s),o))}return[]}(e,n._path,r):function(e,t){return ga(e,new eo({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},t))}(e,n._path);{const r=function(e,t){let n="Unknown Error";"too_big"===e?n="The data requested exceeds the maximum size that can be accessed with a single request.":"permission_denied"===e?n="Client doesn't have permission to access the desired data.":"unavailable"===e&&(n="The service is unavailable");const r=new Error(e+" at "+t._path.toString()+": "+n);return r.code=e.toUpperCase(),r}(t,n);return fa(e,n,null,r)}}}}function ba(e,t){const n=ka(t);return e.queryToTagMap.get(n)}function ka(e){return e._path.toString()+"$"+e._queryIdentifier}function Ea(e,t){return e.tagToQueryMap.get(t)}function Ta(e){const t=e.indexOf("$");return s(-1!==t&&t<e.length-1,"Bad queryKey."),{queryId:e.substr(t+1),path:new Li(e.substr(0,t))}}function Sa(e,t,n){const r=e.syncPointTree_.get(t);return s(r,"Missing sync point for query tag that we're tracking"),ta(r,n,So(e.pendingWriteTree_,t),null)}function Ia(e){return e._queryParams.loadsAllData()&&!e._queryParams.isDefault()?new(s(Xo,"Reference.ts has not been loaded"),Xo)(e._repo,e._path):e}class Ca{constructor(e){this.node_=e}getImmediateChild(e){const t=this.node_.getImmediateChild(e);return new Ca(t)}node(){return this.node_}}class xa{constructor(e,t){this.syncTree_=e,this.path_=t}getImmediateChild(e){const t=Hi(this.path_,e);return new xa(this.syncTree_,t)}node(){return ma(this.syncTree_,this.path_)}}const Aa=function(e,t,n){return e&&"object"==typeof e?(s(".sv"in e,"Unexpected leaf node or priority contents"),"string"==typeof e[".sv"]?Na(e[".sv"],t,n):"object"==typeof e[".sv"]?Pa(e[".sv"],t):void s(!1,"Unexpected server value: "+JSON.stringify(e,null,2))):e},Na=function(e,t,n){if("timestamp"===e)return n.timestamp;s(!1,"Unexpected server value: "+e)},Pa=function(e,t,n){e.hasOwnProperty("increment")||s(!1,"Unexpected server value: "+JSON.stringify(e,null,2));const r=e.increment;"number"!=typeof r&&s(!1,"Unexpected increment value: "+r);const i=t.node();if(s(null!=i,"Expected ChildrenNode.EMPTY_NODE for nulls"),!i.isLeafNode())return r;const o=i.getValue();return"number"!=typeof o?r:o+r},Oa=function(e,t,n,r){return Da(t,new xa(n,e),r)},Ra=function(e,t,n){return Da(e,new Ca(t),n)};function Da(e,t,n){const r=e.getPriority().val(),i=Aa(r,t.getImmediateChild(".priority"),n);let s;if(e.isLeafNode()){const r=e,s=Aa(r.getValue(),t,n);return s!==r.getValue()||i!==r.getPriority().val()?new vs(s,Ns(i)):e}{const r=e;return s=r,i!==r.getPriority().val()&&(s=s.updatePriority(new vs(i))),r.forEachChild(ws,((e,r)=>{const i=Da(r,t.getImmediateChild(e),n);i!==r&&(s=s.updateImmediateChild(e,i))})),s}}class za{constructor(e="",t=null,n={children:{},childCount:0}){this.name=e,this.parent=t,this.node=n}}function Ma(e,t){let n=t instanceof Li?t:new Li(t),r=e,i=Fi(n);for(;null!==i;){const e=T(r.node.children,i)||{children:{},childCount:0};r=new za(i,r,e),n=qi(n),i=Fi(n)}return r}function La(e){return e.node.value}function Ua(e,t){e.node.value=t,Wa(e)}function Fa(e){return e.node.childCount>0}function ja(e,t){li(e.node.children,((n,r)=>{t(new za(n,e,r))}))}function qa(e,t,n,r){n&&!r&&t(e),ja(e,(e=>{qa(e,t,!0,r)})),n&&r&&t(e)}function Ba(e){return new Li(null===e.parent?e.name:Ba(e.parent)+"/"+e.name)}function Wa(e){null!==e.parent&&function(e,t,n){const r=function(e){return void 0===La(e)&&!Fa(e)}(n),i=E(e.node.children,t);r&&i?(delete e.node.children[t],e.node.childCount--,Wa(e)):r||i||(e.node.children[t]=n.node,e.node.childCount++,Wa(e))}(e.parent,e.name,e)}const Va=/[\[\].#$\/\u0000-\u001F\u007F]/,Ha=/[\[\].#$\u0000-\u001F\u007F]/,Ka=10485760,$a=function(e){return"string"==typeof e&&0!==e.length&&!Va.test(e)},Ga=function(e){return"string"==typeof e&&0!==e.length&&!Ha.test(e)},Ja=function(e){return null===e||"string"==typeof e||"number"==typeof e&&!ti(e)||e&&"object"==typeof e&&E(e,".sv")},Za=function(e,t,n){const r=n instanceof Li?new Yi(n,e):n;if(void 0===t)throw new Error(e+"contains undefined "+Xi(r));if("function"==typeof t)throw new Error(e+"contains a function "+Xi(r)+" with contents = "+t.toString());if(ti(t))throw new Error(e+"contains "+t.toString()+" "+Xi(r));if("string"==typeof t&&t.length>Ka/3&&M(t)>Ka)throw new Error(e+"contains a string greater than 10485760 utf8 bytes "+Xi(r)+" ('"+t.substring(0,50)+"...')");if(t&&"object"==typeof t){let n=!1,i=!1;if(li(t,((t,s)=>{if(".value"===t)n=!0;else if(".priority"!==t&&".sv"!==t&&(i=!0,!$a(t)))throw new Error(e+" contains an invalid key ("+t+") "+Xi(r)+'.  Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');!function(e,t){e.parts_.length>0&&(e.byteLength_+=1),e.parts_.push(t),e.byteLength_+=M(t),Qi(e)}(r,t),Za(e,s,r),function(e){const t=e.parts_.pop();e.byteLength_-=M(t),e.parts_.length>0&&(e.byteLength_-=1)}(r)})),n&&i)throw new Error(e+' contains ".value" child '+Xi(r)+" in addition to actual children.")}},Ya=function(e,t,n,r){if(!(r&&void 0===n||Ga(n)))throw new Error(z(e,t)+'was an invalid path = "'+n+'". Paths must be non-empty strings and can\'t contain ".", "#", "$", "[", or "]"')};class Qa{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function Xa(e,t){let n=null;for(let r=0;r<t.length;r++){const i=t[r],s=i.getPath();null===n||Ji(s,n.path)||(e.eventLists_.push(n),n=null),null===n&&(n={events:[],path:s}),n.events.push(i)}n&&e.eventLists_.push(n)}function ec(e,t,n){Xa(e,n),nc(e,(e=>Ji(e,t)))}function tc(e,t,n){Xa(e,n),nc(e,(e=>Zi(e,t)||Zi(t,e)))}function nc(e,t){e.recursionDepth_++;let n=!0;for(let r=0;r<e.eventLists_.length;r++){const i=e.eventLists_[r];i&&(t(i.path)?(rc(e.eventLists_[r]),e.eventLists_[r]=null):n=!1)}n&&(e.eventLists_=[]),e.recursionDepth_--}function rc(e){for(let t=0;t<e.events.length;t++){const n=e.events[t];if(null!==n){e.events[t]=null;const r=n.getEventRunner();Gr&&Zr("event: "+n.toString()),pi(r)}}}class ic{constructor(e,t,n,r){this.repoInfo_=e,this.forceRestClient_=t,this.authTokenProvider_=n,this.appCheckProvider_=r,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new Qa,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=Hs(),this.transactionQueueTree_=new za,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function sc(e,t,n){if(e.stats_=Ii(e.repoInfo_),e.forceRestClient_||("object"==typeof window&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0)e.server_=new Ws(e.repoInfo_,((t,n,r,i)=>{cc(e,t,n,r,i)}),e.authTokenProvider_,e.appCheckProvider_),setTimeout((()=>lc(e,!0)),0);else{if(null!=n){if("object"!=typeof n)throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{b(n)}catch(e){throw new Error("Invalid authOverride provided: "+e)}}e.persistentConnection_=new ns(e.repoInfo_,t,((t,n,r,i)=>{cc(e,t,n,r,i)}),(t=>{lc(e,t)}),(t=>{!function(e,t){li(t,((t,n)=>{uc(e,t,n)}))}(e,t)}),e.authTokenProvider_,e.appCheckProvider_,n),e.server_=e.persistentConnection_}e.authTokenProvider_.addTokenChangeListener((t=>{e.server_.refreshAuthToken(t)})),e.appCheckProvider_.addTokenChangeListener((t=>{e.server_.refreshAppCheckToken(t.token)})),e.statsReporter_=function(t,n){const r=t.toString();return Si[r]||(Si[r]=new Js(e.stats_,e.server_)),Si[r]}(e.repoInfo_),e.infoData_=new Vs,e.infoSyncTree_=new ua({startListening:(t,n,r,i)=>{let s=[];const o=e.infoData_.getNode(t._path);return o.isEmpty()||(s=pa(e.infoSyncTree_,t._path,o),setTimeout((()=>{i("ok")}),0)),s},stopListening:()=>{}}),uc(e,"connected",!1),e.serverSyncTree_=new ua({startListening:(t,n,r,i)=>(e.server_.listen(t,r,n,((n,r)=>{const s=i(n,r);tc(e.eventQueue_,t._path,s)})),[]),stopListening:(t,n)=>{e.server_.unlisten(t,n)}})}function oc(e){const t=e.infoData_.getNode(new Li(".info/serverTimeOffset")).val()||0;return(new Date).getTime()+t}function ac(e){return(t=(t={timestamp:oc(e)})||{}).timestamp=t.timestamp||(new Date).getTime(),t;var t}function cc(e,t,n,r,i){e.dataUpdateCount++;const s=new Li(t);n=e.interceptServerDataCallback_?e.interceptServerDataCallback_(t,n):n;let o=[];if(i)if(r){const t=I(n,(e=>Ns(e)));o=function(e,t,n,r){const i=Ea(e,r);if(i){const r=Ta(i),s=r.path,o=r.queryId,a=$i(s,t),c=po.fromObject(n);return Sa(e,s,new no(Qs(o),a,c))}return[]}(e.serverSyncTree_,s,t,i)}else{const t=Ns(n);o=function(e,t,n,r){const i=Ea(e,r);if(null!=i){const r=Ta(i),s=r.path,o=r.queryId,a=$i(s,t);return Sa(e,s,new to(Qs(o),a,n))}return[]}(e.serverSyncTree_,s,t,i)}else if(r){const t=I(n,(e=>Ns(e)));o=function(e,t,n){const r=po.fromObject(n);return ga(e,new no({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},t,r))}(e.serverSyncTree_,s,t)}else{const t=Ns(n);o=pa(e.serverSyncTree_,s,t)}let a=s;o.length>0&&(a=gc(e,s)),tc(e.eventQueue_,a,o)}function lc(e,t){uc(e,"connected",t),!1===t&&function(e){pc(e,"onDisconnectEvents");const t=ac(e),n=Hs();$s(e.onDisconnect_,Ui(),((r,i)=>{const s=Oa(r,i,e.serverSyncTree_,t);Ks(n,r,s)}));let r=[];$s(n,Ui(),((t,n)=>{r=r.concat(pa(e.serverSyncTree_,t,n));const i=kc(e,t);gc(e,i)})),e.onDisconnect_=Hs(),tc(e.eventQueue_,Ui(),r)}(e)}function uc(e,t,n){const r=new Li("/.info/"+t),i=Ns(n);e.infoData_.updateSnapshot(r,i);const s=pa(e.infoSyncTree_,r,i);tc(e.eventQueue_,r,s)}function hc(e){return e.nextWriteId_++}function dc(e,t,n){let r;r=".info"===Fi(t._path)?fa(e.infoSyncTree_,t,n):fa(e.serverSyncTree_,t,n),ec(e.eventQueue_,t._path,r)}function pc(e,...t){let n="";e.persistentConnection_&&(n=e.persistentConnection_.id+":"),Zr(n,...t)}function fc(e,t,n,r){t&&pi((()=>{if("ok"===n)t(null);else{const e=(n||"error").toUpperCase();let i=e;r&&(i+=": "+r);const s=new Error(i);s.code=e,t(s)}}))}function _c(e,t,n){return ma(e.serverSyncTree_,t,n)||xs.EMPTY_NODE}function mc(e,t=e.transactionQueueTree_){if(t||bc(e,t),La(t)){const n=vc(e,t);s(n.length>0,"Sending zero length transaction queue"),n.every((e=>0===e.status))&&function(e,t,n){const r=n.map((e=>e.currentWriteId)),i=_c(e,t,r);let o=i;const a=i.hash();for(let e=0;e<n.length;e++){const r=n[e];s(0===r.status,"tryToSendTransactionQueue_: items in queue should all be run."),r.status=1,r.retryCount++;const i=$i(t,r.path);o=o.updateChild(i,r.currentOutputSnapshotRaw)}const c=o.val(!0),l=t;e.server_.put(l.toString(),c,(r=>{pc(e,"transaction put response",{path:l.toString(),status:r});let i=[];if("ok"===r){const r=[];for(let t=0;t<n.length;t++)n[t].status=2,i=i.concat(da(e.serverSyncTree_,n[t].currentWriteId)),n[t].onComplete&&r.push((()=>n[t].onComplete(null,!0,n[t].currentOutputSnapshotResolved))),n[t].unwatcher();bc(e,Ma(e.transactionQueueTree_,t)),mc(e,e.transactionQueueTree_),tc(e.eventQueue_,t,i);for(let e=0;e<r.length;e++)pi(r[e])}else{if("datastale"===r)for(let e=0;e<n.length;e++)3===n[e].status?n[e].status=4:n[e].status=0;else{ei("transaction at "+l.toString()+" failed: "+r);for(let e=0;e<n.length;e++)n[e].status=4,n[e].abortReason=r}gc(e,t)}}),a)}(e,Ba(t),n)}else Fa(t)&&ja(t,(t=>{mc(e,t)}))}function gc(e,t){const n=yc(e,t),r=Ba(n);return function(e,t,n){if(0===t.length)return;const r=[];let i=[];const o=t.filter((e=>0===e.status)).map((e=>e.currentWriteId));for(let c=0;c<t.length;c++){const l=t[c],u=$i(n,l.path);let h,d=!1;if(s(null!==u,"rerunTransactionsUnderNode_: relativePath should not be null."),4===l.status)d=!0,h=l.abortReason,i=i.concat(da(e.serverSyncTree_,l.currentWriteId,!0));else if(0===l.status)if(l.retryCount>=25)d=!0,h="maxretry",i=i.concat(da(e.serverSyncTree_,l.currentWriteId,!0));else{const n=_c(e,l.path,o);l.currentInputSnapshot=n;const r=t[c].update(n.val());if(void 0!==r){Za("transaction failed: Data returned ",r,l.path);let t=Ns(r);"object"==typeof r&&null!=r&&E(r,".priority")||(t=t.updatePriority(n.getPriority()));const s=l.currentWriteId,a=ac(e),c=Ra(t,n,a);l.currentOutputSnapshotRaw=t,l.currentOutputSnapshotResolved=c,l.currentWriteId=hc(e),o.splice(o.indexOf(s),1),i=i.concat(ha(e.serverSyncTree_,l.path,c,l.currentWriteId,l.applyLocally)),i=i.concat(da(e.serverSyncTree_,s,!0))}else d=!0,h="nodata",i=i.concat(da(e.serverSyncTree_,l.currentWriteId,!0))}tc(e.eventQueue_,n,i),i=[],d&&(t[c].status=2,a=t[c].unwatcher,setTimeout(a,Math.floor(0)),t[c].onComplete&&("nodata"===h?r.push((()=>t[c].onComplete(null,!1,t[c].currentInputSnapshot))):r.push((()=>t[c].onComplete(new Error(h),!1,null)))))}var a;bc(e,e.transactionQueueTree_);for(let e=0;e<r.length;e++)pi(r[e]);mc(e,e.transactionQueueTree_)}(e,vc(e,n),r),r}function yc(e,t){let n,r=e.transactionQueueTree_;for(n=Fi(t);null!==n&&void 0===La(r);)r=Ma(r,n),n=Fi(t=qi(t));return r}function vc(e,t){const n=[];return wc(e,t,n),n.sort(((e,t)=>e.order-t.order)),n}function wc(e,t,n){const r=La(t);if(r)for(let e=0;e<r.length;e++)n.push(r[e]);ja(t,(t=>{wc(e,t,n)}))}function bc(e,t){const n=La(t);if(n){let e=0;for(let t=0;t<n.length;t++)2!==n[t].status&&(n[e]=n[t],e++);n.length=e,Ua(t,n.length>0?n:void 0)}ja(t,(t=>{bc(e,t)}))}function kc(e,t){const n=Ba(yc(e,t)),r=Ma(e.transactionQueueTree_,t);return function(e,t,n){let r=e.parent;for(;null!==r;){if(t(r))return!0;r=r.parent}}(r,(t=>{Ec(e,t)})),Ec(e,r),qa(r,(t=>{Ec(e,t)})),n}function Ec(e,t){const n=La(t);if(n){const r=[];let i=[],o=-1;for(let t=0;t<n.length;t++)3===n[t].status||(1===n[t].status?(s(o===t-1,"All SENT items should be at beginning of queue."),o=t,n[t].status=3,n[t].abortReason="set"):(s(0===n[t].status,"Unexpected transaction status in abort"),n[t].unwatcher(),i=i.concat(da(e.serverSyncTree_,n[t].currentWriteId,!0)),n[t].onComplete&&r.push(n[t].onComplete.bind(null,new Error("set"),!1,null))));-1===o?Ua(t,void 0):n.length=o+1,tc(e.eventQueue_,Ba(t),i);for(let e=0;e<r.length;e++)pi(r[e])}}const Tc=function(e,t){const n=Sc(e),r=n.namespace;"firebase.com"===n.domain&&Xr(n.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),r&&"undefined"!==r||"localhost"===n.domain||Xr("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),n.secure||"undefined"!=typeof window&&window.location&&window.location.protocol&&-1!==window.location.protocol.indexOf("https:")&&ei("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().");const i="ws"===n.scheme||"wss"===n.scheme;return{repoInfo:new bi(n.host,n.secure,r,t,i,"",r!==n.subdomain),path:new Li(n.pathString)}},Sc=function(e){let t="",n="",r="",i="",s="",o=!0,a="https",c=443;if("string"==typeof e){let l=e.indexOf("//");l>=0&&(a=e.substring(0,l-1),e=e.substring(l+2));let u=e.indexOf("/");-1===u&&(u=e.length);let h=e.indexOf("?");-1===h&&(h=e.length),t=e.substring(0,Math.min(u,h)),u<h&&(i=function(e){let t="";const n=e.split("/");for(let e=0;e<n.length;e++)if(n[e].length>0){let r=n[e];try{r=decodeURIComponent(r.replace(/\+/g," "))}catch(e){}t+="/"+r}return t}(e.substring(u,h)));const d=function(e){const t={};"?"===e.charAt(0)&&(e=e.substring(1));for(const n of e.split("&")){if(0===n.length)continue;const r=n.split("=");2===r.length?t[decodeURIComponent(r[0])]=decodeURIComponent(r[1]):ei(`Invalid query segment '${n}' in query '${e}'`)}return t}(e.substring(Math.min(e.length,h)));l=t.indexOf(":"),l>=0?(o="https"===a||"wss"===a,c=parseInt(t.substring(l+1),10)):l=t.length;const p=t.slice(0,l);if("localhost"===p.toLowerCase())n="localhost";else if(p.split(".").length<=2)n=p;else{const e=t.indexOf(".");r=t.substring(0,e).toLowerCase(),n=t.substring(e+1),s=r}"ns"in d&&(s=d.ns)}return{host:t,port:c,domain:n,subdomain:r,secure:o,scheme:a,pathString:i,namespace:s}};class Ic{constructor(e,t,n,r){this.eventType=e,this.eventRegistration=t,this.snapshot=n,this.prevName=r}getPath(){const e=this.snapshot.ref;return"value"===this.eventType?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+b(this.snapshot.exportVal())}}class Cc{constructor(e,t,n){this.eventRegistration=e,this.error=t,this.path=n}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}}class xc{constructor(e,t){this.snapshotCallback=e,this.cancelCallback=t}onValue(e,t){this.snapshotCallback.call(null,e,t)}onCancel(e){return s(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||void 0!==this.snapshotCallback.userCallback&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}}class Ac{constructor(e,t,n,r){this._repo=e,this._path=t,this._queryParams=n,this._orderByCalled=r}get key(){return Ki(this._path)?null:Bi(this._path)}get ref(){return new Pc(this._repo,this._path)}get _queryIdentifier(){const e=Bs(this._queryParams),t=ai(e);return"{}"===t?"default":t}get _queryObject(){return Bs(this._queryParams)}isEqual(e){if(!((e=U(e))instanceof Ac))return!1;const t=this._repo===e._repo,n=Ji(this._path,e._path),r=this._queryIdentifier===e._queryIdentifier;return t&&n&&r}toJSON(){return this.toString()}toString(){return this._repo.toString()+function(e){let t="";for(let n=e.pieceNum_;n<e.pieces_.length;n++)""!==e.pieces_[n]&&(t+="/"+encodeURIComponent(String(e.pieces_[n])));return t||"/"}(this._path)}}function Nc(e){let t=null,n=null;if(e.hasStart()&&(t=e.getIndexStartValue()),e.hasEnd()&&(n=e.getIndexEndValue()),e.getIndex()===as){const r="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",i="Query: When ordering by key, the argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() must be a string.";if(e.hasStart()){if(e.getIndexStartName()!==ni)throw new Error(r);if("string"!=typeof t)throw new Error(i)}if(e.hasEnd()){if(e.getIndexEndName()!==ri)throw new Error(r);if("string"!=typeof n)throw new Error(i)}}else if(e.getIndex()===ws){if(null!=t&&!Ja(t)||null!=n&&!Ja(n))throw new Error("Query: When ordering by priority, the first argument passed to startAt(), startAfter() endAt(), endBefore(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if(s(e.getIndex()instanceof Ps||e.getIndex()===Os,"unknown index type."),null!=t&&"object"==typeof t||null!=n&&"object"==typeof n)throw new Error("Query: First argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() cannot be an object.")}class Pc extends Ac{constructor(e,t){super(e,t,new js,!1)}get parent(){const e=Vi(this._path);return null===e?null:new Pc(this._repo,e)}get root(){let e=this;for(;null!==e.parent;)e=e.parent;return e}}class Oc{constructor(e,t,n){this._node=e,this.ref=t,this._index=n}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){const t=new Li(e),n=Dc(this.ref,e);return new Oc(this._node.getChild(t),n,ws)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){return!this._node.isLeafNode()&&!!this._node.forEachChild(this._index,((t,n)=>e(new Oc(n,Dc(this.ref,t),ws))))}hasChild(e){const t=new Li(e);return!this._node.getChild(t).isEmpty()}hasChildren(){return!this._node.isLeafNode()&&!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}}function Rc(e,t){return(e=U(e))._checkNotDeleted("ref"),void 0!==t?Dc(e._root,t):e._root}function Dc(e,t){var n;return null===Fi((e=U(e))._path)?("child","path",!1,(n=t)&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),Ya("child","path",n,false)):Ya("child","path",t,!1),new Pc(e._repo,Hi(e._path,t))}function zc(e,t){!function(e,t,n,r){if(r&&void 0===t)return;const i=z(e,"values");if(!t||"object"!=typeof t||Array.isArray(t))throw new Error(i+" must be an object containing the children to replace.");const s=[];li(t,((e,t)=>{const r=new Li(e);if(Za(i,t,Hi(n,r)),".priority"===Bi(r)&&!Ja(t))throw new Error(i+"contains an invalid value for '"+r.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");s.push(r)})),function(e,t){let n,r;for(n=0;n<t.length;n++){r=t[n];const i=Wi(r);for(let t=0;t<i.length;t++)if(".priority"===i[t]&&t===i.length-1);else if(!$a(i[t]))throw new Error(e+"contains an invalid key ("+i[t]+") in path "+r.toString()+'. Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"')}t.sort(Gi);let i=null;for(n=0;n<t.length;n++){if(r=t[n],null!==i&&Zi(i,r))throw new Error(e+"contains a path "+i.toString()+" that is ancestor of another path "+r.toString());i=r}}(i,s)}("update",t,e._path,!1);const n=new d;return function(e,t,n,r){pc(e,"update",{path:t.toString(),value:n});let i=!0;const o=ac(e),a={};if(li(n,((n,r)=>{i=!1,a[n]=Oa(Hi(t,n),Ns(r),e.serverSyncTree_,o)})),i)Zr("update() called with empty data.  Don't do anything."),fc(0,r,"ok",void 0);else{const i=hc(e),o=function(e,t,n,r){!function(e,t,n,r){s(r>e.lastWriteId,"Stacking an older merge on top of newer ones"),e.allWrites.push({path:t,children:n,writeId:r,visible:!0}),e.visibleWrites=mo(e.visibleWrites,t,n),e.lastWriteId=r}(e.pendingWriteTree_,t,n,r);const i=po.fromObject(n);return ga(e,new no({fromUser:!0,fromServer:!1,queryId:null,tagged:!1},t,i))}(e.serverSyncTree_,t,a,i);Xa(e.eventQueue_,o),e.server_.merge(t.toString(),n,((n,s)=>{const o="ok"===n;o||ei("update at "+t+" failed: "+n);const a=da(e.serverSyncTree_,i,!o),c=a.length>0?gc(e,t):t;tc(e.eventQueue_,c,a),fc(0,r,n,s)})),li(n,(n=>{const r=kc(e,Hi(t,n));gc(e,r)})),tc(e.eventQueue_,t,[])}}(e._repo,e._path,t,n.wrapCallback((()=>{}))),n.promise}class Mc{constructor(e){this.callbackContext=e}respondsTo(e){return"value"===e}createEvent(e,t){const n=t._queryParams.getIndex();return new Ic("value",this,new Oc(e.snapshotNode,new Pc(t._repo,t._path),n))}getEventRunner(e){return"cancel"===e.getEventType()?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,t){return this.callbackContext.hasCancelCallback?new Cc(this,e,t):null}matches(e){return e instanceof Mc&&(!e.callbackContext||!this.callbackContext||e.callbackContext.matches(this.callbackContext))}hasAnyCallback(){return null!==this.callbackContext}}class Lc{constructor(e,t){this.eventType=e,this.callbackContext=t}respondsTo(e){let t="children_added"===e?"child_added":e;return t="children_removed"===t?"child_removed":t,this.eventType===t}createCancelEvent(e,t){return this.callbackContext.hasCancelCallback?new Cc(this,e,t):null}createEvent(e,t){s(null!=e.childName,"Child events should have a childName.");const n=Dc(new Pc(t._repo,t._path),e.childName),r=t._queryParams.getIndex();return new Ic(e.type,this,new Oc(e.snapshotNode,n,r),e.prevName)}getEventRunner(e){return"cancel"===e.getEventType()?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,e.prevName)}matches(e){return e instanceof Lc&&this.eventType===e.eventType&&(!this.callbackContext||!e.callbackContext||this.callbackContext.matches(e.callbackContext))}hasAnyCallback(){return!!this.callbackContext}}function Uc(e,t,n,r){return function(e,t,n,r,i){let s;if("object"==typeof r&&(s=void 0,i=r),"function"==typeof r&&(s=r),i&&i.onlyOnce){const t=n,r=(n,r)=>{dc(e._repo,e,a),t(n,r)};r.userCallback=n.userCallback,r.context=n.context,n=r}const o=new xc(n,s||void 0),a="value"===t?new Mc(o):new Lc(t,o);return function(e,t,n){let r;r=".info"===Fi(t._path)?_a(e.infoSyncTree_,t,n):_a(e.serverSyncTree_,t,n),ec(e.eventQueue_,t._path,r)}(e._repo,e,a),()=>dc(e._repo,e,a)}(e,"value",t,n,r)}class Fc{}class jc extends Fc{constructor(e,t){super(),this._value=e,this._key=t}_apply(e){var t,n,r;t="startAt",n=this._value,r=e._path,!0&&void 0===n||Za(z(t,"value"),n,r);const i=function(e,t,n){const r=e.copy();return r.startSet_=!0,void 0===t&&(t=null),r.indexStartValue_=t,null!=n?(r.startNameSet_=!0,r.indexStartName_=n):(r.startNameSet_=!1,r.indexStartName_=""),r}(e._queryParams,this._value,this._key);if(function(e){if(e.hasStart()&&e.hasEnd()&&e.hasLimit()&&!e.hasAnchoredLimit())throw new Error("Query: Can't combine startAt(), startAfter(), endAt(), endBefore(), and limit(). Use limitToFirst() or limitToLast() instead.")}(i),Nc(i),e._queryParams.hasStart())throw new Error("startAt: Starting point was already set (by another call to startAt, startBefore or equalTo).");return new Ac(e._repo,e._path,i,e._orderByCalled)}}class qc extends Fc{constructor(e){super(),this._path=e}_apply(e){!function(e,t){if(!0===e._orderByCalled)throw new Error(t+": You can't combine multiple orderBy calls.")}(e,"orderByChild");const t=new Li(this._path);if(Ki(t))throw new Error("orderByChild: cannot pass in empty path. Use orderByValue() instead.");const n=new Ps(t),r=function(e,t){const n=e.copy();return n.index_=t,n}(e._queryParams,n);return Nc(r),new Ac(e._repo,e._path,r,!0)}}!function(e){s(!Qo,"__referenceConstructor has already been defined"),Qo=e}(Pc),function(e){s(!Xo,"__referenceConstructor has already been defined"),Xo=e}(Pc);const Bc={};function Wc(e,t,n,r,i){let s=r||e.options.databaseURL;void 0===s&&(e.options.projectId||Xr("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),Zr("Using default host for project ",e.options.projectId),s=`${e.options.projectId}-default-rtdb.firebaseio.com`);let o,a,c=Tc(s,i),l=c.repoInfo;"undefined"!=typeof process&&(a=process.env.FIREBASE_DATABASE_EMULATOR_HOST),a?(o=!0,s=`http://${a}?ns=${l.namespace}`,c=Tc(s,i),l=c.repoInfo):o=!c.repoInfo.secure;const u=i&&o?new gi(gi.OWNER):new mi(e.name,e.options,t);(function(e,t){const n=t.path.toString();if("string"!=typeof t.repoInfo.host||0===t.repoInfo.host.length||!$a(t.repoInfo.namespace)&&"localhost"!==t.repoInfo.host.split(":")[0]||0!==n.length&&!function(e){return e&&(e=e.replace(/^\/*\.info(\/|$)/,"/")),Ga(e)}(n))throw new Error(z(e,"url")+'must be a valid firebase URL and the path can\'t contain ".", "#", "$", "[", or "]".')})("Invalid Firebase Database URL",c),Ki(c.path)||Xr("Database URL must point to the root of a Firebase Database (not including a child path).");const h=function(e,t,n,r){let i=Bc[t.name];i||(i={},Bc[t.name]=i);let s=i[e.toURLString()];return s&&Xr("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),s=new ic(e,false,n,r),i[e.toURLString()]=s,s}(l,e,u,new _i(e.name,n));return new Vc(h,e)}class Vc{constructor(e,t){this._repoInternal=e,this.app=t,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(sc(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new Pc(this._repo,Ui())),this._rootInternal}_delete(){return null!==this._rootInternal&&(function(e,t){const n=Bc[t];n&&n[e.key]===e||Xr(`Database ${t}(${e.repoInfo_}) has already been deleted.`),function(e){e.persistentConnection_&&e.persistentConnection_.interrupt("repo_interrupt")}(e),delete n[e.key]}(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){null===this._rootInternal&&Xr("Cannot call "+e+" on a deleted database.")}}function Hc(e,t){const n={};for(const r in e)e.hasOwnProperty(r)&&(n[r]=t(e[r]));return n}function Kc(e){if(null==e)return null;if(e instanceof Number&&(e=e.valueOf()),"number"==typeof e&&isFinite(e))return e;if(!0===e||!1===e)return e;if("[object String]"===Object.prototype.toString.call(e))return e;if(e instanceof Date)return e.toISOString();if(Array.isArray(e))return e.map((e=>Kc(e)));if("function"==typeof e||"object"==typeof e)return Hc(e,(e=>Kc(e)));throw new Error("Data cannot be encoded in JSON: "+e)}function $c(e){if(null==e)return e;if(e["@type"])switch(e["@type"]){case"type.googleapis.com/google.protobuf.Int64Value":case"type.googleapis.com/google.protobuf.UInt64Value":{const t=Number(e.value);if(isNaN(t))throw new Error("Data cannot be decoded from JSON: "+e);return t}default:throw new Error("Data cannot be decoded from JSON: "+e)}return Array.isArray(e)?e.map((e=>$c(e))):"function"==typeof e||"object"==typeof e?Hc(e,(e=>$c(e))):e}ns.prototype.simpleListen=function(e,t){this.sendRequest("q",{p:e},t)},ns.prototype.echo=function(e,t){this.sendRequest("echo",{d:e},t)},Ur="9.6.0",ie(new F("database",((e,{instanceIdentifier:t})=>Wc(e.getProvider("app").getImmediate(),e.getProvider("auth-internal"),e.getProvider("app-check-internal"),t)),"PUBLIC").setMultipleInstances(!0)),ue(Mr,Lr,void 0),ue(Mr,Lr,"esm2017");const Gc="functions",Jc={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Zc extends g{constructor(e,t,n){super(`functions/${e}`,t||""),this.details=n}}class Yc{constructor(e,t,n){this.auth=null,this.messaging=null,this.appCheck=null,this.auth=e.getImmediate({optional:!0}),this.messaging=t.getImmediate({optional:!0}),this.auth||e.get().then((e=>this.auth=e),(()=>{})),this.messaging||t.get().then((e=>this.messaging=e),(()=>{})),this.appCheck||n.get().then((e=>this.appCheck=e),(()=>{}))}async getAuthToken(){if(this.auth)try{const e=await this.auth.getToken();return null==e?void 0:e.accessToken}catch(e){return}}async getMessagingToken(){if(this.messaging&&"Notification"in self&&"granted"===Notification.permission)try{return await this.messaging.getToken()}catch(e){return}}async getAppCheckToken(){if(this.appCheck){const e=await this.appCheck.getToken();return e.error?null:e.token}return null}async getContext(){return{authToken:await this.getAuthToken(),messagingToken:await this.getMessagingToken(),appCheckToken:await this.getAppCheckToken()}}}class Qc{constructor(e,t,n,r,i="us-central1",s){this.app=e,this.fetchImpl=s,this.emulatorOrigin=null,this.contextProvider=new Yc(t,n,r),this.cancelAllRequests=new Promise((e=>{this.deleteService=()=>Promise.resolve(e())}));try{const e=new URL(i);this.customDomain=e.origin,this.region="us-central1"}catch(e){this.customDomain=null,this.region=i}}_delete(){return this.deleteService()}_url(e){const t=this.app.options.projectId;return null!==this.emulatorOrigin?`${this.emulatorOrigin}/${t}/${this.region}/${e}`:null!==this.customDomain?`${this.customDomain}/${e}`:`https://${this.region}-${t}.cloudfunctions.net/${e}`}}async function Xc(e,t,n,r){let i;n["Content-Type"]="application/json";try{i=await r(e,{method:"POST",body:JSON.stringify(t),headers:n})}catch(e){return{status:0,json:null}}let s=null;try{s=await i.json()}catch(e){}return{status:i.status,json:s}}const el="@firebase/functions",tl="0.7.6";function nl(e,t,n){return function(e,t,n){return r=>async function(e,t,n,r){const i=e._url(t),s={data:n=Kc(n)},o={},a=await e.contextProvider.getContext();a.authToken&&(o.Authorization="Bearer "+a.authToken),a.messagingToken&&(o["Firebase-Instance-ID-Token"]=a.messagingToken),null!==a.appCheckToken&&(o["X-Firebase-AppCheck"]=a.appCheckToken);const c=function(e){let t=null;return{promise:new Promise(((n,r)=>{t=setTimeout((()=>{r(new Zc("deadline-exceeded","deadline-exceeded"))}),e)})),cancel:()=>{t&&clearTimeout(t)}}}(r.timeout||7e4),l=await Promise.race([Xc(i,s,o,e.fetchImpl),c.promise,e.cancelAllRequests]);if(c.cancel(),!l)throw new Zc("cancelled","Firebase Functions instance was deleted.");const u=function(e,t){let n,r=function(e){if(e>=200&&e<300)return"ok";switch(e){case 0:case 500:return"internal";case 400:return"invalid-argument";case 401:return"unauthenticated";case 403:return"permission-denied";case 404:return"not-found";case 409:return"aborted";case 429:return"resource-exhausted";case 499:return"cancelled";case 501:return"unimplemented";case 503:return"unavailable";case 504:return"deadline-exceeded"}return"unknown"}(e),i=r;try{const e=t&&t.error;if(e){const t=e.status;if("string"==typeof t){if(!Jc[t])return new Zc("internal","internal");r=Jc[t],i=t}const s=e.message;"string"==typeof s&&(i=s),n=e.details,void 0!==n&&(n=$c(n))}}catch(e){}return"ok"===r?null:new Zc(r,i,n)}(l.status,l.json);if(u)throw u;if(!l.json)throw new Zc("internal","Response is not valid JSON object.");let h=l.json.data;if(void 0===h&&(h=l.json.result),void 0===h)throw new Zc("internal","Response is missing data field.");return{data:$c(h)}}(e,t,r,n||{})}(U(e),t,n)}var rl;rl=fetch.bind(self),ie(new F(Gc,((e,{instanceIdentifier:t})=>{const n=e.getProvider("app").getImmediate(),r=e.getProvider("auth-internal"),i=e.getProvider("messaging-internal"),s=e.getProvider("app-check-internal");return new Qc(n,r,i,s,t,rl)}),"PUBLIC").setMultipleInstances(!0)),ue(el,tl,void 0),ue(el,tl,"esm2017");var il={apiKey:"AIzaSyBe1CQlVamPQSYOmguNTsvqNvssUvN-8xU",authDomain:"zany-gumballs.firebaseapp.com",databaseURL:"https://zany-gumballs-default-rtdb.firebaseio.com",projectId:"zany-gumballs",storageBucket:"zany-gumballs.appspot.com",messagingSenderId:"172092464993",appId:"1:172092464993:web:eec3b3b589104ef0be6f20",measurementId:"G-62E2MJ32C7"},sl=["330504","330501","330495","330490","330487","295563","295562","295561","295560","295559","295558","295557","254475","234211","119963","119799","112103","112098","112093","112091","112090","112089","112083","112076","110470","110469","110468","110467","110463","110456","110454","110449","110444","110419","110416","110413","110410","110406","110405","110404","110401","110395","110391","110389","110385","110384","110381","110379"],ol=["clunk_bw","me_bw","link_bw","chum_bw","nan_bw","zim","rye","rafe","kay","ice","bae","abe","bop_saves_galaxy","mooch_bw","dave","eke_two_sides","pi","pam","kipp","grey","jill","holt","fuse","elle","yam","trish","stan","sis","shar","sauce","rush","roy","prim","nan","mooch","mike","me","link","kells","jet","hue","faith","eke","dapp","clunk","chum","bud","bop"],al=["dave","pi","pam","kipp","grey","jill","holt","fuse","elle"];function cl(e,t,n,r,i,s,o){try{var a=e[s](o),c=a.value}catch(e){return void n(e)}a.done?t(c):Promise.resolve(c).then(r,i)}function ll(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var s=e.apply(t,n);function o(e){cl(s,r,i,o,a,"next",e)}function a(e){cl(s,r,i,o,a,"throw",e)}o(void 0)}))}}function ul(e){return function(e){if(Array.isArray(e))return hl(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return hl(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?hl(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function hl(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}document.addEventListener("DOMContentLoaded",(function(){var e,t,n,s,o,a,c,l="zanygumballs",u=document.querySelector(".grid"),h=document.getElementsByClassName("score"),d=document.getElementById("progress-front"),p=document.getElementById("moves-left"),f=document.getElementById("section-login"),_=document.getElementById("btn-menu"),m=document.querySelector(".links"),g=document.getElementById("chance-bar").getElementsByClassName("chnc"),y=document.getElementsByClassName("chances-left"),v=document.getElementById("login-result"),w=document.getElementById("login"),b=document.getElementById("logout"),k=document.getElementById("enter"),E=document.getElementById("rank"),T=document.getElementById("score-high"),S=document.getElementById("interval"),I=document.querySelector(".interval-text"),x=document.querySelector(".loader"),A=document.querySelector(".game-timer"),N=document.getElementById("interval-timer"),P=document.querySelector(".game-period-info"),O=document.getElementById("btn-buy-chnc"),R=document.getElementById("shop-close-btn"),D=document.querySelector(".in-game-shop"),M=document.getElementById("btn-buy-one-chnc"),L=document.getElementById("btn-reset-all-chnc"),F=document.querySelector(".player-balance"),j=sessionStorage.getItem("userLoggedIn"),q='<img src="./imgs/transparent.png" class="img-gumball" alt="" />',W=new Audio("./audios/bubble_pop_pitch_sharp2.mp3"),V=new Audio("./audios/plop.mp3"),H="show-in-game-shop",K=function(e,t={}){"object"!=typeof t&&(t={name:t});const n=Object.assign({name:"[DEFAULT]",automaticDataCollectionEnabled:!1},t),r=n.name;if("string"!=typeof r||!r)throw oe.create("bad-app-name",{appName:String(r)});const i=te.get(r);if(i){if(C(e,i.options)&&C(n,i.config))return i;throw oe.create("duplicate-app",{appName:r})}const s=new B(r);for(const e of ne.values())s.addComponent(e);const o=new ae(e,n,s);return te.set(r,o),o}(il),$=function(e=le()){const t=se(e,"auth");return t.isInitialized()?t.getImmediate():function(e,t){const n=se(e,"auth");if(n.isInitialized()){const e=n.getImmediate();if(C(n.getOptions(),null!=t?t:{}))return e;me(e,"already-initialized")}return n.initialize({options:t})}(e,{popupRedirectResolver:xn,persistence:[Zt,Rt,zt]})}(),G=(function(e=le()){const t=se(e=U(e),fr);t.isInitialized()?t.getImmediate():function(e,t={}){const n=se(e,fr);if(n.isInitialized()){const e=n.getImmediate();if(C(t,n.getOptions()))return e;throw yr.create("already-initialized")}n.initialize({options:t})}(e)}(K),function(e=le(),t){return se(e,"database").getImmediate({identifier:t})}(K)),J=function(e=le(),t="us-central1"){return se(U(e),Gc).getImmediate({identifier:t})}(K,"us-central1"),Z=(nl(J,"saveScore"),nl(J,"removeOneChance")),Y=nl(J,"addNewUser"),Q=nl(J,"addOneChance"),X=nl(J,"resetAllChances"),ee=new r.WaxJS({rpcEndpoint:"https://wax.greymass.com",tryAutoLogin:!0}),re=new i.ExplorerApi("https://wax.api.atomicassets.io","atomicassets",{fetch}),ie="386247",ce=[],ue=0,he=0,de=30,pe=Ie(),fe=ce[pe],_e="",ge="",ye=!0,ve=0;function we(){return(we=ll(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ee.isAutoLoginAvailable();case 2:if(!e.sent){e.next=4;break}ke();case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function be(){return(be=ll(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,ee.login();case 3:ke(),e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),console.log(e.t0);case 9:case"end":return e.stop()}}),e,null,[[0,6]])})))).apply(this,arguments)}function ke(){Be(),k.textContent=ee.userAccount,o=(o=ee.userAccount).replace(/\./g,"_"),Ee()}function Ee(){Uc(Rc(G,"users/".concat(o)),(function(e){if(e.exists()){var t=e.val(),n=t.chances_left;s<n?(s=n,Me(),Se()):s=n,he=t.high_score,ye&&j?(ye=!1,T.textContent=he.toString(),Me(),Se()):ye&&!j&&(ye=!1,T.textContent=he.toString(),Me(),function(){Te.apply(this,arguments)}())}else Y({user_id:o}).then((function(e){null!==e&&(s=e.data.chances_left)})).catch((function(e){return console.log(e)}))}))}function Te(){return(Te=ll(regeneratorRuntime.mark((function e(){var t,r,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,re.getAccountCollection(ee.userAccount,l);case 3:t=e.sent,r=t.templates,i=[],r.forEach((function(e){i.push(e.template_id)})),i.includes(ie)?(n=[],i.forEach((function(e){sl.includes(e)&&n.push(e)})),n.length>=6?(sessionStorage.setItem("userLoggedIn",!0),sessionStorage.setItem("userAddress",o),sessionStorage.setItem("userStickerTemplateIds",JSON.stringify(n)),Fe(),Le(),w.textContent=ee.userAccount,Se()):(v.style.display="block",v.textContent="Sorry you can't enter you need at least 6 zany gumballs to play the game, you have ".concat(n.length,' as of now. Buy Some Gumballs\n          <a href="https://wax.atomichub.io/market?collection_name=zanygumballs&order=desc&schema_name=stickers&sort=created&symbol=WAX">here</a>'))):(v.style.display="block",v.textContent="Sorry you can't enter, You do not have Zany Pass. Ask the Owners to issue you a pass."),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),console.log(e.t0);case 13:case"end":return e.stop()}}),e,null,[[0,10]])})))).apply(this,arguments)}function Se(){ce=[];var r,i,l=[];l.push.apply(l,ul(n));for(var f=0;f<6;f++){var _=(r=l)[Math.floor(Math.random()*r.length)];ce.push(ol[sl.indexOf(_)]);var m=l.indexOf(_);-1!=m&&l.splice(m,1)}!function(){u.innerHTML="",t=[];for(var e=0;e<64;e++)Ce(e)}(),s>0&&(function(){var n,r,i,a,l,u;function f(){_.call(this)}function _(){i=this.querySelector(".img-gumball").getAttribute("src"),u=this.querySelector(".img-gumball").getAttribute("alt"),n=parseInt(this.id)}function m(e){e.preventDefault()}function g(e){e.preventDefault()}function y(){}function v(e){e.preventDefault(),w.call(this)}function w(){r=parseInt(this.id),a=this.querySelector(".img-gumball").getAttribute("src"),l=this.querySelector(".img-gumball").getAttribute("alt");var f,_=!1;n!==r-1&&n!==r+1||(n%8==0&&r<n?f=n:r%8==0&&n<r&&(f=r)),f&&(_=0!==n&&0!==r||n!==r-1&&n!==r+1);var m,g=[n-1,n-8,n+1,n+8].includes(r);if((r||i)&&g&&!_?(t[n].innerHTML='<img class="img-gumball" src="'.concat(a,'" alt="').concat(l,'" />'),t[r].innerHTML='<img class="img-gumball" src="'.concat(i,'" alt="').concat(u,'" />'),Oe(),Re(),Ne(),Ae(),r=null,i=null,l!==u&&(de-=1)):!r&&!a||g&&!_?t[n].innerHTML='<img class="img-gumball" src="'.concat(i,'" alt="').concat(u,'" />'):(t[n].innerHTML='<img class="img-gumball" src="'.concat(i,'" alt="').concat(u,'" />'),t[r].innerHTML='<img class="img-gumball" src="'.concat(a,'" alt="').concat(l,'" />')),de<1){var y=5;N.textContent=y,de=s>0?30:0,S.style.display="flex",I.style.display="block",x.style.display="none",Me(),clearInterval(c),A.textContent="00:00";var v=setInterval((function(){y>0?(y--,N.textContent=y.toString()):(S.style.display="none",I.style.display="none",x.style.display="block",Le(),function(){if(ue>he){var e={high_score:ue,time_taken_high_score:ve,zany_pts_hscore:ue/ve};zc(Rc(G,"users/".concat(o)),e).then((function(){T.textContent=he.toString()})).catch((function(e){console.log(e)}))}ue=0,d.style.width="0rem",ul(h).forEach((function(e){e.textContent=ue})),Se()}(),clearInterval(v))}),1e3)}else 29===de&&(Z({user_id:o}).then((function(e){null!==e&&console.log(e)})).catch((function(e){console.log(e.message)})),function(){ve=0;var e="00",t="00",n="00:00";console.log("timer start"),c=setInterval((function(){e=Math.floor(ve/60),t=ve>=60?ve%60:ve,e>10&&t>10?(e="".concat(e),t="".concat(t)):e>10&&t<10?(e="".concat(e),t="0".concat(t)):e<10&&t>10?(e="0".concat(e),t="".concat(t)):e<10&&t<10&&(e="0".concat(e),t="0".concat(t)),n="".concat(e,":").concat(t),A.textContent=n,ve++}),1e3)}(),m="show-game-period-info",P.classList.add(m),setTimeout((function(){P.classList.remove(m)}),4e3),clearTimeout(e),je());p.textContent=de.toString()}function b(){}function k(){""===_e?(_e=this.id,this.style.backgroundColor="aquamarine",_.call(this)):(ge=this.id,this.style.backgroundColor="goldenrod",w.call(this),t[_e].style.backgroundColor="",t[ge].style.backgroundColor="",_e="",ge="")}t.forEach((function(e){return e.addEventListener("dragstart",f)})),t.forEach((function(e){return e.addEventListener("dragend",b)})),t.forEach((function(e){return e.addEventListener("dragover",m)})),t.forEach((function(e){return e.addEventListener("dragenter",g)})),t.forEach((function(e){return e.addEventListener("dragleave",y)})),t.forEach((function(e){return e.addEventListener("drop",v)})),t.forEach((function(e){return e.addEventListener("click",k)}))}(),void 0!==a&&clearInterval(a),a=setInterval((function(){!function(){for(var e=0;e<=63;e++)if("./imgs/transparent.png"===t[e].querySelector(".img-gumball").getAttribute("src")){if(e>=8)t[e].innerHTML=t[e-8].innerHTML,t[e-8].innerHTML=q;else if(e<=7){var n=Ie();t[e].innerHTML='<img src="./imgs/'.concat(ce[n],'.png" class="img-gumball" alt="').concat(ce[n],'" />')}W.play()}}(),Oe(),Re(),Ne(),Ae()}),50*s)),Uc(function(e,...t){let n=U(e);for(const e of t)n=e._apply(n);return n}(Rc(G,"leaderboard"),(Ya("orderByChild","path",i="highScore",!1),new qc(i)),function(e=null,t){return function(e,t,n,r){if(!(r&&void 0===n||$a(n)))throw new Error(z(e,t)+'was an invalid key = "'+n+'".  Firebase keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]").')}("startAt","key",t,!0),new jc(e,t)}(1)),(function(e){var t={};e.forEach((function(e){t[e.key]=e.val()})),null!==t&&function(e){var t=Object.keys(e);t.reverse(),t.includes(o)?E.textContent=(t.indexOf(o)+1).toString():E.textContent="0"}(t)})),Ue()}function Ie(){return Math.floor(Math.random()*ce.length)}function Ce(e){pe=Ie(),e>8?ce[pe]!=document.getElementById(e-2).getElementsByTagName("img")[0].getAttribute("alt")&&ce[pe]!=document.getElementById(e-8).getElementsByTagName("img")[0].getAttribute("alt")?xe(e):Ce(e):ce[pe]!=fe?xe(e):Ce(e)}function xe(e){var n=document.createElement("div");n.setAttribute("draggable",!0),n.setAttribute("id",e),n.innerHTML='<img class="img-gumball" src="./imgs/'.concat(ce[pe],'.png" alt="').concat(ce[pe],'" />'),fe=ce[pe],u.appendChild(n),t.push(n)}function Ae(e){for(var n=function(e){var n=[e,e+1,e+2],r=t[e].querySelector(".img-gumball").getAttribute("alt"),i=""===t[e].querySelector(".img-gumball").getAttribute("alt");(n[0]+1)%8!=0&&(n[1]+1)%8!=0&&n.every((function(e){return t[e].querySelector(".img-gumball").getAttribute("alt")===r&&!i}))&&(V.play(),n.forEach((function(e){t[e].style.backgroundColor="goldenrod"})),s>-1&&ze(3,r),setTimeout((function(){n.forEach((function(e){t[e].style.backgroundColor="",t[e].innerHTML=q}))}),150))},r=0;r<=61;r++)n(r)}function Ne(){for(var e=function(e){var n=[e,e-8,e+8],r=t[e].querySelector(".img-gumball").getAttribute("alt"),i=""===t[e].querySelector(".img-gumball").getAttribute("alt");n.every((function(e){return t[e].querySelector(".img-gumball").getAttribute("alt")===r&&!i}))&&(V.play(),n.forEach((function(e){t[e].style.backgroundColor="goldenrod"})),s>-1&&ze(3,r),setTimeout((function(){n.forEach((function(e){t[e].innerHTML=q,t[e].style.backgroundColor=""}))}),150))},n=8;n<=55;n++)e(n)}function Oe(){for(var e=function(e){var n=[e,e+1,e+2,e+3],r=t[e].querySelector(".img-gumball").getAttribute("alt"),i=""===t[e].querySelector(".img-gumball").getAttribute("alt");(n[0]+1)%8!=0&&(n[1]+1)%8!=0&&(n[2]+1)%8!=0&&n.every((function(e){return t[e].querySelector(".img-gumball").getAttribute("alt")===r&&!i}))&&(V.play(),n.forEach((function(e){t[e].style.backgroundColor="goldenrod"})),s>-1&&ze(4,r),setTimeout((function(){n.forEach((function(e){t[e].innerHTML=q,t[e].style.backgroundColor=""}))}),150))},n=0;n<=60;n++)e(n)}function Re(){for(var e=function(e){var n=[e,e-8,e+8,e+16],r=t[e].querySelector(".img-gumball").getAttribute("alt"),i=""===t[e].querySelector(".img-gumball").getAttribute("alt");n.every((function(e){return t[e].querySelector(".img-gumball").getAttribute("alt")===r&&!i}))&&(V.play(),n.forEach((function(e){t[e].style.backgroundColor="goldenrod"})),s>-1&&ze(4,r),setTimeout((function(){n.forEach((function(e){t[e].innerHTML=q,t[e].style.backgroundColor=""}))}),150))},n=8;n<=47;n++)e(n)}function ze(e,t){var n;n=al.includes(t)?e+2:e;var r,i,s=.06*(ue+=n);d.style.width=s+"rem",ul(h).forEach((function(e){e.textContent=ue})),r=Rc(G,"users/".concat(o)),(i={score:ue,time_taken_score:ve,zany_pts_score:ue/ve}).zany_pts_score===1/0&&(i.score=0,i.time_taken_score=0,i.zany_pts_score=0),zc(r,i).then((function(){})).catch((function(e){console.log(e)}))}function Me(){console.log("chances left",s),ul(y).forEach((function(e){e.textContent=s.toString()})),ul(g).forEach((function(e){e.style.display="inline-block"}));for(var e=4;e>=s;e--)g[e].style.display="none"}function Le(){S.style.display="flex",I.style.display="none",x.style.display="block"}function Ue(){S.style.display="none",I.style.display="block",x.style.display="none"}function Fe(){f.style.display="none"}function je(){e=setTimeout((function(){location.reload()}),36e5)}function qe(){D.classList.remove(H)}function Be(){ll(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0="",e.next=3,ee.rpc.get_currency_balance("metatoken.gm",ee.userAccount,"ZANY");case 3:e.t1=e.sent,F.textContent=e.t0.concat.call(e.t0,e.t1);case 5:case"end":return e.stop()}}),e)})))()}function We(e){return Ve.apply(this,arguments)}function Ve(){return Ve=ll(regeneratorRuntime.mark((function e(t){var n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,ee.isAutoLoginAvailable();case 3:if(e.sent){e.next=6;break}return e.next=6,ee.login();case 6:return e.next=8,ee.api.transact({actions:[{account:"metatoken.gm",name:"transfer",authorization:[{actor:ee.userAccount,permission:"active"}],data:{from:ee.userAccount,to:"zanygumplays",quantity:"".concat(10*t,".0000 ZANY"),memo:"I hereby declare to be granted ".concat(t," chances")}}]},{blocksBehind:3,expireSeconds:1200});case 8:n=e.sent,console.log(n),r={user_id:o,trx_id:n.transaction_id},n.processed&&1===t?Q(r).then((function(){Me(),qe(),Le()})).catch((function(e){console.log(e)})):n.processed&&5===t&&X(r).then((function(){Me(),qe(),Le()})).catch((function(e){console.log(e)})),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(0),console.log(e.t0);case 17:case"end":return e.stop()}}),e,null,[[0,14]])}))),Ve.apply(this,arguments)}Le(),async function(e){var t;const n=ut(e);if(await n._initializationPromise,null===(t=n.currentUser)||void 0===t?void 0:t.isAnonymous)return new It({user:n.currentUser,providerId:null,operationType:"signIn"});const r=await async function(e,t){return De(e,"POST","/v1/accounts:signUp",Pe(e,t))}(n,{returnSecureToken:!0}),i=await It._fromIdTokenResponse(n,"signIn",r,!0);return await n._updateCurrentUser(i.user),i}($).then((function(){var e;Ue(),j?(Fe(),Le(),o=sessionStorage.getItem("userAddress"),w.textContent=o.replace(/\_/g,"."),(e=n=[]).push.apply(e,ul(JSON.parse(sessionStorage.getItem("userStickerTemplateIds")))),Ee()):function(){we.apply(this,arguments)}()})).catch((function(e){console.log(e.message)})),k.addEventListener("click",(function(){return be.apply(this,arguments)})),b.addEventListener("click",(function(){location.reload(),sessionStorage.removeItem("userLoggedIn")})),_.addEventListener("click",(function(){m.classList.toggle("show-links")})),O.addEventListener("click",(function(){D.classList.add(H),Be(),0===s?L.disabled=!1:s<5&&(M.disabled=!1)})),R.addEventListener("click",(function(){qe()})),M.addEventListener("click",(function(){We(1)})),L.addEventListener("click",(function(){console.log("click"),We(5)})),je()}))}},t={};function n(r){var i=t[r];if(void 0!==i)return i.exports;var s=t[r]={id:r,loaded:!1,exports:{}};return e[r].call(s.exports,s,s.exports,n),s.loaded=!0,s.exports}n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),n(7588),n(1303)})();